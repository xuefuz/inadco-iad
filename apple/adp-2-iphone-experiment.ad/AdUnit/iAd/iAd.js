
/**
*
* Copyright Â© 2009 - 2012 Apple Inc.  All rights reserved.
*
**/

/* iAd JS Version: 1.6.1 -  */
var iAd={};iAd.VERSION="1.6.1";iAd.Console={};iAd.Console.log=function(){window.console&&console.log&&console.log.apply(console,arguments)};iAd.Console._fallbackLog=function(a,b){b.unshift(a.toUpperCase()+":");iAd.Console.log.apply(iAd.Console,b)};iAd.Console._log=function(a,b){window.console&&console[a]?console[a].apply(console,b):iAd.Console._fallbackLog(a,Array.prototype.slice.call(b))};iAd.Console.warn=function(){iAd.Console._log("warn",arguments)};
iAd.Console.error=function(){iAd.Console._log("error",arguments)};iAd.Console.debug=function(){iAd.Console._log("debug",arguments)};iAd.Console.assert=function(){if(window.console&&console.assert)console.assert.apply(console,arguments);else arguments[0]||iAd.Console._fallbackLog("assert",[arguments[1]||""])};iAd.Console.info=function(){iAd.Console._log("info",arguments)};iAd.Utils={};iAd.Utils.copyPropertiesFromSourceToTarget=function(a,b){for(var c in a)b[c]=a[c]};
iAd.Utils.objectIsFunction=function(a){return typeof a=="function"};iAd.Utils.objectIsString=function(a){return typeof a=="string"||a instanceof String};iAd.Utils.objectIsArray=function(a){return a instanceof Array};iAd.Utils.objectIsPrimitive=function(a){return a==null||typeof a=="number"||typeof a=="boolean"||this.objectIsString(a)};iAd.Utils.objectHasMethod=function(a,b){return a!=null&&a[b]!==undefined&&this.objectIsFunction(a[b])};
iAd.Utils.objectIsInstanceOfClass=function(a,b){return b!=null&&a instanceof b};iAd.Utils.resolveObjectPathFrom=function(a,b,c){if(!(!b||b[0]==".")){b=b.split(".");for(var d,e,f=0,g=b.length;a!=null&&f<g;f++){e=b[f];d=a[e];if(c&&d==null)d=a[e]={};a=d}return a}};iAd.Utils.resolveObjectPath=function(a,b){return iAd.Utils.resolveObjectPathFrom(window,a,b)};
iAd.Utils.setupDisplayNames=function(a,b){b=b||a.displayName||a.name;a.displayName=a.displayName||b;for(var c in a)if(!a.__lookupGetter__(c)){var d=a[c];if(iAd.Utils.objectIsFunction(d))d.displayName=iAd.Utils.createDisplayName(b,c)}for(c in a.prototype)if(!a.prototype.__lookupGetter__(c)){d=a.prototype[c];if(iAd.Utils.objectIsFunction(d))d.displayName=iAd.Utils.createDisplayName(b,c,true)}};iAd.Utils.createDisplayName=function(a,b,c){return a+(c?".":"#")+b+"()"};
iAd.Utils.setupDisplayNames(iAd.Utils,"iAd.Utils");iAd.Array={};iAd.Array.removeObjectFromArray=function(a,b){var c=b.indexOf(a);if(c==-1)return false;b.splice(c,1);return true};iAd.Utils.setupDisplayNames(iAd.Array,"iAd.Array");iAd.Analytics={_observedObjects:{},_messagesById:{},_uid:1};iAd.Analytics.logsToConsole=false;iAd.Analytics.NAME_TO_SYMBOL_MAP={analyticsObjectId:"as",analyticsName:"an",analyticsType:"at",analyticsSectionId:"k"};
iAd.Analytics.log=function(a){if(a==null)iAd.Console.warn("iAd.Analytics.log requires a valid parameter.");else{var b={},c;for(var d in a)if(d in this.NAME_TO_SYMBOL_MAP)b[this.NAME_TO_SYMBOL_MAP[d]]=a[d];else{if(c==null)c={};c[d]=a[d]}if(c!=null)b.a=c;a={v:iAd.VERSION};a[Date.now()]=b;this.composeMessage(a)}};iAd.Analytics.setMessageForId=function(a,b){if(b&&a)this._messagesById[b]=a};
iAd.Analytics.updateMessageWithId=function(a,b){var c=this._messagesById[a];c&&b&&iAd.Utils.copyPropertiesFromSourceToTarget(b,c)};iAd.Analytics.logMessageWithId=function(a,b,c){if(a=this._messagesById[a]){var d={};iAd.Utils.copyPropertiesFromSourceToTarget(a,d);c&&c.analyticsDetails&&iAd.Utils.copyPropertiesFromSourceToTarget(c.analyticsDetails,d);b&&iAd.Utils.copyPropertiesFromSourceToTarget(b,d);for(key in d){value=d[key];d[key]=iAd.Utils.objectIsFunction(value)?value.call(c||this):value}this.log(d)}};
iAd.Analytics.logEvent=function(a,b,c){var d=b.id||b._analyticsId;if(d)if(d=this._observedObjects[d])(a=d[a])&&a.forEach(function(e){this.logMessageWithId(e,c,b)},this)};iAd.Analytics.registerMessageForEvent=function(a,b,c){if(c){var d;d=iAd.Utils.objectIsString(c)?c:c.id?c.id:c._analyticsId?c._analyticsId:c._analyticsId=this.uniqueId();if(b&&a){(c=this._observedObjects[d])||(c=this._observedObjects[d]={});(d=c[b])||(d=c[b]=[]);d.indexOf(a)==-1&&d.push(a)}}};
iAd.Analytics.unregisterMessageForEvent=function(a,b,c){if(c){c=iAd.Utils.objectIsString(c)?c:c.id||c._analyticsId;if(!(!c||!b||!a))if(c=this._observedObjects[c])(b=c[b])&&iAd.Array.removeObjectFromArray(a,b)}};iAd.Analytics.composeMessage=function(a){a=JSON.stringify(a);window.hasOwnProperty("ad")&&window.ad.reportClickEvent(a);this.logsToConsole&&iAd.Console.log("[ANALYTICS]: "+a)};
iAd.Analytics.processAnalyticsWithConfiguration=function(a){var b=a.messages;if(b)for(var c in b)this.setMessageForId(b[c],c);(a=a.messagesForEvents)&&a.forEach(function(d){this.registerMessageForEvent(d.messageId,d.eventType,d.objectId)},this)};iAd.Analytics.uniqueId=function(){return"analytics-"+this._uid++};iAd.Event={};iAd.Event.notificationEvents={};iAd.Event.registerForNotificationEvent=function(a){iAd.Event.notificationEvents[a]=true};iAd.Event.SUPPORTS_TOUCHES="createTouch"in document;
iAd.Event.START_EVENT=iAd.Event.SUPPORTS_TOUCHES?"touchstart":"mousedown";iAd.Event.MOVE_EVENT=iAd.Event.SUPPORTS_TOUCHES?"touchmove":"mousemove";iAd.Event.END_EVENT=iAd.Event.SUPPORTS_TOUCHES?"touchend":"mouseup";iAd.Event.CANCEL_EVENT="touchcancel";iAd.Event.createUIEvent=function(a,b){return iAd.Event.SUPPORTS_TOUCHES?this.createEventWithTouch(a,b):this.createEventWithMouse(a,b)};
iAd.Event.createEventWithTouch=function(a,b){var c=document.createEvent("TouchEvent");c.initTouchEvent(a,b.bubbles,b.cancelable,window,b.detail,b.screenX,b.screenY,b.clientX,b.clientY,b.ctrlKey,b.altKey,b.shiftKey,b.metaKey,b.touches,b.targetTouches,b.changedTouches,b.scale,b.rotation);return c};
iAd.Event.createEventWithMouse=function(a,b){var c=document.createEvent("MouseEvent");c.initMouseEvent(a,b.bubbles,b.cancelable,document.defaultView,b.detail,b.screenX,b.screenY,b.clientX,b.clientY,b.ctrlKey,b.altKey,b.shiftKey,b.metaKey,b.metaKey,b.button,b.relatedTarget);return c};iAd.Event.preventDefault=function(a){a.preventDefault()};iAd.Event.eventHandlerForString=function(a){var b=new Function(a);return function(c){b.call(null,c)}};iAd.Event.KEYBOARD_BACKSPACE=8;iAd.Event.KEYBOARD_LEFT=37;
iAd.Event.KEYBOARD_RIGHT=39;iAd.Event.KEYBOARD_UP=38;iAd.Event.KEYBOARD_DOWN=40;iAd.Event.KEYBOARD_RETURN=13;iAd.Utils.setupDisplayNames(iAd.Event,"iAd.Event");iAd.EventTarget={};iAd.EventTarget.addEventListener=function(a,b,c){if(this.eventTarget){iAd.Event.registerForNotificationEvent(a);this.eventTarget.addEventListener(a,b,c)}else iAd.Console.warn("iAd.EventTarget.addEventListener: cannot add event listener since no eventTarget was specified by the mixing object.")};
iAd.EventTarget.removeEventListener=function(a,b,c){this.eventTarget?this.eventTarget.removeEventListener(a,b,c):iAd.Console.warn("iAd.EventTarget.removeEventListener: cannot remove event listener since no eventTarget was specified by the mixing object.")};iAd.EventTarget.dispatchEvent=function(a){this.eventTarget?this.eventTarget.dispatchEvent(a):iAd.Console.warn("iAd.EventTarget.dispatchEvent: cannot dispatch event since no eventTarget was specified by the mixing object.")};
iAd.EventTarget.dispatchNotification=function(a,b,c){this.notifyDelegate(a,b,c);this.createAndDispatchEvent(a,c)};iAd.EventTarget.notifyDelegate=function(a,b,c){if(iAd.Utils.objectHasMethod(b,a)){var d=[this];if(c)d=d.concat(c.map(function(e){return e[1]}));b[a].apply(b,d)}};iAd.EventTarget.createEvent=function(a,b){var c=document.createEvent("Event");c.initEvent(a,true,false);if(!c.ad)c.ad={};c.ad.sender=this;if(b)for(var d=0,e=b.length;d<e;d++)c.ad[b[d][0]]=b[d][1];return c};
iAd.EventTarget.createAndDispatchEvent=function(a,b){iAd.Event.notificationEvents[a]&&this.dispatchEvent(this.createEvent(a,b))};iAd.Utils.setupDisplayNames(iAd.EventTarget,"iAd.EventTarget");
(function(){var a=iAd.EventTarget.createAndDispatchEvent;iAd.EventTarget.createAndDispatchEvent=function(c){a.apply(this,arguments);iAd.Event.notificationEvents[c]||iAd.Analytics.logEvent(c,this)};var b=iAd.EventTarget.dispatchEvent;iAd.EventTarget.dispatchEvent=function(c){b.apply(this,arguments);iAd.Analytics.logEvent(c.type,this)}})();
iAd.Class=function(a){if(typeof a==="string")a={name:a};a=a||{};a.symbol=a.symbol===undefined?a.name:a.symbol;a.name=a.name||"AnonymousClass";if(!a.superclass)if("superclass"in a)throw new ReferenceError("An undefined superclass was provided for "+a.name);else if(iAd.Object)a.superclass=iAd.Object;var b=function(){b.processed||iAd.Class.processAllClasses();b.prototype.init.apply(this,arguments)};b.processed=false;iAd.Class.unprocessedClasses.push(b);b.displayName=b._name=a.name;iAd.Utils.copyPropertiesFromSourceToTarget(a,
b);if(a.symbol&&typeof a.symbol==="string"){var c=a.symbol.split(".");a=c.pop();if(c=c.length?iAd.Utils.resolveObjectPath(c.join("."),true):window)c[a]=b}return b};iAd.Class.unprocessedClasses=[];iAd.Class.processAllClasses=function(){for(var a,b=0,c=iAd.Class.unprocessedClasses.length;b<c;b++){a=iAd.Class.unprocessedClasses[b];a.processed||iAd.Class.processClassAndHierarchy(a)}iAd.Class.unprocessedClasses=[]};
iAd.Class.processClassAndHierarchy=function(a){for(var b=[a],c=a;c=c.superclass;)b.push(c);var d;for(c=b.length-1;c>=0;c--){d=b[c];d.processed||iAd.Class.processClass(d)}for(c=b.length-1;c>=0;c--){d=b[c];iAd.Utils.objectHasMethod(d,"initialize")&&d.initialize.apply(a)}};
iAd.Class.processClass=function(a){a.mixins&&iAd.Class.mixin(a.prototype,a.mixins);for(var b=a.synthesizedProperties||[],c=0,d=b.length;c<d;c++)iAd.Class.synthesizeProperty(a.prototype,b[c]);for(var e in a.prototype)iAd.Class.processMethod(a,e);for(e in a)a.hasOwnProperty(e)&&iAd.Class.processClassMethod(a,e);if(a!==iAd.Object)a.prototype.__proto__=a.superclass.prototype;a.processed=true};
iAd.Class.synthesizeProperty=function(a,b){var c=b.charAt(0).toUpperCase()+b.substr(1),d="get"+c,e="set"+c,f="_"+b;iAd.Utils.objectHasMethod(a,e)||(a[e]=function(h){this[f]=h});c=function(h){this[e](h);this.notifyPropertyChange(b)};c.displayName="Setter for ."+b+" on "+a.constructor.displayName;iAd.Utils.objectHasMethod(a,d)||(a[d]=function(){return this[f]});var g=function(){return this[d]()};g.displayName="Getter for ."+b+" on "+a.constructor.displayName;Object.defineProperty(a,b,{get:g,set:c})};
iAd.Class.processMethod=function(a,b){var c=Object.getOwnPropertyDescriptor(a.prototype,b).value;if(iAd.Utils.objectIsFunction(c)){c._class=a;c._name=b;if(c.displayName==null)c.displayName=iAd.Utils.createDisplayName(a.displayName,b)}};iAd.Class.processClassMethod=function(a,b){var c=Object.getOwnPropertyDescriptor(a,b).value;if(iAd.Utils.objectIsFunction(c)&&c.displayName==null)c.displayName=iAd.Utils.createDisplayName(a.displayName,b,true)};
iAd.Class.mixin=function(a,b){for(var c,d=0,e=b.length;d<e;d++){c=b[d];for(var f in c)a.hasOwnProperty(f)||(a[f]=c[f])}};iAd.Class.synthesizeProperties=function(a,b){iAd.Class.processClassAndHierarchy(a);for(var c=0,d=b.length;c<d;c++)iAd.Class.synthesizeProperty(a.prototype,b[c])};iAd.Class.processMethods=function(a,b){iAd.Class.processClassAndHierarchy(a);for(var c=0,d=b.length;c<d;c++)iAd.Class.processMethod(a,b[c])};iAd.Utils.setupDisplayNames(iAd.Class,"iAd.Class");
iAd.Class({name:"iAd.Object",archivedProperties:["delegate","dataSource"]});iAd.Object.PROPERTY_CHANGED="handlePropertyChange";iAd.Object.prototype.init=function(){this.observedProperties={}};iAd.Object.DELEGATE_REG_EXP=/delegate/i;iAd.Object.DATA_SOURCE_REG_EXP=/dataSource/i;
iAd.Object.prototype.archiveProperty=function(a){var b=this[a];if(iAd.Object.DELEGATE_REG_EXP.test(a)||iAd.Object.DATA_SOURCE_REG_EXP.test(a)){if(iAd.Utils.objectIsInstanceOfClass(b,iAd.ViewController))return b.id;return b?iAd.Archiver.referenceForObject(b):null}return b};
iAd.Object.prototype.restoreProperty=function(a,b){if(iAd.Object.DELEGATE_REG_EXP.test(a)||iAd.Object.DATA_SOURCE_REG_EXP.test(a))b=iAd.ViewController&&iAd.ViewController.instances[b]?iAd.ViewController.instances[b]:iAd.Archiver.objectForReference(b);this[a]=b};
iAd.Object.prototype.callSuper=function(){var a=iAd.Object.prototype.callSuper.caller;if(iAd.Utils.objectHasMethod(a,"superclass"))a.superclass.apply(this,arguments);else{var b=a._class.superclass.prototype;a=a._name;if(iAd.Utils.objectHasMethod(b,a))return b[a].apply(this,arguments)}};iAd.Object.prototype.isPropertyObserved=function(a){return this.observedProperties[a]!==undefined};
iAd.Object.prototype.addPropertyObserver=function(a,b,c){var d=this.observedProperties[a];if(this.isPropertyObserved(a)){if(d.targets.indexOf(b)>-1)return}else d=this.observedProperties[a]={targets:[],methodNames:[]};c=c||iAd.Object.PROPERTY_CHANGED;if(iAd.Utils.objectHasMethod(b,c)){d.targets.push(b);d.methodNames.push(c)}};
iAd.Object.prototype.removePropertyObserver=function(a,b){if(!this.isPropertyObserved(a))return false;var c=this.observedProperties[a],d=c.targets.indexOf(b),e=d>-1;if(e){c.targets.splice(d,1);c.methodNames.splice(d,1);c.targets.length==0&&delete this.observedProperties[a]}return e};iAd.Object.prototype.notifyPropertyChange=function(a){if(this.isPropertyObserved(a)){var b=this.observedProperties[a],c=b.targets.slice();b=b.methodNames.slice();for(var d=0,e=c.length;d<e;d++)c[d][b[d]](this,a)}};
iAd.Object.prototype.callMethodNameAfterDelay=function(a,b){var c=this,d=Array.prototype.slice.call(arguments,2),e=function(){c[a].apply(c,d)};e.displayName=iAd.Utils.createDisplayName(this.constructor.displayName||this.constructor.name,a);return setTimeout(e,b*1E3)};iAd.Class({name:"iAd.Point",archivedProperties:["x","y"]});iAd.Point.prototype.init=function(a,b){this.callSuper();this.x=a!=null&&!isNaN(a)?a:0;this.y=b!=null&&!isNaN(b)?b:0};
iAd.Point.fromEvent=function(a){a=a.touches&&a.touches.length>0?a.touches[0]:a;return new iAd.Point(a.pageX,a.pageY)};iAd.Point.fromEventInElement=function(a,b){a=a.touches&&a.touches.length>0?a.touches[0]:a;var c=window.webkitConvertPointFromPageToNode(b,new WebKitPoint(a.pageX,a.pageY));return new iAd.Point(c.x,c.y)};iAd.Point.prototype.toString=function(){return"iAd.Point["+this.x+","+this.y+"]"};iAd.Point.prototype.copy=function(){return new iAd.Point(this.x,this.y)};
iAd.Point.prototype.equals=function(a){return this.x==a.x&&this.y==a.y};iAd.Class({name:"iAd.Size",archivedProperties:["width","height"]});iAd.Size.prototype.init=function(a,b){this.callSuper();this.width=a!=null&&!isNaN(a)?a:0;this.height=b!=null&&!isNaN(b)?b:0};iAd.Size.ZERO_SIZE=new iAd.Size(0,0);iAd.Size.prototype.toString=function(){return"iAd.Size["+this.width+","+this.height+"]"};iAd.Size.prototype.copy=function(){return new iAd.Size(this.width,this.height)};
iAd.Size.prototype.equals=function(a){return this.width==a.width&&this.height==a.height};iAd.Class({name:"iAd.Rect",archivedProperties:["origin","size"]});iAd.Rect.prototype.init=function(a,b,c,d){this.callSuper();this.origin=new iAd.Point(a||0,b||0);this.size=new iAd.Size(c||0,d||0)};iAd.Rect.ZERO_RECT=new iAd.Rect(0,0,0,0);iAd.Rect.prototype.toString=function(){return"iAd.Rect["+[this.origin.x,this.origin.y,this.size.width,this.size.height].join(", ")+"]"};
iAd.Rect.prototype.copy=function(){return new iAd.Rect(this.origin.x,this.origin.y,this.size.width,this.size.height)};iAd.Rect.prototype.equals=function(a){return this.origin.equals(a.origin)&&this.size.equals(a.size)};iAd.Rect.prototype.inset=function(a){return new iAd.Rect(this.origin.x+a.left,this.origin.y+a.top,this.size.width-a.left-a.right,this.size.height-a.top-a.bottom)};iAd.Rect.prototype.minX=function(){return this.origin.x};iAd.Rect.prototype.minY=function(){return this.origin.y};
iAd.Rect.prototype.midX=function(){return this.origin.x+this.size.width/2};iAd.Rect.prototype.midY=function(){return this.origin.y+this.size.height/2};iAd.Rect.prototype.maxX=function(){return this.origin.x+this.size.width};iAd.Rect.prototype.maxY=function(){return this.origin.y+this.size.height};
iAd.Rect.prototype.intersectionWithRect=function(a){var b=new iAd.Rect,c=Math.max(this.minX(),a.minX()),d=Math.min(this.maxX(),a.maxX());if(c>d)return iAd.Rect.ZERO_RECT;b.origin.x=c;b.size.width=d-c;c=Math.max(this.minY(),a.minY());a=Math.min(this.maxY(),a.maxY());if(c>a)return iAd.Rect.ZERO_RECT;b.origin.y=c;b.size.height=a-c;return b};iAd.Class({name:"iAd.EdgeInsets",archivedProperties:["top","right","bottom","left"]});
iAd.EdgeInsets.prototype.init=function(a,b,c,d){this.top=a;this.right=b;this.bottom=c;this.left=d};iAd.EdgeInsets.prototype.equals=function(a){return this.top==a.top&&this.right==a.right&&this.bottom==a.bottom&&this.left==a.left};iAd.EdgeInsets.prototype.copy=function(){return new iAd.EdgeInsets(this.top,this.right,this.bottom,this.left)};iAd.CSS={};iAd.CSS.t=function(a,b){return iAd.CSS.t3d(a,b,0)};
iAd.CSS.t3d=function(a,b,c){iAd.CSS.sanitizeNumberArguments(arguments);return"translate3d("+a+"px, "+b+"px, "+c+"px)"};iAd.CSS.r3d=function(a,b,c,d){iAd.CSS.sanitizeNumberArguments(arguments);return"rotate3d("+a+", "+b+", "+c+", "+d+"rad)"};iAd.CSS.roundedPxValue=function(a){var b=window.devicePixelRatio;return(a*b|0)/b};iAd.CSS.tm=function(a,b){iAd.CSS.sanitizeNumberArguments(arguments);return"matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, "+a+", "+b+", 0, 1)"};
iAd.CSS.matrixFromString=function(a){var b="";if(a.length>0&&a!="none")b=a.replace(/([^(]*)\(([^)]*)\)/g,function(c,d,e){c=e.replace(/(\-?[0-9.]+(?:e\-?[0-9]+)?)([^,]*)/g,function(f,g,h){g=parseFloat(g);return g.toFixed(6)+h});return d+"("+c+")"});return new WebKitCSSMatrix(b)};iAd.CSS.concatenateTransforms=function(){for(var a=[],b=0,c=arguments.length;b<c;b++){var d=arguments[b];d&&d!="none"&&a.push(d)}return a.join(" ")};
iAd.CSS.isClassNameValid=function(a){return a!=null&&a!=""&&a===String(a).replace(/\s/g,"")};iAd.CSS.matrixEqualsToMatrix=function(a,b){for(var c=1;c<=4;c++)for(var d=1;d<=4;d++){var e="m"+c+d;if(a[e]!==b[e])return false}return true};iAd.CSS.widthForTextAndFont=function(a,b){if(!this.textMeasuringCanvasContext)this.textMeasuringCanvasContext=document.createElement("canvas").getContext("2d");if(b)this.textMeasuringCanvasContext.font=b;return this.textMeasuringCanvasContext.measureText(a).width};
iAd.CSS.isStyleSheetLoaded=function(a){return iAd.CSS.elementForStyleSheet(a)!=null};iAd.CSS.elementForStyleSheet=function(a){for(var b,c=document.styleSheets,d=0,e=c.length;d<e;d++){b=c[d];if(b.href==a)return b}return null};iAd.CSS.flushPendingUpdates=function(){};iAd.CSS.sanitizeNumberArguments=function(a){for(var b=0,c=a.length;b<c;b++)if(typeof a[b]=="number")a[b]=a[b].toFixed(20)};iAd.Utils.setupDisplayNames(iAd.CSS,"iAd.CSS");iAd.Element={};iAd.Element.HTML5_CUSTOM_ATTRIBUTE_PREFIX="data-";
iAd.Element.ATTRIBUTE_PREFIX="ad-";iAd.Element.elementFromString=function(a){var b=document.createRange();b.selectNode(document.body);for(a=b.createContextualFragment(a).firstChild;a.nodeType!=Node.ELEMENT_NODE&&a.nextSibling;)a=a.nextSibling;return a};iAd.Element.hasCustomAttribute=function(a,b){return a.hasAttribute(iAd.Element.HTML5_CUSTOM_ATTRIBUTE_PREFIX+b)||a.hasAttribute(b)};
iAd.Element.getCustomAttribute=function(a,b){var c=a.getAttribute(iAd.Element.HTML5_CUSTOM_ATTRIBUTE_PREFIX+b);return iAd.Utils.objectIsString(c)?c:a.getAttribute(b)};iAd.Element.SUPPORTS_CLASS_LIST="classList"in document.documentElement;Element.prototype.hasClassName=iAd.Element.SUPPORTS_CLASS_LIST?function(a){return iAd.CSS.isClassNameValid(a)&&this.classList.contains(a)}:function(a){return RegExp("(?:^|\\s+)"+a+"(?:\\s+|$)").test(this.className)};
Element.prototype.addClassName=iAd.Element.SUPPORTS_CLASS_LIST?function(a){if(!iAd.CSS.isClassNameValid(a)||this.classList.contains(a))return false;this.classList.add(a);return true}:function(a){if(this.hasClassName(a))return false;else{this.className=[this.className,a].join(" ");return true}};
Element.prototype.removeClassName=iAd.Element.SUPPORTS_CLASS_LIST?function(a){if(iAd.CSS.isClassNameValid(a)&&this.classList.contains(a)){this.classList.remove(a);return true}return false}:function(a){if(this.hasClassName(a)){this.className=this.className.replace(RegExp("(?:^|\\s+)"+a+"(?:\\s+|$)","g")," ");return true}return false};
Element.prototype.toggleClassName=iAd.Element.SUPPORTS_CLASS_LIST?function(a,b){if(iAd.CSS.isClassNameValid(a)){if(b==null)b=!this.classList.contains(a);this.classList[b?"add":"remove"](a)}}:function(a,b){if(b==null)b=!this.hasClassName(a);this[b?"addClassName":"removeClassName"](a)};iAd.Utils.setupDisplayNames(Element,"Element");iAd.Class({name:"iAd.Transition",mixins:[iAd.EventTarget]});iAd.Transition.DID_COMPLETE_DELEGATE="transitionDidComplete";
iAd.Transition.DEFAULTS={duration:0.5,delay:0,removesTargetUponCompletion:false,revertsToOriginalValues:false};iAd.Transition.STYLES=["-webkit-transition-property","-webkit-transition-duration","-webkit-transition-timing-function","-webkit-transition-delay","-webkit-transition"];iAd.Transition.NORMALIZE_ZERO_REG_EXP=/([^\d+-]|^)[+-]?0[a-z%]*/g;iAd.Transition.HARDWARE_LAYER_BACKING_PROPERTIES=["position"];
iAd.Transition.prototype.init=function(a,b){this.revertsToOriginalValues=this.removesTargetUponCompletion=this.delegate=this.timingFunction=this.to=this.from=this.delay=this.duration=this.base=this.properties=this.target=null;this.defaultsApplied=false;this.archivedStyles=null;this.archivedValues=[];this.archivedBaseValues=[];this.definition=a;this.reversed=!!b};
iAd.Transition.prototype.applyDefaults=function(){if(!this.defaultsApplied){for(var a in iAd.Transition.DEFAULTS)if(this[a]==null)this[a]=iAd.Transition.DEFAULTS[a];this.defaultsApplied=true}};iAd.Transition.prototype.archiveTransitionStyles=function(){if(this.archivedStyles==null){var a=iAd.Utils.objectIsInstanceOfClass(this.target,iAd.View)?this.target.layer:this.target;this.archivedStyles=[];for(var b=0,c=iAd.Transition.STYLES.length;b<c;b++)this.archivedStyles.push(a.style.getPropertyValue(iAd.Transition.STYLES[b]))}};
iAd.Transition.prototype.restoreTransitionStyles=function(){for(var a=0,b=iAd.Transition.STYLES.length;a<b;a++)this.element.style.setProperty(iAd.Transition.STYLES[a],this.archivedStyles[a],"");this.archivedStyles=null};
iAd.Transition.prototype.archiveBaseValues=function(){if(this.revertsToOriginalValues)if(iAd.Utils.objectIsInstanceOfClass(this.target,iAd.View)){for(var a=0,b=this.properties.length;a<b;a++)this.archivedValues[a]=this.target[this.properties[a]];if(this.base){a=0;for(b=this.base.length;a<b;a+=2)this.archivedBaseValues[a]=this.target[this.base[a]]}}else{a=0;for(b=this.properties.length;a<b;a++)this.archivedValues[a]=this.target.style.getPropertyValue(this.properties[a]);if(this.base){a=0;for(b=this.base.length;a<
b;a+=2)this.archivedBaseValues[a]=this.target.style.getPropertyValue(this.base[a])}}};
iAd.Transition.prototype.restoreBaseValues=function(){if(iAd.Utils.objectIsInstanceOfClass(this.target,iAd.View)){for(var a=0,b=this.properties.length;a<b;a++)this.target[this.properties[a]]=this.archivedValues[a];if(this.base){a=0;for(b=this.base.length;a<b;a+=2)this.target[this.base[a]]=this.archivedBaseValues[a]}}else{a=0;for(b=this.properties.length;a<b;a++)this.target.style.setProperty(this.properties[a],this.archivedValues[a],null);if(this.base){a=0;for(b=this.base.length;a<b;a+=2)this.target.style.setProperty(this.base[a],
this.archivedBaseValues[a],null)}}};iAd.Transition.prototype.start=function(){if(iAd.Transaction.openTransactions>0)iAd.Transaction.addTransition(this);else{this.applyFromState();iAd.CSS.flushPendingUpdates();this.callMethodNameAfterDelay("applyToState",0)}return this};
iAd.Transition.prototype.applyFromState=function(){this.processDefinition();this.applyDefaults();this.archiveTransitionStyles();this.archiveBaseValues();this.enforceHardwareLayerBacking();if(this.from!=null)if(iAd.Utils.objectIsInstanceOfClass(this.target,iAd.View)){this.target.layer.style.webkitTransitionDuration=0;if(this.base)for(var a=0,b=this.base.length;a<b;a+=2)this.target[this.base[a]]=this.base[a+1];a=0;for(b=this.properties.length;a<b;a++)this.target[this.properties[a]]=this.from[a]}else{this.target.style.webkitTransitionDuration=
0;if(this.base){a=0;for(b=this.base.length;a<b;a+=2)this.target.style.setProperty(this.base[a],this.base[a+1],null)}a=0;for(b=this.properties.length;a<b;a++)this.target.style.setProperty(this.properties[a],this.from[a],null)}};
iAd.Transition.prototype.processDefinition=function(){if(this.definition){var a=this.definition;if(iAd.Utils.objectIsFunction(a))if(this.target!=null&&iAd.Utils.objectIsInstanceOfClass(this.target,iAd.View))a=a(this.target);else return;iAd.Utils.copyPropertiesFromSourceToTarget(a,this);if(this.reversed){a=this.from;this.from=this.to;this.to=a}}};
iAd.Transition.prototype.enforceHardwareLayerBacking=function(){if(iAd.Utils.objectIsInstanceOfClass(this.target,iAd.View))for(var a=0,b=this.properties.length;a<b;a++)if(iAd.Transition.HARDWARE_LAYER_BACKING_PROPERTIES.indexOf(this.properties[a])!=-1){this.target.wantsHardwareLayerBacking=true;break}};
iAd.Transition.prototype.applyToState=function(){var a=iAd.Utils.objectIsInstanceOfClass(this.target,iAd.View);this.cssProperties=[];for(var b=[],c=0,d=this.properties.length;c<d;c++){var e=a?this.target.cssPropertyNameForJSProperty(this.properties[c]):this.properties[c];if(!(this.cssProperties.indexOf(e)>-1)){var f=iAd.Utils.objectIsArray(this.duration)?this.duration[c]:this.duration,g=iAd.Utils.objectIsArray(this.timingFunction)?this.timingFunction[c]:this.timingFunction,h=iAd.Utils.objectIsArray(this.delay)?
this.delay[c]:this.delay;b.push([e,f+"s",g,h+"s"].join(" "));this.propertyStatesAreEqualForIndex(c)||this.cssProperties.push(e)}}this.eventTarget=this.element=a?this.target.layer:this.target;f!==0&&this.element.addEventListener("webkitTransitionEnd",this,false);this.completedTransitions=0;this.element.style.webkitTransition=b.join(", ");if(a){c=0;for(d=this.properties.length;c<d;c++)this.target[this.properties[c]]=this.to[c]}else{c=0;for(d=this.properties.length;c<d;c++)this.target.style.setProperty(this.properties[c],
this.to[c],"")}this.cssProperties.length||this.callMethodNameAfterDelay("handleTransitionComplete",0)};
iAd.Transition.prototype.propertyStatesAreEqualForIndex=function(a){var b=this.from==null?this.target[this.properties[a]]:this.from[a];a=this.to[a];if(b instanceof iAd.Point&&a instanceof iAd.Point||b instanceof iAd.Size&&a instanceof iAd.Size)return b.equals(a);else{if(iAd.Utils.objectIsString(b)&&iAd.Utils.objectIsString(a)){b=b.replace(iAd.Transition.NORMALIZE_ZERO_REG_EXP,"$10");a=a.replace(iAd.Transition.NORMALIZE_ZERO_REG_EXP,"$10")}return b===a}};
iAd.Transition.prototype.handleEvent=function(a){if(a.target===this.element){this.completedTransitions++;this.completedTransitions==this.cssProperties.length&&this.handleTransitionComplete()}};
iAd.Transition.prototype.handleTransitionComplete=function(){this.dispatchNotification(iAd.Transition.DID_COMPLETE_DELEGATE,this.delegate);this.element.removeEventListener("webkitTransitionEnd",this,false);if(this.removesTargetUponCompletion){var a=this.target;iAd.Utils.objectIsInstanceOfClass(this.target,iAd.View)?a.removeFromSuperview():a.parentNode.removeChild(a)}else this.restoreTransitionStyles();this.revertsToOriginalValues&&this.restoreBaseValues()};iAd.Device={};iAd.Device.iOS_VERSION=navigator.userAgent.match(/OS ([0-9_]+)/);
iAd.Device.iOS_VERSION=iAd.Device.iOS_VERSION?iAd.Device.iOS_VERSION[1].replace(/_/g,"."):null;iAd.Device.IS_IPAD=navigator.platform.indexOf("iPad")>-1;iAd.Device.HAS_HIDPI_DISPLAY=window.devicePixelRatio>=2;iAd.Device.iOSVersionLessThan=function(a){if(iAd.Device.iOS_VERSION==null){iAd.Console.warn("iAd.Device.iOS_VERSION is null.");return false}return iAd.Device.compareiOSVersions(iAd.Device.iOS_VERSION,a)==-1};
iAd.Device.compareiOSVersions=function(a,b){for(var c=a.split("."),d=b.split("."),e=0,f=Math.max(c.length,d.length);e<f;e++){var g=parseInt(c[e]||"0",10),h=parseInt(d[e]||"0",10);if(h>g)return-1;else if(g>h)return 1}return 0};iAd.Device.ORIENTATION_PORTRAIT_CSS="ad-device-portrait";iAd.Device.ORIENTATION_LANDSCAPE_CSS="ad-device-landscape";iAd.Device.ORIENTATION_PORTRAIT=0;iAd.Device.ORIENTATION_PORTRAIT_UPSIDE_DOWN=180;iAd.Device.ORIENTATION_LANDSCAPE_LEFT=90;
iAd.Device.ORIENTATION_LANDSCAPE_RIGHT=-90;iAd.Device.init=function(){iAd.Device.iOS_VERSION&&window.addEventListener("orientationchange",iAd.Device.interfaceOrientationDidChange,true);iAd.Device.setInterfaceOrientation(window.orientation||iAd.Device.ORIENTATION_PORTRAIT)};iAd.Device.interfaceOrientationDidChange=function(){iAd.Device.setInterfaceOrientation(window.orientation)};
iAd.Device.setInterfaceOrientation=function(a){var b=this.interfaceOrientation;this.interfaceOrientation=a;a=Math.abs(a)==90;var c=document.body;if(c.addClassName(a?iAd.Device.ORIENTATION_LANDSCAPE_CSS:iAd.Device.ORIENTATION_PORTRAIT_CSS))c.removeClassName(a?iAd.Device.ORIENTATION_PORTRAIT_CSS:iAd.Device.ORIENTATION_LANDSCAPE_CSS);b!=null&&iAd.ViewController&&iAd.ViewController.orientationDidChange(b)};window.addEventListener("DOMContentLoaded",iAd.Device.init,true);
iAd.Utils.setupDisplayNames(iAd.Device,"iAd.Device");iAd.String={};iAd.String.dashedStringToCamelCase=function(a){a=a.split("-");return a.shift()+a.map(iAd.String.capitalizeString).join("")};iAd.String.capitalizeString=function(a){return a.charAt(0).toUpperCase()+a.substr(1)};iAd.String.camelCaseStringToDashed=function(a){return a.replace(/([A-Z])/g,function(b){return"-"+b.toLowerCase()})};iAd.String.REPLACEMENT_SENTINEL="%@";iAd.String.REPLACEMENT_SENTINEL_LENGTH=iAd.String.REPLACEMENT_SENTINEL.length;
iAd.String.format=function(){var a=arguments.length;if(!a)return"";var b=arguments[0],c="",d=0,e=0,f;for(f=1;f<a&&(e=b.indexOf(iAd.String.REPLACEMENT_SENTINEL,d))>=0;++f){c+=b.slice(d,e);c+=arguments[f];d=e+iAd.String.REPLACEMENT_SENTINEL_LENGTH}b=b.slice(d);c+=b;f<a&&iAd.Console.warn("String.format - More arguments than specifiers");b.indexOf(iAd.String.REPLACEMENT_SENTINEL)!==-1&&iAd.Console.warn("String.format - More specifiers than arguments");return c};
iAd.Utils.setupDisplayNames(iAd.String,"iAd.String");
iAd.Class({name:"iAd.View",superclass:iAd.Object,mixins:[iAd.EventTarget],synthesizedProperties:["id","position","size","frame","transform","anchorPoint","anchorPointZ","doubleSided","zIndex","opacity","clipsToBounds","hidden","wantsHardwareLayerBacking","transitionsEnabled","transitionsDuration","hostingLayer","userInteractionEnabled","declarativeLayerWasInitialized","eventTarget","layerIsInDocument","touchLayer","tracking","navigable","focused"],archivedProperties:["id","position","size","autoresizingMask",
"transform","anchorPoint","anchorPointZ","doubleSided","zIndex","opacity","clipsToBounds","hidden","wantsHardwareLayerBacking","transitionsEnabled","transitionsDuration","subviews","userInteractionEnabled","navigable","focused"],cssClassName:"ad-view",collectionAccessor:"views"});
iAd.View.prototype.init=function(a){this.callSuper();if(iAd.Utils.objectIsString(a))a=document.querySelector(a);this.layer=a;this.superview=null;this.subviews=[];this.autoresizesSubviews=this.tracksAllTouchesOnceTouchesBegan=true;this.autoresizingMask=iAd.View.AUTORESIZING_NONE;this._layerIsInDocument=false;this._position=new iAd.Point;this._size=new iAd.Size;this._anchorPoint=new iAd.Point(0.5,0.5);this._anchorPointZ=0;this._doubleSided=true;this._zIndex=0;this._opacity=1;this._transform="none";
this._transitionsEnabled=this._wantsHardwareLayerBacking=this._hidden=this._clipsToBounds=false;this._transitionsDuration=0.5;this._hostingLayer=null;this._userInteractionEnabled=false;this._touchLayer=null;this.mouseInside=this.touchInside=this._tracking=this._focused=this._navigable=false;this.gestureRecognizers=[];this.usesDeclarativeBacking=a instanceof Element;this._declarativeLayerWasInitialized=false;if(this.usesDeclarativeBacking){if(document.body.contains(this.layer)){this._layerIsInDocument=
true;this.initWithDeclarativeBacking();this.layerWasInsertedIntoDocument()}}else{this.createLayer();this.setupCSSClasses();this.layerWasCreated()}this.layer._view=this};iAd.View.MANAGED_BY_VIEW_CONTROLLER_ATTR="ad-managed-by-view-controller";iAd.View.AUTORESIZING_NONE=0;iAd.View.AUTORESIZING_FLEXIBLE_LEFT_MARGIN=1;iAd.View.AUTORESIZING_FLEXIBLE_WIDTH=2;iAd.View.AUTORESIZING_FLEXIBLE_RIGHT_MARGIN=4;iAd.View.AUTORESIZING_FLEXIBLE_TOP_MARGIN=8;iAd.View.AUTORESIZING_FLEXIBLE_HEIGHT=16;
iAd.View.AUTORESIZING_FLEXIBLE_BOTTOM_MARGIN=32;iAd.View.PROPERTY_MAPPING={opacity:"opacity",transform:"-webkit-transform",position:"-webkit-transform",anchorPoint:"-webkit-transform-origin",doubleSided:"-webkit-backface-visibility",zIndex:"z-index"};iAd.View.EVENT_ATTRIBUTE_PREFIX=iAd.Element.ATTRIBUTE_PREFIX+"on";iAd.View.LAYER_STYLE_DID_CHANGE_EVENT="viewLayerStyleDidChange";iAd.View.INSIDE_PADDING=iAd.Device.IS_IPAD?25:70;iAd.View.TOUCH_DOWN_EVENT="viewTouchDown";
iAd.View.TOUCH_DRAG_INSIDE_EVENT="viewTouchDragInside";iAd.View.TOUCH_DRAG_OUTSIDE_EVENT="viewTouchDragOutside";iAd.View.TOUCH_DRAG_ENTER_EVENT="viewTouchDragEnter";iAd.View.TOUCH_DRAG_EXIT_EVENT="viewTouchDragExit";iAd.View.TOUCH_UP_INSIDE_EVENT="viewTouchUpInside";iAd.View.TOUCH_UP_OUTSIDE_EVENT="viewTouchUpOutside";iAd.View.TOUCH_CANCEL_EVENT="viewTouchCancel";iAd.View.TOUCH_STATE_CHANGE_EVENT="viewTouchStateChange";iAd.View.FOCUS_IN_EVENT="viewFocusIn";iAd.View.FOCUS_OUT_EVENT="viewFocusOut";
iAd.View.ACTIVATE_EVENT="viewActivate";iAd.View.synthesizedEvents=[iAd.View.TOUCH_DOWN_EVENT,iAd.View.TOUCH_DRAG_INSIDE_EVENT,iAd.View.TOUCH_DRAG_OUTSIDE_EVENT,iAd.View.TOUCH_DRAG_ENTER_EVENT,iAd.View.TOUCH_DRAG_EXIT_EVENT,iAd.View.TOUCH_UP_INSIDE_EVENT,iAd.View.TOUCH_UP_OUTSIDE_EVENT,iAd.View.TOUCH_CANCEL_EVENT,iAd.View.TOUCH_STATE_CHANGE_EVENT];iAd.View.dispatchesStyleChangeEvents=false;iAd.View.FOCUSED_CSS_CLASS="ad-focused";iAd.View.prototype.createLayer=function(){this.layer=document.createElement("div")};
iAd.View.prototype.initWithDeclarativeBacking=function(){this.setupLayer();this.layerWasCreated();this.setupCSSClasses();this.readPropertiesFromLayerComputedStyle(window.getComputedStyle(this.layer));this.readPropertiesFromLayerAttributes(this.getCustomLayerAttributes());this.declarativeLayerWasInitialized=true};iAd.View.prototype.setupLayer=function(){this.lookupViewLayersInLayer(this.hostingLayer);if(this.layer.hasClassName(iAd.SpatialNavigationManager.NAVIGABLE_CSS_CLASS))this.navigable=true};
iAd.View.prototype.lookupViewLayersInLayer=function(a){for(a=a.firstElementChild;a;){if(!a.hasOwnProperty("_view")){var b=iAd.View.viewClassForLayer(a);if(b){b=new b(a);b._indexInSuperviewSubviews=this.subviews.push(b)-1;b.willMoveToSuperview(this);b.superview=this;b.didMoveToSuperview()}else this.lookupViewLayersInLayer(a)}a=a.nextElementSibling}};
iAd.View.prototype.setupCSSClasses=function(){for(var a=this.constructor,b;a.superclass;){(b=a.cssClassName)&&this.layer.addClassName(b);if(a===iAd.View)break;a=a.superclass}};
iAd.View.prototype.readPropertiesFromLayerComputedStyle=function(a){this._size.width=parseInt(a.width,10)||0;this._size.height=parseInt(a.height,10)||0;this._position.x=parseInt(a.left,10)||0;this._position.y=parseInt(a.top,10)||0;this._zIndex=parseInt(a.zIndex,10)||0;this._clipsToBounds=a.overflow=="hidden";this._doubleSided=a.webkitBackfaceVisibility=="visible";this._transform=a.webkitTransform;this._hidden=a.visibility=="hidden";this._opacity=parseFloat(a.opacity);a=iAd.CSS.matrixFromString(this._transform);
var b=new WebKitCSSMatrix;if(!iAd.CSS.matrixEqualsToMatrix(a,b)){this._position.x+=a.m41;this._position.y+=a.m42;a=a.translate(a.m41*-1,a.m42*-1,0);this._transform=a.toString()}if(this._transform!="none")this._wantsHardwareLayerBacking=true};
iAd.View.prototype.readPropertiesFromLayerAttributes=function(a){iAd.ViewController!=null&&a.hasOwnProperty(iAd.View.MANAGED_BY_VIEW_CONTROLLER_ATTR)&&this.createManagingViewController();var b,c,d,e=this.constructor.synthesizedEventMap;for(b in a){d=a[b];(c=e[b.toLowerCase()])?this.addEventListener(c,iAd.Event.eventHandlerForString(d),false):this.setValueForAttribute(d,b)}};
iAd.View.prototype.createManagingViewController=function(){new iAd.ViewController({id:this.layer.hasAttribute("id")?this.layer.getAttribute("id"):"",properties:{view:this}})};iAd.View.prototype.setValueForAttribute=function(a,b){var c=this.propertyNameForAttribute(b);switch(typeof this[c]){case "string":this[c]=a;break;case "number":this[c]=parseFloat(a);break;case "boolean":this[c]=a!="false";break;default:this[c]=a}};iAd.View.prototype.propertyNameForAttribute=function(a){return iAd.String.dashedStringToCamelCase(a.substr(iAd.Element.ATTRIBUTE_PREFIX.length))};
iAd.View.prototype.attributeNameForProperty=function(a){return iAd.Element.ATTRIBUTE_PREFIX+iAd.String.camelCaseStringToDashed(a)};
iAd.View.prototype.getCustomLayerAttributes=function(){for(var a={},b=iAd.Element.HTML5_CUSTOM_ATTRIBUTE_PREFIX+iAd.Element.ATTRIBUTE_PREFIX,c=this.layer.attributes,d,e,f=0,g=c.length;f<g;f++){d=c.item(f);e=d.name;if(e.indexOf(b)==0)a[e.substr(iAd.Element.HTML5_CUSTOM_ATTRIBUTE_PREFIX.length)]=d.value;else if(e.indexOf(iAd.Element.ATTRIBUTE_PREFIX)==0)a[e]=d.value}return this.customLayerAttributes=a};
iAd.View.prototype.layerHasCustomAttribute=function(a){if(this.customLayerAttributes)return this.customLayerAttributes.hasOwnProperty(a);return iAd.Element.hasCustomAttribute(this.layer,a)};iAd.View.prototype.getLayerCustomAttributeValue=function(a){return this.customLayerAttributes?this.customLayerAttributes[a]||null:iAd.Element.getCustomAttribute(this.layer,a)};
iAd.View.prototype.setLayerStyle=function(a){for(var b in a)this.layer.style.setProperty(b,a[b]);iAd.View.dispatchesStyleChangeEvents&&this.createAndDispatchEvent(iAd.View.LAYER_STYLE_DID_CHANGE_EVENT,[["changedProperties",a]])};iAd.View.prototype.toString=function(){return[this.constructor.displayName,"[",this._size.width,"x",this._size.height,"@",this._position.x,",",this._position.y,"]"].join("")};iAd.View.prototype.getId=function(){return this.layer.id};
iAd.View.prototype.setId=function(a){this.layer.id=a};iAd.View.prototype.setPosition=function(a){if(!(!a||this._position.equals(a))){this._position=a;this.updatePositionAndTransform()}};iAd.View.prototype.setSize=function(a){if(!(!a||this._size.equals(a))){var b=this._size.copy();this._size=a;this.setLayerStyle({width:a.width+"px",height:a.height+"px"});this.autoresizesSubviews&&this.resizeSubviewsWithOldSize(b)}};
iAd.View.prototype.getFrame=function(){return new iAd.Rect(this.position.x,this.position.y,this.size.width,this.size.height)};iAd.View.prototype.setFrame=function(a){this.position=a.origin;this.size=a.size};iAd.View.prototype.setTransform=function(a){this._transform=a;this.updatePositionAndTransform()};iAd.View.prototype.setAnchorPoint=function(a){if(a){this._anchorPoint=a;this.updateLayerTransformOrigin()}};iAd.View.prototype.setAnchorPointZ=function(a){this._anchorPointZ=a;this.updateLayerTransformOrigin()};
iAd.View.prototype.updateLayerTransformOrigin=function(){this.setLayerStyle({"-webkit-transform-origin":Math.round(this._anchorPoint.x*100)+"% "+Math.round(this._anchorPoint.y*100)+"% "+this._anchorPointZ+"px"})};iAd.View.prototype.setDoubleSided=function(a){this._doubleSided=a;this.setLayerStyle({"-webkit-backface-visibility":a?"visible":"hidden"})};iAd.View.prototype.setZIndex=function(a){this._zIndex=a;this.setLayerStyle({"z-index":a})};
iAd.View.prototype.setHidden=function(a){this._hidden=a;this.setLayerStyle({visibility:a?"hidden":"visible"})};iAd.View.prototype.updatePositionAndTransform=function(){this._wantsHardwareLayerBacking||this._transitionsEnabled?this.setLayerStyle({left:"0",top:"0","-webkit-transform":iAd.CSS.concatenateTransforms(iAd.CSS.tm(iAd.CSS.roundedPxValue(this._position.x),iAd.CSS.roundedPxValue(this._position.y)),this._transform)}):this.setLayerStyle({left:this._position.x+"px",top:this._position.y+"px","-webkit-transform":this._transform})};
iAd.View.prototype.setOpacity=function(a){this._opacity=a;this.setLayerStyle({opacity:a})};iAd.View.prototype.setTransitionsEnabled=function(a){this.setLayerStyle({"-webkit-transition-duration":a?this._transitionsDuration+"s":"0s"});this._transitionsEnabled=a;this.updatePositionAndTransform()};iAd.View.prototype.setWantsHardwareLayerBacking=function(a){if(this._wantsHardwareLayerBacking!=a){this._wantsHardwareLayerBacking=a;this.updatePositionAndTransform()}};
iAd.View.prototype.setTransitionsDuration=function(a){this.setLayerStyle({"-webkit-transition-duration":a+"s"});this._transitionsDuration=a};iAd.View.prototype.setClipsToBounds=function(a){this._clipsToBounds=a;this.setLayerStyle({overflow:a?"hidden":"visible"})};iAd.View.prototype.getTouchLayer=function(){return this._touchLayer||this.layer};iAd.View.prototype.getHostingLayer=function(){return this._hostingLayer!=null?this._hostingLayer:this.layer};
iAd.View.prototype.addSubview=function(a){return this.insertSubviewAtIndex(a,this.subviews.length)};iAd.View.prototype.removeFromSuperview=function(){if(this.superview!=null){this.willMoveToSuperview(null);this.superview.removeSubview(this);this.layer.parentNode.removeChild(this.layer);this.superview=null;this.didMoveToSuperview();this.dispatchNotificationOfLayerRemovalFromDocument()}};
iAd.View.prototype.removeSubview=function(a){if(a.superview==this){this.willRemoveSubview(a);var b=this.subviews;a=a._indexInSuperviewSubviews;b.splice(a,1);a=a;for(var c=b.length;a<c;a++)b[a]._indexInSuperviewSubviews=a}};
iAd.View.prototype.insertSubviewAtIndex=function(a,b){var c=this.subviews;if(!(b>c.length)){var d=a.superview,e;if(d==this){e=a._indexInSuperviewSubviews;if(b===e)return;c.splice(e,1);b>e&&b--}else{d&&d.removeSubview(a);a.willMoveToSuperview(this)}c.splice(b,0,a);a._indexInSuperviewSubviews=b;e=e!=null&&e<b?e:b+1;for(var f=c.length;e<f;e++)c[e]._indexInSuperviewSubviews=e;c=c[b+1];this.hostingLayer.insertBefore(a.layer,c?c.layer:null);if(d!=this){a.superview=this;a.didMoveToSuperview()}this.didAddSubview(a);
this._layerIsInDocument&&!a._layerIsInDocument&&a.dispatchNotificationOfLayerInsertionIntoDocument();return a}};iAd.View.prototype.insertSubviewAfterSubview=function(a,b){if(b.superview===this){var c=b._indexInSuperviewSubviews+1;c<this.subviews.length?this.insertSubviewAtIndex(a,c):this.addSubview(a);return a}};iAd.View.prototype.insertSubviewBeforeSubview=function(a,b){if(b.superview===this)return this.insertSubviewAtIndex(a,b._indexInSuperviewSubviews)};
iAd.View.prototype.exchangeSubviewsAtIndices=function(a,b){if(!(a>=this.subviews.length||b>=this.subviews.length)){var c=this.subviews[a],d=this.subviews[b];this.subviews[a]=d;this.subviews[b]=c;c._indexInSuperviewSubviews=b;d._indexInSuperviewSubviews=a;c=c.layer;d=d.layer;var e=this.hostingLayer,f=c.nextSibling,g=d.nextSibling;f!=null?e.insertBefore(d,f):e.appendChild(d);g!=null?e.insertBefore(c,g):e.appendChild(c)}};
iAd.View.prototype.isDescendantOfView=function(a){for(var b=false,c=this;c.superview!=null;){if(c.superview===a){b=true;break}c=c.superview}return b};iAd.View.prototype.layerWasCreated=function(){};iAd.View.prototype.willMoveToSuperview=function(){};iAd.View.prototype.didMoveToSuperview=function(){};iAd.View.prototype.didAddSubview=function(){};iAd.View.prototype.willRemoveSubview=function(){};
iAd.View.prototype.layerWasInsertedIntoDocument=function(){if(this.usesDeclarativeBacking)if(this.declarativeLayerWasInitialized){var a=window.getComputedStyle(this.layer);if(isNaN(this._size.width)){this._size.width=parseInt(a.width,10);this._size.height=parseInt(a.height,10)}if(isNaN(this._position.x)){this._position.x=parseInt(a.left,10);this._position.y=parseInt(a.top,10)}}else this.initWithDeclarativeBacking();this.layerIsInDocument=true};
iAd.View.prototype.layerWasRemovedFromDocument=function(){this.layerIsInDocument=false};iAd.View.prototype.dispatchNotificationOfLayerInsertionIntoDocument=function(){for(var a=this.subviews,b=0,c=a.length;b<c;b++)a[b].dispatchNotificationOfLayerInsertionIntoDocument();this.layerWasInsertedIntoDocument()};iAd.View.prototype.dispatchNotificationOfLayerRemovalFromDocument=function(){for(var a=this.subviews,b=0,c=a.length;b<c;b++)a[b].dispatchNotificationOfLayerRemovalFromDocument();this.layerWasRemovedFromDocument()};
iAd.View.prototype.setUserInteractionEnabled=function(a){if(this._userInteractionEnabled!=a){var b=Element.prototype[a?"addEventListener":"removeEventListener"];b.call(this.touchLayer,iAd.Event.START_EVENT,this,false);if(!iAd.Event.SUPPORTS_TOUCHES){var c=this.layer;b.call(c,"mouseover",this,false);b.call(c,"mouseout",this,false)}this._userInteractionEnabled=a}};
iAd.View.prototype.handleEvent=function(a){switch(a.type){case iAd.Event.START_EVENT:this.touchesBegan(a);break;case iAd.Event.MOVE_EVENT:this.touchesMoved(a);break;case iAd.Event.END_EVENT:this.touchesEnded(a);break;case iAd.Event.CANCEL_EVENT:this.touchesCancelled(a);break;case "mouseover":this.handleMouseover(a);break;case "mouseout":this.handleMouseout(a);break;case iAd.SpatialNavigationManager.ACTIVATE_EVENT:this.handleSNMActivate(a);break;case iAd.SpatialNavigationManager.FOCUS_IN_EVENT:this.handleSNMFocusIn(a);
break;case iAd.SpatialNavigationManager.FOCUS_OUT_EVENT:this.handleSNMFocusOut(a)}};iAd.View.prototype.handleSNMActivate=function(a){this.createAndDispatchEvent(iAd.View.ACTIVATE_EVENT,[["originalEvent",a]])};iAd.View.prototype.handleSNMFocusIn=function(){this.focused=true};iAd.View.prototype.handleSNMFocusOut=function(){if(this.mouseInside)this.layer.addClassName(iAd.View.FOCUSED_CSS_CLASS);else this.focused=false};
iAd.View.prototype.touchesBegan=function(a){if(this.tracksAllTouchesOnceTouchesBegan){window.addEventListener(iAd.Event.MOVE_EVENT,this,true);window.addEventListener(iAd.Event.END_EVENT,this,true);window.addEventListener(iAd.Event.CANCEL_EVENT,this,true)}a.preventDefault();this.touchInside=this.tracking=true;this.dispatchEvent(this.createUIEvent(iAd.View.TOUCH_DOWN_EVENT,a));this.createAndDispatchEvent(iAd.View.TOUCH_STATE_CHANGE_EVENT);this.lastProcessedEvent=a};
iAd.View.prototype.touchesMoved=function(a){this.shouldPreventEventDefault(a)&&a.preventDefault();var b=this.pointInsidePaddedBounds(iAd.Point.fromEventInElement(a,this.layer)),c=b?iAd.View.TOUCH_DRAG_INSIDE_EVENT:iAd.View.TOUCH_DRAG_OUTSIDE_EVENT;if(b!=this.touchInside){c=(this.touchInside=b)?iAd.View.TOUCH_DRAG_ENTER_EVENT:iAd.View.TOUCH_DRAG_EXIT_EVENT;this.createAndDispatchEvent(iAd.View.TOUCH_STATE_CHANGE_EVENT)}this.dispatchEvent(this.createUIEvent(c,a));this.lastProcessedEvent=a};
iAd.View.prototype.shouldPreventEventDefault=function(){return true};
iAd.View.prototype.touchesEnded=function(a){window.removeEventListener(iAd.Event.MOVE_EVENT,this,true);window.removeEventListener(iAd.Event.END_EVENT,this,true);window.removeEventListener(iAd.Event.CANCEL_EVENT,this,true);this.tracking=false;this.dispatchEvent(this.createUIEvent(this.touchInside?iAd.View.TOUCH_UP_INSIDE_EVENT:iAd.View.TOUCH_UP_OUTSIDE_EVENT,this.lastProcessedEvent));this.touchInside&&this.createAndDispatchEvent(iAd.View.ACTIVATE_EVENT,[["originalEvent",a]]);this.touchInside=false;
this.createAndDispatchEvent(iAd.View.TOUCH_STATE_CHANGE_EVENT)};iAd.View.prototype.touchesCancelled=function(a){window.removeEventListener(iAd.Event.MOVE_EVENT,this,true);window.removeEventListener(iAd.Event.END_EVENT,this,true);window.removeEventListener(iAd.Event.CANCEL_EVENT,this,true);this.touchInside=this.tracking=false;this.dispatchEvent(this.createUIEvent(iAd.View.TOUCH_CANCEL_EVENT,a))};iAd.View.prototype.handleMouseover=function(a){a.target===a.currentTarget&&this.mouseEntered(a)};
iAd.View.prototype.handleMouseout=function(a){a.target===a.currentTarget&&!this.pointInside(iAd.Point.fromEventInElement(a,this.layer))&&this.mouseExited(a)};iAd.View.prototype.mouseEntered=function(){this.focused=this.mouseInside=true};iAd.View.prototype.mouseExited=function(){this.mouseInside=false;if(iAd.SpatialNavigationManager.sharedManager.focusedElement!==this.layer)this.focused=false};
iAd.View.prototype.createUIEvent=function(a,b){var c=iAd.Event.createUIEvent(a,b);if(!c.ad)c.ad={};c.ad.sender=this;return c};iAd.View.prototype.pointInsidePaddedBounds=function(a){var b=iAd.View.INSIDE_PADDING;return a.x>=-b&&a.x<this.size.width+b&&a.y>=-b&&a.y<this.size.height+b};iAd.View.prototype.pointInside=function(a){return a.x>=0&&a.x<this.size.width&&a.y>=0&&a.y<this.size.height};iAd.View.prototype.resizeSubviewsWithOldSize=function(a){for(var b=0,c=this.subviews.length;b<c;b++)this.subviews[b].resizeWithOldSuperviewSize(a)};
iAd.View.prototype.resizeWithOldSuperviewSize=function(a){var b=this._position.copy(),c=this._size.copy(),d=this.autoresizingMask;if(a.width!=0||c.width==0){var e;switch((d&iAd.View.AUTORESIZING_FLEXIBLE_LEFT_MARGIN)+(d&iAd.View.AUTORESIZING_FLEXIBLE_WIDTH)+(d&iAd.View.AUTORESIZING_FLEXIBLE_RIGHT_MARGIN)){case iAd.View.AUTORESIZING_FLEXIBLE_LEFT_MARGIN:b.x+=this.superview._size.width-a.width;break;case iAd.View.AUTORESIZING_FLEXIBLE_WIDTH:c.width=this.superview._size.width-(a.width-this._size.width);
break;case iAd.View.AUTORESIZING_FLEXIBLE_LEFT_MARGIN|iAd.View.AUTORESIZING_FLEXIBLE_WIDTH:e=a.width-this._size.width-this._position.x;b.x=this._position.x/(a.width-e)*(this.superview._size.width-e);c.width=this.superview._size.width-b.x-e;break;case iAd.View.AUTORESIZING_FLEXIBLE_LEFT_MARGIN|iAd.View.AUTORESIZING_FLEXIBLE_RIGHT_MARGIN:e=a.width-this._size.width-this._position.x;b.x+=(this.superview._size.width-a.width)*(this.position.x/(this.position.x+e));break;case iAd.View.AUTORESIZING_FLEXIBLE_RIGHT_MARGIN|
iAd.View.AUTORESIZING_FLEXIBLE_WIDTH:e=a.width-this._size.width-this._position.x;scaled_right_margin=e/(a.width-this._position.x)*(this.superview._size.width-this._position.x);c.width=this.superview._size.width-b.x-scaled_right_margin;break;case iAd.View.AUTORESIZING_FLEXIBLE_LEFT_MARGIN|iAd.View.AUTORESIZING_FLEXIBLE_WIDTH|iAd.View.AUTORESIZING_FLEXIBLE_RIGHT_MARGIN:b.x=this._position.x/a.width*this.superview._size.width;c.width=this._size.width/a.width*this.superview._size.width}}if(a.height!=0||
c.height==0)switch((d&iAd.View.AUTORESIZING_FLEXIBLE_TOP_MARGIN)+(d&iAd.View.AUTORESIZING_FLEXIBLE_HEIGHT)+(d&iAd.View.AUTORESIZING_FLEXIBLE_BOTTOM_MARGIN)){case iAd.View.AUTORESIZING_FLEXIBLE_TOP_MARGIN:b.y+=this.superview._size.height-a.height;break;case iAd.View.AUTORESIZING_FLEXIBLE_HEIGHT:c.height=this.superview._size.height-(a.height-this._size.height);break;case iAd.View.AUTORESIZING_FLEXIBLE_TOP_MARGIN|iAd.View.AUTORESIZING_FLEXIBLE_HEIGHT:d=a.height-this._size.height-this._position.y;b.y=
this._position.y/(a.height-d)*(this.superview._size.height-d);c.height=this.superview._size.height-b.y-d;break;case iAd.View.AUTORESIZING_FLEXIBLE_TOP_MARGIN|iAd.View.AUTORESIZING_FLEXIBLE_BOTTOM_MARGIN:d=a.height-this._size.height-this._position.y;b.y+=(this.superview._size.height-a.height)*(this.position.y/(this.position.y+d));break;case iAd.View.AUTORESIZING_FLEXIBLE_BOTTOM_MARGIN|iAd.View.AUTORESIZING_FLEXIBLE_HEIGHT:d=a.height-this._size.height-this._position.y;scaled_bottom_margin=d/(a.height-
this._position.y)*(this.superview._size.height-this._position.y);c.height=this.superview._size.height-b.y-scaled_bottom_margin;break;case iAd.View.AUTORESIZING_FLEXIBLE_TOP_MARGIN|iAd.View.AUTORESIZING_FLEXIBLE_HEIGHT|iAd.View.AUTORESIZING_FLEXIBLE_BOTTOM_MARGIN:b.y=this._position.y/a.height*this.superview._size.height;c.height=this._size.height/a.height*this.superview._size.height}this.position=b;this.size=c};iAd.View.prototype.cssPropertyNameForJSProperty=function(a){return iAd.View.PROPERTY_MAPPING[a]};
iAd.View.prototype.applyTransition=function(a,b){if(a==null)return null;var c=new iAd.Transition(a,b);c.target=this;c.start();return c};iAd.View.prototype.descendantViewsOfClass=function(a){return iAd.View.viewsForClassAndNode(a,this.layer)};iAd.View.prototype.getEventTarget=function(){return this.layer};
iAd.View.prototype.addGestureRecognizer=function(a){if(this.gestureRecognizers.indexOf(a)==-1){a.view!=null&&a.view!==this&&a.view.removeGestureRecognizer(a);this.gestureRecognizers.push(a);a.view=this}};iAd.View.prototype.removeGestureRecognizer=function(a){if(iAd.Array.removeObjectFromArray(a,this.gestureRecognizers))a.view=null};
iAd.View.prototype.convertRectToView=function(a,b){var c=this.convertPointToView(a.origin,b),d=this.convertPointToView(new iAd.Point(a.maxX(),a.maxY()),b);return new iAd.Rect(c.x,c.y,d.x-c.x,d.y-c.y)};iAd.View.prototype.convertRectFromView=function(a,b){return b.convertRectToView(a,this)};
iAd.View.prototype.convertPointToView=function(a,b){var c=window.webkitConvertPointFromNodeToPage(this.layer,new WebKitPoint(a.x,a.y));c=window.webkitConvertPointFromPageToNode(b.layer,c);return new iAd.Point(c.x,c.y)};iAd.View.prototype.convertPointFromView=function(a,b){return b.convertPointToView(a,this)};iAd.View.prototype.restoreProperty=function(a,b){switch(a){case "subviews":for(var c=0,d=b.length;c<d;c++)this.addSubview(b[c]);break;default:this.callSuper(a,b)}};
iAd.View.prototype.setNavigable=function(a){if(this._navigable!=a){var b=(this._navigable=a)?"add":"remove",c=this.layer;c.toggleClassName(iAd.SpatialNavigationManager.NAVIGABLE_CSS_CLASS,a);this.layerIsInDocument&&iAd.SpatialNavigationManager.sharedManager[b+"NavigableElement"](c);a=b+"EventListener";c[a].call(c,iAd.SpatialNavigationManager.ACTIVATE_EVENT,this,false);c[a].call(c,iAd.SpatialNavigationManager.FOCUS_IN_EVENT,this,false);c[a].call(c,iAd.SpatialNavigationManager.FOCUS_OUT_EVENT,this,
false)}};iAd.View.prototype.setFocused=function(a){if(a!=this._focused){this._focused=a;var b=this.layer;b.toggleClassName(iAd.View.FOCUSED_CSS_CLASS,a);if(!a){var c=iAd.SpatialNavigationManager.sharedManager;c.focusedElement===b&&c.focusElement(null)}this.createAndDispatchEvent(a?iAd.View.FOCUS_IN_EVENT:iAd.View.FOCUS_OUT_EVENT)}};iAd.View.getViewById=function(a){return(a=document.getElementById(a))&&a._view!=undefined?a._view:null};iAd.View.registeredHTMLViewLoadingClasses={};
iAd.View.registerClassForHTMLViewLoading=function(a){iAd.View.registeredHTMLViewLoadingClasses[a.cssClassName]=a};iAd.View.viewClassForLayer=function(a){var b=this.registeredHTMLViewLoadingClasses;a=a.className.trim().split(/\s+/);for(var c=0,d=a.length;c<d;c++){var e=b.hasOwnProperty(a[c])?b[a[c]]:null;if(e)return e}return null};iAd.View.viewForLayer=function(a){return new (iAd.View.viewClassForLayer(a)||iAd.View)(a)};
iAd.View.viewsForClassAndNode=function(a,b){var c=[];if(!a.hasOwnProperty("cssClassName"))return c;for(var d=b.querySelectorAll("."+a.cssClassName),e=0,f=d.length;e<f;e++)c.push(d[e]._view);return c};iAd.View.nearestViewForElement=function(a){for(;a._view==undefined&&a.parentNode;)a=a.parentNode;return a._view==undefined?null:a._view};iAd.Utils.setupDisplayNames(Node,"Node");
iAd.View.initialize=function(){var a=this;if(this.hasOwnProperty("cssClassName")){Object.defineProperty(this,"views",{get:function(){return iAd.View.viewsForClassAndNode(a,document)}});iAd.View.registerClassForHTMLViewLoading(this);if(a.hasOwnProperty("collectionAccessor"))Object.getOwnPropertyDescriptor(iAd.View.prototype,this.collectionAccessor)?iAd.Console.warn("The class "+this._name+' has a .collectionAccessor "'+this.collectionAccessor+'" in conflict with another iAd.View subclass, this collection accessor will be ignored.'):
Object.defineProperty(iAd.View.prototype,this.collectionAccessor,{get:function(){return this.descendantViewsOfClass(a)}})}if(!this.hasOwnProperty("synthesizedEventMap"))this.synthesizedEventMap={};for(var b=this;b;){if(b.hasOwnProperty("synthesizedEvents"))for(var c=b.synthesizedEvents,d=0,e=c.length;d<e;d++){var f=c[d];this.synthesizedEventMap[iAd.View.EVENT_ATTRIBUTE_PREFIX+f.toLowerCase()]=f}b=b.superclass}};iAd.Path={};iAd.Path.HIDPI_SUFFIX="@2x";
iAd.Path.escapeRegExp=function(a){var b=RegExp("[.*+?|()\\[\\]{}\\\\]","g");return a.replace(b,"\\$&")};
iAd.Path.appendHiDPISuffix=function(a){var b="("+iAd.Path.escapeRegExp(iAd.Path.HIDPI_SUFFIX)+"|"+iAd.Path.escapeRegExp(encodeURIComponent(iAd.Path.HIDPI_SUFFIX))+")(\\.[^\\./]+)?$";if(!RegExp(b,"i").test(a))if(/~ipad/.test(a)){b=a.lastIndexOf("~ipad");a=a.substr(0,b)+iAd.Path.HIDPI_SUFFIX+a.substr(b)}else if(/\.[^\.\/]+/.test(a)){b=a.lastIndexOf(".");a=a.substr(0,b)+iAd.Path.HIDPI_SUFFIX+a.substr(b)}else a+=iAd.Path.HIDPI_SUFFIX;return a};iAd.Path.HREF_PROXY=null;
iAd.Path.resolveAbsolutePath=function(a){if(!iAd.Path.HREF_PROXY)iAd.Path.HREF_PROXY=document.createElement("a");var b=iAd.Path.HREF_PROXY;b.href=a;return b.href};iAd.Path.objectToQueryString=function(a,b){return iAd.Path.objectToQueryStringForKey(a,b,null)};
iAd.Path.objectToQueryStringForKey=function(a,b,c){b=b||"&";c=c||"";if(iAd.Utils.objectIsPrimitive(a)){a=a?encodeURIComponent(a):"";if(c&&a)return encodeURIComponent(c)+"="+a;return a}var d=[],e=c;if(iAd.Utils.objectIsArray(a)){if(e)e+="[]";c=0;for(var f=a.length;c<f;c++)d.push(iAd.Path.objectToQueryStringForKey(a[c],b,e))}else if(typeof a=="object")for(c in a)d.push(iAd.Path.objectToQueryStringForKey(a[c],b,e?e+"["+c+"]":c));return d.join(b)};
Object.defineProperty(iAd.Path,"assetsPath",{get:function(){if(this._assetsPath)return this._assetsPath;for(var a=/\/?iAd(-\w+)?\.cssz?(\?.*)?$/,b,c,d=0,e=document.styleSheets.length;d<e;d++){b=document.styleSheets[d];if(b.href){b=b.href.split("/");c=b.pop();if(a.test(c)){b.push("assets/");return this._assetsPath=b.join("/")}}}},set:function(a){this._assetsPath=a}});iAd.Utils.setupDisplayNames(iAd.Path,"iAd.Path");
iAd.Class({name:"iAd.ScriptAction",mixins:[iAd.EventTarget],synthesizedProperties:["viewController","delay"]});iAd.ScriptAction.ACTION_DID_COMPLETE="scriptActionDidComplete";iAd.ScriptAction.prototype.init=function(a){this.callSuper();this.viewController=a;this.delay=0;this.eventTarget=document};iAd.ScriptAction.prototype.run=function(){this.callMethodNameAfterDelay("start",this.delay)};iAd.ScriptAction.prototype.prepare=function(){};iAd.ScriptAction.prototype.start=function(){this.end()};
iAd.ScriptAction.prototype.end=function(){this.dispatchNotification(iAd.ScriptAction.ACTION_DID_COMPLETE,this.delegate)};iAd.Class({name:"iAd.ActionListManager",mixins:[iAd.EventTarget]});iAd.ActionListManager.ACTIVE_STATE_SUFFIX="-is-active";iAd.ActionListManager.ACTION_LIST_WILL_START="actionListWillStart";iAd.ActionListManager.ACTION_LIST_DID_START="actionListDidStart";iAd.ActionListManager.ACTION_LIST_WILL_ITERATE="actionListWillIterate";iAd.ActionListManager.ACTION_LIST_DID_ITERATE="actionListDidIterate";
iAd.ActionListManager.ACTION_LIST_WILL_COMPLETE="actionListWillComplete";iAd.ActionListManager.ACTION_LIST_DID_COMPLETE="actionListDidComplete";iAd.ActionListManager.ACTION_LIST_DID_CANCEL="actionListDidCancel";iAd.ActionListManager.ACTION_LIST_DID_PROGRESS="actionListDidProgress";
iAd.ActionListManager.prototype.init=function(a,b){this.callSuper();this.eventTarget=document;this.id=a.id||iAd.ActionListManager.uniqueId();this.actionList=a;this.viewController=b;this.actionsByName={};this.actions=[];this.seedActions=[];this.actionQueue=[];this.dependency={};this.selectors=[];this.timers=[];this.usesAnimationIterationCount=true;var c,d;this.actionList.actions.forEach(function(e){var f=e.type;if(f=="css-reset")this.selectors.push(e.selector);else{var g=e.name,h=e.startAfter||[];
if(f=="script"){f=e.className;var i=iAd.Utils.resolveObjectPath(f);if(!i)throw new ReferenceError("Can't find script action class named: "+f);f=new i(this.viewController);i=e.properties;for(var j in i)f[j]=i[j];if(e.delay)f.delay=e.delay;if(!e.asynchronous)f.delegate=this;f._action=e;f.prepare();e.object=f;this.usesAnimationIterationCount=false}else if(f=="css"){this.selectors.push(e.selector);j=e.duration||0;if(c==null)c=j;else if(c!=j)this.usesAnimationIterationCount=false;j=e.delay||0;if(d==null)d=
j;else if(d!=j)this.usesAnimationIterationCount=false}if(h.length>0){h.forEach(function(k){if(this.dependency[k])this.dependency[k].push(e);else this.dependency[k]=[e]},this);this.usesAnimationIterationCount=false}else this.seedActions.push(e);if(g)this.actionsByName[g]=e;e.completed=false;this.actions.push(e)}},this);this.totalIterations=this.actionList.iterationCount||1;this.totalActions=this.actions.length};
iAd.ActionListManager.prototype.start=function(){if(this.viewController.isInState(this.actionList.cssClassName)){this.reset(true);this.callMethodNameAfterDelay("start",0)}else{this.clearCSSAnimationProperties();this.dispatchNotification(iAd.ActionListManager.ACTION_LIST_WILL_START,this.viewController,[["actionList",this.actionList]]);this.viewController.enterState(this.actionList.cssClassName);this.viewController.enterState(this.actionList.cssClassName+iAd.ActionListManager.ACTIVE_STATE_SUFFIX);this.viewController.view.layer.addEventListener("webkitAnimationEnd",
this,true);this.usesAnimationIterationCount&&this.viewController.view.layer.addEventListener("webkitAnimationIteration",this,true);this.completedIterationCount=0;this.iterate();this.dispatchNotification(iAd.ActionListManager.ACTION_LIST_DID_START,this.viewController,[["actionList",this.actionList]])}};
iAd.ActionListManager.prototype.iterate=function(){this.dispatchNotification(iAd.ActionListManager.ACTION_LIST_WILL_ITERATE,this.viewController,[["actionList",this.actionList],["iteration",this.completedIterationCount]]);this.completedActionCount=0;this.actionQueue=this.seedActions.slice();this.flushActionQueue()};
iAd.ActionListManager.prototype.clearCSSAnimationProperties=function(){if(this.selectors.length!=0)for(var a=this.viewController.view.layer.querySelectorAll(this.selectors.join(",")),b=a.length-1;b>=0;b--){var c=a[b];c.style.webkitAnimationName="";c.style.webkitAnimationDuration="";c.style.webkitAnimationDelay="";c.style.webkitAnimationIterationCount=""}};
iAd.ActionListManager.prototype.reset=function(a){this.clearCSSAnimationProperties();this.timers.forEach(clearTimeout);this.timers=[];this.actionQueue=[];this.actions.forEach(function(b){b.completed=false},this);this.viewController.exitState(this.actionList.cssClassName);this.viewController.exitState(this.actionList.cssClassName+iAd.ActionListManager.ACTIVE_STATE_SUFFIX);a!=true&&this.dispatchNotification(iAd.ActionListManager.ACTION_LIST_DID_CANCEL,this.viewController,[["actionList",this.actionList]])};
iAd.ActionListManager.prototype.handleEvent=function(a){var b,c=a.type;if(c=="webkitAnimationEnd"||c=="webkitAnimationIteration")b=this.actionsByName[a.animationName];b==null||b.asynchronous||this.handleActionDidComplete(b)};iAd.ActionListManager.prototype.scriptActionDidComplete=function(a){this.handleActionDidComplete(a._action)};
iAd.ActionListManager.prototype.handleActionDidComplete=function(a){a.completed=true;this.completedActionCount++;this.dispatchNotification(iAd.ActionListManager.ACTION_LIST_DID_PROGRESS,this.viewController,[["actionList",this.actionList],["action",a],["progress",this.totalIterations=="infinite"?0:(this.completedIterationCount*this.totalActions+this.completedActionCount)/(this.totalActions*this.totalIterations)]]);if(this.completedActionCount==this.totalActions){this.dispatchNotification(iAd.ActionListManager.ACTION_LIST_DID_ITERATE,
this.viewController,[["actionList",this.actionList],["iteration",this.completedIterationCount]]);this.completedIterationCount++;if(this.totalIterations!="infinite"&&this.completedIterationCount==this.totalIterations){this.dispatchNotification(iAd.ActionListManager.ACTION_LIST_WILL_COMPLETE,this.viewController,[["actionList",this.actionList]]);this.viewController.view.layer.removeEventListener("webkitAnimationEnd",this,true);this.usesAnimationIterationCount&&this.viewController.view.layer.removeEventListener("webkitAnimationIteration",
this,true);this.dispatchNotification(iAd.ActionListManager.ACTION_LIST_DID_COMPLETE,this.viewController,[["actionList",this.actionList]]);this.viewController.exitState(this.actionList.cssClassName+iAd.ActionListManager.ACTIVE_STATE_SUFFIX)}else if(this.usesAnimationIterationCount){this.dispatchNotification(iAd.ActionListManager.ACTION_LIST_WILL_ITERATE,this.viewController,[["actionList",this.actionList],["iteration",this.completedIterationCount]]);this.completedActionCount=0}else{this.reset();this.callMethodNameAfterDelay("iterate",
0)}}else if(a=a.name)if(a=this.dependency[a])for(var b=0,c=a.length;b<c;b++){for(var d=a[b],e=d.startAfter,f=true,g=0,h=e.length;g<h;g++){var i=this.actionsByName[e[g]];if(i&&i.completed==false){f=false;break}}f&&this.actionQueue.push(d)}this.flushActionQueue()};
iAd.ActionListManager.prototype.flushActionQueue=function(){if(this.actionQueue.length!=0){var a=[],b={},c=this.viewController.view.layer;this.actionQueue.forEach(function(g){var h=g.type;if(h=="css"){h=c.querySelectorAll(g.selector);var i=h.length;if(i>0)for(var j=g.name,k=g.duration+"s",l=g.delay||"0s",m=0;m<i;m++){var n=h[m],o=n.id;if(!o)o=n.id=iAd.ActionListManager.uniqueId();var p=b[o];if(p){p.keyframeNames.push(j);p.durations.push(k);p.delays.push(l)}else b[o]={keyframeNames:[j],durations:[k],
delays:[l],element:n}}}else h=="script"&&this.timers.push(g.object.run());g.asynchronous&&a.push(g)},this);for(var d in b){var e=b[d],f=e.element;f.style.webkitAnimationName=e.keyframeNames.join(",");f.style.webkitAnimationDuration=e.durations.join(",");f.style.webkitAnimationDelay=e.delays.join(",");f.style.webkitAnimationFillMode="both";f.style.webkitAnimationIterationCount=this.usesAnimationIterationCount?this.totalIterations:""}this.actionQueue=[];a.forEach(this.handleActionDidComplete,this);
this.flushActionQueue()}};iAd.ActionListManager.uniqueId=function(){return"al-"+this._uid++};iAd.ActionListManager._uid=1;iAd.Archiver={};iAd.Archiver._uid=1;iAd.Archiver.WILL_ENCODE_OBJECT="willEncodeObjectToArchive";iAd.Archiver.DID_ENCODE_OBJECT="didEncodeObjectToArchive";iAd.Archiver.WILL_RESTORE_OBJECT="willRestoreFromArchive";iAd.Archiver.DID_RESTORE_OBJECT="didRestoreFromArchive";
iAd.Archiver.archive=function(a,b){if(!b){b={};return{__root:this.archive(a,b),__objects:b}}if(iAd.Utils.objectIsPrimitive(a))return a;else if(iAd.Utils.objectIsArray(a))return a.map(function(g){return this.archive(g,b)},this);var c=a._uid||(a._uid=this._uid++);if(!b[c]){var d=b[c]={};if(iAd.Utils.objectIsInstanceOfClass(a,iAd.Object)){var e=a.constructor;d.__className=e._name;e=this.archivePropertiesForClass(e);iAd.Utils.objectHasMethod(a,iAd.Archiver.WILL_ENCODE_OBJECT)&&a[iAd.Archiver.WILL_ENCODE_OBJECT](d);
for(var f in e)d[f]=this.archive(a.archiveProperty(f),b);iAd.Utils.objectHasMethod(a,iAd.Archiver.DID_ENCODE_OBJECT)&&a[iAd.Archiver.DID_ENCODE_OBJECT](d)}else for(f in a)if(f!="_uid")d[f]=this.archive(a[f],b)}return{_uid:c}};iAd.Archiver.archiveToJSON=function(a){return JSON.stringify(this.archive(a))};
iAd.Archiver.archivePropertiesForClass=function(a){var b=a._archivePropertyMap;if(b)return b;b=a._archivePropertyMap={};var c=a.superclass;c&&iAd.Utils.copyPropertiesFromSourceToTarget(this.archivePropertiesForClass(c),b);var d=a.archivedProperties||[];c=0;for(var e=d.length;c<e;c++)b[d[c]]=true;a=a.excludedProperties||[];c=0;for(e=a.length;c<e;c++)delete b[a[c]];return b};
iAd.Archiver.restoreFromArchive=function(a,b,c){if(iAd.Utils.objectIsPrimitive(a))return a;else if(a.__root)return this.restoreFromArchive(a.__root,a.__objects,{});else if(a._uid){a=a._uid;return c[a]||(c[a]=this.restoreFromArchive(b[a],b,c))}else if(iAd.Utils.objectIsArray(a))return a.map(function(i){return this.restoreFromArchive(i,b,c)},this);else{var d={};for(var e in a)if(e!="__className")d[e]=this.restoreFromArchive(a[e],b,c);if(a.__className){var f=iAd.Utils.resolveObjectPath(a.__className),
g=f,h;do h=g.restoreFromArchive;while(!h&&(g=g.superclass));f=h?h.call(f,d):new f;iAd.Utils.objectHasMethod(f,iAd.Archiver.WILL_RESTORE_OBJECT)&&f[iAd.Archiver.WILL_RESTORE_OBJECT](a);for(e in d)f.restoreProperty(e,d[e]);iAd.Utils.objectHasMethod(f,iAd.Archiver.DID_RESTORE_OBJECT)&&f[iAd.Archiver.DID_RESTORE_OBJECT](a);return f}else return d}};iAd.Archiver.restoreWithJSONArchive=function(a){return a?this.restoreFromArchive(JSON.parse(a)):null};iAd.Archiver.objectReferences={};
iAd.Archiver.referenceForObject=function(a){var b=this.objectReferences,c;if(a.__archiveReference){c=a.__archiveReference;b[c].count++;return c}c=++this._uid;b[c]={object:a,count:1};return a.__archiveReference=c};iAd.Archiver.objectForReference=function(a){var b=this.objectReferences,c=b[a];if(!c)return null;var d=c.object;c.count--;if(c.count<=0){delete b[a];delete d.__archiveReference}return d};
iAd.Class({name:"iAd.Loader",mixins:[iAd.EventTarget],synthesizedProperties:["supportingObject","progress","url","resolvedURL","timeout"]});iAd.Loader.DID_START="loaderDidStart";iAd.Loader.DID_PROGRESS="loaderDidProgress";iAd.Loader.DID_COMPLETE="loaderDidComplete";iAd.Loader.DID_FAIL="loaderDidFail";iAd.Loader.NO_ERROR=0;iAd.Loader.LOAD_ERROR=1;iAd.Loader.LOAD_ABORTED=2;iAd.Loader.LOAD_TIMED_OUT=3;iAd.Loader.DEFAULT_TIMEOUT=0;
iAd.Loader.prototype.init=function(a){this.callSuper();this._url=a;this._timeout=-1;this.delegate=null;this.loaded=this.loading=false;this.error=iAd.Loader.NO_ERROR;this.eventTarget=document};iAd.Loader.prototype.load=function(){if(this.loading)return false;this.loading=true;this.loaded=false;this.error=iAd.Loader.NO_ERROR;this.startTimeoutTimer();this.notifyLoaderDidStart();this.startLoad();return true};
iAd.Loader.prototype.abort=function(){if(!this.loading||this.loaded)return false;this.actuallyAbort();this.notifyLoaderDidFail(iAd.Loader.LOAD_ABORTED);return true};iAd.Loader.prototype.actuallyAbort=function(){this.loaded=this.loading=false;this.abortLoad()};iAd.Loader.prototype.getProgress=function(){return this.loaded?1:0};iAd.Loader.prototype.setUrl=function(a){if(this.loading||this.loaded)iAd.Console.warn("iAd.Loader: You cannot change the url after starting the load.");else this._url=a};
iAd.Loader.prototype.getResolvedURL=function(){return iAd.Path.resolveAbsolutePath(this._url)};iAd.Loader.prototype.getTimeout=function(){return this._timeout>=0?this._timeout:this.constructor.DEFAULT_TIMEOUT};iAd.Loader.prototype.startLoad=function(){this.notifyLoaderDidFail(iAd.Loader.LOAD_ERROR)};iAd.Loader.prototype.abortLoad=function(){};iAd.Loader.prototype.startTimeoutTimer=function(){if(this.timeout>0)this.timeoutTimer=this.callMethodNameAfterDelay("handleTimeout",this.timeout)};
iAd.Loader.prototype.cancelTimeoutTimer=function(){this.timeoutTimer&&clearTimeout(this.timeoutTimer);this.timeoutTimer=null};iAd.Loader.prototype.handleTimeout=function(){this.actuallyAbort();this.notifyLoaderDidFail(iAd.Loader.LOAD_TIMED_OUT)};iAd.Loader.prototype.notifyLoaderDidStart=function(){this.loading=true;this.dispatchLoaderNotification(iAd.Loader.DID_START)};iAd.Loader.prototype.notifyLoaderDidProgress=function(){this.dispatchLoaderNotification(iAd.Loader.DID_PROGRESS,[["progress",this.progress]])};
iAd.Loader.prototype.notifyLoaderDidFail=function(a){this.cancelTimeoutTimer();this.loading=false;this.error=a;this.dispatchLoaderNotification(iAd.Loader.DID_FAIL,[["error",a||iAd.Loader.LOAD_ERROR]])};iAd.Loader.prototype.notifyLoaderDidComplete=function(){if(!(this.loaded&&!this.loading)){this.cancelTimeoutTimer();this.loading=false;this.loaded=true;this.dispatchLoaderNotification(iAd.Loader.DID_COMPLETE)}};
iAd.Loader.prototype.dispatchLoaderNotification=function(a,b){this.dispatchNotification(a,this.delegate,b);this.notifyDelegate(a,this._manager,b)};iAd.Class({name:"iAd.LoaderManager",superclass:iAd.Loader,synthesizedProperties:["length"]});iAd.LoaderManager.DID_PROGRESS="loaderDidProgress";iAd.LoaderManager.prototype.init=function(a){this.callSuper();this._progress=0;this.loaders=a||[];this.pendingLoaders=this.loaders.slice();this.failedLoaders=[];this.completedLoaders=[];this.openLoaders=[]};
iAd.LoaderManager.prototype.add=function(a){if(this.contains(a)){iAd.Console.warn(this.constructor.displayName+": Unable to add loader again if already managed.");return false}if(a.error||a.loaded||a.loading){iAd.Console.warn(this.constructor.displayName+": Unable to add a loader that has already started to load.");return false}this.loaders.push(a);this.pendingLoaders.push(a);this.loading&&this.updateProgress();return true};
iAd.LoaderManager.prototype.remove=function(a){if(this.loading){iAd.Console.warn(this.constructor.displayName+": Unable to remove loaders from a manager that has already started to load.");return false}if(this.contains(a)&&this.pendingLoaders.indexOf(a)==-1){iAd.Console.warn(this.constructor.displayName+": Unable to remove a loader that has already started to load.");return false}var b=iAd.Array.removeObjectFromArray(a,this.loaders);iAd.Array.removeObjectFromArray(a,this.pendingLoaders);return b};
iAd.LoaderManager.prototype.clear=function(){if(this.loading)iAd.Console.warn(this.constructor.displayName+": You cannot clear while loading is in progress.");else{this.resetLoaderArrays();this.updateProgress()}};iAd.LoaderManager.prototype.contains=function(a){return this.loaders.indexOf(a)!=-1};iAd.LoaderManager.prototype.resetLoaderArrays=function(){this.pendingLoaders=[];this.completedLoaders=[];this.openLoaders=[];this.failedLoaders=[];this.loaders=[]};
iAd.LoaderManager.prototype.getProgress=function(){return this._progress};iAd.LoaderManager.prototype.updateProgress=function(){var a=this.length;if(a==0)this._progress=0;else{for(var b=this.loaders,c=0,d=0,e,f,g=0;g<a;g++){e=b[g];f=e.length||1;c+=f;d+=f*e.progress}this._progress=d/c}};iAd.LoaderManager.prototype.getLength=function(){return this.loaders.length};iAd.LoaderManager.prototype.startLoad=function(){this._progress=0;this.openLoaders=[];this.completedLoaders=[];this.failedLoaders=[]};
iAd.LoaderManager.prototype.abortLoad=function(){for(var a=0,b=this.openLoaders.length;a<b;a++)this.openLoaders[a].abort();return true};iAd.LoaderManager.prototype.loadNextItem=function(){if(this.pendingLoaders.length!=0){var a=this.pendingLoaders.shift();this.openLoaders.push(a);a._manager=this;a.callMethodNameAfterDelay("load",0)}};iAd.LoaderManager.prototype.loaderDidComplete=function(a){this.completedLoaders.push(a);this.loaderDidEnd(a)};
iAd.LoaderManager.prototype.loaderDidFail=function(a){this.failedLoaders.push(a);this.loaderDidEnd(a)};iAd.LoaderManager.prototype.loaderDidProgress=function(a,b,c){this.notifyLoaderDidProgress(c||a)};iAd.LoaderManager.prototype.loaderDidEnd=function(a){iAd.Array.removeObjectFromArray(a,this.openLoaders);delete a._manager;this.notifyLoaderDidProgress(a)};
iAd.LoaderManager.prototype.notifyLoaderDidProgress=function(a){this.updateProgress();this.dispatchLoaderNotification(iAd.Loader.DID_PROGRESS,[["progress",this.progress],["relatedLoader",a]])};iAd.Class({name:"iAd.LoaderBatch",superclass:iAd.LoaderManager});iAd.LoaderBatch.prototype.add=function(a){if(this.callSuper(a)&&this.loading){this.loadNextItem();this.notifyLoaderDidProgress()}};
iAd.LoaderBatch.prototype.startLoad=function(){this.callSuper();for(var a=this.pendingLoaders;a.length>0;)this.loadNextItem();return true};iAd.LoaderBatch.prototype.loaderDidComplete=function(a){this.callSuper(a);this.checkLoaderDidComplete()};iAd.LoaderBatch.prototype.loaderDidFail=function(a,b){this.callSuper(a,b);this.checkLoaderDidComplete()};iAd.LoaderBatch.prototype.checkLoaderDidComplete=function(){this.openLoaders.length==0&&this.notifyLoaderDidComplete()};
iAd.Class({name:"iAd.StyleLoader",superclass:iAd.Loader});iAd.StyleLoader.DEFAULT_TIMEOUT=0;iAd.StyleLoader.LOAD_EVENT_SUPPORT_DETECTED=false;
iAd.StyleLoader.prototype.startLoad=function(){var a=this._element=document.createElement("link");a.rel="stylesheet";a.href=this._url;if(iAd.CSS.isStyleSheetLoaded(this.resolvedURL)){this._element=iAd.CSS.elementForStyleSheet(this.resolvedURL);this.notifyLoaderDidComplete()}else{this.addElementListeners();iAd.StyleLoader.LOAD_EVENT_SUPPORT_DETECTED||iAd.StyleLoader.enqueueStyleLoader(this);document.head.appendChild(a)}};
iAd.StyleLoader.prototype.abortLoad=function(){if(this._element){this.removeElementListeners();document.head.removeChild(this._element);iAd.StyleLoader.dequeueStyleLoader(this)}};iAd.StyleLoader.prototype.getSupportingObject=function(){return this._element};iAd.StyleLoader.prototype.getResolvedURL=function(){return this._element?this._element.href:this.callSuper()};
iAd.StyleLoader.prototype.addElementListeners=function(){this._element.addEventListener("load",this);this._element.addEventListener("error",this)};iAd.StyleLoader.prototype.removeElementListeners=function(){this._element.removeEventListener("load",this);this._element.removeEventListener("error",this)};
iAd.StyleLoader.prototype.handleEvent=function(a){iAd.StyleLoader.LOAD_EVENT_SUPPORT_DETECTED=true;iAd.StyleLoader.dequeueStyleLoader(this);this.removeElementListeners();switch(a.type){case "load":this.loaded||this.notifyLoaderDidComplete();break;case "error":this.notifyLoaderDidFail()}};iAd.StyleLoader.stylesheetsLoadingQueue={};iAd.StyleLoader.stylesheetsLoadPoller=null;
iAd.StyleLoader.enqueueStyleLoader=function(a){var b=a.resolvedURL,c=iAd.StyleLoader.stylesheetsLoadingQueue;if(c.hasOwnProperty(b))c[b].push(a);else c[b]=[a];if(iAd.StyleLoader.stylesheetsLoadPoller==null)iAd.StyleLoader.stylesheetsLoadPoller=window.setInterval(iAd.StyleLoader.pollStylesheetLoad,50)};
iAd.StyleLoader.dequeueStyleLoader=function(a){var b=iAd.StyleLoader.stylesheetsLoadingQueue,c=a.resolvedURL;b.hasOwnProperty(c)&&iAd.Array.removeObjectFromArray(a,b[c]);b[c]&&b[c].length==0&&delete b[c];iAd.StyleLoader.stylesheetsLoadPoller&&Object.keys(b).length==0&&iAd.StyleLoader.stopPolling()};
iAd.StyleLoader.pollStylesheetLoad=function(){var a=iAd.StyleLoader.stylesheetsLoadingQueue;if(iAd.StyleLoader.LOAD_EVENT_SUPPORT_DETECTED){iAd.StyleLoader.stylesheetsLoadingQueue={};iAd.StyleLoader.stopPolling()}else{for(var b in a)if(iAd.CSS.isStyleSheetLoaded(b)){a[b].forEach(function(c){c.notifyLoaderDidComplete()});delete a[b]}Object.keys(a).length==0&&iAd.StyleLoader.stopPolling()}};
iAd.StyleLoader.stopPolling=function(){window.clearInterval(iAd.StyleLoader.stylesheetsLoadPoller);iAd.StyleLoader.stylesheetsLoadPoller=null};iAd.Class({name:"iAd.XHRLoader",superclass:iAd.Loader,synthesizedProperties:["xmlContent","content"]});iAd.XHRLoader.SUPPORTS_CONTENT_TYPE=(new XMLHttpRequest).hasOwnProperty("responseType");iAd.XHRLoader.XHR_EVENTS=["loadstart","progress","abort","error","load","timeout","loadend","readystatechange"];iAd.XHRLoader.DEFAULT_TIMEOUT=0;
iAd.XHRLoader.prototype.init=function(a,b,c){this.callSuper(a);this.method=b||"GET";this.params=c;this.headers={};this.urlEncoded=true;this.contentType=""};iAd.XHRLoader.prototype.getContent=function(){if(this._xhr)return iAd.XHRLoader.SUPPORTS_CONTENT_TYPE?this._xhr.response:this._xhr.responseText;return null};iAd.XHRLoader.prototype.getXmlContent=function(){try{return this._xhr?this._xhr.responseXML:null}catch(a){return null}};iAd.XHRLoader.prototype.getSupportingObject=function(){return this._xhr};
iAd.XHRLoader.prototype.getProgress=function(){if(this.loaded)return 1;return this.bytesTotal?this.bytesLoaded/this.bytesTotal:0};iAd.XHRLoader.prototype.getResolvedURL=function(){return iAd.Path.resolveAbsolutePath(this.shouldSerializeURL()?this.serializeURL():this._url)};
iAd.XHRLoader.prototype.startLoad=function(){var a=this.shouldSerializeURL()?this.serializeURL():this._url,b=this.method.toUpperCase(),c=this.params;if(b=="GET")c=null;if(this.urlEncoded&&(b=="POST"||b=="PUT")){this.headers["Content-type"]="application/x-www-form-urlencoded; charset=utf-8";if(c)c=this.serializeParams()}if(!this._xhr)this._xhr=new XMLHttpRequest;this.addXHRListeners();this._xhr.open(b,a,true);for(var d in this.headers)try{this._xhr.setRequestHeader(d,this.headers[d])}catch(e){iAd.Console.warn('iAd.XHRLoader: Error when attempting to set header "'+
d+'".')}if(iAd.XHRLoader.SUPPORTS_CONTENT_TYPE)try{this._xhr.responseType=this.contentType}catch(f){iAd.Console.warn('iAd.XHRLoader: Invalid contentType "'+this.contentType+'".');this.contentType=""}this.bytesLoaded=this.bytesTotal=0;this._xhr.send(c)};iAd.XHRLoader.prototype.abortLoad=function(){if(this._xhr){this.removeXHRListeners();this._xhr.abort();this._xhr=null}};
iAd.XHRLoader.prototype.serializeURL=function(){var a=this._url,b=a.indexOf("?")!=-1?"&":"?";return this.params?a+b+this.serializeParams():a};iAd.XHRLoader.prototype.serializeParams=function(){return iAd.Path.objectToQueryString(this.params)};iAd.XHRLoader.prototype.shouldSerializeURL=function(){return this.method.toUpperCase()=="GET"&&!!this.params};iAd.XHRLoader.prototype.addXHRListeners=function(){for(var a=iAd.XHRLoader.XHR_EVENTS,b=0,c=a.length;b<c;b++)this._xhr.addEventListener(a[b],this)};
iAd.XHRLoader.prototype.removeXHRListeners=function(){for(var a=iAd.XHRLoader.XHR_EVENTS,b=0,c=a.length;b<c;b++)this._xhr.removeEventListener(a[b],this)};iAd.XHRLoader.prototype.handleEvent=function(a){switch(a.type){case "load":this.handleLoadEvent(a);break;case "progress":this.handleProgressEvent(a);break;case "abort":this.handleAbortEvent(a);break;case "error":this.handleErrorEvent(a)}};iAd.XHRLoader.prototype.handleLoadEvent=function(){this.notifyLoaderDidComplete()};
iAd.XHRLoader.prototype.handleProgressEvent=function(a){if(a.lengthComputable){this.bytesLoaded=a.loaded;this.bytesTotal=a.total}this.notifyLoaderDidProgress()};iAd.XHRLoader.prototype.handleAbortEvent=function(){this.notifyLoaderDidFail(iAd.Loader.LOAD_ABORTED)};iAd.XHRLoader.prototype.handleErrorEvent=function(){this.notifyLoaderDidFail(iAd.Loader.LOAD_ERROR)};iAd.Class({name:"iAd.ScriptLoader",superclass:iAd.Loader});iAd.ScriptLoader.DEFAULT_TIMEOUT=0;
iAd.ScriptLoader.prototype.startLoad=function(){var a=this._element=document.createElement("script");a.type="text/javascript";a.src=this._url;var b=iAd.ScriptLoader.elementForScript(a.src);if(b){this._element=b;this.notifyLoaderDidComplete()}else{this.addElementListeners();document.head.appendChild(a)}};iAd.ScriptLoader.prototype.abortLoad=function(){if(this._element){this.removeElementListeners();document.head.removeChild(this._element)}};iAd.ScriptLoader.prototype.getSupportingObject=function(){return this._element};
iAd.ScriptLoader.prototype.getResolvedURL=function(){return this._element?this._element.src:this.callSuper()};iAd.ScriptLoader.prototype.addElementListeners=function(){if(this._element){this._element.addEventListener("load",this,false);this._element.addEventListener("error",this,false)}};iAd.ScriptLoader.prototype.removeElementListeners=function(){if(this._element){this._element.removeEventListener("load",this,false);this._element.removeEventListener("error",this,false)}};
iAd.ScriptLoader.prototype.handleEvent=function(a){this.removeElementListeners();if(a.type=="load")this.notifyLoaderDidComplete();else a.type=="error"&&this.notifyLoaderDidFail(iAd.Loader.LOAD_ERROR)};iAd.ScriptLoader.elementForScript=function(a){for(var b,c=document.scripts,d=0,e=c.length;d<e;d++){b=c[d];if(b.href==a)return b}return null};iAd.Class({name:"iAd.ImageLoader",superclass:iAd.Loader});iAd.ImageLoader.DEFAULT_TIMEOUT=5;
iAd.ImageLoader.prototype.init=function(a,b){this.callSuper(a);this.hasHiDPIVersion=b};iAd.ImageLoader.prototype.startLoad=function(){var a=this._img=document.createElement("img");this.addImageEventListeners();a.src=this.processImageURL(this._url,this.hasHiDPIVersion)};iAd.ImageLoader.prototype.processImageURL=function(a,b){return b&&iAd.Device.HAS_HIDPI_DISPLAY?iAd.Path.appendHiDPISuffix(a):a};iAd.ImageLoader.prototype.abortLoad=function(){this.removeImageEventListeners()};
iAd.ImageLoader.prototype.getSupportingObject=function(){return this._img};iAd.ImageLoader.prototype.getResolvedURL=function(){return this.processImageURL(this.callSuper(),this.hasHiDPIVersion)};iAd.ImageLoader.prototype.handleEvent=function(a){this.removeImageEventListeners();if(a.type=="load")this.notifyLoaderDidComplete();else a.type=="error"&&this.notifyLoaderDidFail(iAd.Loader.LOAD_ERROR)};
iAd.ImageLoader.prototype.addImageEventListeners=function(){if(this._img){this._img.addEventListener("load",this);this._img.addEventListener("error",this)}};iAd.ImageLoader.prototype.removeImageEventListeners=function(){if(this._img){this._img.removeEventListener("load",this);this._img.removeEventListener("error",this)}};iAd.Class({name:"iAd.ViewControllerRequiredFilesLoader",superclass:iAd.LoaderBatch,synthesizedProperties:["contentViewMarkup"]});
iAd.ViewControllerRequiredFilesLoader.LOADER_CLASSES={stylesheets:iAd.StyleLoader,scripts:iAd.ScriptLoader,images:iAd.ImageLoader,contentView:iAd.XHRLoader};iAd.ViewControllerRequiredFilesLoader.prototype.init=function(a){this.callSuper();this.viewController=a;a=a.configuration;a.requiredFileURIs&&this.processFiles(a.requiredFileURIs)};iAd.ViewControllerRequiredFilesLoader.prototype.getContentViewMarkup=function(){return this.contentViewLoader.content};
iAd.ViewControllerRequiredFilesLoader.prototype.processFiles=function(a){for(var b in a)if(a.hasOwnProperty(b))switch(b){case "contentView":this.contentViewLoader=this.addFilesOfType([a[b]],b)[0];break;case "stylesheets":this.addFilesOfType(a[b],b);break;case "scripts":this.addFilesOfType(a[b],b);break;case "images":this.addFilesOfType(a[b],b);break;default:iAd.Console.warn('iAd.ViewController # loadRequiredFiles : unknown key "'+b+'" in configuration.requiredFileURIs')}};
iAd.ViewControllerRequiredFilesLoader.prototype.addFilesOfType=function(a,b){var c=iAd.ViewControllerRequiredFilesLoader.LOADER_CLASSES[b];if(c){for(var d=[],e=0,f=a.length;e<f;e++){var g=a[e];g=c==iAd.ImageLoader?new c(g,this.viewController.configuration.hasHiDPIVersion):new c(g);this.add(g);d.push(g)}return d}else iAd.Console.warn('iAd.ViewController #loadRequiredFiles : No known loader for type "'+b+'"')};
iAd.ViewControllerRequiredFilesLoader.prototype.notifyLoaderDidProgress=function(a){this.callSuper(a);this.viewController.requiredFilesLoaderDidProgress(this,this.progress,a)};iAd.ViewControllerRequiredFilesLoader.prototype.notifyLoaderDidFail=function(a){this.callSuper(a);this.viewController.requiredFilesLoaderDidFail(this,a)};iAd.ViewControllerRequiredFilesLoader.prototype.notifyLoaderDidComplete=function(){this.callSuper();this.viewController.requiredFilesLoaderDidComplete(this)};
iAd.Class({name:"iAd.ViewController",superclass:iAd.Object,mixins:[iAd.EventTarget],synthesizedProperties:["view","title","loadingRequiredFiles","loadedAllRequiredFiles","viewWasProcessed","contentView","interfaceOrientation","contentSizeForViewInPopover"],archivedProperties:["configuration","viewWasArchived","title","toolbarItems","requiredFilesLoadDelegate","stateChangeDelegate","actionListDelegate","wasBackItemTransition","becomesBackItemTransition","wasTopItemTransition","becomesTopItemTransition",
"becomesHiddenTransition","becomesVisibleTransition","buildInActionListShouldOccurAfterTransition","buildOutActionListShouldDelayTransition","disableLoadingViewController","viewLoadingDelaysTransition","contentSizeForViewInPopover","modalInPopover"]});iAd.ViewController.__minimalViewLoadingTime=0;
iAd.ViewController.prototype.init=function(a){this.actionListDelegate=this.stateChangeDelegate=this.requiredFilesLoadDelegate=null;this.callSuper();this.configuration={};this.viewWasArchived=this.viewIsLoaded=this.shouldProcessViewUponRequestsCompleted=this.shouldSetUpContentViewUponLoad=false;this.shouldArchiveView=true;if(iAd.Utils.objectIsString(a))this.configuration={id:a};else if(a!==undefined&&a!==null)this.configuration=a;this.id=this.configuration.id||iAd.ViewController.uniqueId();this._contentView=
this._view=null;this._title="";this._navigationItem=this._tabBarItem=null;this._toolbarItems=[];this._viewWasProcessed=false;this.outlets={};this.eventTarget=document;this.searchDisplayController=this.modalTransitionStyle=this.viewAppearancePropagationProperty=this.parentViewController=this.modalViewController=null;this.wasBackItemTransition=iAd.ViewController.TRANSITION_IN_FROM_LEFT;this.becomesBackItemTransition=iAd.ViewController.TRANSITION_OUT_TO_LEFT;this.wasTopItemTransition=iAd.ViewController.TRANSITION_OUT_TO_RIGHT;
this.becomesTopItemTransition=iAd.ViewController.TRANSITION_IN_FROM_RIGHT;this.becomesHiddenTransition=iAd.ViewController.TRANSITION_DISSOLVE_OUT;this.becomesVisibleTransition=iAd.ViewController.TRANSITION_DISSOLVE_IN;this.disableLoadingViewController=this.buildOutActionListShouldDelayTransition=this.buildInActionListShouldOccurAfterTransition=false;this.viewLoadingDelaysTransition=true;this.__minimalViewLoadingTime=iAd.ViewController.__minimalViewLoadingTime;this.contentSizeForViewInPopover=new iAd.Size(320,
1100);this.modalInPopover=false;iAd.ViewController.instances[this.id]=this;iAd.Utils.copyPropertiesFromSourceToTarget(this.configuration.properties,this);this.actionListManagersByName={};this.actionListByName={};this.actionListNameByClassName={};if(a=this.configuration.actionLists)for(var b=0,c=a.length;b<c;b++)this.loadActionList(a[b])};iAd.ViewController.restoreFromArchive=function(a){return new this(a.configuration)};iAd.ViewController.instances={};iAd.ViewController.viewProcessors=[];
iAd.ViewController.WILL_LOAD_REQUIRED_FILES="viewControllerWillLoadRequiredFiles";iAd.ViewController.PROGRESS_LOADING_REQUIRED_FILES="viewControllerProgressLoadingRequiredFiles";iAd.ViewController.DID_LOAD_REQUIRED_FILES="viewControllerDidLoadRequiredFiles";iAd.ViewController.DID_ABORT_LOAD_REQUIRED_FILES="viewControllerDidAbortLoadRequiredFiles";iAd.ViewController.DID_ENTER_STATE="viewControllerDidEnterState";iAd.ViewController.DID_EXIT_STATE="viewControllerDidExitState";
iAd.ViewController.ACTION_LIST_WILL_START="viewControllerActionListWillStart";iAd.ViewController.ACTION_LIST_DID_START="viewControllerActionListDidStart";iAd.ViewController.ACTION_LIST_WILL_ITERATE="viewControllerActionListWillIterate";iAd.ViewController.ACTION_LIST_DID_ITERATE="viewControllerActionListDidIterate";iAd.ViewController.ACTION_LIST_WILL_COMPLETE="viewControllerActionListWillComplete";iAd.ViewController.ACTION_LIST_DID_COMPLETE="viewControllerActionListDidComplete";
iAd.ViewController.ACTION_LIST_DID_CANCEL="viewControllerActionListDidCancel";iAd.ViewController.ACTION_LIST_DID_PROGRESS="viewControllerActionListDidProgress";iAd.ViewController.VIEW_WILL_APPEAR_STATE="ad-view-will-appear";iAd.ViewController.VIEW_DID_APPEAR_STATE="ad-view-did-appear";iAd.ViewController.VIEW_WILL_DISAPPEAR_STATE="ad-view-will-disappear";iAd.ViewController.VIEW_DID_DISAPPEAR_STATE="ad-view-did-disappear";
iAd.ViewController.APPEARANCE_STATES=[iAd.ViewController.VIEW_WILL_APPEAR_STATE,iAd.ViewController.VIEW_DID_APPEAR_STATE,iAd.ViewController.VIEW_WILL_DISAPPEAR_STATE,iAd.ViewController.VIEW_DID_DISAPPEAR_STATE];iAd.ViewController.VIEW_WILL_APPEAR_EVENT="viewControllerViewWillAppear";iAd.ViewController.VIEW_DID_APPEAR_EVENT="viewControllerViewDidAppear";iAd.ViewController.VIEW_WILL_DISAPPEAR_EVENT="viewControllerViewWillDisappear";iAd.ViewController.VIEW_DID_DISAPPEAR_EVENT="viewControllerViewDidDisappear";
iAd.ViewController.VIEW_DID_LOAD="viewControllerViewDidLoad";iAd.ViewController.VIEW_DID_UNLOAD="viewControllerViewDidUnload";iAd.ViewController.TRANSITION_IN_FROM_RIGHT={properties:["transform"],from:["translateX(100%)"],to:["translateX(0)"]};iAd.ViewController.TRANSITION_IN_FROM_LEFT={properties:["transform"],from:["translateX(-100%)"],to:["translateX(0)"]};iAd.ViewController.TRANSITION_OUT_TO_RIGHT={properties:["transform"],from:["translateX(0)"],to:["translateX(100%)"]};
iAd.ViewController.TRANSITION_OUT_TO_LEFT={properties:["transform"],from:["translateX(0)"],to:["translateX(-100%)"]};iAd.ViewController.TRANSITION_DISSOLVE_OUT={properties:["opacity"],from:[1],to:[0]};iAd.ViewController.TRANSITION_DISSOLVE_IN={properties:["opacity"],from:[0],to:[1]};iAd.ViewController.DECLARATIVE_MIME_TYPE="application/vnd.apple.iadjs; type=view-controllers";iAd.ViewController.ARCHIVE_PREFIX=window.location.href+":";iAd.ViewController.VIEW_ARCHIVE_PREFIX=window.location.href+"-view:";
iAd.ViewController.prototype.getView=function(){if(this._view)return this._view;if(this.viewWasArchived){var a=iAd.ViewController.VIEW_ARCHIVE_PREFIX+this.id,b=window.localStorage[a];delete window.localStorage[a];this.viewWasArchived=false;this.view=iAd.Archiver.restoreWithJSONArchive(b)}this._view==null&&this.loadView();return this._view};
iAd.ViewController.prototype.setView=function(a){this._view instanceof iAd.View&&delete this._view._viewController;if(a==null){a=this.shouldArchiveView;this.shouldArchiveView=false;this.unloadView();this.shouldArchiveView=a}else{if(this.__minimalViewLoadingTime>0)this.__loadViewStartTime=new Date;a._viewController=this;this._view=a;var b=this.configuration;if(a.usesDeclarativeBacking&&a.layerHasCustomAttribute("ad-content-view")){if(!b.requiredFileURIs)b.requiredFileURIs={};b.requiredFileURIs.contentView=
a.getLayerCustomAttributeValue("ad-content-view")}if(b.requiredFileURIs&&b.requiredFileURIs.contentView)this.loadContentView();else if(b.requiredFileURIs&&!this.loadedAllRequiredFiles){this.shouldProcessViewUponRequestsCompleted=true;this.loadingRequiredFiles||this.loadRequiredFiles()}else this.processView()}};iAd.ViewController.prototype.setContentView=function(a){a.autoresizingMask=iAd.View.AUTORESIZING_FLEXIBLE_WIDTH|iAd.View.AUTORESIZING_FLEXIBLE_HEIGHT;this._contentView=a};
iAd.ViewController.prototype.loadView=function(){this.view=new iAd.View};iAd.ViewController.prototype.loadContentView=function(){if(this.loadingRequiredFiles)this.shouldSetUpContentViewUponLoad=true;else if(this.loadedAllRequiredFiles)this.setupContentViewFromLayer();else{this.shouldSetUpContentViewUponLoad=true;this.loadRequiredFiles()}};
iAd.ViewController.prototype.unloadView=function(){if(!(this._view==null||!this.isViewLoaded())){this.archiveView();this._contentView=null;this._view.removeFromSuperview();this.cleanViewProcessors();this._view=null;this.viewIsLoaded=false;this.viewDidUnload()}};
iAd.ViewController.prototype.archiveView=function(){if(!(!this.shouldArchiveView||!this._view||this._contentView)){window.localStorage[iAd.ViewController.VIEW_ARCHIVE_PREFIX+this.id]=iAd.Archiver.archiveToJSON(this._view);this.viewWasArchived=true}};iAd.ViewController.prototype.willEncodeObjectToArchive=function(a){this.archiveView();this.callSuper(a)};iAd.ViewController.prototype.archiveProperty=function(a){var b=this.callSuper(a);if(a=="configuration")b.id=this.id;return b};
iAd.ViewController.prototype.isViewLoading=function(){return this.loadingRequiredFiles||this.loadedAllRequiredFiles&&!this.viewIsLoaded};iAd.ViewController.prototype.isViewLoaded=function(){return this.viewIsLoaded};iAd.ViewController.prototype.viewDidLoad=function(){this.createAndDispatchEvent(iAd.ViewController.VIEW_DID_LOAD)};iAd.ViewController.prototype.viewDidUnload=function(){this.createAndDispatchEvent(iAd.ViewController.VIEW_DID_UNLOAD)};
iAd.ViewController.prototype.didReceiveMemoryWarning=function(){this.parentViewController==null&&this.isViewLoaded()&&!document.body.contains(this.view.layer)&&this.unloadView()};iAd.ViewController.prototype.setTitle=function(a){this._title=a;var b=this.parentViewController;if(b!=null)if(iAd.Utils.objectIsInstanceOfClass(b,iAd.TabBarController))this.tabBarItem.title=a;else if(iAd.Utils.objectIsInstanceOfClass(b,iAd.NavigationController))this.navigationItem.title=a};
iAd.ViewController.prototype.isInState=function(a){return this.view.layer.hasClassName(a)};iAd.ViewController.prototype.enterState=function(a){var b=this.view.layer.addClassName(a);b&&this.dispatchNotification(iAd.ViewController.DID_ENTER_STATE,this.stateChangeDelegate,[["state",a]]);return b};iAd.ViewController.prototype.exitState=function(a){var b=this.view.layer.removeClassName(a);b&&this.dispatchNotification(iAd.ViewController.DID_EXIT_STATE,this.stateChangeDelegate,[["state",a]]);return b};
iAd.ViewController.prototype.toggleState=function(a,b){if(b==null)b=!this.isInState(a);this[b?"enterState":"exitState"](a)};iAd.ViewController.prototype.enterExclusiveAppearanceState=function(a){for(var b,c=0,d=iAd.ViewController.APPEARANCE_STATES.length;c<d;c++){b=iAd.ViewController.APPEARANCE_STATES[c];this[b===a?"enterState":"exitState"](b)}};
iAd.ViewController.prototype.propagateViewAppearanceIfNotInState=function(a,b,c){var d=this.viewAppearancePropagationProperty;(d=d?this[d]:null)&&!d.isInState(c)&&d[a](b)};iAd.ViewController.prototype.viewWillAppear=function(a){this.createAndDispatchEvent(iAd.ViewController.VIEW_WILL_APPEAR_EVENT,[["animated",a]]);this.enterExclusiveAppearanceState(iAd.ViewController.VIEW_WILL_APPEAR_STATE);this.propagateViewAppearanceIfNotInState("viewWillAppear",a,iAd.ViewController.VIEW_DID_APPEAR_STATE)};
iAd.ViewController.prototype.viewDidAppear=function(a){this.enterExclusiveAppearanceState(iAd.ViewController.VIEW_DID_APPEAR_STATE);this.createAndDispatchEvent(iAd.ViewController.VIEW_DID_APPEAR_EVENT,[["animated",a]]);this.propagateViewAppearanceIfNotInState("viewDidAppear",a,iAd.ViewController.VIEW_DID_APPEAR_STATE)};
iAd.ViewController.prototype.viewWillDisappear=function(a){this.createAndDispatchEvent(iAd.ViewController.VIEW_WILL_DISAPPEAR_EVENT,[["animated",a]]);this.enterExclusiveAppearanceState(iAd.ViewController.VIEW_WILL_DISAPPEAR_STATE);this.propagateViewAppearanceIfNotInState("viewWillDisappear",a,iAd.ViewController.VIEW_DID_DISAPPEAR_STATE)};
iAd.ViewController.prototype.viewDidDisappear=function(a){this.enterExclusiveAppearanceState(iAd.ViewController.VIEW_DID_DISAPPEAR_STATE);this.createAndDispatchEvent(iAd.ViewController.VIEW_DID_DISAPPEAR_EVENT,[["animated",a]]);this.propagateViewAppearanceIfNotInState("viewDidDisappear",a,iAd.ViewController.VIEW_DID_DISAPPEAR_STATE);this.resetAllActionLists()};iAd.ViewController.prototype.presentModalViewControllerAnimated=function(a){this.modalViewController=a};
iAd.ViewController.prototype.dismissModalViewControllerAnimated=function(){this.modalViewController=null};iAd.ViewController.prototype.parentControllerOfKind=function(a){for(var b=this;b=b.parentViewController;)if(iAd.Utils.objectIsInstanceOfClass(b,a))return b;return null};iAd.ViewController.prototype.getLoadingRequiredFiles=function(){return this.requiredFilesLoader&&this.requiredFilesLoader.loading};
iAd.ViewController.prototype.getLoadedAllRequiredFiles=function(){var a=this.requiredFilesLoader;return a&&(a.loaded||a.length==0)};
iAd.ViewController.prototype.loadRequiredFiles=function(){if(!this.loadedAllRequiredFiles){if(!this.requiredFilesLoader)this.requiredFilesLoader=new iAd.ViewControllerRequiredFilesLoader(this);this.dispatchNotification(iAd.ViewController.WILL_LOAD_REQUIRED_FILES,this.requiredFilesLoadDelegate);var a=this.requiredFilesLoader;if(a.length>0){a.load();this.notifyPropertyChange("loadingRequiredFiles")}else this.dispatchNotification(iAd.ViewController.DID_LOAD_REQUIRED_FILES,this.requiredFilesLoadDelegate)}};
iAd.ViewController.prototype.abortLoadRequiredFiles=function(){this.requiredFilesLoader.loading&&this.requiredFilesLoader.abort()};iAd.ViewController.prototype.handleEvent=function(){};
iAd.ViewController.prototype.setupContentViewFromLayer=function(){var a=iAd.Element.elementFromString(this.requiredFilesLoader.contentViewMarkup);this._view.hostingLayer.appendChild(a);if(!a.hasAttribute("id"))a.id=this.id;a=iAd.View.viewForLayer(a);a.superview=this._view;a._indexInSuperviewSubviews=this._view.subviews.push(a)-1;this.contentView=a;a.declarativeLayerWasInitialized?this.processView():a.addPropertyObserver("declarativeLayerWasInitialized",this,"processView")};
iAd.ViewController.prototype.requiredFilesLoaderDidProgress=function(a,b,c){if(c.loaded)this.dispatchNotification(iAd.ViewController.PROGRESS_LOADING_REQUIRED_FILES,this.requiredFilesLoadDelegate,[["progress",b],["url",c.url]]);else c.error&&iAd.Console.warn("iAd.ViewController \u2014 could not load required file with URI "+c.url)};
iAd.ViewController.prototype.requiredFilesLoaderDidComplete=function(){this.dispatchNotification(iAd.ViewController.DID_LOAD_REQUIRED_FILES,this.requiredFilesLoadDelegate);this.notifyPropertyChange("loadingRequiredFiles");if(this.shouldSetUpContentViewUponLoad)this.setupContentViewFromLayer();else this.shouldProcessViewUponRequestsCompleted&&this.processView()};
iAd.ViewController.prototype.requiredFilesLoaderDidFail=function(a,b){if(b==iAd.Loader.LOAD_ABORTED){for(var c=[],d=this.requiredFilesLoader.openLoaders,e=0,f=d.length;e<f;e++)c.push(d[e].url);this.notifyPropertyChange("loadingRequiredFiles");this.dispatchNotification(iAd.ViewController.DID_ABORT_LOAD_REQUIRED_FILES,this.requiredFilesLoadDelegate,[["uris",c]])}};
iAd.ViewController.prototype.processView=function(){if(!this._view.layer.hasAttribute("id"))this._view.id=this.id+(this.configuration.hasOwnProperty("requiredFileURIs")&&this.configuration.requiredFileURIs.hasOwnProperty("contentView")?"-container":"");this.viewProcessors=[];for(var a,b=0,c=iAd.ViewController.viewProcessors.length;b<c;b++){a=new iAd.ViewController.viewProcessors[b](this);a.processView(this._view);this.viewProcessors.push(a)}if(this.__minimalViewLoadingTime>0){a=(Date.now()-this.__loadViewStartTime)/
1E3;if(a<this.__minimalViewLoadingTime){this.callMethodNameAfterDelay("viewProcessingDidComplete",this.__minimalViewLoadingTime-a);return}}this.viewProcessingDidComplete()};iAd.ViewController.prototype.viewProcessingDidComplete=function(){if(!this.viewIsLoaded){this.viewIsLoaded=true;this.viewDidLoad()}this.viewWasProcessed=true};iAd.ViewController.prototype.cleanViewProcessors=function(){for(;this.viewProcessors.length;)this.viewProcessors.pop().cleanUp();this.viewWasProcessed=false};
iAd.ViewController.uniqueId=function(){return"vc-"+Math.floor(Math.random()*1E10)};iAd.ViewController.addViewProcessor=function(a){iAd.ViewController.viewProcessors.push(a)};
iAd.ViewController.init=function(){iAd.Class.processAllClasses();for(var a=document.scripts,b,c=0,d=a.length;c<d;c++){b=a[c];b.type==iAd.ViewController.DECLARATIVE_MIME_TYPE&&iAd.ViewController.handleScriptElementForDeclarativeViewControllers(b)}window.addEventListener("ADMemoryLevelWarning",iAd.ViewController.handleMemoryWarning,true);window.addEventListener("ADMemoryLevelUrgent",iAd.ViewController.handleMemoryWarning,true)};
iAd.ViewController.handleScriptElementForDeclarativeViewControllers=function(a){if(a.src!=""){var b=new XMLHttpRequest;b._url=a.src;b.addEventListener("load",this.handleEventProxy,false);b.addEventListener("error",this.handleEventProxy,false);b.open("GET",b._url,true);b.send()}else{var c=Function("undefined","return ("+a.textContent+");")();setTimeout(function(){iAd.ViewController.handleDeclarativeViewControllerDefinitions(c)},0)}};iAd.ViewController.handleEventProxy=function(a){iAd.ViewController.handleEvent(a)};
iAd.ViewController.handleEvent=function(a){var b=a.target;switch(a.type){case "load":a=Function("undefined","return ("+b.responseText+");")();iAd.ViewController.handleDeclarativeViewControllerDefinitions(a);break;case "error":iAd.Console.error("Failed to read content from JSON file "+b._url)}};iAd.ViewController.handleDeclarativeViewControllerDefinitions=function(a){if(iAd.Utils.objectIsArray(a))for(var b=0,c=a.length;b<c;b++)iAd.ViewController.viewControllerWithConfiguration(a[b]);else iAd.ViewController.viewControllerWithConfiguration(a)};
iAd.ViewController.viewControllerWithConfiguration=function(a){if(!iAd.ViewController.instances.hasOwnProperty(a.id))return new (iAd.ViewController.constructorMap[a.type]||iAd.ViewController)(a)};iAd.ViewController.constructorMap={};iAd.ViewController.handleMemoryWarning=function(){var a=iAd.ViewController.instances;for(var b in a)a[b].didReceiveMemoryWarning()};
iAd.ViewController.prototype.startAction=function(a){var b=iAd.Utils.resolveObjectPath(a.className);if(!b)throw iAd.ActionListManager.INVALID_CLASS_NAME_EXCEPTION;b=new b(this);var c=a.properties;for(var d in c)b[d]=c[d];if(a.delay)b.delay=a.delay;b.prepare();b.run()};
iAd.ViewController.prototype.loadActionList=function(a){var b=a.name,c=a.cssClassName;if(b&&a.actions.length>0){this.actionListByName[b]=a;if(c==null)a.cssClassName=c=b.replace(/\s+/g,"-").toLowerCase();this.actionListNameByClassName[c]=b}};iAd.ViewController.prototype.startActionList=function(a){var b=this.actionListByName[a];if(b){var c=this.actionListManagersByName[a];c||(this.actionListManagersByName[a]=c=new iAd.ActionListManager(b,this));c.callMethodNameAfterDelay("start",0)}};
iAd.ViewController.prototype.cancelActionList=function(a){(a=this.actionListManagersByName[a])&&a.reset()};iAd.ViewController.prototype.resetAllActionLists=function(){for(var a in this.actionListManagersByName)this.actionListManagersByName[a].reset()};iAd.ViewController.prototype.hasActionList=function(a){return!!this.actionListByName[a]};
iAd.ViewController.prototype.dispatchActionListNotification=function(a,b){this.notifyDelegate(a,this.transitionController,b);this.dispatchNotification(a,this.actionListDelegate,b)};iAd.ViewController.prototype.actionListWillStart=function(a,b){this.dispatchActionListNotification(iAd.ViewController.ACTION_LIST_WILL_START,[["actionList",b]])};iAd.ViewController.prototype.actionListDidStart=function(a,b){this.dispatchActionListNotification(iAd.ViewController.ACTION_LIST_DID_START,[["actionList",b]])};
iAd.ViewController.prototype.actionListWillIterate=function(a,b,c){this.dispatchActionListNotification(iAd.ViewController.ACTION_LIST_WILL_ITERATE,[["actionList",b],["iteration",c]])};iAd.ViewController.prototype.actionListDidIterate=function(a,b,c){this.dispatchActionListNotification(iAd.ViewController.ACTION_LIST_DID_ITERATE,[["actionList",b],["iteration",c]])};
iAd.ViewController.prototype.actionListWillComplete=function(a,b){this.dispatchActionListNotification(iAd.ViewController.ACTION_LIST_WILL_COMPLETE,[["actionList",b]])};iAd.ViewController.prototype.actionListDidComplete=function(a,b){this.dispatchActionListNotification(iAd.ViewController.ACTION_LIST_DID_COMPLETE,[["actionList",b]])};iAd.ViewController.prototype.actionListDidCancel=function(a,b){this.dispatchActionListNotification(iAd.ViewController.ACTION_LIST_DID_CANCEL,[["actionList",b]])};
iAd.ViewController.prototype.actionListDidProgress=function(a,b,c,d){this.dispatchActionListNotification(iAd.ViewController.ACTION_LIST_DID_PROGRESS,[["actionList",b],["action",c],["progress",d]])};iAd.ViewController.orientationDidChange=function(a){var b=this.instances;for(var c in b)b[c].didRotateFromInterfaceOrientation(a)};iAd.ViewController.prototype.getInterfaceOrientation=function(){return iAd.Device.interfaceOrientation};iAd.ViewController.prototype.didRotateFromInterfaceOrientation=function(){};
iAd.ViewController.prototype.archive=function(){window.localStorage[iAd.ViewController.ARCHIVE_PREFIX+this.id]=iAd.Archiver.archiveToJSON(this)};iAd.ViewController.restore=function(a){return(a=window.localStorage[iAd.ViewController.ARCHIVE_PREFIX+a])?iAd.Archiver.restoreWithJSONArchive(a):null};iAd.ViewController.clearArchives=function(){for(var a in window.localStorage)if(a.indexOf(iAd.ViewController.ARCHIVE_PREFIX)==0||a.indexOf(iAd.ViewController.VIEW_ARCHIVE_PREFIX)==0)delete window.localStorage[a]};
iAd.ViewController.initialize=function(){iAd.ViewController.constructorMap[this.displayName]=this};iAd.View.prototype.containingViewController=function(){for(var a=this;a;){if(a._viewController)return a._viewController;a=a.superview}};iAd.Class.processMethods(iAd.View,["containingViewController"]);window.addEventListener("DOMContentLoaded",iAd.ViewController.init,true);
(function(){iAd.Class.processMethod(iAd.ViewController,"init");var a=iAd.ViewController.prototype.init;iAd.ViewController.prototype.init=function(){a.apply(this,arguments);var b=this.configuration.analytics;b&&iAd.Analytics.processAnalyticsWithConfiguration(b)}})();iAd.BindingError={};iAd.BindingError.UNKNOWN_ERROR=1;iAd.BindingError.URL_RESOURCE_ERROR=2;iAd.BindingError.INVALID_PROPERTIES_ERROR=3;iAd.BindingError.MODAL_ACTIVITY_ERROR=4;iAd.BindingError.INVALID_PRESENTATION_RECT_ERROR=5;
iAd.BindingError.OTHER_ERROR=6;iAd.Bindings={};iAd.Bindings.SHIMS_ENABLED=false;iAd.BindingUtils={};iAd.BindingUtils.BINDING_UNAVAILABLE_ERROR="This binding is unavailable.";iAd.BindingUtils.initializeBindingObject=function(a,b){var c=b?a:a.constructor;a._binding=c.BINDING_OBJECT;if(!iAd.Bindings.SHIMS_ENABLED&&a._binding.shim)a._binding=null;a._bindingClass=c.BINDING_CLASS;a._bindingProtocol=c.BINDING_PROTOCOL};
iAd.BindingUtils.registerBindingClass=function(a){Object.defineProperty(a,"available",{get:function(){return this.hasOwnProperty("getAvailable")?this.getAvailable():iAd.BindingUtils.isBindingClassAvailable(this)}})};iAd.BindingUtils.isBindingClassAvailable=function(a){return!!(a.BINDING_OBJECT&&(iAd.Bindings.SHIMS_ENABLED||!a.BINDING_OBJECT.shim))};iAd.BindingUtils.isErrorFromModalActivity=function(a){return(a=this.sanitizeMessageFromError(a))&&a.indexOf("modal activity is in progress")!==-1};
iAd.BindingUtils.sanitizeMessageFromError=function(a){if(!a)return"";if(a.hasOwnProperty("message"))return a.message;return a.toString()};iAd.ComposerBackedObject={};iAd.ComposerBackedObject.init=function(){this.requestActivationForComposer()};iAd.ComposerBackedObject.requestActivationForComposer=function(){var a=this.constructor,b=a.activeObjectForComposer;if(b!==this){b&&b.resignAsActiveComposer();a.activeObjectForComposer=this;this.isActiveObjectForComposer=true;this.didBecomeActiveObjectForComposer()}};
iAd.ComposerBackedObject.resignAsActiveComposer=function(){if(this.isActiveObjectForComposer){this.isActiveObjectForComposer=false;this.willResignActiveObjectForComposer();this.constructor.activeObjectForComposer=null}};iAd.ComposerBackedObject.didBecomeActiveObjectForComposer=function(){};iAd.ComposerBackedObject.willResignActiveObjectForComposer=function(){};iAd.Class({name:"iAd.SavableContent",mixins:[iAd.EventTarget]});iAd.SavableContent.SAVE_DID_COMPLETE="savableContentSaveDidComplete";
iAd.SavableContent.SAVE_DID_FAIL="savableContentSaveDidFail";iAd.SavableContent.SAVE_DID_CANCEL="savableContentSaveDidCancel";iAd.SavableContent.prototype.init=function(a,b){this.callSuper();this.delegate=b;iAd.BindingUtils.initializeBindingObject(this);if(!this._binding)throw iAd.BindingUtils.BINDING_UNAVAILABLE_ERROR;iAd.Utils.copyPropertiesFromSourceToTarget(a,this)};iAd.SavableContent.prototype.present=function(){};
iAd.SavableContent.prototype.presentDidThrowError=function(a){var b=iAd.BindingUtils.sanitizeMessageFromError(a);if(b.match(/(Presentation\srect)(.*)(is\snot\svalid)/))this.notifySaveDidFail(iAd.BindingError.INVALID_PRESENTATION_RECT_ERROR);else iAd.BindingUtils.isErrorFromModalActivity(a)?this.notifySaveDidFail(iAd.BindingError.MODAL_ACTIVITY_ERROR):this.notifySaveDidFail(iAd.BindingError.OTHER_ERROR,b)};
iAd.SavableContent.prototype.notifySaveDidComplete=function(){this.notifyDelegate(iAd.SavableContent.SAVE_DID_COMPLETE,this.delegate)};iAd.SavableContent.prototype.notifySaveDidCancel=function(){this.notifyDelegate(iAd.SavableContent.SAVE_DID_CANCEL,this.delegate)};iAd.SavableContent.prototype.notifySaveDidFail=function(a,b){this.notifyDelegate(iAd.SavableContent.SAVE_DID_FAIL,this.delegate,[["errorCode",a||iAd.BindingError.UNKNOWN_ERROR],["errorDetail",b||null]])};
iAd.SavableContent.prototype.sanitizeRectForBinding=function(a){if(a instanceof iAd.Rect)return{left:a.origin.x,top:a.origin.y,width:a.size.width,height:a.size.height};else if(a instanceof ClientRect)return a;return null};window._ad={shim:true};
if(!window.ADAd)window._ADAd={ADInterfaceOrientationLandscapeLeft:4,ADInterfaceOrientationLandscapeRight:8,ADInterfaceOrientationPortrait:1,ADInterfaceOrientationPortraitUpsideDown:2,kInvalidOrCorruptImageError:4,kInvalidURL:100,kURLInvalidSchemeViolation:105,kURLRelativePathViolation:103,kURLSameOriginPolicyViolation:104};
if(!window.ADNetworkTypeListener){window._ADNetworkTypeListener={kADNetworkTypeListenerNetworkType3G:3,kADNetworkTypeListenerNetworkTypeEDGE:2,kADNetworkTypeListenerNetworkTypeGPRS:1,kADNetworkTypeListenerNetworkTypeUnknown:0,kADNetworkTypeListenerNetworkTypeWiFi:4};window._ad.networkType=window._ADNetworkTypeListener.kADNetworkTypeListenerNetworkTypeUnknown}if(!window.ad||!window.ad.hasOwnProperty("currentSupportedInterfaceOrientations"))window._ad.currentSupportedInterfaceOrientations=0;
if(!window.ad||!window.ad.hasOwnProperty("locationServicesEnabled"))window._ad.locationServicesEnabled=false;window.ad||Object.defineProperty(window._ad,"deviceOrientationListener",{set:function(a){iAd.Bindings.SHIMS_ENABLED&&a.deviceOrientationDidChange(0)}});if(!window.ADCalendarListener)window._ADCalendarListener={kADCalendarEventCanceledCode:1,kADCalendarEventCreatedCode:0,kADCalendarMissingOrInvalidPropertiesErrorCode:3,kADCalendarUnknownErrorCode:2};
if(!window.ad||!window.ad.calendar)window._ad.calendar={shim:true,presentComposer:function(a,b){b.calendarComposerDidFinish(window._ADCalendarListener.kADCalendarEventCreatedCode)}};iAd.Class({name:"iAd.CalendarEvent",superclass:iAd.SavableContent});iAd.CalendarEvent.BINDING_OBJECT=window._ad.calendar||window.ad.calendar;iAd.CalendarEvent.BINDING_PROTOCOL=window._ADCalendarListener||window.ADCalendarListener;
iAd.CalendarEvent.prototype.init=function(a,b){this.end=this.start=this.summary=this.location=this.description=null;this.allDay=false;this.recurrence=null;this.callSuper(a,b)};
iAd.CalendarEvent.prototype.createEventObject=function(){var a=this.end<this.start?this.start:this.end;return{description:this.description!=undefined?this.description:null,location:this.location||null,end:a?a.toISOString():null,start:this.start?this.start.toISOString():null,allDay:this.allDay||false,recurrence:this.recurrence||null,summary:this.summary||null}};
iAd.CalendarEvent.prototype.present=function(a){if(iAd.Device.IS_IPAD&&!a)this.notifySaveDidFail(iAd.BindingError.INVALID_PRESENTATION_RECT_ERROR);else{this._binding.listener=this;try{this._binding.presentComposer(this.createEventObject(),this,this.sanitizeRectForBinding(a))}catch(b){this.presentDidThrowError(b)}}};
iAd.CalendarEvent.prototype.presentDidThrowError=function(a){var b=iAd.BindingUtils.sanitizeMessageFromError(a);if(b.indexOf("missing required properties:")!==-1){a=b.lastIndexOf(": ");b=error_string.substr(a+2);a=b.split(", ");this.notifySaveDidFail(iAd.BindingError.INVALID_PROPERTIES_ERROR,a)}else this.callSuper(a)};
iAd.CalendarEvent.prototype.calendarComposerDidFinish=function(a){switch(a){case this._bindingProtocol.kADCalendarEventCanceledCode:this.notifySaveDidCancel();break;case this._bindingProtocol.kADCalendarEventCreatedCode:this.notifySaveDidComplete();break;case this._bindingProtocol.kADCalendarUnknownErrorCode:this.notifySaveDidFail();break;case this._bindingProtocol.kADCalendarMissingOrInvalidPropertiesErrorCode:break;default:this.notifySaveDidFail()}};iAd.BindingUtils.registerBindingClass(iAd.CalendarEvent);
if(!window.ADContacts)window._ADContacts={ADContactsEntryCanceled:"ADContactsEntryCanceled",ADContactsEntryCreated:"ADContactsEntryCreated",ADContactsReadyToPresent:"ADContactsReadyToPresent"};
if(!window.ad||!window.ad.contacts){window._ad.contacts={shim:true,eventTarget:window,readyToPresent:true,presentComposer:function(){var a=iAd.EventTarget.createEvent(window._ADContacts.ADContactsEntryCreated);iAd.EventTarget.dispatchEvent.call(window._ad.contacts,a)}};Object.defineProperty(window._ad.contacts,"contactInfo",{set:function(){var a=iAd.EventTarget.createEvent(window._ADContacts.ADContactsReadyToPresent);iAd.EventTarget.dispatchEvent.call(window._ad.contacts,a)}})}
iAd.Class({name:"iAd.ContactCard",superclass:iAd.SavableContent,synthesizedProperties:["birthday"],mixins:[iAd.ComposerBackedObject]});iAd.ContactCard.BINDING_OBJECT=window._ad.contacts||window.ad.contacts;iAd.ContactCard.BINDING_PROTOCOL=window._ADContacts||window.ADContacts;
iAd.ContactCard.prototype.init=function(a,b){this.homePage=this.imageURL=this.department=this.jobTitle=this.organization=this.nickname=this.suffix=this.prefix=this.lastName=this.middleName=this.firstName=null;this.phoneNumbers=[];this.addresses=[];this.emails=[];this._birthday=this.note=null;this._readyToPresent=false;this.callSuper(a,b)};
iAd.ContactCard.prototype.setBirthday=function(a){if(iAd.Utils.objectIsInstanceOfClass(a,Date)){a.setHours(12);a.setMinutes(0);a.setMilliseconds(0);this._birthday=a}else iAd.Console.warn('iAd.ContactCard: The "birthday" property needs to be a Date.')};
iAd.ContactCard.prototype.applyContactInfo=function(){this.batch=null;var a={firstName:this.firstName||null,middleName:this.middleName||null,lastName:this.lastName||null,prefix:this.prefix||null,suffix:this.suffix||null,nickname:this.nickname||null,organization:this.organization||null,jobTitle:this.jobTitle||null,department:this.department||null,note:this.note||null,imageURL:this.imageURL||null,homePage:this.homePage||null,phoneNumbers:this.phoneNumbers||null,addresses:this.addresses||null,emails:this.emails||
null,birthday:this._birthday&&iAd.Utils.objectIsInstanceOfClass(this._birthday,Date)?this._birthday.getTime():null};try{this.addReadyListener();this._binding.contactInfo=a}catch(b){this.removeReadyListener();this.presentDidThrowError(b)}};iAd.ContactCard.prototype.present=function(){if(this._readyToPresent)try{this.addCreateListeners();this._binding.presentComposer()}catch(a){this.removeCreateListeners();this.presentDidThrowError(a)}else this.requestActivationForComposer()};
iAd.ContactCard.prototype.didBecomeActiveObjectForComposer=function(){this._waitingToPresent=true;this.applyContactInfo()};iAd.ContactCard.prototype.willResignActiveObjectForComposer=function(){this._readyToPresent=false};iAd.ContactCard.prototype.addReadyListener=function(){window.addEventListener(this._bindingProtocol.ADContactsReadyToPresent,this)};iAd.ContactCard.prototype.removeReadyListener=function(){window.removeEventListener(this._bindingProtocol.ADContactsReadyToPresent,this)};
iAd.ContactCard.prototype.addCreateListeners=function(){window.addEventListener(this._bindingProtocol.ADContactsEntryCreated,this);window.addEventListener(this._bindingProtocol.ADContactsEntryCanceled,this)};iAd.ContactCard.prototype.removeCreateListeners=function(){window.removeEventListener(this._bindingProtocol.ADContactsEntryCreated,this);window.removeEventListener(this._bindingProtocol.ADContactsEntryCanceled,this)};
iAd.ContactCard.prototype.handleEvent=function(a){switch(a.type){case this._bindingProtocol.ADContactsReadyToPresent:this.removeReadyListener();this._readyToPresent=true;if(this._waitingToPresent){this._waitingToPresent=false;this.present()}break;case this._bindingProtocol.ADContactsEntryCreated:this.resignAsActiveComposer();this.removeCreateListeners();this.notifySaveDidComplete();break;case this._bindingProtocol.ADContactsEntryCanceled:this.resignAsActiveComposer();this.removeCreateListeners();
this.notifySaveDidCancel();break;default:this.resignAsActiveComposer();this.notifySaveDidFail()}};iAd.BindingUtils.registerBindingClass(iAd.ContactCard);if(!window.ADPassbook)window._ADPassbook={kADPassbookSuccess:0,kADPassbookResourceError:1,kADPassbookPassFormatError:2,kADPassbookCanceled:3};
if(!window.ad||!window.ad.passbook){window._ad.passbook={shim:true,presentComposer:function(){this.listener.addPassbookPassFinished(window._ADPassbook.kADPassbookSuccess)}};Object.defineProperty(window._ad.passbook,"passURL",{set:function(a){window._ad.passbook._passURL=a;(a=window._ad.passbook.listener)&&a.passbookReadyToPresent()}})}iAd.URLResourceError={};iAd.URLResourceError.UNKNOWN_ERROR=1;iAd.URLResourceError.URL_NOT_FOUND_ERROR=2;iAd.URLResourceError.INVALID_OR_CORRUPT_ERROR=3;
iAd.URLResourceError.INVALID_URL_ERROR=4;iAd.URLResourceError.INVALID_SCHEME_VIOLATION=5;iAd.URLResourceError.RELATIVE_PATH_VIOLATION=6;iAd.URLResourceError.SAME_ORIGIN_POLICY_VIOLATION=7;iAd.URLResourceError.TOO_LARGE_ERROR=8;
iAd.URLResourceError.errorFromBindingError=function(a){var b=window.ADAd,c=iAd.URLResourceError.UNKNOWN_ERROR;switch(a){case b.kInvalidOrCorruptImageError:c=iAd.URLResourceError.INVALID_OR_CORRUPT_ERROR;break;case b.kInvalidURL:c=iAd.URLResourceError.INVALID_URL_ERROR;break;case b.kURLInvalidSchemeViolation:c=iAd.URLResourceError.INVALID_SCHEME_VIOLATION;break;case b.kURLRelativePathViolation:c=iAd.URLResourceError.RELATIVE_PATH_VIOLATION;break;case b.kURLSameOriginPolicyViolation:c=iAd.URLResourceError.SAME_ORIGIN_VIOLATION}return c};
iAd.Class({name:"iAd.PassbookPass",mixins:[iAd.EventTarget,iAd.ComposerBackedObject],synthesizedProperties:["url"]});iAd.PassbookPass.SHOULD_PRESENT="passbookPassShouldPresent";iAd.PassbookPass.ALREADY_EXISTS="passbookPassAlreadyExists";iAd.PassbookPass.DID_COMPLETE="passbookPassDidComplete";iAd.PassbookPass.DID_FAIL="passbookPassDidFail";iAd.PassbookPass.DID_CANCEL="passbookPassDidCancel";iAd.PassbookPass.BINDING_OBJECT=window._ad.passbook||window.ad.passbook;
iAd.PassbookPass.BINDING_PROTOCOL=window._ADPassbook||window.ADPassbook;iAd.PassbookPass.prototype.init=function(a,b){this.callSuper();this._url=a;this.delegate=b;this.readyToPresent=false;iAd.BindingUtils.initializeBindingObject(this);if(!this._binding)throw iAd.BindingUtils.BINDING_UNAVAILABLE_ERROR;};iAd.PassbookPass.prototype.setUrl=function(){iAd.Console.warn("iAd.PassbookPass: url is read-only")};
iAd.PassbookPass.prototype.presentWhenReady=function(){if(this.isActiveObjectForComposer)this.readyToPresent&&this.presentComposer();else this.requestActivationForComposer()};iAd.PassbookPass.prototype.didBecomeActiveObjectForComposer=function(){this._binding.listener=this;try{this._binding.passURL=this.url}catch(a){this._binding.listener=null;this.notifyDidFail(iAd.BindingError.URL_RESOURCE_ERROR,iAd.URLResourceError.INVALID_URL_ERROR)}};
iAd.PassbookPass.prototype.presentComposer=function(){if(!(iAd.Utils.objectHasMethod(this.delegate,iAd.PassbookPass.SHOULD_PRESENT)&&!this.delegate[iAd.PassbookPass.SHOULD_PRESENT](this)))try{this._binding.presentComposer()}catch(a){this.presentComposerDidThrowError(a)}};
iAd.PassbookPass.prototype.presentComposerDidThrowError=function(a){a=iAd.BindingUtils.sanitizeMessageFromError(a);a=="Unable to present passbook composer without a valid pass."?this.notifyDidFail(iAd.BindingError.URL_RESOURCE_ERROR,iAd.URLResourceError.UNKNOWN_ERROR):this.notifyDidFail(iAd.BindingError.OTHER_ERROR,a)};iAd.PassbookPass.prototype.willResignActiveObjectForComposer=function(){this.readyToPresent=false};
iAd.PassbookPass.prototype.passbookPassRetrievalFailed=function(a,b){if(b==this._bindingProtocol.kADPassbookResourceError)this.notifyDidFail(iAd.BindingError.URL_RESOURCE_ERROR,iAd.URLResourceError.UNKNOWN_ERROR);else b==this._bindingProtocol.kADPassbookCardFormatError?this.notifyDidFail(iAd.BindingError.URL_RESOURCE_ERROR,iAd.URLResourceError.INVALID_OR_CORRUPT_ERROR):this.notifyDidFail()};
iAd.PassbookPass.prototype.addPassbookPassFinished=function(a){a==this._bindingProtocol.kADPassbookCanceled?this.notifyDidCancel():this.notifyDidComplete()};iAd.PassbookPass.prototype.passbookReadyToPresent=function(){this.readyToPresent=true;this.isActiveObjectForComposer&&this.presentComposer()};iAd.PassbookPass.prototype.passbookContainsPass=function(){this.resignAsActiveComposer();this.notifyDelegate(iAd.PassbookPass.ALREADY_EXISTS,this.delegate)};
iAd.PassbookPass.prototype.notifyDidComplete=function(){this.resignAsActiveComposer();this.notifyDelegate(iAd.PassbookPass.DID_COMPLETE,this.delegate)};iAd.PassbookPass.prototype.notifyDidCancel=function(){this.notifyDelegate(iAd.PassbookPass.DID_CANCEL,this.delegate)};iAd.PassbookPass.prototype.notifyDidFail=function(a,b){this.resignAsActiveComposer();this.notifyDelegate(iAd.PassbookPass.DID_FAIL,this.delegate,[["errorCode",a||iAd.BindingError.UNKNOWN_ERROR],["errorDetail",b||null]])};iAd.BindingUtils.registerBindingClass(iAd.PassbookPass);
if(!window.ADBooks)window._ADBooks={kADBooksMetaDataAuthor:"author",kADBooksMetaDataSubject:"subject",kADBooksMetaDataTitle:"title",kADBooksPDFURI:"pdf-uri"};if(!window.ADBooksListener)window._ADBooksListener={kADBooksCanceled:5,kADBooksMetadataError:2,kADBooksResourceError:1,kADBooksResourceTooLarge:3,kADBooksSaveError:4,kADBooksSuccess:0};if(!window.ad||!window.ad.books)window._ad.books={shim:true,addPDF:function(a,b){b.requestFinished(window._ADBooksListener.kADBooksSuccess)}};
iAd.Class({name:"iAd.PDF",superclass:iAd.SavableContent});iAd.PDF.BINDING_OBJECT=window._ad.books||window.ad.books;iAd.PDF.BINDING_CLASS=window._ADBooks||window.ADBooks;iAd.PDF.BINDING_PROTOCOL=window._ADBooksListener||window.ADBooksListener;iAd.PDF.prototype.init=function(a,b){this.subject=this.title=this.url=this.author=null;this.callSuper(a,b)};
iAd.PDF.prototype.present=function(){var a={};a[this._bindingClass.kADBooksPDFURI]=this.url;a[this._bindingClass.kADBooksMetaDataAuthor]=this.author||null;a[this._bindingClass.kADBooksMetaDataTitle]=this.title||null;a[this._bindingClass.kADBooksMetaDataSubject]=this.subject||null;try{this._binding.addPDF(a,this)}catch(b){this.notifySaveDidFail()}};
iAd.PDF.prototype.requestFinished=function(a){if(a==this._bindingProtocol.kADBooksSuccess)this.notifySaveDidComplete();else if(a==this._bindingProtocol.kADBooksCanceled)this.notifySaveDidCancel();else{var b=iAd.SavableContent.UNKNOWN_ERROR,c=null;switch(a){case this._bindingProtocol.kADBooksMetadataError:b=iAd.BindingError.INVALID_PROPERTIES_ERROR;break;case this._bindingProtocol.kADBooksResourceError:b=iAd.BindingError.URL_RESOURCE_ERROR;c=iAd.URLResourceError.URL_NOT_FOUND_ERROR;break;case this._bindingProtocol.kADBooksResourceTooLarge:b=
iAd.BindingError.URL_RESOURCE_ERROR;c=iAd.URLResourceError.TOO_LARGE_ERROR}this.notifySaveDidFail(b,c)}};iAd.BindingUtils.registerBindingClass(iAd.PDF);if(!window.ADReminderListener)window._ADReminderListener={kADReminderCanceledCode:1,kADReminderCreatedCode:0,kADReminderUnknownErrorCode:2};if(!window.ad||!window.ad.reminderComposer)window._ad.reminderComposer={shim:true,listener:{},presentComposerForReminder:function(){this.listener.reminderComposerDidFinish(window._ADReminderListener.kADReminderCreatedCode)}};
iAd.Class({name:"iAd.Reminder",superclass:iAd.SavableContent});iAd.Reminder.BINDING_OBJECT=window._ad.reminderComposer||window.ad.reminderComposer;iAd.Reminder.BINDING_PROTOCOL=window._ADReminderListener||window.ADReminderListener;iAd.Reminder.prototype.init=function(a,b){this.longitude=this.latitude=this.dueDate=this.notes=this.location=this.title=null;this.callSuper(a,b)};
iAd.Reminder.prototype.present=function(a){if(iAd.Device.IS_IPAD&&!a)this.notifySaveDidFail(iAd.BindingError.INVALID_PRESENTATION_RECT_ERROR);else{var b={title:this.title,notes:this.notes,dueDate:this.dueDate?this.dueDate.toISOString():null};if(this.latitude!=null&&this.longitude!=null){b.degreesLatitude=this.latitude;b.degreesLongitude=this.longitude;b.location=this.location||null}this._binding.listener=this;try{this._binding.presentComposerForReminder(b,this.sanitizeRectForBinding(a))}catch(c){this.presentDidThrowError(c)}}};
iAd.Reminder.prototype.presentDidThrowError=function(a){var b=iAd.BindingUtils.sanitizeMessageFromError(a),c=iAd.BindingError.INVALID_PROPERTIES_ERROR;if(b=="Invalid or missing reminder properties")this.notifySaveDidFail(c);else b=="Invalid ADCalendarReminderProperties: Missing title"?this.notifySaveDidFail(c,["title"]):this.callSuper(a)};
iAd.Reminder.prototype.reminderComposerDidFinish=function(a){switch(a){case this._bindingProtocol.kADReminderCreatedCode:this.notifySaveDidComplete();break;case this._bindingProtocol.kADReminderCanceledCode:this.notifySaveDidCancel();break;case this._bindingProtocol.kADReminderUnknownErrorCode:this.notifySaveDidFail()}};iAd.BindingUtils.registerBindingClass(iAd.Reminder);
if(!window.ad||!window.ad.addRingtone)window._ad.addRingtone=function(){var a=iAd.EventTarget.createEvent("ADRingtoneSaveSucceeded");iAd.EventTarget.dispatchEvent.call({eventTarget:window},a)};iAd.Class({name:"iAd.Ringtone",superclass:iAd.SavableContent});iAd.Ringtone.BINDING_OBJECT=window.ad||window._ad;iAd.Ringtone.prototype.init=function(a,b){this.genre=this.artist=this.url=this.title=null;this.callSuper(a,b)};
iAd.Ringtone.prototype.present=function(){this.addListeners();var a={url:this.url,artist:this.artist||null,genre:this.genre||null,title:this.title||null};try{this._binding.addRingtone(a)}catch(b){this.presentDidThrowError(b)}};iAd.Ringtone.prototype.addListeners=function(){window.addEventListener("ADRingtoneSaveFailed",this);window.addEventListener("ADRingtoneSaveCanceled",this);window.addEventListener("ADRingtoneSaveSucceeded",this)};
iAd.Ringtone.prototype.removeListeners=function(){window.removeEventListener("ADRingtoneSaveFailed",this);window.removeEventListener("ADRingtoneSaveCanceled",this);window.removeEventListener("ADRingtoneSaveSucceeded",this)};iAd.Ringtone.prototype.handleEvent=function(a){this.removeListeners();switch(a.type){case "ADRingtoneSaveSucceeded":this.notifySaveDidComplete();break;case "ADRingtoneSaveCanceled":this.notifySaveDidCancel();break;case "ADRingtoneSaveFailed":this.notifySaveDidFail()}};iAd.BindingUtils.registerBindingClass(iAd.Ringtone);
if(!Function.prototype.hasOwnProperty("bind"))Function.prototype.bind=function(a){if(typeof this!=="function")throw new TypeError("Function.prototype.bind - cannot bind something that is not callable");var b=Array.prototype.slice.call(arguments,1),c=this,d=function(){},e=function(){return c.apply(this instanceof d?this:a||window,b.concat(Array.prototype.slice.call(arguments)))};d.prototype=this.prototype;e.prototype=new d;return e};iAd.Device._binding=window.ad||window._ad;
iAd.Device._bindingProtocol=window._ADAd||window.ADAd;iAd.Device._bindingNetworkProtocol=window._ADNetworkTypeListener||window.ADNetworkTypeListener;iAd.Device.SHAKE_EVENT="deviceShakeDidOccur";iAd.Device.NETWORK_TYPE_CHANGE_EVENT="deviceNetworkTypeDidChange";iAd.Device.ORIENTATION_DID_CHANGE_EVENT="deviceOrientationDidChange";iAd.Device.NETWORK_TYPE_UNKNOWN=iAd.Device._bindingNetworkProtocol.kADNetworkTypeListenerNetworkTypeUnknown;iAd.Device.NETWORK_TYPE_GPRS=iAd.Device._bindingNetworkProtocol.kADNetworkTypeListenerNetworkTypeGPRS;
iAd.Device.NETWORK_TYPE_EDGE=iAd.Device._bindingNetworkProtocol.kADNetworkTypeListenerNetworkTypeEDGE;iAd.Device.NETWORK_TYPE_3G=iAd.Device._bindingNetworkProtocol.kADNetworkTypeListenerNetworkType3G;iAd.Device.NETWORK_TYPE_WIFI=iAd.Device._bindingNetworkProtocol.kADNetworkTypeListenerNetworkTypeWiFi;iAd.Device.ORIENTATION_UNKNOWN=-1;iAd.Device.ORIENTATION_FACE_UP=5;iAd.Device.ORIENTATION_FACE_DOWN=6;iAd.Device.BINDING_DEVICE_ORIENTATION_UNKNOWN=0;iAd.Device.BINDING_DEVICE_ORIENTATION_PORTRAIT=1;
iAd.Device.BINDING_DEVICE_ORIENTATION_PORTRAIT_UPSIDE_DOWN=2;iAd.Device.BINDING_DEVICE_ORIENTATION_LANDSCAPE_LEFT=3;iAd.Device.BINDING_DEVICE_ORIENTATION_LANDSCAPE_RIGHT=4;iAd.Device.BINDING_DEVICE_ORIENTATION_FACE_UP=5;iAd.Device.BINDING_DEVICE_ORIENTATION_FACE_DOWN=6;
iAd.Device.orientationForBindingDeviceOrientation=function(a){switch(a){case iAd.Device.BINDING_DEVICE_ORIENTATION_PORTRAIT:return iAd.Device.ORIENTATION_PORTRAIT;case iAd.Device.BINDING_DEVICE_ORIENTATION_PORTRAIT_UPSIDE_DOWN:return iAd.Device.ORIENTATION_PORTRAIT_UPSIDE_DOWN;case iAd.Device.BINDING_DEVICE_ORIENTATION_LANDSCAPE_LEFT:return iAd.Device.ORIENTATION_LANDSCAPE_LEFT;case iAd.Device.BINDING_DEVICE_ORIENTATION_LANDSCAPE_RIGHT:return iAd.Device.ORIENTATION_LANDSCAPE_RIGHT;case iAd.Device.BINDING_DEVICE_ORIENTATION_FACE_UP:return iAd.Device.ORIENTATION_FACE_UP;
case iAd.Device.BINDING_DEVICE_ORIENTATION_FACE_DOWN:return iAd.Device.ORIENTATION_FACE_DOWN;default:return iAd.Device.ORIENTATION_UNKNOWN}};iAd.Device.BINDING_ORIENTATION_UNKNOWN=0;iAd.Device.BINDING_ORIENTATION_PORTRAIT=iAd.Device._bindingProtocol.ADInterfaceOrientationPortrait;iAd.Device.BINDING_ORIENTATION_PORTRAIT_UPSIDE_DOWN=iAd.Device._bindingProtocol.ADInterfaceOrientationPortraitUpsideDown;iAd.Device.BINDING_ORIENTATION_LANDSCAPE_LEFT=iAd.Device._bindingProtocol.ADInterfaceOrientationLandscapeLeft;
iAd.Device.BINDING_ORIENTATION_LANDSCAPE_RIGHT=iAd.Device._bindingProtocol.ADInterfaceOrientationLandscapeRight;iAd.Device.BINDING_ORIENTATIONS=[iAd.Device.BINDING_ORIENTATION_PORTRAIT,iAd.Device.BINDING_ORIENTATION_PORTRAIT_UPSIDE_DOWN,iAd.Device.BINDING_ORIENTATION_LANDSCAPE_LEFT,iAd.Device.BINDING_ORIENTATION_LANDSCAPE_RIGHT];
iAd.Device.orientationForBindingOrientation=function(a){switch(a){case iAd.Device.BINDING_ORIENTATION_PORTRAIT:return iAd.Device.ORIENTATION_PORTRAIT;case iAd.Device.BINDING_ORIENTATION_PORTRAIT_UPSIDE_DOWN:return iAd.Device.ORIENTATION_PORTRAIT_UPSIDE_DOWN;case iAd.Device.BINDING_ORIENTATION_LANDSCAPE_LEFT:return iAd.Device.ORIENTATION_LANDSCAPE_LEFT;case iAd.Device.BINDING_ORIENTATION_LANDSCAPE_RIGHT:return iAd.Device.ORIENTATION_LANDSCAPE_RIGHT;default:return null}};
iAd.Device.bindingOrientationForOrientation=function(a){switch(a){case iAd.Device.ORIENTATION_PORTRAIT:return iAd.Device.BINDING_ORIENTATION_PORTRAIT;case iAd.Device.ORIENTATION_PORTRAIT_UPSIDE_DOWN:return iAd.Device.BINDING_ORIENTATION_PORTRAIT_UPSIDE_DOWN;case iAd.Device.ORIENTATION_LANDSCAPE_LEFT:return iAd.Device.BINDING_ORIENTATION_LANDSCAPE_LEFT;case iAd.Device.ORIENTATION_LANDSCAPE_RIGHT:return iAd.Device.BINDING_ORIENTATION_LANDSCAPE_RIGHT;default:return null}};iAd.Device.eventTarget=document;
iAd.Device.setupBindings=function(){iAd.Utils.copyPropertiesFromSourceToTarget(iAd.EventTarget,this);var a=iAd.Device._binding;a.networkTypeListener=this;a.shakeEventsListener=this;a.deviceOrientationListener=this};iAd.Device.shakeEventDidOccur=function(){this.createAndDispatchEvent(iAd.Device.SHAKE_EVENT)};iAd.Device.networkTypeDidChange=function(a){this.createAndDispatchEvent(iAd.Device.NETWORK_TYPE_CHANGE_EVENT,[["networkType",a]])};
iAd.Device.deviceOrientationDidChange=function(a){this.orientation=iAd.Device.orientationForBindingDeviceOrientation(a);this.createAndDispatchEvent(iAd.Device.ORIENTATION_DID_CHANGE_EVENT,[["orientation",this.orientation]])};iAd.Device.getSupportedOrientations=function(){for(var a=iAd.Device._binding.currentSupportedInterfaceOrientations,b=[],c,d=0,e=iAd.Device.BINDING_ORIENTATIONS.length;d<e;d++){c=iAd.Device.BINDING_ORIENTATIONS[d];a&c&&b.push(iAd.Device.orientationForBindingOrientation(c))}return b};
iAd.Device.setSupportedOrientations=function(a){for(var b,c=0,d=a.length;c<d;c++)b|=iAd.Device.bindingOrientationForOrientation(a[c]);try{iAd.Device._binding.currentSupportedInterfaceOrientations=b}catch(e){iAd.Console.warn("iAd.Device: There was an error setting .supportedOrientations")}};Object.defineProperty(iAd.Device,"supportedOrientations",{get:iAd.Device.getSupportedOrientations,set:iAd.Device.setSupportedOrientations});iAd.Device.getNetworkType=function(){return this._binding.networkType};
Object.defineProperty(iAd.Device,"networkType",{get:iAd.Device.getNetworkType});iAd.Device.getLocationServicesEnabled=function(){return this._binding.locationServicesEnabled};Object.defineProperty(iAd.Device,"locationServicesEnabled",{get:iAd.Device.getLocationServicesEnabled});window.addEventListener("DOMContentLoaded",iAd.Device.setupBindings.bind(iAd.Device),true);iAd.Class({name:"iAd.Image",synthesizedProperties:["width","height","loaded"],archivedProperties:["url","hasHiDPIVersion"]});
iAd.Image.prototype.init=function(a,b){this.callSuper();this.url=a;this.resolvedURL=iAd.Image.resolveURL(a,b);this.hasHiDPIVersion=b;this._loaded=false;this.scaleFactor=b&&iAd.Device.HAS_HIDPI_DISPLAY?0.5:1;this.element=new Image;this.load();iAd.Image.imageWasCreated(this)};iAd.Image.prototype.getWidth=function(){return this.element.width*this.scaleFactor};iAd.Image.prototype.getHeight=function(){return this.element.height*this.scaleFactor};
iAd.Image.prototype.handleEvent=function(a){if(a.type==="load"&&a.target===this.element){this.loaded=true;this.element.removeEventListener("load",this,false);this.runCompletion(false)}};iAd.Image.prototype.load=function(){this.element.src=this.resolvedURL;if(this.element.complete)this.loaded=true;else this.element.addEventListener("load",this,false)};iAd.Image.prototype.whenLoaded=function(a,b){this.whenLoadedArguments={completion:a,methodName:b};this._loaded&&this.runCompletion(true)};
iAd.Image.prototype.runCompletion=function(a){var b=this.whenLoadedArguments;if(b){if(iAd.Utils.objectIsFunction(b.completion))b.completion(this,a);else iAd.Utils.objectHasMethod(b.completion,b.methodName)&&b.completion[b.methodName](this,a);delete this.whenLoadedArguments}};iAd.Image.imageForURL=function(a,b){if(!a)return null;var c=iAd.Image.resolveURL(a,b);if(this.instances&&this.instances[c])return this.instances[c];return new iAd.Image(a,b)};
iAd.Image.restoreFromArchive=function(a){return this.imageForURL(a.url,a.hasHiDPIVersion)};iAd.Image.resolveURL=function(a,b){return b&&iAd.Device.HAS_HIDPI_DISPLAY?iAd.Path.appendHiDPISuffix(a):a};iAd.Image.imageWasCreated=function(a){if(!this.instances){this.instances={};window.setTimeout(iAd.Image.runLoopDidStart,0)}this.instances[a.resolvedURL]=a};iAd.Image.runLoopDidStart=function(){delete iAd.Image.instances};iAd.Class({name:"iAd.ImageAction",mixins:[iAd.EventTarget],synthesizedProperties:["url"]});
iAd.ImageAction.DID_COMPLETE="imageActionDidComplete";iAd.ImageAction.DID_CANCEL="imageActionDidCancel";iAd.ImageAction.DID_FAIL="imageActionDidFail";iAd.ImageAction.prototype.init=function(a,b){this.callSuper();this._url=a;this.delegate=b;iAd.BindingUtils.initializeBindingObject(this);if(!this._binding)throw iAd.BindingUtils.BINDING_UNAVAILABLE_ERROR;this.callMethodNameAfterDelay("execute",0)};iAd.ImageAction.prototype.execute=function(){};
iAd.ImageAction.prototype.executeDidThrowError=function(a){iAd.BindingUtils.isErrorFromModalActivity(a)?this.notifyDidFail(iAd.BindingError.MODAL_ACTIVITY_ERROR):this.notifyDidFail(iAd.BindingError.OTHER_ERROR,iAd.BindingUtils.sanitizeMessageFromError(a))};iAd.ImageAction.prototype.setUrl=function(){};iAd.ImageAction.prototype.notifyDidComplete=function(){this.notifyDelegate(iAd.ImageAction.DID_COMPLETE,this.delegate)};
iAd.ImageAction.prototype.notifyDidCancel=function(){this.notifyDelegate(iAd.ImageAction.DID_CANCEL,this.delegate)};iAd.ImageAction.prototype.notifyDidFail=function(a,b){this.notifyDelegate(iAd.ImageAction.DID_FAIL,this.delegate,[["errorCode",a||iAd.BindingError.ERROR_UNKNOWN],["errorDetail",b||null]])};if(!window.ADCamera)window._ADCamera={ADCameraUserCanceledPicture:"ADCameraUserCanceledPicture",ADCameraUserTookPicture:"ADCameraUserTookPicture"};
if(!window.ad||!window.ad.camera)window._ad.camera={shim:true,eventTarget:window,present:function(a){if(a){window._ad.camera.currentPictureURI=iAd.Path.assetsPath+"pixel.png";a=iAd.EventTarget.createEvent(window._ADCamera.ADCameraUserTookPicture);iAd.EventTarget.dispatchEvent.call(this,a)}else throw"Unable to start camera capture, reason provided was null, empty, or not a string";},currentPictureURI:null};iAd.Class({name:"iAd.CameraImageAction",superclass:iAd.ImageAction});
iAd.CameraImageAction.BINDING_OBJECT=window._ad.camera||window.ad.camera;iAd.CameraImageAction.BINDING_PROTOCOL=window._ADCamera||window.ADCamera;iAd.CameraImageAction.prototype.init=function(a,b){this.message=a;this.callSuper(null,b)};iAd.CameraImageAction.prototype.execute=function(){try{this.addEventListeners();this._binding.present(this.message)}catch(a){this.removeEventListeners();this.executeDidThrowError(a)}};
iAd.CameraImageAction.prototype.addEventListeners=function(){window.addEventListener(this._bindingProtocol.ADCameraUserTookPicture,this);window.addEventListener(this._bindingProtocol.ADCameraUserCanceledPicture,this)};iAd.CameraImageAction.prototype.removeEventListeners=function(){window.removeEventListener(this._bindingProtocol.ADCameraUserTookPicture,this);window.removeEventListener(this._bindingProtocol.ADCameraUserCanceledPicture,this)};
iAd.CameraImageAction.prototype.handleEvent=function(a){this.removeEventListeners();switch(a.type){case this._bindingProtocol.ADCameraUserTookPicture:this._url=this._binding.currentPictureURI;this.notifyDidComplete();break;case this._bindingProtocol.ADCameraUserCanceledPicture:this.notifyDidCancel()}};iAd.Image.captureImageFromCamera=function(a,b){return new iAd.CameraImageAction(a,b)};Object.defineProperty(iAd.Image,"cameraAvailable",{get:function(){return iAd.BindingUtils.isBindingClassAvailable(iAd.CameraImageAction)}});
if(!window.ADImageWriteListener)window._ADImageWriteListener={kUnableToCaptureDisplayedContentError:2,kWriteImageCancelledError:1};if(!window.ad||!window.ad.writeImageToSavedPhotosAlbum)window._ad.writeImageToSavedPhotosAlbum=function(a,b){b.writeImageToSavedPhotosSucceeded()};if(!window.ad||!window.ad.writeDisplayedContentToSavedPhotosAlbum)window._ad.writeDisplayedContentToSavedPhotosAlbum=function(a){a.writeImageToSavedPhotosSucceeded()};iAd.Class({name:"iAd.SaveToPhotoLibraryImageAction",superclass:iAd.ImageAction});
iAd.SaveToPhotoLibraryImageAction.BINDING_OBJECT=window.ad||window._ad;iAd.SaveToPhotoLibraryImageAction.BINDING_PROTOCOL=window._ADImageWriteListener||window.ADImageWriteListener;iAd.SaveToPhotoLibraryImageAction.prototype.init=function(a,b){this.callSuper(a,b)};iAd.SaveToPhotoLibraryImageAction.prototype.execute=function(){try{this._binding.writeImageToSavedPhotosAlbum(this.url,this)}catch(a){this.executeDidThrowError(a)}};
iAd.SaveToPhotoLibraryImageAction.prototype.writeImageToSavedPhotosFailed=function(a){if(a==this._bindingProtocol.kWriteImageCancelledError)this.notifyDidCancel();else{var b;switch(a){case this._bindingProtocol.kUnableToCaptureDisplayedContentError:b=iAd.BindingError.OTHER_ERROR;a="Unable to capture the displayed content.";break;default:b=iAd.BindingError.URL_RESOURCE_ERROR;a=iAd.URLResourceError.errorFromBindingError(a)}this.notifyDidFail(b,a)}};
iAd.SaveToPhotoLibraryImageAction.prototype.writeImageToSavedPhotosSucceeded=function(){this.notifyDidComplete()};iAd.Image.saveImageToPhotoLibrary=function(a,b){return new iAd.SaveToPhotoLibraryImageAction(a,b)};iAd.Class({name:"iAd.ScreenshotImageAction",superclass:iAd.SaveToPhotoLibraryImageAction});iAd.ScreenshotImageAction.BINDING_OBJECT=iAd.SaveToPhotoLibraryImageAction.BINDING_OBJECT;iAd.ScreenshotImageAction.BINDING_PROTOCOL=iAd.SaveToPhotoLibraryImageAction.BINDING_PROTOCOL;
iAd.ScreenshotImageAction.prototype.init=function(a){this.callSuper(null,a)};iAd.ScreenshotImageAction.prototype.execute=function(){try{this._binding.writeDisplayedContentToSavedPhotosAlbum(this)}catch(a){this.executeDidThrowError(a)}};iAd.Image.saveScreenshotToPhotoLibrary=function(a){return new iAd.ScreenshotImageAction(a)};Object.defineProperty(iAd.Image,"photoLibraryAvailable",{get:function(){return iAd.BindingUtils.isBindingClassAvailable(iAd.SaveToPhotoLibraryImageAction)}});
if(!window.ADWallpaperListener)window._ADWallpaperListener={kInvalidWallpaperURL:100,kSetWallpaperCancelledError:102,kUnknownError:101};if(!window.ad||!window.ad.setImageAsWallpaper)window._ad.setImageAsWallpaper=function(a,b,c){c.setImageAsWallpaperSucceeded(a)};iAd.Class({name:"iAd.WallpaperImageAction",superclass:iAd.ImageAction});iAd.WallpaperImageAction.BINDING_OBJECT=window.ad||window._ad;iAd.WallpaperImageAction.BINDING_PROTOCOL=window._ADWallpaperListener||window.ADWallpaperListener;
iAd.WallpaperImageAction.prototype.init=function(a,b,c){this.title=b;this.callSuper(a,c)};iAd.WallpaperImageAction.prototype.execute=function(){try{this._binding.setImageAsWallpaper(this.url,this.title,this)}catch(a){this.executeDidThrowError(a)}};
iAd.WallpaperImageAction.prototype.setImageAsWallpaperFailed=function(a,b){if(this.url==a)if(b==this._bindingProtocol.kSetWallpaperCancelledError)this.notifyDidCancel();else{var c,d;if(b==this._bindingProtocol.kUnknownError)c=iAd.BindingError.UNKNOWN_ERROR;else if(b==this._bindingProtocol.kInvalidWallpaperURL){c=iAd.BindingError.URL_RESOURCE_ERROR;d=iAd.URLResourceError.INVALID_OR_CORRUPT_ERROR}else{c=iAd.BindingError.URL_RESOURCE_ERROR;d=iAd.URLResourceError.errorFromBindingError(b)}this.notifyDidFail(c,
d)}};iAd.WallpaperImageAction.prototype.setImageAsWallpaperSucceeded=function(){this.notifyDidComplete()};iAd.Image.setImageAsWallpaper=function(a,b,c){return new iAd.WallpaperImageAction(a,b,c)};Object.defineProperty(iAd.Image,"wallpaperAvailable",{get:function(){return iAd.BindingUtils.isBindingClassAvailable(iAd.WallpaperImageAction)}});iAd.Class({name:"iAd.MapCoordinate"});iAd.MapCoordinate.prototype.init=function(a,b){this.callSuper();this.latitude=a;this.longitude=b};
iAd.MapCoordinate.prototype.equals=function(a){return!!a&&this.latitude==a.latitude&&this.longitude==a.longitude};iAd.MapCoordinate.prototype.copy=function(){return new iAd.MapCoordinate(this.latitude,this.longitude)};iAd.Class({name:"iAd.MapAnnotation",synthesizedProperties:["identifier","latitude","longitude"]});iAd.MapAnnotation.PIN_COLOR_RED="red";iAd.MapAnnotation.PIN_COLOR_GREEN="green";iAd.MapAnnotation.PIN_COLOR_PURPLE="purple";
iAd.MapAnnotation.prototype.init=function(a){this.callSuper();this.coordinate=a.coordinate.copy();this.id=a.id;this.title=(a.title||"").toString();this.subtitle=(a.subtitle||"").toString();this.pinColor=a.pinColor||iAd.MapAnnotation.PIN_COLOR_RED;this.imageURL=a.imageURL?iAd.Path.resolveAbsolutePath(a.imageURL):null;this.xOffset=a.xOffset;this.yOffset=a.yOffset;this.draggable=a.draggable;this.hasLeftCalloutButton=a.hasLeftCalloutButton;this.hasRightCalloutButton=a.hasRightCalloutButton;this.pinAnimatesDrop=
a.pinAnimatesDrop};iAd.MapAnnotation.prototype.getIdentifier=function(){return this.id};iAd.MapAnnotation.prototype.setIdentifier=function(){iAd.Console.warn("iAd.MapAnnotation.identifier is read-only. Please use iAd.MapAnnotation.id instead.")};iAd.MapAnnotation.prototype.getLatitude=function(){return this.coordinate.latitude};iAd.MapAnnotation.prototype.setLatitude=function(){iAd.Console.warn("iAd.MapAnnotation.latitude is read-only. Please use iAd.MapAnnotation.coordinate instead.")};
iAd.MapAnnotation.prototype.getLongitude=function(){return this.coordinate.longitude};iAd.MapAnnotation.prototype.setLongitude=function(){iAd.Console.warn("iAd.MapAnnotation.longitude is read-only. Please use iAd.MapAnnotation.coordinate instead.")};iAd.Class({name:"iAd.MapOverlay",synthesizedProperties:["identifier"]});iAd.MapOverlay.prototype.init=function(a){this.callSuper();iAd.Utils.copyPropertiesFromSourceToTarget(a,this)};iAd.MapOverlay.prototype.getIdentifier=function(){return this.id};
iAd.MapOverlay.prototype.setIdentifier=function(){iAd.Console.warn("iAd.MapOverlay's .identifier property is read-only. Please use the .id property instead.")};iAd.MapOverlay.LINE_CAP_ROUND="round";iAd.MapOverlay.LINE_CAP_SQUARE="square";iAd.MapOverlay.LINE_CAP_BUTT="butt";iAd.MapOverlay.LINE_JOIN_ROUND="round";iAd.MapOverlay.LINE_JOIN_MITER="miter";iAd.MapOverlay.LINE_JOIN_BEVEL="bevel";iAd.Class({name:"iAd.MapRegion"});
iAd.MapRegion.prototype.init=function(a,b,c,d){this.callSuper();this.latitude=a;this.longitude=b;this.latitudeDelta=c;this.longitudeDelta=d};iAd.MapRegion.prototype.equals=function(a){return!!a&&this.latitude==a.latitude&&this.longitude==a.longitude&&this.latitudeDelta==a.latitudeDelta&&this.longitudeDelta==a.longitudeDelta};iAd.MapRegion.prototype.copy=function(){return new iAd.MapRegion(this.latitude,this.longitude,this.latitudeDelta,this.longitudeDelta)};
iAd.MapRegion.fromCoordinates=function(a){for(var b=a.length,c=90,d=-90,e=360,f=-360,g,h;b--;){g=a[b].latitude;h=a[b].longitude;c=Math.min(c,g);d=Math.max(d,g);e=Math.min(e,h);f=Math.max(f,h)}b=c+(d-c)/2;g=e+(f-e)/2;if(a.length>1){a=(d-c)*1.25;e=(f-e)*1.25}else a=e=0.08;return new iAd.MapRegion(b,g,a,e)};
iAd.Class({name:"iAd.MapView",superclass:iAd.View,cssClassName:"ad-map-view",synthesizedProperties:["mapType","scrollEnabled","zoomEnabled","region","centerCoordinate","annotations","selectedAnnotations","overlays","showsUserLocation","userLocation","userLocationVisible","longPressDropsPin","droppedPinIdentifier","droppedPinTitle"],archivedProperties:["mapType","scrollEnabled","zoomEnabled","region","centerCoordinate","annotations","selectedAnnotations","overlays","showsUserLocation","userLocationVisible",
"longPressDropsPin","droppedPinIdentifier","droppedPinTitle"],collectionAccessor:"mapViews"});iAd.MapView.MAPS_PLUGIN_MEDIA_TYPE="application/x-geomap";iAd.MapView.MAPS_PLUGIN_PRESENT=!!navigator.mimeTypes[iAd.MapView.MAPS_PLUGIN_MEDIA_TYPE];iAd.MapView.MAP_TYPE_STANDARD="standard";iAd.MapView.MAP_TYPE_SATELLITE="satellite";iAd.MapView.MAP_TYPE_HYBRID="hybrid";iAd.MapView.MAP_TYPES_ENUM={standard:0,satellite:1,hybrid:2};iAd.MapView.MAP_TYPES_ARRAY=["standard","satellite","hybrid"];
iAd.MapView.ANNOTATION_LEFT_CALLOUT_TAPPED="mapViewAnnotationLeftCalloutTapped";iAd.MapView.ANNOTATION_RIGHT_CALLOUT_TAPPED="mapViewAnnotationRightCalloutTapped";iAd.MapView.ANNOTATION_DID_FINISH_DRAG="mapViewAnnotationDidFinishDrag";iAd.MapView.DID_SELECT_ANNOTATION="mapViewDidSelectAnnotation";iAd.MapView.DID_DESELECT_ANNOTATION="mapViewDidDeselectAnnotation";iAd.MapView.DID_ADD_VIEWS_FOR_ANNOTATIONS="mapViewDidAddViewsForAnnotations";iAd.MapView.DID_ADD_OVERLAYS="mapViewDidAddOverlays";
iAd.MapView.FAILED_RETRIEVING_IMAGE_FOR_ANNOTATION="mapViewDidFailToRetrieveImageForAnnotation";iAd.MapView.WILL_START_LOADING_MAP="mapViewWillStartLoadingMap";iAd.MapView.DID_FINISH_LOADING_MAP="mapViewDidFinishLoadingMap";iAd.MapView.DID_FAIL_LOADING_MAP="mapViewDidFailLoadingMap";iAd.MapView.REGION_WILL_CHANGE="mapViewRegionWillChange";iAd.MapView.REGION_DID_CHANGE="mapViewRegionDidChange";iAd.MapView.WILL_START_UPDATING_USER_LOCATION="mapViewWillStartUpdatingUserLocation";
iAd.MapView.DID_STOP_UPDATING_USER_LOCATION="mapViewDidStopUpdatingUserLocation";iAd.MapView.DID_UPDATE_USER_LOCATION="mapViewDidUpdateUserLocation";iAd.MapView.UPDATE_USER_LOCATION_FAILED="mapViewUserLocationUpdateDidFail";
iAd.MapView.prototype.init=function(a){this._mapType=0;this._zoomEnabled=this._scrollEnabled=true;this._centerCoordinate=this._region=null;this._annotationsById={};this._selectedAnnotations=null;this._overlaysById={};this._showsUserLocation=false;this._userLocation=null;this._longPressDropsPin=this._userLocationVisible=false;this.delegate=this._droppedPinTitle=this._droppedPinIdentifier=null;this.initMapObject();this.callSuper(a)};
iAd.MapView.prototype.initMapObject=function(){if(iAd.MapView.MAPS_PLUGIN_PRESENT){this.mapObject=document.createElement("object");this.mapObject.listener=this;this.mapObject.type=iAd.MapView.MAPS_PLUGIN_MEDIA_TYPE}else{if(!iAd.Bindings.SHIMS_ENABLED)throw iAd.BindingUtils.BINDING_UNAVAILABLE_ERROR;this.mapObject=new iAd.MapView.MapPluginShim}};iAd.MapView.prototype.layerWasCreated=function(){this.callSuper();iAd.MapView.MAPS_PLUGIN_PRESENT&&this.layer.appendChild(this.mapObject)};
iAd.MapView.prototype.readPropertiesFromLayerAttributes=function(a){if(a.hasOwnProperty("ad-shows-user-location")){var b=a["ad-shows-user-location"];delete a["ad-shows-user-location"];this.callSuper(a);this.setValueForAttribute(b,"ad-shows-user-location")}else this.callSuper(a)};
iAd.MapView.prototype.layerWasInsertedIntoDocument=function(){this.callSuper();if(this.wasPreviouslyRemovedFromDocument){this.wasPreviouslyRemovedFromDocument=false;this.mapRestorationTimeout=this.callMethodNameAfterDelay("restoreState",0.4)}else this.restoreState()};
iAd.MapView.prototype.layerWasRemovedFromDocument=function(){if(iAd.Device.iOS_VERSION&&iAd.Device.iOSVersionLessThan("6.0")){if(this.mapRestorationTimeout){window.clearTimeout(this.mapRestorationTimeout);this.mapRestorationTimeout=null}this.wasPreviouslyRemovedFromDocument=true}this.callSuper()};iAd.MapView.prototype.getMapProperty=function(a,b){if(!this.layerIsInDocument)return this["_"+a];var c=this.mapObject[a];if(b){if(c===1)return true;if(c===0)return false}return c};
iAd.MapView.prototype.setMapProperty=function(a,b){this["_"+a]=b;if(this.layerIsInDocument){var c=this.mapObject;if(c[a]!=b)c[a]=b}return b};iAd.MapView.prototype.restoreState=function(){var a=this.mapObject,b=this.getAnnotations(),c=this.getOverlays(),d=this._region;a.listener=this;["mapType","droppedPinIdentifier","droppedPinTitle","longPressDropsPin","scrollEnabled","zoomEnabled","showsUserLocation"].forEach(function(e){this[e]=this[e]},this);d&&a.setRegion(d,false);c&&a.addOverlays(c);b&&a.addAnnotations(b)};
iAd.MapView.prototype.setMapType=function(a){return this.setMapProperty("mapType",iAd.MapView.MAP_TYPES_ENUM[a])};iAd.MapView.prototype.getMapType=function(){return iAd.MapView.MAP_TYPES_ARRAY[this.getMapProperty("mapType")]};iAd.MapView.prototype.setZoomEnabled=function(a){return this.setMapProperty("zoomEnabled",a)};iAd.MapView.prototype.getZoomEnabled=function(){return this.getMapProperty("zoomEnabled",true)};
iAd.MapView.prototype.setScrollEnabled=function(a){return this.setMapProperty("scrollEnabled",a)};iAd.MapView.prototype.getScrollEnabled=function(){return this.getMapProperty("scrollEnabled",true)};iAd.MapView.prototype.setShowsUserLocation=function(a){return this.setMapProperty("showsUserLocation",a)};iAd.MapView.prototype.getShowsUserLocation=function(){return this.getMapProperty("showsUserLocation",true)};iAd.MapView.prototype.setUserLocation=function(){iAd.Console.warn("iAd.MapView.userLocation is read-only.")};
iAd.MapView.prototype.getUserLocation=function(){var a=this._userLocation;if(!a&&this.layerIsInDocument&&this.mapObject.showsUserLocation)if(a=this.mapObject.userLocation)this._userLocation=this.processUserLocation(a);return this._userLocation};iAd.MapView.prototype.setUserLocationVisible=function(){iAd.Console.warn("iAd.MapView.userLocationVisible is read-only.")};iAd.MapView.prototype.getUserLocationVisible=function(){return this.mapObject.userLocationVisible};
iAd.MapView.prototype.setLongPressDropsPin=function(a){return this.setMapProperty("longPressDropsPin",a)};iAd.MapView.prototype.getLongPressDropsPin=function(){return this.getMapProperty("longPressDropsPin",true)};iAd.MapView.prototype.setDroppedPinTitle=function(a){return this.setMapProperty("droppedPinTitle",a)};iAd.MapView.prototype.getDroppedPinTitle=function(){return this.getMapProperty("droppedPinTitle")};
iAd.MapView.prototype.setDroppedPinIdentifier=function(a){return this.setMapProperty("droppedPinIdentifier",a)};iAd.MapView.prototype.getDroppedPinIdentifier=function(){return this.getMapProperty("droppedPinIdentifier")};iAd.MapView.prototype.setCenterCoordinate=function(a){if(this.layerIsInDocument)this.setCenterCoordinateAnimated(a,true);else this._centerCoordinate=a};iAd.MapView.prototype.setCenterCoordinateAnimated=function(a,b){this.mapObject.setCenterCoordinate(a,b)};
iAd.MapView.prototype.getCenterCoordinate=function(){if(this.layerIsInDocument){var a=this.mapObject.centerCoordinate;return new iAd.MapCoordinate(a.latitude,a.longitude)}else return this._centerCoordinate};iAd.MapView.prototype.setRegion=function(a){this.setRegionAnimated(a,true)};iAd.MapView.prototype.setRegionAnimated=function(a,b){this._region=a;this.layerIsInDocument&&this.mapObject.setRegion(a,b)};
iAd.MapView.prototype.getRegion=function(){if(this._region)return this._region;else if(this.layerIsInDocument&&this.mapObject.region){var a=this.mapObject.region;return new iAd.MapRegion(a.latitude,a.longitude,a.latitudeDelta,a.longitudeDelta)}};iAd.MapView.prototype.mapRegionWillChange=function(){this.dispatchNotification(iAd.MapView.REGION_WILL_CHANGE,this.delegate,[])};
iAd.MapView.prototype.mapRegionDidChange=function(a){a=new iAd.MapRegion(a.latitude,a.longitude,a.latitudeDelta,a.longitudeDelta);if(!a.equals(this._region)){this._region=a;this.dispatchNotification(iAd.MapView.REGION_DID_CHANGE,this.delegate,[["region",a]])}};iAd.MapView.prototype.convertCoordinateToPoint=function(a){a=this.mapObject.convertCoordinateToPoint(a);return new iAd.Point(a.x,a.y)};
iAd.MapView.prototype.convertPointToCoordinate=function(a){a=this.mapObject.convertPointToCoordinate(a);return new iAd.MapCoordinate(a.latitude,a.longitude)};iAd.MapView.prototype.convertRectToRegion=function(a){a=this.mapObject.convertRectToRegion(a);return new iAd.MapRegion(a.latitude,a.longitude,a.latitudeDelta,a.longitudeDelta)};iAd.MapView.prototype.convertRegionToRect=function(a){a=this.mapObject.convertRegionToRect(a);return new iAd.Rect(a.x,a.y,a.width,a.height)};
iAd.MapView.prototype.getAnnotations=function(){return this.annotationsForIds(Object.keys(this._annotationsById))};iAd.MapView.prototype.setAnnotations=function(){iAd.Console.warn("iAd.MapView.annotations is read-only. Please use iAd.MapView.addAnnotations() instead.")};iAd.MapView.prototype.addAnnotations=function(a){for(var b=0,c=a.length,d;b<c;b++){d=a[b];this._annotationsById[d.id]=d}this.mapObject.addAnnotations(a)};
iAd.MapView.prototype.selectAnnotation=function(a,b){this.mapObject.selectAnnotation(a.id,b)};iAd.MapView.prototype.deselectAnnotation=function(a,b){this.mapObject.deselectAnnotation(a.id,b)};iAd.MapView.prototype.removeAnnotations=function(a){for(var b=[],c=0,d=a.length,e;c<d;c++){e=a[c].id;delete this._annotationsById[e];b.push(e)}this.mapObject.removeAnnotations(b)};iAd.MapView.prototype.setSelectedAnnotations=function(){iAd.Console.warn("iAd.MapView.selectedAnnotations is read-only. Please use iAd.MapView.selectAnnotation() instead.")};
iAd.MapView.prototype.getSelectedAnnotations=function(){return this.annotationsForIds(this.mapObject.selectedAnnotations)};iAd.MapView.prototype.annotationsForIds=function(a){var b=[];a.forEach(function(c){(c=this._annotationsById[c])&&b.push(c)},this);return b};iAd.MapView.prototype.mapDidSelectAnnotation=function(a){this.dispatchNotification(iAd.MapView.DID_SELECT_ANNOTATION,this.delegate,[["annotation",this._annotationsById[a]]])};
iAd.MapView.prototype.mapDidDeselectAnnotation=function(a){this.dispatchNotification(iAd.MapView.DID_DESELECT_ANNOTATION,this.delegate,[["annotation",this._annotationsById[a]]])};iAd.MapView.prototype.mapDidAddViewsForAnnotations=function(a){this.dispatchNotification(iAd.MapView.DID_ADD_VIEWS_FOR_ANNOTATIONS,this.delegate,[["annotations",this.annotationsForIds(a)]])};
iAd.MapView.prototype.mapAnnotationLeftCalloutTapped=function(a){this.dispatchNotification(iAd.MapView.ANNOTATION_LEFT_CALLOUT_TAPPED,this.delegate,[["annotation",this._annotationsById[a]]])};iAd.MapView.prototype.mapAnnotationRightCalloutTapped=function(a){this.dispatchNotification(iAd.MapView.ANNOTATION_RIGHT_CALLOUT_TAPPED,this.delegate,[["annotation",this._annotationsById[a]]])};
iAd.MapView.prototype.mapAnnotationDidFinishDrag=function(a,b){this.dispatchNotification(iAd.MapView.ANNOTATION_DID_FINISH_DRAG,this.delegate,[["annotation",this._annotationsById[a]],["coordinate",new iAd.MapCoordinate(b.latitude,b.longitude)]])};iAd.MapView.prototype.mapFailedRetrievingImageForAnnotation=function(a,b,c){this.dispatchNotification(iAd.MapView.FAILED_RETRIEVING_IMAGE_FOR_ANNOTATION,this.delegate,[["annotation",this._annotationsById[a]],["errorCode",b],["url",c]])};
iAd.MapView.prototype.getOverlays=function(){return this.overlaysForIds(Object.keys(this._overlaysById))};iAd.MapView.prototype.setOverlays=function(){iAd.Console.warn("iAd.MapView.overlays is read-only. Please use iAd.MapView.addOverlays() instead.")};iAd.MapView.prototype.addOverlays=function(a){for(var b=0,c=a.length,d;b<c;b++){d=a[b];this._overlaysById[d.id]=d}this.mapObject.addOverlays(a)};
iAd.MapView.prototype.removeOverlays=function(a){for(var b=[],c=0,d=a.length,e;c<d;c++){e=a[c].id;delete this._overlaysById[e];b.push(e)}this.mapObject.removeOverlays(b)};iAd.MapView.prototype.exchangeOverlaysAtIndices=function(){this.mapObject.exchangeOverlays(index1,index2)};iAd.MapView.prototype.insertOverlayAtIndex=function(a,b){this.mapObject.insertOverlayAtIndex(a,b)};iAd.MapView.prototype.insertOverlayAboveOverlay=function(a,b){this.mapObject.insertOverlayAboveOverlay(a,b.identifier)};
iAd.MapView.prototype.insertOverlayBelowOverlay=function(a){this.mapObject.insertOverlayBelowOverlay(a,identifier)};iAd.MapView.prototype.overlaysForIds=function(a){var b=[];a.forEach(function(c){(c=this._overlaysById[c])&&b.push(c)},this);return b};iAd.MapView.prototype.mapDidAddOverlays=function(a){Array.isArray(a)||(a=[a]);this.dispatchNotification(iAd.MapView.DID_ADD_OVERLAYS,this.delegate,[["overlays",this.overlaysForIds(a)]])};
iAd.MapView.prototype.mapDidUpdateUserLocation=function(a){this._userLocation=a=this.processUserLocation(a);this.dispatchNotification(iAd.MapView.DID_UPDATE_USER_LOCATION,this.delegate,[["location",a]])};iAd.MapView.prototype.processUserLocation=function(a){return{latitude:a.latitude,longitude:a.longitude,altitude:a.altitude,horizontalAccuracy:a.horizontalAccuracy,verticalAccuracy:a.verticalAccuracy}};
iAd.MapView.prototype.mapUpdateUserLocationFailed=function(a){this.dispatchNotification(iAd.MapView.UPDATE_USER_LOCATION_FAILED,this.delegate,[["errorCode",a]])};iAd.MapView.prototype.mapWillStartUpdatingUserLocation=function(){this.dispatchNotification(iAd.MapView.WILL_START_UPDATING_USER_LOCATION,this.delegate,[])};iAd.MapView.prototype.mapDidStopUpdatingUserLocation=function(){this.dispatchNotification(iAd.MapView.DID_STOP_UPDATING_USER_LOCATION,this.delegate,[])};
iAd.MapView.prototype.mapWillStartLoadingMap=function(){this.dispatchNotification(iAd.MapView.WILL_START_LOADING_MAP,this.delegate,[])};iAd.MapView.prototype.mapDidFinishLoadingMap=function(){this.dispatchNotification(iAd.MapView.DID_FINISH_LOADING_MAP,this.delegate,[])};iAd.MapView.prototype.mapDidFailLoadingMap=function(){this.dispatchNotification(iAd.MapView.DID_FAIL_LOADING_MAP,this.delegate,[])};
iAd.MapView.MapPluginShim=function(){this.shim=true;this.style={};["addAnnotation","addAnnotations","removeAnnotation","removeAnnotations","addOverlay","addOverlays","removeOverlay","removeOverlays","convertCoordinateToPoint","convertPointToCoordinate","convertRectToRegion","convertRegionToRect","deselectAnnotation","exchangeOverlays","insertOverlayAboveOverlay","insertOverlayAtIndex","insertOverlayBelowOverlay","regionThatFits","setRegion","setCenterCoordinate"].forEach(function(a){this[a]=function(){iAd.Console.log("iAd.MapView # "+
a+" : shim implementation called")}},this)};iAd.Class({name:"iAd.Message",mixins:[iAd.EventTarget,iAd.ComposerBackedObject],synthesizedProperties:["attachments","readyToPresent"]});iAd.Message.SHOULD_PRESENT="messageShouldPresent";iAd.Message.DID_SEND="messageDidSend";iAd.Message.DID_CANCEL="messageDidCancel";iAd.Message.DID_FAIL="messageDidFail";iAd.Message.DID_SAVE="messageDidSave";iAd.Message.ATTACHMENT_DID_FAIL="messageAttachmentDidFail";iAd.Message.COMPOSITION_DID_ERROR="messageCompositionDidError";
iAd.Message.ATTACHMENT_TOO_LONG=1;iAd.Message.ATTACHMENT_URL_RESOURCE_ERROR=2;iAd.Message.ATTACHMENT_INVALID_FORMAT_ERROR=3;iAd.Message.ATTACHMENT_UNSUPPORTED_TYPE_ERROR=4;iAd.Message.ATTACHMENT_MISSING_FILENAME_EXTENSION_ERROR=5;
iAd.Message.prototype.init=function(a,b){this.callSuper();this.delegate=b;this._readyToPresent=false;iAd.BindingUtils.initializeBindingObject(this);if(!this._binding)throw iAd.BindingUtils.BINDING_UNAVAILABLE_ERROR;if(this._binding)this._binding.listener=this.listenerObject();this.configuration=a;iAd.ComposerBackedObject.init.call(this)};iAd.Message.prototype.listenerObject=function(){return this};
iAd.Message.prototype.presentWhenReady=function(){this._presentWhenReady=true;if(this.isActiveObjectForComposer)this._readyToPresent&&this.presentComposer();else{this.requestActivationForComposer();if(this._readyToPresent){this._presentWhenReady=false;this.presentComposer()}}};
iAd.Message.prototype.presentComposer=function(){if(!(!this._presentWithoutAskingDelegate&&iAd.Utils.objectHasMethod(this.delegate,iAd.Message.SHOULD_PRESENT)&&!this.delegate[iAd.Message.SHOULD_PRESENT](this))){this._presentWithoutAskingDelegate=false;try{this._binding.presentComposer()}catch(a){this.presentDidThrowError(a)}}};
iAd.Message.prototype.presentDidThrowError=function(a){iAd.BindingUtils.isErrorFromModalActivity(a)?this.notifyDidFail(iAd.BindingError.MODAL_ACTIVITY_ERROR):this.notifyDidFail(iAd.BindingError.OTHER_ERROR,iAd.BindingUtils.sanitizeMessageFromError(a))};
iAd.Message.prototype.setAttachments=function(a){if(this._binding){if(a&&!iAd.Utils.objectIsArray(a)){this.notifyAttachmentDidFail(a,iAd.Message.ATTACHMENT_INVALID_FORMAT_ERROR);a=null}a=a?this.validateAttachmentsArray(a):null;this._readyToPresent=!a||!a.length;this._attachments=a;try{this._binding.setAttachments(a)}catch(b){this.attachmentsDidError(b)}}};iAd.Message.prototype.setReadyToPresent=function(){};
iAd.Message.prototype.setComposerProperty=function(a,b,c){this.requestActivationForComposer();var d="_"+a;try{this._binding&&c.call(this,b);this[d]=b}catch(e){this.notifyCompositionDidError(a)}};iAd.Message.prototype.willResignActiveObjectForComposer=function(){if(this._attachments&&this._attachments.length)this._readyToPresent=false};
iAd.Message.prototype.didBecomeActiveObjectForComposer=function(){if(this._binding)this._binding.listener=this.listenerObject();if(this.initialized)this.synchronizePropertiesWithComposer();else{var a={};iAd.Utils.copyPropertiesFromSourceToTarget(this.constructor.DEFAULTS,a);iAd.Utils.copyPropertiesFromSourceToTarget(this.configuration,a);iAd.Utils.copyPropertiesFromSourceToTarget(a,this);this.initialized=true}this._attachments||this.notifyReadyToPresent()};
iAd.Message.prototype.synchronizePropertiesWithComposer=function(){var a=this.constructor.synthesizedProperties.slice(),b;a.push("attachments");for(var c=0,d=a.length;c<d;c++){b=a[c];this[b]=this["_"+b]}};iAd.Message.prototype.notifyReadyToPresent=function(){if(!this._readyToPresent){this._readyToPresent=true;if(this._presentWhenReady){this._presentWhenReady=false;this.presentComposer()}}};iAd.Message.prototype.notifyDidSend=function(){this.notifyDelegate(iAd.Message.DID_SEND,this.delegate)};
iAd.Message.prototype.notifyDidCancel=function(){this.notifyDelegate(iAd.Message.DID_CANCEL,this.delegate)};iAd.Message.prototype.notifyDidFail=function(a,b){this.notifyDelegate(iAd.Message.DID_FAIL,this.delegate,[["errorCode",a||iAd.BindingError.UKNOWN_ERROR],["errorDetail",b||null]])};
iAd.Message.prototype.notifyAttachmentDidFail=function(a,b,c){a&&this._attachments&&iAd.Array.removeObjectFromArray(a,this._attachments);this.notifyDelegate(iAd.Message.ATTACHMENT_DID_FAIL,this.delegate,[["attachment",a],["errorCode",b||iAd.Message.ATTACHMENT_URL_RESOURCE_ERROR],["errorDetail",c||null]])};iAd.Message.prototype.notifyCompositionDidError=function(a){this.notifyDelegate(iAd.Message.COMPOSITION_DID_ERROR,this.delegate,[["property",a]])};
iAd.Message.prototype.validateAttachmentsArray=function(a){for(var b=a.length-1,c;b>=0;b--){c=a[b];if(iAd.Message.isAttachmentValid(c)){if(this.constructor.SUPPORTED_ATTACHMENT_TYPES.indexOf(c.type)==-1){a.splice(b,1);this.notifyAttachmentDidFail(c,iAd.Message.ATTACHMENT_UNSUPPORTED_TYPE_ERROR)}}else{a.splice(b,1);this.notifyAttachmentDidFail(c,iAd.Message.ATTACHMENT_INVALID_FORMAT_ERROR)}}return a};
iAd.Message.prototype.attachmentsDidError=function(a){var b=a.message,c=b.indexOf(": ");a=b.substr(0,c);b=this.attachmentWithErrorRepresentation(b.substr(c+2));switch(a){case "Invalid URL in":this.notifyAttachmentDidFail(b,iAd.Message.ATTACHMENT_URL_RESOURCE_ERROR,iAd.URLResourceError.INVALID_URL_ERROR);break;case "Name for attachment is missing a file name extension":this.notifyAttachmentDidFail(b,iAd.Message.ATTACHMENT_MISSING_FILENAME_EXTENSION_ERROR);break;default:this.notifyAttachmentDidFail(b,
iAd.Message.ATTACHMENT_INVALID_FORMAT_ERROR)}};iAd.Message.prototype.attachmentWithURL=function(a){if(!this._attachments)return null;for(var b,c,d=iAd.Path.resolveAbsolutePath(a),e=0,f=this._attachments.length;e<f;e++){b=this._attachments[e];c=iAd.Path.resolveAbsolutePath(b.url);if(c==d||b.url==a)return b}return null};iAd.Message.prototype.attachmentWithName=function(a){if(!this._attachments)return null;for(var b,c=0,d=this._attachments.length;c<d;c++){b=this._attachments[c];if(b.name==a)return b}return null};
iAd.Message.prototype.attachmentsByType=function(a){if(!this._attachments)return null;return this._attachments.filter(function(b){return b.type==a})};iAd.Message.prototype.attachmentWithErrorRepresentation=function(a){var b=this.parseValueForKeyFromErrorRepresentation("name",a);if(b)return this.attachmentWithName(b);if(a=this.parseValueForKeyFromErrorRepresentation("url",a))return this.attachmentWithURL(a);return null};
iAd.Message.prototype.parseValueForKeyFromErrorRepresentation=function(a,b){var c=RegExp(a+"\\s=\\s(.)+");c=b.match(c);var d=null;if(c){d=c[0].split(" = ")[1];d=d.replace(/"/g,"");if(d.charAt(d.length-1)==";")d=d.substr(0,d.length-1)}return d};iAd.Message.isAttachmentValid=function(a){return!!a&&a.type!=null&&a.url!=null&&a.name!=null};
if(!window.ADMailComposerListener)window._ADMailComposerListener={kADMailComposerMessageAttachmentDownloadInProgressCode:7,kADMailComposerMessageCancelledCode:0,kADMailComposerMessageFailedCode:3,kADMailComposerMessageMissingMessageBodyCode:6,kADMailComposerMessageMissingRecipientsCode:4,kADMailComposerMessageMissingSubjectCode:5,kADMailComposerMessageSavedCode:1,kADMailComposerMessageSentCode:2};
if(!window.ad||!window.ad.mailComposer)window._ad.mailComposer={shim:true,listener:{},setMessageBody:function(){},presentComposer:function(){this.listener.mailComposerDidFinish(window._ADMailComposerListener.kADMailComposerMessageSentCode)},setAttachments:function(a){a&&this.listener.mailComposerAttachmentDownloadsDidFinish()}};iAd.Class({name:"iAd.MailMessage",superclass:iAd.Message,synthesizedProperties:["to","subject","body","html"]});iAd.MailMessage.BINDING_OBJECT=window._ad.mailComposer||window.ad.mailComposer;
iAd.MailMessage.BINDING_PROTOCOL=window._ADMailComposerListener||window.ADMailComposerListener;iAd.MailMessage.DEFAULTS={to:[],subject:"",body:"",html:false,attachments:null};iAd.MailMessage.SUPPORTED_ATTACHMENT_TYPES=["image","other"];iAd.MailMessage.prototype.init=function(a,b){this.callSuper(a,b)};iAd.MailMessage.prototype.setTo=function(a){this.setComposerProperty("to",a||null,function(b){this._binding.toRecipients=b})};
iAd.MailMessage.prototype.setSubject=function(a){this.setComposerProperty("subject",a||"",function(b){this._binding.subject=b})};iAd.MailMessage.prototype.setBody=function(a){this.setComposerProperty("body",a||"",function(b){this._binding.setMessageBody(b,this._html)})};iAd.MailMessage.prototype.setHtml=function(a){this.setComposerProperty("html",a||false,function(b){this._binding.setMessageBody(this._body,b)})};iAd.MailMessage.prototype.mailComposerAttachmentDownloadDidFail=function(a,b){this.notifyAttachmentDidFail(this.attachmentWithName(b))};
iAd.MailMessage.prototype.mailComposerAttachmentDownloadsDidFinish=function(){this.notifyReadyToPresent()};
iAd.MailMessage.prototype.mailComposerDidFinish=function(a){this.resignAsActiveComposer();switch(a){case this._bindingProtocol.kADMailComposerMessageAttachmentDownloadInProgressCode:if(iAd.Device.iOS_VERSION&&iAd.Device.iOSVersionLessThan("6.0")){this._binding.setAttachments(null);this._presentWithoutAskingDelegate=true;this.callMethodNameAfterDelay("presentWhenReady",0)}break;case this._bindingProtocol.kADMailComposerMessageCancelledCode:this.notifyDidCancel();break;case this._bindingProtocol.kADMailComposerMessageFailedCode:this.notifyDidFail();
break;case this._bindingProtocol.kADMailComposerMessageMissingMessageBodyCode:this.notifyCompositionDidError("body");break;case this._bindingProtocol.kADMailComposerMessageMissingRecipientsCode:this.notifyCompositionDidError("to");break;case this._bindingProtocol.kADMailComposerMessageMissingSubjectCode:this.notifyCompositionDidError("subject");break;case this._bindingProtocol.kADMailComposerMessageSavedCode:this.notifyDelegate(iAd.Message.DID_SAVE,this.delegate);break;case this._bindingProtocol.kADMailComposerMessageSentCode:this.notifyDidSend()}};
iAd.BindingUtils.registerBindingClass(iAd.MailMessage);if(!window.ADSMSComposerListener)window._ADSMSComposerListener={kADSMSComposerMessageCancelledCode:1,kADSMSComposerMessageFailedCode:2,kADSMSComposerMessageSentCode:0};if(!window.ad||!window.ad.smsComposer)window._ad.smsComposer={shim:true,listener:{},presentComposer:function(){this.listener.smsComposerDidFinish(window._ADSMSComposerListener.kADSMSComposerMessageSentCode)},setAttachments:function(a){a&&this.listener.smsComposerAttachmentDownloadsDidFinish()}};
iAd.Class({name:"iAd.SMSMessage",superclass:iAd.Message,synthesizedProperties:["to","body"]});iAd.SMSMessage.BINDING_OBJECT=window._ad.smsComposer||window.ad.smsComposer;iAd.SMSMessage.BINDING_PROTOCOL=window._ADSMSComposerListener||window.ADSMSComposerListener;iAd.SMSMessage.DEFAULTS={to:[],body:"",attachments:null};iAd.SMSMessage.SUPPORTED_ATTACHMENT_TYPES=["image","other"];
Object.defineProperty(iAd.SMSMessage,"attachmentsSupported",{get:function(){return iAd.SMSMessage.available&&(iAd.SMSMessage.BINDING_OBJECT.shim||iAd.Device.iOS_VERSION&&!iAd.Device.iOSVersionLessThan("6.0"))}});iAd.SMSMessage.prototype.setTo=function(a){this.setComposerProperty("to",a,function(b){this._binding.recipients=b})};iAd.SMSMessage.prototype.setBody=function(a){this.setComposerProperty("body",a||"",function(b){this._binding.body=b})};
iAd.SMSMessage.prototype.setAttachments=function(a){iAd.SMSMessage.attachmentsSupported?this.callSuper(a):iAd.Console.warn("iAd.SMSMessage: Attachments are not supported in the current environment.")};iAd.SMSMessage.prototype.smsComposerDidFinish=function(a){switch(a){case this._bindingProtocol.kADSMSComposerMessageCancelledCode:this.notifyDidCancel();break;case this._bindingProtocol.kADSMSComposerMessageSentCode:this.notifyDidSend();break;default:this.notifyDidFail()}};
iAd.SMSMessage.prototype.smsComposerAttachmentDownloadDidFail=function(a,b){this.notifyAttachmentDidFail(this.attachmentWithName(b))};iAd.SMSMessage.prototype.smsComposerAttachmentDownloadsDidFinish=function(){this.notifyReadyToPresent()};iAd.BindingUtils.registerBindingClass(iAd.SMSMessage);iAd.Twitter={};iAd.Twitter.sharedListener={};
iAd.Twitter.setupSharedListenerMethodsForComposerBackedClass=function(a,b){a.forEach(function(c){iAd.Twitter.sharedListener[c]=function(){var d=b.activeObjectForComposer;d&&d[c].apply(d,arguments)}})};iAd.Class({name:"iAd.TwitterAction",mixins:[iAd.EventTarget,iAd.ComposerBackedObject]});iAd.TwitterAction.DID_COMPLETE="twitterActionDidComplete";iAd.TwitterAction.DID_FAIL="twitterActionDidFail";iAd.TwitterAction.TIMEOUT=10;iAd.TwitterAction.TIMEOUT_ERROR_MESSAGE="Response timed out.";
iAd.TwitterAction.prototype.init=function(a){this.callSuper();this.delegate=a;iAd.BindingUtils.initializeBindingObject(this);if(!this._binding)throw iAd.BindingUtils.BINDING_UNAVAILABLE_ERROR;this.callMethodNameAfterDelay("requestActivationForComposer",0)};iAd.TwitterAction.prototype.execute=function(){this.beginTimeout()};iAd.TwitterAction.prototype.didBecomeActiveObjectForComposer=function(){this.execute()};iAd.TwitterAction.prototype.willResignActiveObjectForComposer=function(){};
iAd.TwitterAction.prototype.beginTimeout=function(){this.actionTimeout=this.callMethodNameAfterDelay("actionDidTimeout",this.constructor.TIMEOUT)};iAd.TwitterAction.prototype.endTimeout=function(){if(this.actionTimeout){clearTimeout(this.actionTimeout);this.actionTimeout=null}};iAd.TwitterAction.prototype.actionDidTimeout=function(){this.notifyDidFail(iAd.TwitterAction.TIMEOUT_ERROR_MESSAGE)};
iAd.TwitterAction.prototype.notifyDidComplete=function(){this.endTimeout();this.resignAsActiveComposer();this.notifyDelegate(iAd.TwitterAction.DID_COMPLETE,this.delegate)};iAd.TwitterAction.prototype.notifyDidFail=function(a){this.endTimeout();this.resignAsActiveComposer();this.notifyDelegate(iAd.TwitterAction.DID_FAIL,this.delegate,[["errorMessage",a]])};if(!window.ADTwitterComposerListener)window._ADTwitterComposerListener={kADTwitterComposerStatusImageExceedsMaximumSize:2E3,kADTwitterComposerStatusURLIsNotAnImage:1E3};
if(!window.ad||!window.ad.twitterComposer){window._ad.twitterComposer={shim:true,listener:{},presentComposer:function(){this.listener.twitterComposerDidSendTweet()},follow:function(){this.listener.followDidSucceed()}};Object.defineProperty(window._ad.twitterComposer,"images",{set:function(a){a&&this.listener.twitterComposerReadyToPresent()}})}iAd.Class({name:"iAd.TwitterFollowAction",superclass:iAd.TwitterAction});iAd.TwitterFollowAction.BINDING_OBJECT=window._ad.twitterComposer||window.ad.twitterComposer;
iAd.TwitterFollowAction.BINDING_PROTOCOL=window._ADTwitterComposerListener||window.ADTwitterComposerListener;iAd.TwitterFollowAction.TIMEOUT=iAd.TwitterAction.TIMEOUT;iAd.TwitterFollowAction.prototype.init=function(a,b,c){this.screenName=a;this.userId=b;this.callSuper(c)};iAd.TwitterFollowAction.prototype.execute=function(){if(this._binding){this.callSuper();this._binding.listener=iAd.Twitter.sharedListener;this._binding.follow(this.screenName,this.userId)}else this.notifyDidFail("The Twitter binding is unavailable.")};
iAd.TwitterFollowAction.prototype.followDidSucceed=function(){this.notifyDidComplete()};iAd.TwitterFollowAction.prototype.followDidFail=function(a){this.notifyDidFail(a)};iAd.Twitter.followUserWithScreenName=function(a,b){return new iAd.TwitterFollowAction(a,null,b)};iAd.Twitter.followUserWithUserId=function(a,b){return new iAd.TwitterFollowAction(null,a,b)};Object.defineProperty(iAd.Twitter,"followSupported",{get:function(){return iAd.Twitter.getFollowSupported()}});
iAd.Twitter.getFollowSupported=function(){var a=iAd.BindingUtils.isBindingClassAvailable(iAd.TwitterFollowAction),b=iAd.TwitterFollowAction.BINDING_OBJECT;return a&&b.hasOwnProperty("follow")};iAd.Twitter.setupSharedListenerMethodsForComposerBackedClass(["followDidFail","followDidSucceed"],iAd.TwitterFollowAction);iAd.Utils.setupDisplayNames(iAd.Twitter,"iAd.Twitter");iAd.Class({name:"iAd.TwitterMessage",superclass:iAd.Message,synthesizedProperties:["body"]});
iAd.TwitterMessage.BINDING_OBJECT=window._ad.twitterComposer||window.ad.twitterComposer;iAd.TwitterMessage.BINDING_PROTOCOL=window._ADTwitterComposerListener||window.ADTwitterComposerListener;iAd.TwitterMessage.DEFAULTS={body:"",attachments:null};iAd.TwitterMessage.SUPPORTED_ATTACHMENT_TYPES=["image","url"];iAd.TwitterMessage.prototype.init=function(a,b){this.callSuper(a,b)};iAd.TwitterMessage.prototype.setBody=function(a){this.setComposerProperty("body",a,function(){this._binding.text=a})};
iAd.TwitterMessage.prototype.setAttachments=function(a){if(this._binding){if(iAd.Utils.objectIsArray(a))a=this.validateAttachmentsArray(a);this._attachments=a;this._readyToPresent=!a;a||(a=[]);for(var b=[],c=[],d,e=0,f=a.length;e<f;e++)if(d=a[e])if(d.type==="image")b.push(d.url);else d.type==="url"&&c.push(d.url);try{this._binding.images=b.length?b:null}catch(g){this.handleAttachmentError(g)}try{this._binding.URLs=c.length?c:null}catch(h){this.handleAttachmentError(h)}if(b.length==0)this.notifyReadyToPresent();
else this._readyToPresent=false}};iAd.TwitterMessage.prototype.handleAttachmentError=function(a){a=iAd.BindingUtils.sanitizeMessageFromError(a);var b=a.indexOf("Invalid URL '")+13,c=a.indexOf(" in tweet")-b-1;this.notifyAttachmentDidFail(this.attachmentWithURL(a.substr(b,c)),iAd.Message.ATTACHMENT_URL_RESOURCE_ERROR,iAd.URLResourceError.INVALID_URL_ERROR)};
iAd.TwitterMessage.prototype.willResignActiveObjectForComposer=function(){var a=this.attachmentsByType("image");if(a&&a.length>0)this._readyToPresent=false};iAd.TwitterMessage.prototype.listenerObject=function(){return iAd.Twitter.sharedListener};iAd.TwitterMessage.prototype.twitterComposerReadyToPresent=function(){this.notifyReadyToPresent()};
iAd.TwitterMessage.prototype.twitterComposerImageDownloadDidFail=function(a,b){var c=this.attachmentWithURL(a),d;if(c){switch(b){case this._bindingProtocol.kADTwitterComposerStatusURLIsNotAnImage:d=iAd.URLResourceError.INVALID_OR_CORRUPT_ERROR;break;case this._bindingProtocol.kADTwitterComposerStatusImageExceedsMaximumSize:d=iAd.URLResourceError.TOO_LARGE_ERROR;break;default:d=b}this.notifyAttachmentDidFail(c,iAd.Message.ATTACHMENT_URL_RESOURCE_ERROR,d)}};
iAd.TwitterMessage.prototype.twitterComposerItemExceedsCapacity=function(a){a=this.attachmentWithURL(a);iAd.Array.removeObjectFromArray(a,this._attachments);this.notifyAttachmentDidFail(a,iAd.Message.ATTACHMENT_TOO_LONG)};iAd.TwitterMessage.prototype.twitterComposerDidSendTweet=function(){this.notifyDidSend()};iAd.TwitterMessage.prototype.twitterComposerDidCancelTweet=function(){this.notifyDidCancel()};iAd.BindingUtils.registerBindingClass(iAd.TwitterMessage);
iAd.Twitter.setupSharedListenerMethodsForComposerBackedClass(["twitterComposerReadyToPresent","twittercomposerImageDownloadDidFail","twitterComposerItemExceedsCapacity","twitterComposerDidSendTweet","twitterComposerDidCancelTweet"],iAd.TwitterMessage);
if(!window.ad||!window.ad.rewards)window._ad.rewards={shim:true,rewardTokens:[],lookupReward:function(a){this.listener&&iAd.Utils.objectHasMethod(this.listener,"lookupSucceeded")&&this.listener.lookupSucceeded(a,JSON.stringify({reward:"This is test metadata"}))},userRedeemedReward:function(){}};iAd.Rewards={};iAd.Rewards.BINDING_OBJECT=window._ad.rewards||window.ad.rewards;
Object.defineProperty(iAd.Rewards,"rewardTokens",{get:function(){iAd.BindingUtils.initializeBindingObject(iAd.Rewards,true);if(!iAd.Rewards._binding)throw iAd.BindingUtils.BINDING_UNAVAILABLE_ERROR;if(!iAd.Rewards._rewardTokens)iAd.Rewards._rewardTokens=iAd.Rewards._binding.rewardTokens;return iAd.Rewards._rewardTokens}});iAd.Rewards.loadersByToken={};
iAd.Rewards.rewardLoaderForToken=function(a){iAd.BindingUtils.initializeBindingObject(iAd.Rewards,true);if(!iAd.Rewards._binding)throw iAd.BindingUtils.BINDING_UNAVAILABLE_ERROR;iAd.Rewards._binding.listener=iAd.Rewards;var b=new iAd.RewardLoader(a);return iAd.Rewards.loadersByToken[a]=b};iAd.Rewards.reportUserRedeemedReward=function(a){iAd.BindingUtils.initializeBindingObject(iAd.Rewards,true);if(!iAd.Rewards._binding)throw iAd.BindingUtils.BINDING_UNAVAILABLE_ERROR;iAd.Rewards._binding.userRedeemedReward(a)};
iAd.Rewards.lookupSucceeded=function(a,b){var c=iAd.Rewards.loadersByToken[a];if(c){c.rewardMetadata=b;c.notifyLoaderDidComplete();delete iAd.Rewards.loadersByToken[a]}};iAd.Rewards.lookupFailed=function(a,b){var c=iAd.Rewards.loadersByToken[a];if(c){c.notifyLoaderDidFail(b);delete iAd.Rewards.loadersByToken[a]}};iAd.BindingUtils.registerBindingClass(iAd.Rewards);iAd.Utils.setupDisplayNames(iAd.Rewards,"iAd.Rewards");iAd.Class({name:"iAd.RewardLoader",superclass:iAd.Loader});
iAd.RewardLoader.prototype.init=function(a){this.token=a;this.rewardMetadata=null;this.callSuper()};iAd.RewardLoader.prototype.startLoad=function(){iAd.Rewards._binding.lookupReward(this.token)};window._ADStoreItemListener={kNoBuyParametersError:1,kInsufficientValidTimeError:2,kItemNotFoundInStoreError:3,kNoMetadataForItemError:6,kFunctionalityNotSupportedInSimulatorError:4,kUserCanceledPurchaseError:5,kUnregisteredItemError:7,kIBooksNotInstalledError:8,kInvalidOfferIdentifierError:9};
window._ad.store={shim:true,_registeredItemsForPurchase:[],registerItemsForPurchase:function(a){if(window._ad.store._registeredItemsForPurchase.length!=0)throw"Warning: registerItemsForPurchase can only be called once and it has already been called.";window._ad.store._registeredItemsForPurchase=a},purchaseItemWithID:function(a,b,c){window._ad.store._registeredItemsForPurchase.indexOf(a)==-1&&c.storeItemPurchaseDidFail(a,window._ADStoreItemListener.kUnregisteredItemError);c.storeItemPurchaseDidSucceed(a)},
lookupItemWithID:function(a,b){b.storeItemLookupDidSucceed({adamId:a,title:"Simulated store item",offers:[{action:"INSTALL",preorder:false,price:"FREE",id:"TEST"}],previews:[]})},redeemiTunesGiftCode:function(a,b){b.redeemCodeDidSucceed(a)}};iAd.Store={BINDING_OBJECT:window.ad&&window.ad.store?window.ad.store:window._ad.store,BINDING_PROTOCOL:window.ADStoreItemListener||window._ADStoreItemListener};iAd.Store._registeredItemsForPurchase=[];
iAd.Store.registerItemsForPurchase=function(a){if(!this._initializedBinding){this._initializedBinding=true;iAd.BindingUtils.initializeBindingObject(iAd.Store,true)}if(!this._binding)throw iAd.BindingUtils.BINDING_UNAVAILABLE_ERROR;if(iAd.Store._registeredItemsForPurchase.length){iAd.Console.warn("iAd.Store: You can only call registerItemsForPurchase once, the new identifiers were not registered.");return false}try{this._binding.registerItemsForPurchase(a);iAd.Store._registeredItemsForPurchase=a}catch(b){throw"iAd.Store: Invalid identifier array passed to registerItemsForPurchase";
}return true};iAd.Store.loaderForItemId=function(a){if(!this._registeredItemsForPurchase.length){iAd.Console.warn("iAd.Store: You must first register items for purchase before loading them");return null}if(this._registeredItemsForPurchase.indexOf(a)==-1){iAd.Console.warn('iAd.Store: An item with id "'+a+'" was not registered.');return null}return new iAd.StoreItemLoader(a,this)};
iAd.Store.useShimOverride=function(){this._binding=iAd.StoreItemLoader.BINDING_OBJECT=iAd.StoreItem.BINDING_OBJECT=iAd.StoreRedeemCodeAction.BINDING_OBJECT=window._ad.store;this._bindingProtocol=iAd.StoreItemLoader.BINDING_PROTOCOL=iAd.StoreItem.BINDING_PROTOCOL=iAd.StoreRedeemCodeAction.BINDING_PROTOCOL=window._ADStoreItemListener;this._binding._registeredItemsForPurchase=this._registeredItemsForPurchase.slice()};iAd.BindingUtils.registerBindingClass(iAd.Store);
iAd.Utils.setupDisplayNames(iAd.Store,"iAd.Store");iAd.Class({name:"iAd.StoreItem",mixins:[iAd.EventTarget]});iAd.StoreItem.PURCHASE_DID_SUCCEED="storeItemPurchaseDidSucceed";iAd.StoreItem.PURCHASE_DID_FAIL="storeItemPurchaseDidFail";iAd.StoreItem.PURCHASE_DID_CANCEL="storeItemPurchaseDidCancel";iAd.StoreItem.METADATA_DID_EXPIRE="storeItemMetadataDidExpire";iAd.StoreItem.UNKNOWN_ERROR=1;iAd.StoreItem.INVALID_OFFER_ERROR=2;iAd.StoreItem.UNREGISTERED_ITEM_ERROR=3;iAd.StoreItem.BINDING_OBJECT=iAd.Store.BINDING_OBJECT;
iAd.StoreItem.BINDING_PROTOCOL=iAd.Store.BINDING_PROTOCOL;iAd.StoreItem.prototype.init=function(a){this.callSuper();this.delegate=null;this.id=a.adamId;this.title=a.title;this.previews=a.previews.map(function(b){return b});this.offers=a.offers.map(function(b){return{id:b.identifier,action:b.action,preorder:!!b.preorder,price:b.price}});this.metadataExpired=false;iAd.BindingUtils.initializeBindingObject(this)};
iAd.StoreItem.prototype.purchaseWithOffer=function(a){try{this._binding.purchaseItemWithID(this.id,a.id,this)}catch(b){iAd.BindingUtils.isErrorFromModalActivity(b)?this.notifyPurchaseDidFail(iAd.BindingError.MODAL_ACTIVITY_ERROR):this.notifyPurchaseDidFail(iAd.StoreItem.UKNOWN_ERROR)}};iAd.StoreItem.prototype.storeItemMetadataDidExpire=function(){this.metadataExpired=true;this.notifyDelegate(iAd.StoreItem.METADATA_DID_EXPIRE,this.delegate)};
iAd.StoreItem.prototype.storeItemPurchaseDidFail=function(a,b){if(b==this._bindingProtocol.kUserCanceledPurchaseError)this.notifyDelegate(iAd.StoreItem.PURCHASE_DID_CANCEL,this.delegate);else{var c=null;switch(b){case this._bindingProtocol.kUnregisteredItemError:c=iAd.StoreItem.UNREGISTERED_ITEM_ERROR;break;case this._bindingProtocol.kInvalidOfferIdentifierError:c=iAd.StoreItem.INVALID_OFFER_ERROR;break;default:c=iAd.StoreItem.UNKNOWN_ERROR}this.notifyPurchaseDidFail(c)}};
iAd.StoreItem.prototype.storeItemPurchaseDidSucceed=function(){this.notifyDelegate(iAd.StoreItem.PURCHASE_DID_SUCCEED,this.delegate)};iAd.StoreItem.prototype.notifyPurchaseDidFail=function(a){this.notifyDelegate(iAd.StoreItem.PURCHASE_DID_FAIL,this.delegate,[["errorCode",a]])};iAd.Class({name:"iAd.StoreItemLoader",superclass:iAd.Loader,synthesizedProperties:["storeItem"]});iAd.StoreItemLoader.BINDING_OBJECT=iAd.StoreItem.BINDING_OBJECT;iAd.StoreItemLoader.BINDING_PROTOCOL=iAd.StoreItem.BINDING_PROTOCOL;
iAd.StoreItemLoader.UNKNOWN_ERROR=1;iAd.StoreItemLoader.ITEM_NOT_FOUND_ERROR=2;iAd.StoreItemLoader.INSUFFICIENT_VALID_TIME_ERROR=3;iAd.StoreItemLoader.NO_METADATA_ERROR=4;iAd.StoreItemLoader.NO_BUY_PARAMETERS_ERROR=5;iAd.StoreItemLoader.UNSUPPORTED_IN_SIMULATOR_ERROR=6;
iAd.StoreItemLoader.prototype.init=function(a,b){if(b){this.callSuper();iAd.BindingUtils.initializeBindingObject(this);this.itemId=a;this._storeItem=null;if(!this._binding)throw iAd.BindingUtils.BINDING_UNAVAILABLE_ERROR;}else iAd.Console.warn(this.constructor.displayName+": This class cannot be instantiated directly, please use iAd.Store.loaderForItemID.")};iAd.StoreItemLoader.prototype.startLoad=function(){this._binding.lookupItemWithID(this.itemId,this)};
iAd.StoreItemLoader.prototype.abortLoad=function(){};iAd.StoreItemLoader.prototype.storeItemLookupDidSucceed=function(a){this._storeItem=new iAd.StoreItem(a);this.notifyLoaderDidComplete()};iAd.StoreItemLoader.prototype.storeItemMetadataDidExpire=function(){this._storeItem&&this._storeItem.storeItemMetadataDidExpire()};
iAd.StoreItemLoader.prototype.storeItemLookupDidFail=function(a,b){if(b===this._bindingProtocol.kFunctionalityNotSupportedInSimulatorError)if(iAd.Bindings.SHIMS_ENABLED){iAd.Store.useShimOverride();iAd.BindingUtils.initializeBindingObject(this);this.startLoad()}else this.notifyLoaderDidFail(iAd.StoreItemLoader.UNSUPPORTED_IN_SIMULATOR_ERROR);else{var c;switch(b){case this._bindingProtocol.kItemNotFoundInStoreError:c=iAd.StoreItemLoader.ITEM_NOT_FOUND_ERROR;break;case this._bindingProtocol.kInsufficientValidTimeError:c=
iAd.StoreItemLoader.INSUFFICIENT_VALID_TIME_ERROR;break;case this._bindingProtocol.kNoMetadataForItemError:c=iAd.StoreItemLoader.NO_METADATA_ERROR;break;case this._bindingProtocol.kNoBuyParametersError:c=iAd.StoreItemLoader.NO_BUY_PARAMETERS_ERROR;break;default:c=iAd.StoreItemLoader.UNKNOWN_ERROR}this.notifyLoaderDidFail(c)}};iAd.StoreItemLoader.prototype.setStoreItem=function(){iAd.Console.warn(this.constructor.displayName+": storeItem is read-only.")};iAd.Class({name:"iAd.StoreAction",mixins:[iAd.EventTarget]});
iAd.StoreAction.DID_COMPLETE="storeActionDidComplete";iAd.StoreAction.DID_FAIL="storeActionDidFail";iAd.StoreAction.BINDING_OBJECT=iAd.Store.BINDING_OBJECT;iAd.StoreAction.BINDING_PROTOCOL=iAd.Store.BINDING_PROTOCOL;iAd.StoreAction.prototype.init=function(a){this.callSuper();iAd.BindingUtils.initializeBindingObject(this);if(!this._binding)throw iAd.BindingUtils.BINDING_UNAVAILABLE_ERROR;this.delegate=a;this.execute()};iAd.StoreAction.prototype.execute=function(){};
iAd.StoreAction.prototype.executeDidThrowError=function(a){this.notifyDidFail(iAd.BindingUtils.sanitizeMessageFromError(a))};iAd.StoreAction.prototype.notifyDidComplete=function(){this.notifyDelegate(iAd.StoreAction.DID_COMPLETE,this.delegate)};iAd.StoreAction.prototype.notifyDidFail=function(a,b){this.notifyDelegate(iAd.StoreAction.DID_FAIL,this.delegate,[["errorMessage",a],["errorCode",b||0]])};iAd.Class({name:"iAd.StoreRedeemCodeAction",superclass:iAd.StoreAction});
iAd.StoreRedeemCodeAction.BINDING_OBJECT=iAd.Store.BINDING_OBJECT;iAd.StoreRedeemCodeAction.BINDING_PROTOCOL=iAd.Store.BINDING_PROTOCOL;iAd.StoreRedeemCodeAction.prototype.init=function(a,b){this.redeemCode=a;this.callSuper(b)};iAd.StoreRedeemCodeAction.prototype.execute=function(){try{this._binding.redeemiTunesGiftCode(this.redeemCode,this)}catch(a){this.executeDidThrowError(a)}};iAd.StoreRedeemCodeAction.prototype.redeemCodeDidFail=function(a,b,c){this.notifyDidFail(b,c)};
iAd.StoreRedeemCodeAction.prototype.redeemCodeDidSucceed=function(){this.notifyDidComplete()};iAd.Store.redeemGiftCode=function(a,b){return new iAd.StoreRedeemCodeAction(a,b)};Object.defineProperty(iAd.Store,"redeemGiftCodeSupported",{get:function(){var a=iAd.BindingUtils.isBindingClassAvailable(iAd.StoreRedeemCodeAction),b=iAd.StoreRedeemCodeAction.BINDING_OBJECT;return a&&b.hasOwnProperty("redeemiTunesGiftCode")}});iAd.Class("iAd.ViewProcessor");
iAd.ViewProcessor.prototype.init=function(a){this.callSuper();this.viewController=a};iAd.ViewProcessor.prototype.processView=function(){};iAd.ViewProcessor.prototype.cleanUp=function(){};iAd.Class({name:"iAd.Control",superclass:iAd.View,synthesizedProperties:["state","enabled","selected","highlighted"],archivedProperties:["highlighted","enabled","selected","tag"],cssClassName:"ad-control",collectionAccessor:"controls"});iAd.Control.UNHIGHLIGHT_DELAY=0.1;
iAd.Control.prototype.init=function(a){this.tag=0;this._enabled=true;this._highlighted=this._selected=false;this.callSuper(a);this.layer._control=this;this.userInteractionEnabled=this._enabled;this.navigable=true};iAd.Control.VALUE_CHANGE_EVENT="controlValueChange";iAd.Control.STATE_NORMAL=0;iAd.Control.STATE_NORMAL_CSS="ad-normal";iAd.Control.STATE_HIGHLIGHTED=1;iAd.Control.STATE_HIGHLIGHTED_CSS="ad-highlighted";iAd.Control.STATE_DISABLED=2;iAd.Control.STATE_DISABLED_CSS="ad-disabled";
iAd.Control.STATE_SELECTED=4;iAd.Control.STATE_SELECTED_CSS="ad-selected";iAd.Control.synthesizedEvents=[iAd.Control.VALUE_CHANGE_EVENT];iAd.Control.prototype.getState=function(){return iAd.Control.STATE_NORMAL|(this._highlighted?iAd.Control.STATE_HIGHLIGHTED:0)|(this._enabled?0:iAd.Control.STATE_DISABLED)|(this._selected?iAd.Control.STATE_SELECTED:0)};
iAd.Control.prototype.setEnabled=function(a){if(a!=this._enabled){var b=this.layer;b.toggleClassName(iAd.Control.STATE_DISABLED_CSS,!a);b.setAttribute("aria-disabled",a?"false":"true");this.userInteractionEnabled=this._enabled=a;this.notifyPropertyChange("state")}};iAd.Control.prototype.setSelected=function(a){if(a!=this._selected){this.layer.toggleClassName(iAd.Control.STATE_SELECTED_CSS,a);this._selected=a;this.notifyPropertyChange("state")}};
iAd.Control.prototype.setHighlighted=function(a){this._snmHighlightedTimer&&clearTimeout(this._snmHighlightedTimer);if(a!=this._highlighted){this.layer.toggleClassName(iAd.Control.STATE_HIGHLIGHTED_CSS,a);this._highlighted=a;this.notifyPropertyChange("state")}};iAd.Control.prototype.handleSNMActivate=function(a){this.highlighted=true;this._snmHighlightedTimer=this.callMethodNameAfterDelay("setHighlighted",iAd.Control.UNHIGHLIGHT_DELAY,false);this.callSuper(a)};
iAd.Control.prototype.touchesBegan=function(a){if(this._enabled){this.callSuper(a);this.highlighted=true}};iAd.Control.prototype.touchesMoved=function(a){var b=this.touchInside;this.callSuper(a);if(b!=this.touchInside)this.highlighted=this.touchInside};iAd.Control.prototype.touchesEnded=function(a){this.callSuper(a);this.highlighted=false};iAd.Control.prototype.touchesCancelled=function(a){this.callSuper(a);this.highlighted=false};
iAd.Control.isNodeInControlHierarchyBoundedByElement=function(a,b){for(;a.parentNode;){if(a.hasOwnProperty("_view")&&a._view instanceof iAd.Control)return true;if(a===b)break;a=a.parentNode}return false};iAd.Class({name:"iAd.ActionsViewProcessor",superclass:iAd.ViewProcessor});iAd.ActionsViewProcessor.ATTR_NAME="ad-action";iAd.ActionsViewProcessor.prototype.init=function(a){this.callSuper(a);this.anchors=[]};
iAd.ActionsViewProcessor.prototype.processView=function(a){var b=iAd.ActionsViewProcessor.ATTR_NAME;b=a.layer.querySelectorAll("["+(iAd.Element.HTML5_CUSTOM_ATTRIBUTE_PREFIX+b)+"],["+b+"]");for(var c=0,d=b.length;c<d;c++){a=b[c];if(!a.hasOwnProperty("_adProcessedAction")){iAd.Event.registerForNotificationEvent(iAd.View.ACTIVATE_EVENT);a.addEventListener(iAd.View.ACTIVATE_EVENT,this,false);a.addEventListener("click",this,false);iAd.SpatialNavigationManager.sharedManager.addNavigableElement(a);a.addEventListener(iAd.SpatialNavigationManager.ACTIVATE_EVENT,
this,false);a._adProcessedAction=true;this.anchors.push(a)}}};iAd.ActionsViewProcessor.prototype.cleanUp=function(){for(var a;this.anchors.length;){a=this.anchors.pop();a.removeEventListener(iAd.View.ACTIVATE_EVENT,this,false);a.removeEventListener("click",this,false);a.removeEventListener(iAd.SpatialNavigationManager.ACTIVATE_EVENT,this,false);iAd.SpatialNavigationManager.sharedManager.removeNavigableElement(a);delete a._adProcessedAction}};
iAd.ActionsViewProcessor.prototype.handleEvent=function(a){var b=a.currentTarget;if(iAd.Element.hasCustomAttribute(b,iAd.ActionsViewProcessor.ATTR_NAME))if(!(a.type=="click"&&iAd.Control.isNodeInControlHierarchyBoundedByElement(a.target,b))){b=iAd.Element.getCustomAttribute(b,iAd.ActionsViewProcessor.ATTR_NAME);iAd.Utils.objectHasMethod(this.viewController,b)&&this.viewController[b](a)}};iAd.ViewController.addViewProcessor(iAd.ActionsViewProcessor);
iAd.Transaction={transitions:[],openTransactions:0,defaults:{},defaultsStates:[]};iAd.Transaction.begin=function(){if(this.openTransactions==0){this.transitions=[];this.defaults={}}else{var a={};iAd.Utils.copyPropertiesFromSourceToTarget(this.defaults,a);this.defaultsStates.push(a)}this.openTransactions++};iAd.Transaction.addTransition=function(a){for(var b in this.defaults)if(a[b]==null)a[b]=this.defaults[b];this.transitions.push(a)};
iAd.Transaction.commit=function(){if(this.openTransactions!=0){this.openTransactions--;if(this.openTransactions!=0)this.defaults=this.defaultsStates.pop();else{for(var a=this.transitions,b=0,c=a.length;b<c;b++)a[b].applyFromState();iAd.CSS.flushPendingUpdates();setTimeout(function(){for(;a.length;)a.pop().applyToState()},0)}}};iAd.Utils.setupDisplayNames(iAd.Transaction,"iAd.Transaction");
iAd.Class({name:"iAd.RootView",superclass:iAd.View,synthesizedProperties:["disablesDefaultScrolling","scrollsHorizontally","scrollsVertically"],archivedProperties:["disablesDefaultScrolling","scrollsHorizontally","scrollsVertically"],cssClassName:"ad-root-view"});
iAd.RootView.prototype.init=function(a){this.callSuper(a);if(this.layer===document.body){this.layerIsInDocument=true;this._size=new iAd.Size(window.innerWidth,window.innerHeight);this.layer.removeClassName("ad-view");window.addEventListener(iAd.Device.iOS_VERSION?"orientationchange":"resize",this,true)}this._scrollsHorizontally=false;this.disablesDefaultScrolling=this._scrollsVertically=true;iAd.RootView.sharedRoot=this};iAd.RootView.prototype.createLayer=function(){this.layer=document.body};
iAd.RootView.prototype.setDisablesDefaultScrolling=function(a){this._disablesDefaultScrolling=a;this.updateSize();iAd.HostScrollView||this.layer[a?"addEventListener":"removeEventListener"](iAd.Event.MOVE_EVENT,iAd.Event.preventDefault,false)};iAd.RootView.prototype.handleEvent=function(a){this.callSuper(a);if(a.type=="resize"||a.type=="orientationchange"){this.updateSize();this._disablesDefaultScrolling&&window.scrollTo(0,0)}};
iAd.RootView.prototype.updateSize=function(){if(this.layer===document.body)if(this._disablesDefaultScrolling)this.size=new iAd.Size(window.innerWidth,window.innerHeight);else{this._size=new iAd.Size(document.body.offsetWidth,document.body.offsetHeight);this.notifyPropertyChange("size")}};iAd.RootView._sharedRoot=null;
Object.defineProperty(iAd.RootView,"sharedRoot",{get:function(){if(iAd.RootView._sharedRoot==null)iAd.RootView._sharedRoot=new iAd.RootView;return iAd.RootView._sharedRoot},set:function(a){iAd.RootView._sharedRoot=a}});
iAd.RootView.init=function(){document.body.addClassName(iAd.Device.HAS_HIDPI_DISPLAY?"ad-HiDPI":"ad-LoDPI");iAd.Device.IS_IPAD&&document.body.addClassName("ad-iPad");if(iAd.RootView._sharedRoot==null){var a=document.querySelector("."+iAd.RootView.cssClassName);if(a!=null)iAd.RootView._sharedRoot=new iAd.RootView(a)}};window.addEventListener("DOMContentLoaded",iAd.RootView.init,true);iAd.Class({name:"iAd.RootViewController",superclass:iAd.ViewController,archivedProperties:["navigationController"]});
iAd.RootViewController.ID="root";iAd.RootViewController.prototype.init=function(a){a=a||{};a.id=iAd.RootViewController.ID;a.requiredFileURIs&&delete a.requiredFileURIs.contentView;this.callSuper(a);this.openBeginIgnoringInteractionEventsCalls=0;this.shouldArchiveView=false;iAd.RootViewController.sharedRootViewController=this};iAd.RootViewController.prototype.loadView=function(){this.view=iAd.RootView.sharedRoot};
iAd.RootViewController.prototype.archiveProperty=function(a){return a=="navigationController"?this._navigationController:this.callSuper(a)};iAd.RootViewController.prototype.beginIgnoringInteractionEvents=function(){this.openBeginIgnoringInteractionEventsCalls++;if(this.openBeginIgnoringInteractionEventsCalls==1)this.view.layer.style.pointerEvents="none"};
iAd.RootViewController.prototype.endIgnoringInteractionEvents=function(){if(this.openBeginIgnoringInteractionEventsCalls!=0){this.openBeginIgnoringInteractionEventsCalls--;if(this.openBeginIgnoringInteractionEventsCalls==0)this.view.layer.style.pointerEvents="auto"}};iAd.RootViewController.prototype.isIgnoringInteractionEvents=function(){return this.openBeginIgnoringInteractionEventsCalls>0};
Object.defineProperty(iAd.RootViewController,"sharedRootViewController",{get:function(){iAd.RootViewController.hasOwnProperty("_sharedRootViewController")||new iAd.RootViewController;return iAd.RootViewController._sharedRootViewController},set:function(a){iAd.RootViewController._sharedRootViewController=a}});
iAd.Class({name:"iAd.TransitionController",superclass:iAd.ViewController,synthesizedProperties:["visibleViewController","cachedViewControllers","loadingViewController"],archivedProperties:["visibleViewController","previouslyVisibleViewController","loadingViewController","loadingViewControllerMinimumDisplayTime"]});iAd.TransitionController.WILL_MAKE_VIEW_CONTROLLER_VISIBLE="transitionControllerWillMakeViewControllerVisibleAnimated";iAd.TransitionController.DID_MAKE_VIEW_CONTROLLER_VISIBLE="transitionControllerDidMakeViewControllerVisibleAnimated";
iAd.TransitionController.VIEW_IS_VISIBLE_STATE="ad-transition-controller-visible";iAd.TransitionController.VIEW_IS_HIDDEN_STATE="ad-transition-controller-hidden";iAd.TransitionController.VIEW_BUILDS_IN_STATE="ad-view-builds-in";iAd.TransitionController.VIEW_BUILDS_OUT_STATE="ad-view-builds-out";iAd.TransitionController.VIEW_BUILDS_IN_ACTION_LIST_CLASS="ad-view-builds-in-action-list";iAd.TransitionController.VIEW_BUILDS_OUT_ACTION_LIST_CLASS="ad-view-builds-out-action-list";
iAd.TransitionController.VIEW_IDLE_STATE="ad-view-is-idle";iAd.TransitionController.DEFAULT_TRANSITION_DURATION=0.35;iAd.TransitionController.WAITING_ON_DISPLAY_CSS_CLASS="ad-waiting-on-display";
iAd.TransitionController.prototype.init=function(a,b){this.callSuper(a);this._cachedViewControllers=[];this._loadingViewController=this._visibleViewController=null;this.loadingViewControllerMinimumDisplayTime=0;this.loadingViewControllerVisible=false;this.delegate=null;this.hidesLoadingViewControllerWithTransition=true;this.previouslyVisibleViewController=null;this.busy=false;if(b!=undefined)this.visibleViewController=b};iAd.TransitionController.prototype.loadView=function(){this.view=new iAd.TransitionControllerView};
iAd.TransitionController.prototype.setCachedViewControllers=function(a){for(var b,c=this._cachedViewControllers,d=0,e=c.length;d<e;d++){b=c[d];b!==this._visibleViewController&&a.indexOf(b)==-1&&b.view.removeFromSuperview()}d=0;for(e=a.length;d<e;d++){b=a[d];b!==this._visibleViewController&&c.indexOf(b)==-1&&this.attachViewController(b)}this._cachedViewControllers=a.slice()};
iAd.TransitionController.prototype.attachViewController=function(a){a=a.view;a.layer.addClassName(iAd.TransitionController.WAITING_ON_DISPLAY_CSS_CLASS);a.superview!==this._view&&this._view.addSubview(a)};iAd.TransitionController.prototype.setVisibleViewController=function(a){this.setVisibleViewControllerAnimated(a,false)};
iAd.TransitionController.prototype.setVisibleViewControllerAnimated=function(a,b){if(!(this.busy||this._visibleViewController===a)){iAd.RootViewController.sharedRootViewController.beginIgnoringInteractionEvents();this.transitionIsDelayedByPreviouslyVisibleViewController=false;this.previouslyVisibleViewController=this._visibleViewController;if(this._visibleViewController=a)a._transitionController=this;if(this.previouslyVisibleViewController!=null){this.previouslyVisibleViewController.viewWillDisappear(b);
this.transitionIsDelayedByPreviouslyVisibleViewController=this.prepareToHideViewController(this.previouslyVisibleViewController);iAd.SpatialNavigationManager.sharedManager.unregisterSubtree(this.previouslyVisibleViewController.view.layer)}if(a==null)this.performTransitionToViewController(a,b);else{this.attachViewController(a);this.nextVisibleViewController=a;this.willUseAnimationToTransitionToNextVisibleViewController=b;this.transitionIsDelayedByPreviouslyVisibleViewController||this.previousViewControllerDidUnblockTransitions();
a.isViewLoaded()||a.addPropertyObserver("viewWasProcessed",this,"viewControllerFinishedProcessingView")}}};
iAd.TransitionController.prototype.performTransitionToViewController=function(a,b){a!=null&&a.viewWillAppear(b);this.dispatchNotification(iAd.TransitionController.WILL_MAKE_VIEW_CONTROLLER_VISIBLE,this.delegate,[["newlyVisibleViewController",a],["previouslyVisibleViewController",this.previouslyVisibleViewController],["animated",b]]);a!=null&&this.prepareToShowViewController(a);iAd.Transaction.begin();var c,d=null;this.busy=b;iAd.Transaction.begin();iAd.Transaction.defaults.duration=b?iAd.TransitionController.DEFAULT_TRANSITION_DURATION:
0;if(this.previouslyVisibleViewController!=null){c=b?this.previouslyVisibleViewController.becomesHiddenTransition:null;if(c!=null)c=this.viewForTransition(this.previouslyVisibleViewController).applyTransition(c,false)}if(a!=null){d=b?a.becomesVisibleTransition:null;if(d!=null)d=this.viewForTransition(a).applyTransition(d,false)}if(d instanceof iAd.Transition)d.delegate=this;else if(c instanceof iAd.Transition)c.delegate=this;else b=false;iAd.Transaction.commit();if(a!=null){d?setTimeout(function(){a.view.layer.removeClassName(iAd.TransitionController.WAITING_ON_DISPLAY_CSS_CLASS)},
0):a.view.layer.removeClassName(iAd.TransitionController.WAITING_ON_DISPLAY_CSS_CLASS);iAd.SpatialNavigationManager.sharedManager.registerSubtree(a.view.layer)}this.hidesLoadingViewControllerWithTransition&&this.hideLoadingViewController();iAd.Transaction.commit();b||this.transitionDidComplete()};
iAd.TransitionController.prototype.performBuildInToViewController=function(a){var b=a.actionListNameByClassName[iAd.TransitionController.VIEW_BUILDS_IN_ACTION_LIST_CLASS];if(b){a.enterState(iAd.TransitionController.VIEW_BUILDS_IN_STATE);a.callMethodNameAfterDelay("startActionList",0,b)}};
iAd.TransitionController.prototype.prepareToHideViewController=function(a){var b=false;a.exitState(iAd.TransitionController.VIEW_IS_VISIBLE_STATE);a.enterState(iAd.TransitionController.VIEW_IS_HIDDEN_STATE);a.exitState(iAd.TransitionController.VIEW_IDLE_STATE);var c=a.actionListNameByClassName[iAd.TransitionController.VIEW_BUILDS_OUT_ACTION_LIST_CLASS];if(c){a.enterState(iAd.TransitionController.VIEW_BUILDS_OUT_STATE);a.startActionList(c);if(a.buildOutActionListShouldDelayTransition)b=true}return b};
iAd.TransitionController.prototype.prepareToShowViewController=function(a){a.exitState(iAd.TransitionController.VIEW_BUILDS_OUT_STATE);a.exitState(iAd.TransitionController.VIEW_IS_HIDDEN_STATE);a.enterState(iAd.TransitionController.VIEW_IS_VISIBLE_STATE);a.exitState(iAd.TransitionController.VIEW_IDLE_STATE);a.buildInActionListShouldOccurAfterTransition||this.performBuildInToViewController(a)};
iAd.TransitionController.prototype.viewControllerActionListDidComplete=function(a,b){if(a.isInState(iAd.TransitionController.VIEW_BUILDS_IN_STATE)||a.isInState(iAd.TransitionController.VIEW_BUILDS_OUT_STATE)){var c=b.cssClassName;if(c===iAd.TransitionController.VIEW_BUILDS_OUT_ACTION_LIST_CLASS){a.exitState(iAd.TransitionController.VIEW_BUILDS_OUT_STATE);if(this.transitionIsDelayedByPreviouslyVisibleViewController){this.transitionIsDelayedByPreviouslyVisibleViewController=false;this.previousViewControllerDidUnblockTransitions()}else if(a===
this._loadingViewController){this.detachLoadingViewControllerAnimated(a.becomesHiddenTransition!=null);a.buildOutActionListShouldDelayTransition&&this.showNextViewControllerIfReady()}}else if(c===iAd.TransitionController.VIEW_BUILDS_IN_ACTION_LIST_CLASS){a.exitState(iAd.TransitionController.VIEW_BUILDS_IN_STATE);if(!this.busy){a.enterState(iAd.TransitionController.VIEW_IDLE_STATE);a===this._loadingViewController&&this.showNextViewControllerIfReady()}}}};
iAd.TransitionController.prototype.viewControllerFinishedProcessingView=function(a){a.removePropertyObserver("viewWasProcessed",this);this.showNextViewControllerIfReady()};iAd.TransitionController.prototype.previousViewControllerDidUnblockTransitions=function(){var a=this.nextVisibleViewController,b=a.viewLoadingDelaysTransition&&!a.isViewLoaded();if(!a.disableLoadingViewController&&this._loadingViewController&&b)this.showLoadingViewController();else b||this.performTransitionToViewController(a,this.willUseAnimationToTransitionToNextVisibleViewController)};
iAd.TransitionController.prototype.viewForTransition=function(a){var b=a.view;if(b.size.equals(iAd.Size.ZERO_SIZE)&&a.contentView!=null)b=a.contentView;return b};iAd.TransitionController.prototype.viewControllerViewDidAppear=function(a,b){a.buildInActionListShouldOccurAfterTransition&&this.performBuildInToViewController(a);a.viewDidAppear(b)};iAd.TransitionController.prototype.viewControllerViewDidDisappear=function(a,b){a.viewDidDisappear(b)};
iAd.TransitionController.prototype.contentTransitionDidComplete=function(){iAd.RootViewController.sharedRootViewController.endIgnoringInteractionEvents();var a=this._wasAnimatedTransition=this.busy;if(this.previouslyVisibleViewController!=null){this._cachedViewControllers.indexOf(this.previouslyVisibleViewController)==-1?this.previouslyVisibleViewController.view.removeFromSuperview():this.previouslyVisibleViewController.view.layer.addClassName(iAd.TransitionController.WAITING_ON_DISPLAY_CSS_CLASS);
this.viewControllerViewDidDisappear(this.previouslyVisibleViewController,a)}if(this._visibleViewController!=null)this.loadingViewControllerVisible&&!this.hidesLoadingViewControllerWithTransition?this.hideLoadingViewController():this.notifyVisibleViewControllerDidAppear();this.busy=false;this.dispatchNotification(iAd.TransitionController.DID_MAKE_VIEW_CONTROLLER_VISIBLE,this.delegate,[["newlyVisibleViewController",this._visibleViewController],["previouslyVisibleViewController",this.previouslyVisibleViewController],
["animated",a]])};iAd.TransitionController.prototype.notifyVisibleViewControllerDidAppear=function(){this.viewControllerViewDidAppear(this._visibleViewController,this._wasAnimatedTransition);this._wasAnimatedTransition=false;if(!this._visibleViewController.actionListNameByClassName[iAd.TransitionController.VIEW_BUILDS_IN_ACTION_LIST_CLASS]||!this._visibleViewController.isInState(iAd.TransitionController.VIEW_BUILDS_IN_STATE))this._visibleViewController.enterState(iAd.TransitionController.VIEW_IDLE_STATE)};
iAd.TransitionController.prototype.setLoadingViewController=function(a){if(!this.loadingViewControllerVisible){a&&!a.isViewLoading()&&!a.isViewLoaded()&&this.attachViewController(a);if(this._loadingViewController=a)a._transitionController=this}};
iAd.TransitionController.prototype.showLoadingViewController=function(){if(!(this.loadingViewControllerVisible||this._loadingViewController==null)){var a=this._loadingViewController,b=a.view,c=a.becomesVisibleTransition!=null;a.view.layer.removeClassName(iAd.TransitionController.WAITING_ON_DISPLAY_CSS_CLASS);a.viewWillAppear(c);this.prepareToShowViewController(this._loadingViewController);if(c){b.size=this._view.size.copy();b.autoresizingMask=iAd.View.AUTORESIZING_FLEXIBLE_WIDTH|iAd.View.AUTORESIZING_FLEXIBLE_HEIGHT;
b.applyTransition(a.becomesVisibleTransition,false).delegate=this}this._view.addSubview(b);this.loadingViewControllerVisible=true;if(this.loadingViewControllerMinimumDisplayTime>0){this.loadingViewDisplayTime=new Date;this.callMethodNameAfterDelay("showNextViewControllerIfReady",this.loadingViewControllerMinimumDisplayTime)}if(!c){this.viewControllerViewDidAppear(a,false);this.showNextViewControllerIfReady()}}};
iAd.TransitionController.prototype.hideLoadingViewController=function(){if(this.loadingViewControllerVisible){var a=this._loadingViewController;if(!a.isInState(iAd.ViewController.VIEW_WILL_DISAPPEAR_STATE)){var b=a.becomesHiddenTransition!=null;a.viewWillDisappear(b);this.prepareToHideViewController(a);a.actionListNameByClassName[iAd.TransitionController.VIEW_BUILDS_OUT_ACTION_LIST_CLASS]||this.detachLoadingViewControllerAnimated(b)}}};
iAd.TransitionController.prototype.detachLoadingViewControllerAnimated=function(a){var b=this._loadingViewController;if(a)b.view.applyTransition(b.becomesHiddenTransition,false).delegate=this;else{b.view.removeFromSuperview();this.viewControllerViewDidDisappear(b,false)}this.loadingViewControllerVisible=false};
iAd.TransitionController.prototype.loadingViewControllerTransitionDidComplete=function(){if(this.loadingViewControllerVisible){this.viewControllerViewDidAppear(this._loadingViewController,true);this.showNextViewControllerIfReady()}else{this._loadingViewController.view.removeFromSuperview();this.viewControllerViewDidDisappear(this._loadingViewController,true);this.hidesLoadingViewControllerWithTransition||this.notifyVisibleViewControllerDidAppear()}};
iAd.TransitionController.prototype.showNextViewControllerIfReady=function(){if(!this.transitionIsDelayedByPreviouslyVisibleViewController){if(this.loadingViewControllerVisible){var a=this._loadingViewController;if(a.isInState(iAd.TransitionController.VIEW_BUILDS_IN_STATE)||a.isInState(iAd.ViewController.VIEW_WILL_APPEAR_STATE))return;if(this.loadingViewControllerMinimumDisplayTime>0)if((Date.now()-this.loadingViewDisplayTime)/1E3<this.loadingViewControllerMinimumDisplayTime)return;if(this.hidesLoadingViewControllerWithTransition)if(a.actionListNameByClassName[iAd.TransitionController.VIEW_BUILDS_OUT_ACTION_LIST_CLASS]&&
a.buildOutActionListShouldDelayTransition){this.hideLoadingViewController();return}}(a=this.nextVisibleViewController)&&a.viewLoadingDelaysTransition&&!a.isViewLoaded()||a.isInState(iAd.ViewController.VIEW_WILL_APPEAR_STATE)||a.isInState(iAd.ViewController.VIEW_DID_APPEAR_STATE)||this.performTransitionToViewController(a,this.willUseAnimationToTransitionToNextVisibleViewController)}};
iAd.TransitionController.prototype.transitionDidComplete=function(a){a&&this._loadingViewController!=null&&a.target===this._loadingViewController.view?this.loadingViewControllerTransitionDidComplete(a):this.contentTransitionDidComplete(a)};iAd.Class({name:"iAd.TransitionControllerView",superclass:iAd.View,cssClassName:"ad-transition-controller-view"});iAd.TransitionControllerView.prototype.init=function(a){this.callSuper(a);this.autoresizingMask=iAd.View.AUTORESIZING_FLEXIBLE_WIDTH|iAd.View.AUTORESIZING_FLEXIBLE_HEIGHT};
iAd.TransitionControllerView.prototype.willMoveToSuperview=function(a){this.callSuper(a);if(a!=null&&this._size.equals(iAd.Size.ZERO_SIZE))this.size=a.size.copy()};iAd.ViewController.prototype.getTransitionController=function(){return this._transitionController||this.parentControllerOfKind(iAd.TransitionController)};iAd.Class.synthesizeProperties(iAd.ViewController,["transitionController"]);
iAd.RootViewController.prototype.getTransitionController=function(){if(!this.hasOwnProperty("_transitionController")){var a=iAd.RootView.sharedRoot,b=new iAd.TransitionController;b.view.size=a.size.copy();b.delegate=this;a.addSubview(b.view,0);this._transitionController=b}return this._transitionController};iAd.Class.synthesizeProperties(iAd.RootViewController,["transitionController"]);
iAd.Class({name:"iAd.NavigationController",superclass:iAd.ViewController,synthesizedProperties:["viewControllers","topViewController","visibleViewController","navigationBarHidden","toolbar","navigationBar","toolbarHidden"],archivedProperties:["viewControllers","navigationBarHidden","toolbarHidden","autoReversesTransitions"]});iAd.NavigationController.WILL_SHOW_VIEW_CONTROLLER="navigationControllerWillShowViewControllerAnimated";iAd.NavigationController.DID_SHOW_VIEW_CONTROLLER="navigationControllerDidShowViewControllerAnimated";
iAd.NavigationController.HIDE_SHOW_BAR_DURATION=0.2;iAd.NavigationController.POPOVER_OFFSET=6;
iAd.NavigationController.prototype.init=function(a,b){this.callSuper(a);this.delegate=null;this._viewControllers=[];this.shouldAnimateInitialViewController=this.autoReversesTransitions=false;this.previousController=null;this.viewAppearancePropagationProperty="visibleViewController";this.shouldArchiveView=false;this.delayedSetOperationArguments=null;this.backingTransitionController=new iAd.TransitionController;this.backingTransitionController.delegate=this;this._navigationBarHidden=false;this._toolbarHidden=
true;this._toolbar=this._navigationBar=null;this.requiresDeferredHostViewSizeUpdate=false;if(b!=null)this.viewControllers=[b]};
iAd.NavigationController.prototype.loadView=function(){var a=new iAd.NavigationView(this);this.view=a;a.layer.addClassName("ad-navigation-controller-view");a.size=new iAd.Size(window.innerWidth,window.innerHeight);a.autoresizingMask=iAd.View.AUTORESIZING_FLEXIBLE_WIDTH|iAd.View.AUTORESIZING_FLEXIBLE_HEIGHT;a.clipsToBounds=true;!this._navigationBarHidden&&this.navigationBar&&a.addSubview(this.navigationBar);this.hostView=a.addSubview(this.backingTransitionController.view);this.hostView.layer.addClassName("ad-navigation-controller-host-view");
!this._toolbarHidden&&this.toolbar&&a.addSubview(this.toolbar);a.addPropertyObserver("size",this,"sizeChanged");this.sizeChanged();this.performDelayedSetOperation();var b=this.topViewController?this.topViewController.view:null;if(b&&b.superview!=this.hostView){b.size=this.hostView.size.copy();b.autoresizingMask=iAd.View.AUTORESIZING_FLEXIBLE_WIDTH|iAd.View.AUTORESIZING_FLEXIBLE_HEIGHT;this.hostView.addSubview(b)}a.layer.addEventListener(iAd.SpatialNavigationManager.NAVIGATE_EVENT,this,false)};
iAd.NavigationController.prototype.viewMovedToNewSuperview=function(){var a=this._navigationBar;if(a){a=a.topItem;a!=null&&a.updateLayoutIfTopItem()}};iAd.NavigationController.prototype.unloadView=function(){if(this.hostView){this.hostView.removeFromSuperview();this.hostView=null}if(this._toolbar){this._toolbar.removeFromSuperview();this._toolbar=null}if(this._navigationBar){this._navigationBar.removeFromSuperview();this._navigationBar=null}this.callSuper()};
iAd.NavigationController.prototype.didReceiveMemoryWarning=function(){this.callSuper();for(var a=this._viewControllers.length-(this._view?2:0),b=0;b<a;b++)this._viewControllers[b].unloadView()};iAd.NavigationController.prototype.handleEvent=function(a){if(iAd.SpatialNavigationManager&&a.type==iAd.SpatialNavigationManager.NAVIGATE_EVENT){if(a.ad.command==iAd.Event.KEYBOARD_BACKSPACE){this.popViewControllerAnimated(true);a.preventDefault()}}else this.callSuper(a)};
iAd.NavigationController.prototype.getNavigationBar=function(){var a=this._navigationBar;if(!a){if(!iAd.NavigationBar){iAd.Console.warn("iAd.NavigationController: Attempting to create a navigation bar but iAd.NavigationBar is undefined; navigationBarHidden will be set to true. You must explicitly require iAd.NavigationBar in your project.");this._navigationBarHidden=true;return null}a=this._navigationBar=new iAd.NavigationBar;a.autoresizingMask=iAd.View.AUTORESIZING_FLEXIBLE_WIDTH;if(this.isViewLoaded())a.size=
new iAd.Size(this.view.size.width,iAd.NavigationBar.DEFAULT_HEIGHT)}return a};
iAd.NavigationController.prototype.getToolbar=function(){var a=this._toolbar;if(!a){if(!iAd.Toolbar){iAd.Console.warn("iAd.NavigationController: Attempting to create a toolbar but iAd.Toolbar is undefined; toolbarHidden will be set to true. You must explicitly require iAd.Toolbar in your project.");this._toolbarHidden=true;return null}a=this._toolbar=new iAd.Toolbar;a.autoresizingMask=iAd.View.AUTORESIZING_FLEXIBLE_WIDTH;if(this.isViewLoaded())a.size=new iAd.Size(this.view.size.width,iAd.Toolbar.DEFAULT_HEIGHT)}return a};
iAd.NavigationController.prototype.getTopViewController=function(){return this.viewControllers.length>0?this.viewControllers[this.viewControllers.length-1]:null};iAd.NavigationController.prototype.getVisibleViewController=function(){var a=this.topViewController;return a.modalViewController||a};iAd.NavigationController.prototype.getViewControllers=function(){return this.delayedSetOperationArguments!=null?this.delayedSetOperationArguments[0]:this._viewControllers};
iAd.NavigationController.prototype.setViewControllers=function(a){this.setViewControllersAnimated(a,false)};
iAd.NavigationController.prototype.setViewControllersAnimated=function(a,b){if(a.length!=0)if(this.shouldDelaySetOperation())this.delayedSetOperationArguments=arguments;else{iAd.Transaction.begin();var c=this._viewControllers.length>0?this._viewControllers[this._viewControllers.length-1]:null,d=a[a.length-1],e=this._viewControllers.indexOf(d)!=-1,f=!c&&b?this.shouldAnimateInitialViewController:b;this.dispatchWillShowNotification(d,f);for(var g=0,h=this._viewControllers.length;g<h;g++)this._viewControllers[g].parentViewController=
null;g=0;for(h=a.length;g<h;g++)a[g].parentViewController=this;this._viewControllers=a;this.prepareViewControllersForTransition(c,d,e);this.backingTransitionController.setVisibleViewControllerAnimated(d,f);iAd.Transaction.commit()}};
iAd.NavigationController.prototype.prepareViewControllersForTransition=function(a,b,c){if(a==null)b.becomesVisibleTransition=b.becomesTopItemTransition;else if(a!==b)if(this.autoReversesTransitions){a.becomesHiddenTransition=c?a.wasTopItemTransition:b.becomesBackItemTransition;b.becomesVisibleTransition=c?a.wasBackItemTransition:b.becomesTopItemTransition}else{a.becomesHiddenTransition=c?a.wasTopItemTransition:a.becomesBackItemTransition;b.becomesVisibleTransition=c?b.wasBackItemTransition:b.becomesTopItemTransition}b.view.size=
this.hostView.size.copy();b.view.autoresizingMask=iAd.View.AUTORESIZING_FLEXIBLE_WIDTH|iAd.View.AUTORESIZING_FLEXIBLE_HEIGHT};iAd.NavigationController.prototype.shouldDelaySetOperation=function(){return!this.isViewLoaded()||this.backingTransitionController.busy||!this.navigationBarHidden&&this.navigationBar.busy};
iAd.NavigationController.prototype.pushViewControllerAnimated=function(a,b){this.viewControllers.indexOf(a)!=-1?iAd.Console.warn("iAd.NavigationController.prototype.pushViewControllerAnimated: attempt to push a view controller already in the stack"):this.setViewControllersAnimated(this.viewControllers.concat([a]),b)};
iAd.NavigationController.prototype.popViewControllerAnimated=function(a){if(this.viewControllers.length>1){var b=this.topViewController;this.setViewControllersAnimated(this.viewControllers.slice(0,this.viewControllers.length-1),a);return b}return null};iAd.NavigationController.prototype.popToRootViewControllerAnimated=function(a){return this.popToViewControllerAnimated(this.viewControllers[0],a)};
iAd.NavigationController.prototype.popToViewControllerAnimated=function(a,b){var c=this.viewControllers.indexOf(a);if(c<0||c>=this.viewControllers.length-1)return[];var d=this.viewControllers.slice(c+1);this.setViewControllersAnimated(this.viewControllers.slice(0,c+1),b);return d};
iAd.NavigationController.prototype.transitionControllerWillMakeViewControllerVisibleAnimated=function(a,b,c,d){if(a=this._navigationBar){c=[];for(var e=0,f=this._viewControllers.length;e<f;e++)c.push(this._viewControllers[e].navigationItem);a.setItemsAnimated(c,this.navigationBarHidden?false:d)}(a=this._toolbar)&&a.setItemsAnimated(b.toolbarItems,d)};
iAd.NavigationController.prototype.transitionControllerDidMakeViewControllerVisibleAnimated=function(a,b,c,d){this.dispatchDidShowNotification(b,d);this.performDelayedSetOperation()};iAd.NavigationController.prototype.dispatchDidShowNotification=function(a,b){this.dispatchNotification(iAd.NavigationController.DID_SHOW_VIEW_CONTROLLER,this.delegate,[["viewController",a],["animated",b]])};
iAd.NavigationController.prototype.dispatchWillShowNotification=function(a,b){this.dispatchNotification(iAd.NavigationController.WILL_SHOW_VIEW_CONTROLLER,this.delegate,[["viewController",a],["animated",b]])};
iAd.NavigationController.prototype.performDelayedSetOperation=function(){if(this.delayedSetOperationArguments!=null)if(this._navigationBar&&this.navigationBar.busy)this.navigationBar.addPropertyObserver("busy",this,"navigationBarBusyStateChanged");else{this.setViewControllersAnimated(this.delayedSetOperationArguments[0],this.delayedSetOperationArguments[1]);this.delayedSetOperationArguments=null}};
iAd.NavigationController.prototype.navigationBarBusyStateChanged=function(){if(!(this._navigationBar&&this.navigationBar.busy)){this.navigationBar.removePropertyObserver("busy",this,"navigationBarBusyStateChanged");this.performDelayedSetOperation()}};
iAd.NavigationController.prototype.sizeChanged=function(){var a=this.hostedInPopoverController(),b=iAd.NavigationBar?-iAd.NavigationBar.DEFAULT_HEIGHT:0,c=0,d=this._view.size.height;if(!this._navigationBarHidden){b=a?-iAd.NavigationController.POPOVER_OFFSET:0;c+=iAd.NavigationBar.DEFAULT_HEIGHT-(a?iAd.NavigationController.POPOVER_OFFSET:0)}this._toolbarHidden||(d-=iAd.Toolbar.DEFAULT_HEIGHT-(a?iAd.NavigationController.POPOVER_OFFSET+1:0));this.hostView.position=new iAd.Point(0,c);if(a=this._navigationBar)a.position=
new iAd.Point(0,b);if(this._toolbar)this.toolbar.position=new iAd.Point(0,d);this.updateHostViewSize()};iAd.NavigationController.prototype.updateHostViewSize=function(){var a=this._view.size.height,b=this.hostedInPopoverController();this._navigationBarHidden||(a-=iAd.NavigationBar.DEFAULT_HEIGHT-(b?iAd.NavigationController.POPOVER_OFFSET:0));this._toolbarHidden||(a-=iAd.Toolbar.DEFAULT_HEIGHT-(b?iAd.NavigationController.POPOVER_OFFSET:0));this.hostView.size=new iAd.Size(this._view.size.width,a)};
iAd.NavigationController.prototype.hostedInPopoverController=function(){return iAd.Utils.objectIsInstanceOfClass(this.parentViewController,iAd.PopoverController)};iAd.NavigationController.prototype.setNavigationBarHidden=function(a){this.setNavigationBarHiddenAnimated(a,false)};
iAd.NavigationController.prototype.setNavigationBarHiddenAnimated=function(a,b){if(this._navigationBarHidden!=a){this._navigationBarHidden=a;if(this.isViewLoaded()){var c=this._navigationBar;if(!(!c&&a)){var d=this.hostedInPopoverController(),e=new iAd.Point(0,a?-iAd.NavigationBar.DEFAULT_HEIGHT:d?-iAd.NavigationController.POPOVER_OFFSET:0);d=new iAd.Point(0,a?0:iAd.NavigationBar.DEFAULT_HEIGHT-(d?iAd.NavigationController.POPOVER_OFFSET:0));a||this.view.addSubview(this.navigationBar);if(b){iAd.Transaction.begin();
iAd.Transaction.defaults.duration=b?iAd.NavigationController.HIDE_SHOW_BAR_DURATION:0;iAd.Transaction.defaults.properties=["position"];c.applyTransition({to:[e],removesTargetUponCompletion:a});this.hostView.applyTransition({to:[d],delegate:this});iAd.Transaction.commit();if(a)this.updateHostViewSize();else this.requiresDeferredHostViewSizeUpdate=true}else{c.position=e;this.hostView.position=d;this.updateHostViewSize();a&&c.removeFromSuperview()}}}}};
iAd.NavigationController.prototype.transitionDidComplete=function(){if(this.requiresDeferredHostViewSizeUpdate){this.requiresDeferredHostViewSizeUpdate=false;this.updateHostViewSize()}};iAd.NavigationController.prototype.setToolbarHidden=function(a){this.setToolbarHiddenAnimated(a,false)};
iAd.NavigationController.prototype.setToolbarHiddenAnimated=function(a,b){if(this._toolbarHidden!=a){this._toolbarHidden=a;if(this.isViewLoaded())if(!(!this._toolbar&&a)){var c=new iAd.Point(0,this._view.size.height-(a?0:iAd.Toolbar.DEFAULT_HEIGHT));if(this.hostedInPopoverController())c.y+=iAd.NavigationController.POPOVER_OFFSET;a||this.view.addSubview(this.toolbar);if(b){(new iAd.Transition({target:this.toolbar,properties:["position"],to:[c],duration:b?iAd.NavigationController.HIDE_SHOW_BAR_DURATION:
0,delegate:this,removesTargetUponCompletion:a})).start();if(a)this.updateHostViewSize();else this.requiresDeferredHostViewSizeUpdate=true;this.notifyPropertyChange("toolbarHidden")}else{this.toolbar.position=c;this.updateHostViewSize();a&&this.toolbar.removeFromSuperview()}}}};iAd.Class({name:"iAd.NavigationView",superclass:iAd.View});iAd.NavigationView.prototype.init=function(a){this.callSuper();this.viewController=a};
iAd.NavigationView.prototype.didMoveToSuperview=function(a){this.callSuper(a);a!=null&&this.viewController.viewMovedToNewSuperview()};iAd.ViewController.prototype.getNavigationController=function(){return this.parentControllerOfKind(iAd.NavigationController)};iAd.ViewController.prototype.getNavigationItem=function(){if(this._navigationItem==null){this._navigationItem=new iAd.NavigationItem(this.title);this._navigationItem.viewController=this}return this._navigationItem};
iAd.ViewController.prototype.setToolbarItems=function(a){this.setToolbarItemsAnimated(a,false)};iAd.ViewController.prototype.setToolbarItemsAnimated=function(a,b){if(a){this._toolbarItems=a;var c=this.parentViewController;c!=null&&c instanceof iAd.NavigationController&&c.toolbar.setItemsAnimated(a,b)}};iAd.Class.synthesizeProperties(iAd.ViewController,["navigationController","navigationItem","toolbarItems"]);iAd.Class.processMethods(iAd.ViewController,["setToolbarItemsAnimated"]);
iAd.RootViewController.prototype.getNavigationController=function(){if(!this.hasOwnProperty("_navigationController"))this.navigationController=new iAd.NavigationController;return this._navigationController};iAd.RootViewController.prototype.setNavigationController=function(a){a.navigationBarHidden=true;a.shouldAnimateInitialViewController=true;a.delegate=this;var b=this.view;a.view.size=b._size.copy();b.addSubview(a.view);this._navigationController=a};
iAd.Class.synthesizeProperties(iAd.RootViewController,["navigationController"]);iAd.Class({name:"iAd.ViewControllerReferencingViewProcessor",superclass:iAd.ViewProcessor});iAd.ViewControllerReferencingViewProcessor.prototype.init=function(a){this.callSuper(a);this.anchors=[]};
iAd.ViewControllerReferencingViewProcessor.prototype.processView=function(a){var b=this.constructor.PROCESSED_KEY,c=this.constructor.ATTR_NAME;c=a.layer.querySelectorAll("["+(iAd.Element.HTML5_CUSTOM_ATTRIBUTE_PREFIX+c)+"],["+c+"]");for(var d=0,e=c.length;d<e;d++){a=c[d];if(!a.hasOwnProperty(b)){iAd.Event.registerForNotificationEvent(iAd.View.ACTIVATE_EVENT);a.addEventListener(iAd.View.ACTIVATE_EVENT,this,false);a.addEventListener("click",this,false);iAd.SpatialNavigationManager.sharedManager.addNavigableElement(a);
a.addEventListener(iAd.SpatialNavigationManager.ACTIVATE_EVENT,this,false);a[b]=true;this.anchors.push(a)}}};
iAd.ViewControllerReferencingViewProcessor.prototype.cleanUp=function(){for(var a=this.constructor.PROCESSED_KEY,b;this.anchors.length;){b=this.anchors.pop();b.removeEventListener(iAd.View.ACTIVATE_EVENT,this,false);b.removeEventListener("click",this,false);b.removeEventListener(iAd.SpatialNavigationManager.ACTIVATE_EVENT,this,false);iAd.SpatialNavigationManager.sharedManager.removeNavigableElement(b);delete b[a]}};
iAd.ViewControllerReferencingViewProcessor.prototype.shouldHandleEvent=function(a){var b=a.currentTarget;if(!iAd.Element.hasCustomAttribute(b,this.constructor.ATTR_NAME))return false;if(a.type=="click"&&iAd.Control.isNodeInControlHierarchyBoundedByElement(a.target,b))return false;return true};iAd.Class({name:"iAd.NavigationViewProcessor",superclass:iAd.ViewControllerReferencingViewProcessor});iAd.NavigationViewProcessor.PREVIOUS_ITEM_ID="{previous-item}";iAd.NavigationViewProcessor.ATTR_NAME="ad-navigates-to";
iAd.NavigationViewProcessor.PROCESSED_KEY="_adProcessedNavigatesTo";
iAd.NavigationViewProcessor.prototype.handleEvent=function(a){if(this.shouldHandleEvent(a)){var b=iAd.Element.getCustomAttribute(a.currentTarget,iAd.NavigationViewProcessor.ATTR_NAME);a=iAd.RootViewController.sharedRootViewController.navigationController;if(b==iAd.NavigationViewProcessor.PREVIOUS_ITEM_ID)a.popViewControllerAnimated(true);else if(b=iAd.ViewController.instances[b])a.viewControllers.indexOf(b)!=-1?a.popToViewControllerAnimated(b,true):a.pushViewControllerAnimated(b,true)}};iAd.ViewController.addViewProcessor(iAd.NavigationViewProcessor);
iAd.Class({name:"iAd.OutletsViewProcessor",superclass:iAd.ViewProcessor});iAd.OutletsViewProcessor.prototype.init=function(a){this.callSuper(a);this.outlets=[]};iAd.OutletsViewProcessor.prototype.processView=function(a){for(var b=a.layer.querySelectorAll("["+(iAd.Element.HTML5_CUSTOM_ATTRIBUTE_PREFIX+"ad-outlet")+"],[ad-outlet]"),c=0,d=b.length;c<d;c++){a=b[c];this.viewController.outlets[iAd.Element.getCustomAttribute(a,"ad-outlet")]=a.hasOwnProperty("_view")?a._view:a}};
iAd.OutletsViewProcessor.prototype.cleanUp=function(){for(var a in this.viewController.outlets)delete this.viewController.outlets[a]};iAd.ViewController.addViewProcessor(iAd.OutletsViewProcessor);iAd.Class({name:"iAd.PageControl",superclass:iAd.Control,synthesizedProperties:["currentPage","numberOfPages","hidesForSinglePage"],archivedProperties:["numberOfPages","currentPage","hidesForSinglePage","defersCurrentPageDisplay"],cssClassName:"ad-page-control",collectionAccessor:"pageControls"});
iAd.PageControl.DEFAULT_SIZE=6;iAd.PageControl.MARGIN=10;iAd.PageControl.SELECTED_CSS="ad-selected";iAd.PageControl.prototype.init=function(a){this.dots=[];this.defersCurrentPageDisplay=false;this._numberOfPages=this._currentPage=0;this._hidesForSinglePage=false;this.callSuper(a);this.addEventListener(iAd.View.ACTIVATE_EVENT,this,false)};
iAd.PageControl.prototype.setSize=function(a){a.width=Math.max(a.width,iAd.PageControl.DEFAULT_SIZE);a.height=Math.max(a.height,iAd.PageControl.DEFAULT_SIZE);this.callSuper(a);this.updateLayout()};iAd.PageControl.prototype.setCurrentPage=function(a){if(!(this._currentPage==a||a<0||a>=this.numberOfPages)){this._currentPage=a;this.defersCurrentPageDisplay||this.updateCurrentPageDisplay();this.createAndDispatchEvent(iAd.Control.VALUE_CHANGE_EVENT)}};
iAd.PageControl.prototype.setNumberOfPages=function(a){if(!(this._numberOfPages==a||a<0)){if(this.dots.length>a)for(;this.dots.length>a;)this.layer.removeChild(this.dots.pop());else for(;this.dots.length<a;)this.dots.push(this.layer.appendChild(document.createElement("div")));this._numberOfPages=a;this.updateCurrentPageDisplay();this.updateLayout();this.updateVisibility()}};iAd.PageControl.prototype.setHidesForSinglePage=function(a){this._hidesForSinglePage=a;this.updateVisibility()};
iAd.PageControl.prototype.updateCurrentPageDisplay=function(){var a=this.layer.querySelector("."+iAd.PageControl.SELECTED_CSS);a&&a.removeClassName(iAd.PageControl.SELECTED_CSS);this.currentPage>=0&&this.currentPage<this.dots.length&&this.dots[this.currentPage].addClassName(iAd.PageControl.SELECTED_CSS)};iAd.PageControl.prototype.sizeForNumberOfPages=function(a){return a*(iAd.PageControl.DEFAULT_SIZE+iAd.PageControl.MARGIN)};
iAd.PageControl.prototype.updateLayout=function(){this.setLayerStyle({"padding-left":Math.max(0,(this.size.width-this.sizeForNumberOfPages(this._numberOfPages))/2)+"px","padding-top":(this.size.height-iAd.PageControl.DEFAULT_SIZE)/2+"px"})};iAd.PageControl.prototype.updateVisibility=function(){this.setLayerStyle({visibility:this.numberOfPages==1&&this.hidesForSinglePage?"hidden":"visible"})};
iAd.PageControl.prototype.handleEvent=function(a){this.callSuper(a);if(!(this.numberOfPages<=1))if(a.type==iAd.View.ACTIVATE_EVENT&&a.ad.originalEvent.type==iAd.Event.END_EVENT){a=a.ad.originalEvent;a=iAd.Point.fromEventInElement(a,this.layer).x;var b=this.dots[this.currentPage].offsetLeft;if(a<=b-iAd.PageControl.MARGIN/2)this.currentPage--;else a>=b+iAd.PageControl.DEFAULT_SIZE+iAd.PageControl.MARGIN/2&&this.currentPage++}else if(a.type==iAd.View.ACTIVATE_EVENT)this.currentPage=(this.numberOfPages+
(this.currentPage+1)%this.numberOfPages)%this.numberOfPages};iAd.Number={};iAd.Number.degreesToRadians=function(a){return a/360*Math.PI*2};iAd.Number.radiansToDegrees=function(a){return a/(Math.PI*2)*360};iAd.Number.clampValue=function(a,b,c){return Math.min(Math.max(a,b),c)};iAd.Utils.setupDisplayNames(iAd.Number,"iAd.Number");iAd.Class({name:"iAd.ScrollIndicator",superclass:iAd.View,synthesizedProperties:["visible","width","height","indicatorStyle"]});iAd.ScrollIndicator.THICKNESS=7;
iAd.ScrollIndicator.END_SIZE=3;iAd.ScrollIndicator.TYPE_HORIZONTAL="ad-horizontal";iAd.ScrollIndicator.TYPE_VERTICAL="ad-vertical";
iAd.ScrollIndicator.prototype.init=function(a){this.callSuper();this.type=a;this.layer.addClassName(a);this._visible=false;this._height=this._width=iAd.ScrollIndicator.THICKNESS;this.positionBeforeHide=this.position=new iAd.Point(-iAd.ScrollIndicator.THICKNESS,-iAd.ScrollIndicator.THICKNESS);this.lastPositionUpdateInHide=false;this._indicatorStyle=iAd.ScrollView.INDICATOR_STYLE_DEFAULT;this.visible=false};
iAd.ScrollIndicator.prototype.createLayer=function(){this.callSuper();this.layer.addClassName("ad-scroll-indicator");this.layer.addEventListener("webkitTransitionEnd",this,false);this.start=this.layer.appendChild(document.createElement("div"));this.middle=this.layer.appendChild(document.createElement("div"));this.end=this.layer.appendChild(document.createElement("div"))};
iAd.ScrollIndicator.prototype.setPosition=function(a){a.x=Math.round(a.x);a.y=Math.round(a.y);this.callSuper(a);this.lastPositionUpdateInHide=false};iAd.ScrollIndicator.prototype.setSize=function(a){this.width=a.width;this.height=a.height;this._size=a};
iAd.ScrollIndicator.prototype.setIndicatorStyle=function(a){if(a){this._indicatorStyle=a;this.layer.removeClassName(this._indicatorStyle);this.layer.addClassName(this._indicatorStyle);var b=this.type===iAd.ScrollIndicator.TYPE_HORIZONTAL?"-3px 0":"0 -3px";a=iAd.Path.assetsPath+"scroll-"+a.substr(3)+".png";if(iAd.Device.HAS_HIDPI_DISPLAY)a=iAd.Path.appendHiDPISuffix(a);this.middle.style.background='url("'+a+'") '+b}};
iAd.ScrollIndicator.prototype.setWidth=function(a){this.middle.style.webkitTransform="translate3d(0,0,0) scale("+(a-iAd.ScrollIndicator.END_SIZE*2)+",1)";this.end.style.webkitTransform="translate3d("+(a-iAd.ScrollIndicator.END_SIZE)+"px,0,0)";this._width=a};
iAd.ScrollIndicator.prototype.setHeight=function(a){this.middle.style.webkitTransform="translate3d(0,0,0) scale(1,"+(a-iAd.ScrollIndicator.END_SIZE*2)+")";this.end.style.webkitTransform="translate3d(0,"+(a-iAd.ScrollIndicator.END_SIZE)+"px,0)";this._height=a};
iAd.ScrollIndicator.prototype.setVisible=function(a){if(a){this.fading=false;this.opacity=1;this.position=this.lastPositionUpdateInHide?this.positionBeforeHide:this.position}else if(!this.fading){this.fading=true;this.opacity=0;this.lastPositionUpdateInHide=true;this.positionBeforeHide=this.position}this._visible=a};iAd.ScrollIndicator.prototype.flash=function(){this.flashing=true};
iAd.ScrollIndicator.prototype.handleEvent=function(a){if(a.type=="webkitTransitionEnd"){this.callSuper(a);if(this.flashing)this.flashing=false;else if(this.fading){this.position=new iAd.Point(-iAd.ScrollIndicator.THICKNESS,-iAd.ScrollIndicator.THICKNESS);this.fading=false}}};iAd.Class({name:"iAd.ScrollViewPanGestureRecognizer",synthesizedProperties:["enabled"]});
iAd.ScrollViewPanGestureRecognizer.prototype.init=function(){this.callSuper();this.identifier=this.delegate=this.view=null;this.translation=new iAd.Point;this.panning=this.detectedPanning=this.tracking=false;this.trackingDataPoints=[];this._enabled=true};iAd.ScrollViewPanGestureRecognizer.MINIMUM_TRACKING_FOR_PAN=10;iAd.ScrollViewPanGestureRecognizer.MAX_TIME_FOR_TRACKING_DATA_POINTS=100;iAd.ScrollViewPanGestureRecognizer.PANNING_DID_FAIL="panningGestureDidFail";
iAd.ScrollViewPanGestureRecognizer.PANNING_DID_START="panningGestureDidStart";iAd.ScrollViewPanGestureRecognizer.PANNING_DID_CHANGE="panningGestureDidChange";iAd.ScrollViewPanGestureRecognizer.PANNING_DID_END="panningGestureDidEnd";iAd.ScrollViewPanGestureRecognizer.PANNING_DID_CANCEL="panningGestureDidCancel";
iAd.ScrollViewPanGestureRecognizer.prototype.touchBegan=function(a,b){if(!this.tracking){this.startTouchPosition=iAd.Point.fromEvent(a);this.startTouchPositionInView=iAd.Point.fromEventInElement(a,this.view.layer);this.tracking=true;this.addTrackingDataPoint(this.startTouchPositionInView,b)}};
iAd.ScrollViewPanGestureRecognizer.prototype.touchMoved=function(a,b){this.lastTouchPositionInView=iAd.Point.fromEventInElement(a,this.view.layer);this.addTrackingDataPoint(this.lastTouchPositionInView,b);var c=iAd.Point.fromEvent(a);this.translation=new iAd.Point(c.x-this.startTouchPosition.x,c.y-this.startTouchPosition.y);if(this.panning)this.notifyDelegateOfStateChange(iAd.ScrollViewPanGestureRecognizer.PANNING_DID_CHANGE,b);else{c=iAd.ScrollViewPanGestureRecognizer.MINIMUM_TRACKING_FOR_PAN;if(Math.abs(this.translation.x)>=
c||Math.abs(this.translation.y)>=c)this.detectedPanning=true}};iAd.ScrollViewPanGestureRecognizer.prototype.touchEnded=function(a,b){this.panning&&this.notifyDelegateOfStateChange(iAd.ScrollViewPanGestureRecognizer.PANNING_DID_END,b);this.reset()};iAd.ScrollViewPanGestureRecognizer.prototype.touchCancelled=function(a,b){this.panning&&this.notifyDelegateOfStateChange(iAd.ScrollViewPanGestureRecognizer.PANNING_DID_CANCEL,b);this.reset()};
iAd.ScrollViewPanGestureRecognizer.prototype.reset=function(){this.panning=this.detectedPanning=this.tracking=false;this.trackingDataPoints=[];this.identifier=this.lastTouchPositionInView=null};iAd.ScrollViewPanGestureRecognizer.prototype.setEnabled=function(a){if(a!=this._enabled){this._enabled=a;if(!a){this.panning&&this.touchCancelled();iAd.ScrollViewPanGestureRecognizer.recognizerWasDisabled(this)}}};
iAd.ScrollViewPanGestureRecognizer.prototype.notifyDelegateOfStateChange=function(a,b,c){this.delegate!=null&&iAd.Utils.objectHasMethod(this.delegate,a)&&this.delegate[a](this,b,c)};
iAd.ScrollViewPanGestureRecognizer.prototype.gestureWasRecognized=function(a){this.startTouchPosition=this.trackingDataPoints[0].point;if(this.lastTouchPositionInView)this.startTouchPositionInView=this.lastTouchPositionInView.copy();this.detectedPanning=false;this.panning=true;this.notifyDelegateOfStateChange(iAd.ScrollViewPanGestureRecognizer.PANNING_DID_START,a)};
iAd.ScrollViewPanGestureRecognizer.prototype.gestureWasNotRecognized=function(a,b){this.notifyDelegateOfStateChange(iAd.ScrollViewPanGestureRecognizer.PANNING_DID_FAIL,a,b);this.reset()};iAd.ScrollViewPanGestureRecognizer.prototype.translationInView=function(){return new iAd.Point(this.lastTouchPositionInView.x-this.startTouchPositionInView.x,this.lastTouchPositionInView.y-this.startTouchPositionInView.y)};
iAd.ScrollViewPanGestureRecognizer.prototype.velocityInView=function(){this.purgeTrackingDataPointsWithTime((new Date).getTime());if(this.trackingDataPoints.length<2)return new iAd.Point(0,0);var a=this.trackingDataPoints[0],b=this.trackingDataPoints[this.trackingDataPoints.length-1],c=(b.time-a.time)/1E3;return new iAd.Point((b.point.x-a.point.x)/c,(b.point.y-a.point.y)/c)};
iAd.ScrollViewPanGestureRecognizer.prototype.purgeTrackingDataPointsWithTime=function(a){for(;this.trackingDataPoints.length>0;){if(a-this.trackingDataPoints[0].time<=iAd.ScrollViewPanGestureRecognizer.MAX_TIME_FOR_TRACKING_DATA_POINTS)break;this.trackingDataPoints.shift()}};iAd.ScrollViewPanGestureRecognizer.prototype.addTrackingDataPoint=function(a,b){var c=b.timeStamp;this.purgeTrackingDataPointsWithTime(c);this.trackingDataPoints.push({time:c,point:a})};
iAd.ScrollViewPanGestureRecognizer.recognizers=[];iAd.ScrollViewPanGestureRecognizer.recognizersForTouch={};iAd.ScrollViewPanGestureRecognizer.panningTouchIdentifiers=[];
iAd.ScrollViewPanGestureRecognizer.registerRecognizerWithTouch=function(a,b){if(!(!a.enabled||this.recognizers.indexOf(a)!=-1||!a.view.userInteractionEnabled)){a.identifier=b.identifier;this.recognizers.push(a);if(this.recognizersForTouch[a.identifier]==undefined)this.recognizersForTouch[a.identifier]=[];this.recognizersForTouch[a.identifier].push(a);if(this.recognizers.length==1){window.addEventListener(iAd.Event.MOVE_EVENT,this.handleEventProxy,true);window.addEventListener(iAd.Event.END_EVENT,
this.handleEventProxy,true);window.addEventListener(iAd.Event.CANCEL_EVENT,this.handleEventProxy,true)}}};
iAd.ScrollViewPanGestureRecognizer.stopTrackingTouchIdentifier=function(a){var b=this.recognizersForTouch[a];if(b!=undefined){for(;b.length;)iAd.Array.removeObjectFromArray(b.pop(),this.recognizers);delete this.recognizersForTouch[a];if(this.recognizers.length==0){window.removeEventListener(iAd.Event.MOVE_EVENT,this.handleEventProxy,true);window.removeEventListener(iAd.Event.END_EVENT,this.handleEventProxy,true);window.removeEventListener(iAd.Event.CANCEL_EVENT,this.handleEventProxy,true)}iAd.Array.removeObjectFromArray(a,
this.panningTouchIdentifiers)}};iAd.ScrollViewPanGestureRecognizer.recognizerWasDisabled=function(a){var b=this.recognizersForTouch[a.identifier];if(b!=undefined){iAd.Array.removeObjectFromArray(a,b);iAd.Array.removeObjectFromArray(a,this.recognizers);b.length==0&&this.stopTrackingTouchIdentifier(a.identifier)}};iAd.ScrollViewPanGestureRecognizer.handleEventProxy=function(a){iAd.ScrollViewPanGestureRecognizer.handleEvent(a)};
iAd.ScrollViewPanGestureRecognizer.handleEvent=function(a){if(!a.hasOwnProperty("_synthetic")){var b=a.changedTouches;if(!iAd.Event.SUPPORTS_TOUCHES){a.identifier=0;b=[a]}a.type===iAd.Event.START_EVENT&&this.setupRecognizersForTouches(b,a);for(var c,d,e,f=0,g=b.length;f<g;f++){c=b[f];if(d=this.recognizersForTouch[c.identifier])for(var h=0,i=d.length;h<i;h++){e=d[h];this.sendEventToRecognizer(e,a,c)}a.type==iAd.Event.MOVE_EVENT&&this.panningTouchIdentifiers.indexOf(c.identifier)==-1&&this.checkRecognizersWithTouchIdentifierForPanning(c.identifier,
a);a.type==iAd.Event.END_EVENT&&this.stopTrackingTouchIdentifier(c.identifier)}}};iAd.ScrollViewPanGestureRecognizer.parentScrollViewForView=function(a){for(;a.superview;){a=a.superview;if(a instanceof iAd.ScrollView)return a}return null};iAd.ScrollViewPanGestureRecognizer.scrollViewHasPanningChildScrollView=function(a){a=a.scrollViews;for(var b=0,c=a.length;b<c;b++)if(a[b].dragging)return true;return false};
iAd.ScrollViewPanGestureRecognizer.scrollViewHasPanningParentScrollView=function(a){for(a=this.parentScrollViewForView(a);a!=null;){if(a.dragging)return true;a=this.parentScrollViewForView(a)}return iAd.ScrollView.hostScrollView.dragging};iAd.ScrollViewPanGestureRecognizer.hasRecognizerTrackingNativeScrollView=function(){for(var a=0,b=this.recognizers.length;a<b;a++)if(this.recognizers[a].view.usesNativeScrolling)return true;return false};
iAd.ScrollViewPanGestureRecognizer.setupRecognizersForTouches=function(a,b){for(var c,d,e,f=0,g=a.length;f<g;f++){c=a[f];d=iAd.View.nearestViewForElement(c.target)||iAd.ScrollView.hostScrollView;if(d!=null){e=(e=d instanceof iAd.ScrollView?d:this.parentScrollViewForView(d))||iAd.ScrollView.hostScrollView;if(!(e==null||e.dragging||this.scrollViewHasPanningChildScrollView(e)||this.scrollViewHasPanningParentScrollView(e))){for(e=null;d;){e=this.processViewRecognizersForTouch(d,c);d=d.superview}d=iAd.ScrollView.hostScrollView;
d.touchesBegan(b);this.registerRecognizerWithTouch(d.gestureRecognizers[0],c);if(e){e.touchBegan(c,b);this.gestureWasRecognized(e,b)}}}}};iAd.ScrollViewPanGestureRecognizer.processViewRecognizersForTouch=function(a,b){var c=a.gestureRecognizers,d=null;if(c.length>0&&a.pointInside(iAd.Point.fromEventInElement(b,a.layer)))for(var e=0,f=c.length;e<f;e++){recognizer=c[e];if(recognizer.tracking)return;if(a.decelerating)d=recognizer;a.touchesBegan(event);this.registerRecognizerWithTouch(recognizer,b)}return d};
iAd.ScrollViewPanGestureRecognizer.checkRecognizersWithTouchIdentifierForPanning=function(a,b){var c=this.recognizersForTouch[a];if(c!=undefined)for(var d,e,f=0,g=c.length;f<g;f++){d=c[f];if(d.panning)break;if(d.detectedPanning){e=d.view;var h=iAd.ScrollViewPanGestureRecognizer.MINIMUM_TRACKING_FOR_PAN;if(e=Math.abs(d.translation.x)>=h&&(e.canScrollHorizontally||e.alwaysBounceHorizontal)||Math.abs(d.translation.y)>=h&&(e.canScrollVertically||e.alwaysBounceVertical)){this.gestureWasRecognized(d,b);
break}}}};iAd.ScrollViewPanGestureRecognizer.gestureWasRecognized=function(a,b){a.gestureWasRecognized(b);this.panningTouchIdentifiers.push(a.identifier);for(var c=this.recognizersForTouch[a.identifier],d=c.length;d--;)if(c[d]!=a){c[d].gestureWasNotRecognized(b,a);iAd.Array.removeObjectFromArray(c[d],this.recognizers);c.splice(d,1)}};
iAd.ScrollViewPanGestureRecognizer.sendEventToRecognizer=function(a,b,c){switch(b.type){case iAd.Event.START_EVENT:a.touchBegan(c,b);break;case iAd.Event.MOVE_EVENT:a.touchMoved(c,b);break;case iAd.Event.END_EVENT:a.touchEnded(c,b);break;case iAd.Event.CANCEL_EVENT:a.touchCancelled(c,b)}};document.addEventListener(iAd.Event.START_EVENT,iAd.ScrollViewPanGestureRecognizer.handleEventProxy,true);
iAd.Class({name:"iAd.ScrollView",superclass:iAd.View,synthesizedProperties:["contentOffset","contentSize","indicatorStyle","scrollEnabled","scrollIndicatorInsets","dragging","pagingEnabled","pageSize","bounces","showsHorizontalScrollIndicator","showsVerticalScrollIndicator","usesNativeScrolling"],archivedProperties:["contentSize","contentOffset","indicatorStyle","scrollEnabled","scrollIndicatorInsets","showsHorizontalScrollIndicator","showsVerticalScrollIndicator","pagingEnabled","pageSize","bounces",
"alwaysBounceHorizontal","alwaysBounceVertical","delaysContentTouches","canCancelContentTouches"],cssClassName:"ad-scroll-view",collectionAccessor:"scrollViews"});iAd.ScrollView.WILL_BEGIN_DRAGGING="scrollViewWillBeginDragging";iAd.ScrollView.WILL_BEGIN_SCROLLING_ANIMATION="scrollViewWillBeginScrollingAnimation";iAd.ScrollView.DID_END_SCROLLING_ANIMATION="scrollViewDidEndScrollingAnimation";iAd.ScrollView.DID_SCROLL="scrollViewDidScroll";iAd.ScrollView.WILL_END_DRAGGING="scrollViewWillEndDraggingWithVelocityAndTargetContentOffset";
iAd.ScrollView.DID_END_DRAGGING="scrollViewDidEndDragging";iAd.ScrollView.WILL_BEGIN_DECELERATING="scrollViewWillBeginDecelerating";iAd.ScrollView.DID_END_DECELERATING="scrollViewDidEndDecelerating";iAd.ScrollView.MIN_INDICATOR_LENGTH=34;iAd.ScrollView.DECELERATION_FRICTION_FACTOR=0.998;iAd.ScrollView.DESIRED_ANIMATION_FRAME_RATE=1/60;iAd.ScrollView.MINIMUM_VELOCITY=10;iAd.ScrollView.PENETRATION_DECELERATION=5;iAd.ScrollView.PENETRATION_ACCELERATION=8;
iAd.ScrollView.MIN_VELOCITY_FOR_DECELERATION=250;iAd.ScrollView.MIN_VELOCITY_FOR_DECELERATION_WITH_PAGING=300;iAd.ScrollView.PAGING_ACCELERATION=3.6E-4;iAd.ScrollView.PAGING_DECELERATION=0.9668;iAd.ScrollView.PAGING_TRANSITION_DURATION=0.25;iAd.ScrollView.CONTENT_TOUCHES_DELAY=0.15;iAd.ScrollView.AUTOMATED_CONTENT_SIZE=-1;iAd.ScrollView.INDICATOR_STYLE_DEFAULT="ad-indicator-default";iAd.ScrollView.INDICATOR_STYLE_BLACK="ad-indicator-black";iAd.ScrollView.INDICATOR_STYLE_WHITE="ad-indicator-white";
iAd.ScrollView.NON_NATIVE_PROPERTIES={pagingEnabled:true,bounces:false,showsHorizontalScrollIndicator:false,showsVerticalScrollIndicator:false};iAd.ScrollView.TEXT_FIELD_INPUT_TYPES=["text","password","email","url","search","tel","number","week"];
iAd.ScrollView.prototype.init=function(a){this._contentOffset=new iAd.Point;this._contentSize=iAd.ScrollView.AUTOMATED_CONTENT_SIZE;this.adjustedContentSize=new iAd.Size;this.decelerating=this._dragging=false;this.decelerationTimer=null;this._indicatorStyle="";this._showsVerticalScrollIndicator=this._showsHorizontalScrollIndicator=true;this._scrollIndicatorInsets=new iAd.EdgeInsets(0,0,0,0);this._pagingEnabled=this.scrollIndicatorsNeedFlashing=false;this._pageSize=new iAd.Size;this._bounces=true;
this.alwaysBounceVertical=this.alwaysBounceHorizontal=false;this.delegate=null;this.canCancelContentTouches=this.delaysContentTouches=true;this._setContentOffsetAnimatedCalledFromSetter=false;this.beginTouchesInContentTimer=null;this.panGestureRecognizer=new iAd.ScrollViewPanGestureRecognizer;this.panGestureRecognizer.delegate=this;this.callSuper(a);this.userInteractionEnabled=true;this.layer.addEventListener("webkitTransitionEnd",this,false);this.hostingLayer.addEventListener("webkitTransitionEnd",
this,false);this.addGestureRecognizer(this.panGestureRecognizer);this.layer.addEventListener("focus",this,true);this.shouldPreventSelectElementFocus=false;for(var b in iAd.ScrollView.NON_NATIVE_PROPERTIES)this.addPropertyObserver(b,this,"handleNonNativePropertyChange")};
iAd.ScrollView.prototype.createLayer=function(){this.callSuper();this._hostingLayer=this.layer.appendChild(document.createElement("div"));this._hostingLayer.className="ad-hosting-layer";this.clipsToBounds=true;this.createScrollIndicators();this.indicatorStyle=iAd.ScrollView.INDICATOR_STYLE_DEFAULT};
iAd.ScrollView.prototype.setupLayer=function(){this.callSuper();this._hostingLayer=document.createElement("div");for(this._hostingLayer.className="ad-hosting-layer";this.layer.firstChild;)this._hostingLayer.appendChild(this.layer.firstChild);this.layer.appendChild(this._hostingLayer);this.updateAlwaysBounce();this.usesNativeScrolling||this.createScrollIndicators();this.indicatorStyle=this.layerHasCustomAttribute("ad-indicator-style")?this.getLayerCustomAttributeValue("ad-indicator-style"):iAd.ScrollView.INDICATOR_STYLE_DEFAULT};
iAd.ScrollView.prototype.setValueForAttribute=function(a,b){switch(b){case "ad-scroll-indicator-inset-left":this._scrollIndicatorInsets.left=parseInt(a);break;case "ad-scroll-indicator-inset-top":this._scrollIndicatorInsets.top=parseInt(a);break;case "ad-scroll-indicator-inset-right":this._scrollIndicatorInsets.right=parseInt(a);break;case "ad-scroll-indicator-inset-bottom":this._scrollIndicatorInsets.bottom=parseInt(a);break;case "ad-indicator-style":this.indicatorStyle=a==""?iAd.ScrollView.INDICATOR_STYLE_DEFAULT:
a;break;case "ad-uses-native-scrolling":this.usesNativeScrolling=a=="true"?true:false;break;case "ad-page-width":this.pageSize=new iAd.Size(parseFloat(a),this.pageSize.height);break;case "ad-page-height":this.pageSize=new iAd.Size(this.pageSize.width,parseFloat(a));break;default:this.callSuper(a,b)}};iAd.ScrollView.prototype.setBounces=function(a){if(this._bounces!=a){this._bounces=a;this.updateAlwaysBounce()}};
iAd.ScrollView.prototype.setAlwaysBounceVertical=function(a){if(this._alwaysBounceVertical!=a){this._alwaysBounceVertical=a;this.updateAlwaysBounce()}};iAd.ScrollView.prototype.setAlwaysBounceHorizontal=function(a){if(this._alwaysBounceHorizontal!=a){this._alwaysBounceHorizontal=a;this.updateAlwaysBounce()}};
iAd.ScrollView.prototype.updateAlwaysBounce=function(){if(this.usesNativeScrolling){this._hostingLayer.style.width=this.bounces&&this._alwaysBounceHorizontal&&(!this._contentSize.width||this._contentSize.width<this._size.width)?this._size.width+1+"px":"";this._hostingLayer.style.height=this.bounces&&this._alwaysBounceVertical&&(!this._contentSize.height||this._contentSize.height<this._size.height)?this._size.height+1+"px":""}else{if(this._hostingLayer.style.width==this._size.width+1+"px")this._hostingLayer.style.width=
this._size.width+"px";if(this._hostingLayer.style.height==this._size.height+1+"px")this._hostingLayer.style.height=this._size.height+"px"}};iAd.ScrollView.prototype.setSize=function(a){if(!this._size.equals(a)){this.callSuper(a);if(this._contentSize!==iAd.ScrollView.AUTOMATED_CONTENT_SIZE||this.layerIsInDocument)this.adjustContentSize(true)}};iAd.ScrollView.prototype.getPageSize=function(){return this._pageSize.equals(iAd.Size.ZERO_SIZE)?this._size:this._pageSize};
iAd.ScrollView.prototype.layerWasInsertedIntoDocument=function(){this.callSuper();this._contentSize===iAd.ScrollView.AUTOMATED_CONTENT_SIZE&&this.adjustContentSize(true)};iAd.ScrollView.prototype.setUserInteractionEnabled=function(a){if(this._userInteractionEnabled!=a){this.callSuper(a);this.layer[a?"addEventListener":"removeEventListener"](iAd.Event.START_EVENT,this,true)}};
iAd.ScrollView.prototype.setUsesNativeScrolling=function(a){if(this._usesNativeScrolling!=a)if(a&&iAd.Device.iOS_VERSION&&iAd.Device.iOSVersionLessThan("5.0"))iAd.Console.warn("iAd.ScrollView.usesNativeScrolling is only available on iOS 5 and later.");else{if(this._usesNativeScrolling=a){var b=iAd.ScrollView.NON_NATIVE_PROPERTIES;for(var c in b)if(this[c]==b[c]){this[c]=!b[c];iAd.Console.warn('iAd.ScrollView - the value for "'+c+'" was reverted to '+!b[c]+" to support native scrolling.")}}this.layer.style.overflow=
a&&!this._scrollEnabled?"scroll":"";this.layer.style.webkitOverflowScrolling=a?"touch":"none";this.layer.style.webkitTransition=a?"none":"-webkit-transform";this.layer[this._usesNativeScrolling?"addEventListener":"removeEventListener"]("scroll",this,false);if(this._usesNativeScrolling)this.hideScrollIndicators();else{this.horizontalScrollIndicator||this.createScrollIndicators();this.handleScrollEvent()}this.updateScrollPositionWithContentOffset();this.updateAlwaysBounce()}};
iAd.ScrollView.prototype.handleNonNativePropertyChange=function(a,b){var c=iAd.ScrollView.NON_NATIVE_PROPERTIES;if(this.usesNativeScrolling&&this[b]==c[b]){iAd.Console.warn('iAd.ScrollView - native scrolling was disabled because an unsupported value was set for "'+b+'"');this.usesNativeScrolling=false}};iAd.ScrollView.prototype.getScrollEnabled=function(){return this.panGestureRecognizer.enabled};
iAd.ScrollView.prototype.setScrollEnabled=function(a){if(this.usesNativeScrolling)this.layer.style.overflowX=this.layer.style.overflowY=a?"scroll":"hidden";this.panGestureRecognizer.enabled=a};iAd.ScrollView.prototype.setContentOffset=function(a){this._setContentOffsetAnimatedCalledFromSetter=true;this.setContentOffsetAnimated(a,false)};
iAd.ScrollView.prototype.setContentOffsetAnimated=function(a,b,c){if(!(!a||a.equals(this._contentOffset))){if(b)this.usesNativeScrolling?iAd.Console.warn("iAd.ScrollView - animated content offsets are not supported with native scrolling."):this.dispatchNotification(iAd.ScrollView.WILL_BEGIN_SCROLLING_ANIMATION,this.delegate);this._contentOffset=new iAd.Point(iAd.CSS.roundedPxValue(a.x),iAd.CSS.roundedPxValue(a.y));if(!this.dragging&&!this.decelerating){this.adjustContentSize(false);this._contentOffset.x=
iAd.Number.clampValue(this._contentOffset.x,0,this.maxPoint.x);this._contentOffset.y=iAd.Number.clampValue(this._contentOffset.y,0,this.maxPoint.y)}this.updateScrollPositionWithContentOffset();if(b&&!this.usesNativeScrolling){this.scrollTransitionsNeedRemoval=true;this.hostingLayer.style.webkitTransitionDuration=(c||iAd.ScrollView.PAGING_TRANSITION_DURATION)+"s"}else this.didScroll(false);if(!b&&!this.usesNativeScrolling){this.canScrollHorizontally&&this.showsHorizontalScrollIndicator&&this.updateHorizontalScrollIndicator();
this.canScrollVertically&&this.showsVerticalScrollIndicator&&this.updateVerticalScrollIndicator()}this._setContentOffsetAnimatedCalledFromSetter||this.notifyPropertyChange("contentOffset");this._setContentOffsetAnimatedCalledFromSetter=false}};
iAd.ScrollView.prototype.updateScrollPositionWithContentOffset=function(){if(this.usesNativeScrolling){this.hostingLayer.style.webkitTransform=iAd.CSS.t(0,0);this.layer.scrollTop=this._contentOffset.y;this.layer.scrollLeft=this._contentOffset.x}else{this.layer.scrollTop=this.layer.scrollLeft=0;this.hostingLayer.style.webkitTransform=iAd.CSS.tm(-this._contentOffset.x,-this._contentOffset.y)}};
iAd.ScrollView.prototype.snapContentOffsetToBounds=function(a){var b=false,c=new iAd.Point;if(this.pagingEnabled&&a){b=this.pageSize;c.x=Math.round(this._contentOffset.x/b.width)*b.width;c.y=Math.round(this._contentOffset.y/b.height)*b.height;b=true}else if(this.bounces){c.x=iAd.Number.clampValue(this._contentOffset.x,0,this.maxPoint.x);c.y=iAd.Number.clampValue(this._contentOffset.y,0,this.maxPoint.y);b=c.x!=this._contentOffset.x||c.y!=this._contentOffset.y}b&&this.setContentOffsetAnimated(c,a)};
iAd.ScrollView.prototype.getContentSize=function(){var a=this._contentSize;if(a===iAd.ScrollView.AUTOMATED_CONTENT_SIZE){a=new iAd.Size(this._hostingLayer.offsetWidth,this._hostingLayer.offsetHeight);for(var b=0,c=this.subviews.length;b<c;b++){var d=this.subviews[b];a.width=Math.max(a.width,d.position.x+d.size.width);a.height=Math.max(a.height,d.position.y+d.size.height)}}return a};iAd.ScrollView.prototype.setClipsToBounds=function(a){this.usesNativeScrolling||this.callSuper(a)};
iAd.ScrollView.prototype.setContentSize=function(a){if(a){this._contentSize=a;this.adjustContentSize(false);this.updateAlwaysBounce()}};
iAd.ScrollView.prototype.adjustContentSize=function(a){if(a){var b=new iAd.Point;if(this.adjustedContentSize.width!=0)b.x=this._contentOffset.x/this.adjustedContentSize.width;if(this.adjustedContentSize.height!=0)b.y=this._contentOffset.y/this.adjustedContentSize.height}this.adjustedContentSize.width=Math.max(this._size.width,this.contentSize.width);this.adjustedContentSize.height=Math.max(this._size.height,this.contentSize.height);this.maxPoint=new iAd.Point(this.adjustedContentSize.width-this._size.width,
this.adjustedContentSize.height-this._size.height);if(a)this.contentOffset=new iAd.Point(Math.min(b.x*this.adjustedContentSize.width,this.maxPoint.x),Math.min(b.y*this.adjustedContentSize.height,this.maxPoint.y));this.canScrollHorizontally=this.size.width<this.adjustedContentSize.width;this.canScrollVertically=this.size.height<this.adjustedContentSize.height};
iAd.ScrollView.prototype.setIndicatorStyle=function(a){this._indicatorStyle=a;if(this.usesNativeScrolling)iAd.Console.warn("iAd.ScrollView - indicatorStyle property is not supported with native scrolling.");else{this.horizontalScrollIndicator.indicatorStyle=a;this.verticalScrollIndicator.indicatorStyle=a}};
iAd.ScrollView.prototype.setScrollIndicatorInsets=function(a){this._scrollIndicatorInsets=a;if(this.usesNativeScrolling)iAd.Console.warn("iAd.ScrollView - scrollIndicatorInsets property is not supported with native scrolling.");else{this.horizontalScrollIndicator.visible&&this.updateHorizontalScrollIndicator();this.verticalScrollIndicator.visible&&this.updateVerticalScrollIndicator()}};
iAd.ScrollView.prototype.createScrollIndicators=function(){this.horizontalScrollIndicator=new iAd.ScrollIndicator(iAd.ScrollIndicator.TYPE_HORIZONTAL);this.layer.appendChild(this.horizontalScrollIndicator.layer);this.horizontalScrollIndicator.indicatorStyle=this._indicatorStyle;this.verticalScrollIndicator=new iAd.ScrollIndicator(iAd.ScrollIndicator.TYPE_VERTICAL);this.layer.appendChild(this.verticalScrollIndicator.layer);this.verticalScrollIndicator.indicatorStyle=this._indicatorStyle};
iAd.ScrollView.prototype.updateHorizontalScrollIndicator=function(){var a=this.scrollIndicatorInsets.left+1,b=this.size.width-this.scrollIndicatorInsets.right-1;if(this.canScrollVertically&&this.showsVerticalScrollIndicator)b-=iAd.ScrollIndicator.THICKNESS-1;var c=b-a,d=Math.max(iAd.ScrollView.MIN_INDICATOR_LENGTH,Math.round(this.size.width/this.adjustedContentSize.width*c)),e=this.size.height-iAd.ScrollIndicator.THICKNESS-this.scrollIndicatorInsets.bottom-1;if(this.contentOffset.x<0){d=Math.round(Math.max(d+
this.contentOffset.x,iAd.ScrollIndicator.THICKNESS));a=a}else if(this.contentOffset.x>this.maxPoint.x){d=Math.round(Math.max(d+this.adjustedContentSize.width-this.size.width-this.contentOffset.x,iAd.ScrollIndicator.THICKNESS));a=b-d}else a=iAd.Number.clampValue(Math.round(this.contentOffset.x/(this.adjustedContentSize.width-this.size.width)*(c-d)+this.scrollIndicatorInsets.left),a,b-d);this.horizontalScrollIndicator.position=new iAd.Point(a,e);this.horizontalScrollIndicator.width=d};
iAd.ScrollView.prototype.updateVerticalScrollIndicator=function(){var a=this.scrollIndicatorInsets.top+1,b=this.size.height-this.scrollIndicatorInsets.bottom-1;if(this.canScrollHorizontally&&this.showsHorizontalScrollIndicator)b-=iAd.ScrollIndicator.THICKNESS-1;var c=b-a,d=Math.max(iAd.ScrollView.MIN_INDICATOR_LENGTH,Math.round(this.size.height/this.adjustedContentSize.height*c)),e=this.size.width-iAd.ScrollIndicator.THICKNESS-this.scrollIndicatorInsets.right-1;if(this.contentOffset.y<0){d=Math.round(Math.max(d+
this.contentOffset.y,iAd.ScrollIndicator.THICKNESS));a=a}else if(this.contentOffset.y>this.maxPoint.y){d=Math.round(Math.max(d+this.adjustedContentSize.height-this.size.height-this.contentOffset.y,iAd.ScrollIndicator.THICKNESS));a=b-d}else a=iAd.Number.clampValue(Math.round(this.contentOffset.y/(this.adjustedContentSize.height-this.size.height)*(c-d)+this.scrollIndicatorInsets.top),a,b-d);this.verticalScrollIndicator.position=new iAd.Point(e,a);this.verticalScrollIndicator.height=d};
iAd.ScrollView.prototype.flashScrollIndicators=function(a){if(!this.usesNativeScrolling)if(a)this.scrollIndicatorsNeedFlashing=true;else{if(this.canScrollHorizontally&&this.showsHorizontalScrollIndicator&&this.adjustedContentSize.width>this._size.width){this.updateHorizontalScrollIndicator();this.horizontalScrollIndicator.flash()}if(this.canScrollVertically&&this.showsVerticalScrollIndicator&&this.adjustedContentSize.height>this._size.height){this.updateVerticalScrollIndicator();this.verticalScrollIndicator.flash()}}};
iAd.ScrollView.prototype.hideScrollIndicators=function(){this.horizontalScrollIndicator.visible=false;this.verticalScrollIndicator.visible=false};iAd.ScrollView.prototype.showHorizontalScrollIndicator=function(){if(!this.usesNativeScrolling)this.horizontalScrollIndicator.visible=true};iAd.ScrollView.prototype.showVerticalScrollIndicator=function(){if(!this.usesNativeScrolling)this.verticalScrollIndicator.visible=true};
iAd.ScrollView.prototype.handleEvent=function(a){if(!a.hasOwnProperty("_synthetic"))if(a.type=="focus"&&this.shouldPreventSelectElementFocus){a.stopPropagation();a.preventDefault();this.originalTarget.blur()}else if(a.type==iAd.Event.START_EVENT&&a.eventPhase==Event.CAPTURING_PHASE)this.touchesBeganInCapturePhase(a);else if(a.type=="webkitTransitionEnd")this.transitionEnded(a);else a.type=="scroll"?this.handleScrollEvent(a):this.callSuper(a)};
iAd.ScrollView.prototype.handleScrollEvent=function(a){this._contentOffset=new iAd.Point(this.layer.scrollLeft,this.layer.scrollTop);this.notifyPropertyChange("contentOffset");this.didScroll(!!a)};iAd.ScrollView.prototype.touchesBeganInCapturePhase=function(a){if(this.scrollEnabled){for(var b=iAd.View.nearestViewForElement(a.target);b&&b!=this;){if(b instanceof iAd.ScrollView&&b.scrollEnabled&&b.userInteractionEnabled)return;b=iAd.ScrollViewPanGestureRecognizer.parentScrollViewForView(b)}a.stopPropagation()}};
iAd.ScrollView.prototype.touchesBegan=function(a){document.activeElement===a.target?this.interruptTrackingInteraction(true):this.beginTracking(a)};iAd.ScrollView.prototype.touchesMoved=function(a){var b=this.getInitialTouch(a);if(b!=null){this.lastKnownTouchPosition=iAd.Point.fromEvent(b);this.contentTouchesCouldNotBeCancelled||this.callSuper(a)}};
iAd.ScrollView.prototype.shouldPreventEventDefault=function(a){if(a.type==iAd.Event.MOVE_EVENT||a.type==iAd.Event.START_EVENT)return!this.usesNativeScrolling&&!iAd.ScrollView.isViewInNativeScrollView(this)&&!iAd.ScrollView.viewHasTrackingNativeChildScrollView(this)&&!iAd.ScrollView.hostScrollView.scrollEnabled;return true};
iAd.ScrollView.prototype.touchesEnded=function(a){if(this.getInitialTouch(a)!=null){this.stopTrackingTouches();if(this.scrollEnabled){this.originalEndEvent=a;if(this.contentTouchesCouldNotBeCancelled)if(this.isOriginalTargetElementAtPoint(this.lastKnownTouchPosition)){if(!a.hasOwnProperty("_scrollViewDispatchedEventToContent")){this.dispatchClickToContent();a._scrollViewDispatchedEventToContent=true}}else{if(this.originalTarget.localName=="select")this.shouldPreventSelectElementFocus=true}else if(this.dragging){a.preventDefault();
if(this.originalTarget.localName=="select")this.shouldPreventSelectElementFocus=true;a.stopPropagation()}else{this.hideScrollIndicators();if(this.isOriginalTargetElementAtPoint(this.lastKnownTouchPosition)){if(!a.hasOwnProperty("_scrollViewDispatchedEventToContent")){a.stopPropagation();this.touchesInContentBegan?this.endTouchesInContent():this.dispatchTapSequenceToContent();this.dispatchClickToContent();a._scrollViewDispatchedEventToContent=true}}else if(this.originalTarget.localName=="select")this.shouldPreventSelectElementFocus=
true;else a.preventDefault()}}}};iAd.ScrollView.prototype.touchesCancelled=function(){this.stopTrackingTouches();this.hideScrollIndicators()};iAd.ScrollView.prototype.panningGestureDidFail=function(a,b,c){this.stopTrackingTouches();if(!c||!c.view.usesNativeScrolling)b.preventDefault()};
iAd.ScrollView.prototype.panningGestureDidStart=function(){if(!this.contentTouchesCouldNotBeCancelled)if(this.canCancelContentTouches&&this.touchesInContentBegan&&!this.touchesShouldCancelInContentElementAndView(this.originalTarget,iAd.View.nearestViewForElement(this.originalTarget)))this.interruptTrackingInteraction(true);else{this.cancelTouchesInContent();this.hostingLayer.style.webkitTransitionDuration=0;this.startContentOffset=this.contentOffset.copy();this.dispatchNotification(iAd.ScrollView.WILL_BEGIN_DRAGGING,
this.delegate);this.dragging=true;this.canScrollHorizontally&&this.showsHorizontalScrollIndicator&&this.adjustedContentSize.width>this._size.width&&this.showHorizontalScrollIndicator();this.canScrollVertically&&this.showsVerticalScrollIndicator&&this.adjustedContentSize.height>this._size.height&&this.showVerticalScrollIndicator()}};
iAd.ScrollView.prototype.panningGestureDidChange=function(a,b){if(!this.contentTouchesCouldNotBeCancelled){b.stopPropagation();if(!this.usesNativeScrolling){var c=this.canScrollHorizontally||this.bounces&&this.alwaysBounceHorizontal,d=this.canScrollVertically||this.bounces&&this.alwaysBounceVertical,e=a.translationInView();c=c?this.startContentOffset.x-e.x:this._contentOffset.x;d=d?this.startContentOffset.y-e.y:this._contentOffset.y;if(this.bounces){c-=(c>this.maxPoint.x?c-this.maxPoint.x:c<0?c:0)/
2;d-=(d>this.maxPoint.y?d-this.maxPoint.y:d<0?d:0)/2}else{c=iAd.Number.clampValue(c,0,this.maxPoint.x);d=iAd.Number.clampValue(d,0,this.maxPoint.y)}this.contentOffset=new iAd.Point(c,d)}}};
iAd.ScrollView.prototype.panningGestureDidEnd=function(){if(!this.contentTouchesCouldNotBeCancelled){this.dragging=false;this.stopTrackingTouches();this.usesNativeScrolling||this.startDecelerationAnimation();this.dispatchNotification(iAd.ScrollView.DID_END_DRAGGING,this.delegate);if(!this.decelerating&&!this.usesNativeScrolling){this.snapContentOffsetToBounds(true);this.hideScrollIndicators()}}};
iAd.ScrollView.prototype.panningGestureDidCancel=function(){if(this._dragging){this.dragging=false;this.usesNativeScrolling||this.snapContentOffsetToBounds(true);this.dispatchNotification(iAd.ScrollView.DID_END_DRAGGING,this.delegate);this.hideScrollIndicators()}};iAd.ScrollView.prototype.getInitialTouch=function(a){if(!iAd.Event.SUPPORTS_TOUCHES)return a;for(var b,c=0,d=a.changedTouches.length;c<d;c++){b=a.changedTouches[c];if(b.identifier==this.initialTouchIdentifier)return b}return null};
iAd.ScrollView.prototype.beginTracking=function(a){if(!this._tracking){this.stopDecelerationAnimation();this.usesNativeScrolling||this.snapContentOffsetToBounds(false);this.lastKnownTouchPosition=iAd.Point.fromEvent(a);var b=iAd.Event.SUPPORTS_TOUCHES?a.targetTouches[0]:a;this.initialTouchIdentifier=b.identifier;b=b.target;this.originalTarget=b.nodeType===Node.ELEMENT_NODE?b:b.parentElement;this.originalStartEvent=a;this.originalTarget.localName!="select"&&this.shouldPreventEventDefault(a)&&a.preventDefault();
this.adjustContentSize(false);this.tracking=true;this.beginTouchesInContentTimer=null;this.contentTouchesCouldNotBeCancelled=this.shouldPreventSelectElementFocus=this.touchesInContentBegan=false;if(this.delaysContentTouches)this.beginTouchesInContentTimer=this.callMethodNameAfterDelay("beginTouchesInContentIfPermitted",iAd.ScrollView.CONTENT_TOUCHES_DELAY);else this.beginTouchesInContentIfPermitted();document.addEventListener(iAd.Event.MOVE_EVENT,this,true);document.addEventListener(iAd.Event.END_EVENT,
this,true);document.addEventListener(iAd.Event.CANCEL_EVENT,this,true)}};iAd.ScrollView.prototype.stopTrackingTouches=function(){if(this._tracking){this.tracking=false;document.removeEventListener(iAd.Event.MOVE_EVENT,this,true);document.removeEventListener(iAd.Event.END_EVENT,this,true);document.removeEventListener(iAd.Event.CANCEL_EVENT,this,true);window.clearTimeout(this.beginTouchesInContentTimer)}};
iAd.ScrollView.prototype.interruptTrackingInteraction=function(a){this.contentTouchesCouldNotBeCancelled=a;if(this.dragging){this.dragging=false;this.snapContentOffsetToBounds(true);this.dispatchNotification(iAd.ScrollView.DID_END_DRAGGING,this.delegate);this.hideScrollIndicators()}};iAd.ScrollView.prototype.isOriginalTargetElementAtPoint=function(a){return this.originalTarget===document.elementFromPoint(a.x,a.y)};
iAd.ScrollView.prototype.beginTouchesInContentIfPermitted=function(){this.scrollEnabled&&this.touchesShouldBeginInContentElementAndView(this.originalStartEvent,this.originalTarget,iAd.View.nearestViewForElement(this.originalTarget))&&this.beginTouchesInContent()};
iAd.ScrollView.prototype.beginTouchesInContent=function(){if(!this.isContentInEnabledChildScrollView()){this.touchesInContentBegan=true;this.dispatchUIEventToContent(iAd.Event.START_EVENT,this.originalStartEvent);this.canCancelContentTouches||this.interruptTrackingInteraction(true)}};iAd.ScrollView.prototype.endTouchesInContent=function(){this.dispatchUIEventToContent(iAd.Event.END_EVENT,this.originalEndEvent);this.elementShouldReceiveFocus(this.originalTarget)&&this.originalTarget.focus()};
iAd.ScrollView.prototype.touchesShouldBeginInContentElementAndView=function(){return true};iAd.ScrollView.prototype.cancelTouchesInContent=function(){var a=document.createEvent("Event");a.initEvent(iAd.Event.CANCEL_EVENT,true,true);a._synthetic=true;this.originalTarget.dispatchEvent(a);window.clearTimeout(this.beginTouchesInContentTimer)};iAd.ScrollView.prototype.touchesShouldCancelInContentElementAndView=function(a){return!iAd.Control.isNodeInControlHierarchyBoundedByElement(a,this.hostingLayer)};
iAd.ScrollView.prototype.isContentInEnabledChildScrollView=function(){for(var a,b=this.scrollViews,c=0,d=b.length;c<d;c++){a=b[c];if(a.scrollEnabled&&a.originalTarget===this.originalTarget)return true}return false};iAd.ScrollView.prototype.dispatchTapSequenceToContent=function(){this.dispatchUIEventToContent(iAd.Event.START_EVENT,this.originalStartEvent);this.endTouchesInContent()};
iAd.ScrollView.prototype.dispatchUIEventToContent=function(a,b){var c=iAd.Event.createUIEvent(a,b);c._synthetic=true;this.originalTarget.dispatchEvent(c)};iAd.ScrollView.prototype.elementShouldReceiveFocus=function(a){var b=a.nodeName.toLowerCase();return b=="input"&&iAd.ScrollView.TEXT_FIELD_INPUT_TYPES.indexOf(a.type)!=-1||b=="textarea"};
iAd.ScrollView.prototype.dispatchClickToContent=function(){if(iAd.Event.SUPPORTS_TOUCHES){var a=this.getInitialTouch(this.originalStartEvent);if(a!=null){var b=document.createEvent("MouseEvent");b.initMouseEvent("click",true,true,document.defaultView,0,a.screenX,a.screenY,a.clientX,a.clientY,0,0,0,0,0,0,null);b._synthetic=true;this.originalTarget.dispatchEvent(b)}}};
iAd.ScrollView.prototype.transitionEnded=function(a){if(this.scrollIndicatorsNeedFlashing&&a.currentTarget===this.layer){this.scrollIndicatorsNeedFlashing=false;this.flashScrollIndicators()}if(this.scrollTransitionsNeedRemoval&&a.currentTarget===this.hostingLayer){this.scrollTransitionsNeedRemoval=false;this.hostingLayer.style.webkitTransitionDuration=0;this.didScroll(true)}};
iAd.ScrollView.prototype.didScroll=function(a){a&&this.dispatchNotification(iAd.ScrollView.DID_END_SCROLLING_ANIMATION,this.delegate);this.dispatchNotification(iAd.ScrollView.DID_SCROLL,this.delegate)};
iAd.ScrollView.prototype.startDecelerationAnimation=function(){if(!(this.bounces&&(this._contentOffset.x>this.maxPoint.x||this._contentOffset.x<0)&&(this._contentOffset.y>this.maxPoint.y||this._contentOffset.y<0))){this.decelerationVelocity=this.panGestureRecognizer.velocityInView();this.decelerationVelocity.x=-this.decelerationVelocity.x;this.decelerationVelocity.y=-this.decelerationVelocity.y;this.adjustedDecelerationFactor=new iAd.Size(iAd.ScrollView.DECELERATION_FRICTION_FACTOR,iAd.ScrollView.DECELERATION_FRICTION_FACTOR);
if(!this.canScrollVertically)this.decelerationVelocity.y=0;if(!this.canScrollHorizontally)this.decelerationVelocity.x=0;this.minDecelerationPoint=new iAd.Point(0,0);this.maxDecelerationPoint=this.maxPoint.copy();if(this.pagingEnabled){var a=this.pageSize;this.minDecelerationPoint.x=Math.max(0,Math.floor(this._contentOffset.x/a.width)*a.width);this.minDecelerationPoint.y=Math.max(0,Math.floor(this._contentOffset.y/a.height)*a.height);this.maxDecelerationPoint.x=Math.min(this.maxPoint.x,Math.ceil(this._contentOffset.x/
a.width)*a.width);this.maxDecelerationPoint.y=Math.min(this.maxPoint.y,Math.ceil(this._contentOffset.y/a.height)*a.height)}a=this.pagingEnabled?iAd.ScrollView.MIN_VELOCITY_FOR_DECELERATION_WITH_PAGING:iAd.ScrollView.MIN_VELOCITY_FOR_DECELERATION;if(Math.abs(this.decelerationVelocity.x)>a||Math.abs(this.decelerationVelocity.y)>a){this.decelerating=true;if(this.pagingEnabled)this.nextPageContentOffset=new iAd.Point(this.decelerationVelocity.x>0?this.maxDecelerationPoint.x:this.minDecelerationPoint.x,
this.decelerationVelocity.y>0?this.maxDecelerationPoint.y:this.minDecelerationPoint.y);else iAd.Utils.objectHasMethod(this.delegate,iAd.ScrollView.WILL_END_DRAGGING)&&this.adjustedDecelerationParameters();this.animatedContentOffset=this._contentOffset.copy();this.decelerationTimer=this.callMethodNameAfterDelay("stepThroughDecelerationAnimation",iAd.ScrollView.DESIRED_ANIMATION_FRAME_RATE);this.previousDecelerationFrame=new Date;this.dispatchNotification(iAd.ScrollView.WILL_BEGIN_DECELERATING,this.delegate)}}};
iAd.ScrollView.prototype.adjustedDecelerationParameters=function(){var a=new iAd.Point(this.decelerationVelocity.x/1E3,this.decelerationVelocity.y/1E3),b=new iAd.Point((this.decelerationVelocity.x<0?-iAd.ScrollView.MINIMUM_VELOCITY:iAd.ScrollView.MINIMUM_VELOCITY)/1E3,(this.decelerationVelocity.y<0?-iAd.ScrollView.MINIMUM_VELOCITY:iAd.ScrollView.MINIMUM_VELOCITY)/1E3),c=Math.log(iAd.ScrollView.DECELERATION_FRICTION_FACTOR),d=new iAd.Point(this._contentOffset.x-(a.x-b.x)/c,this._contentOffset.y-(a.y-
b.y)/c);d.x=iAd.Number.clampValue(d.x,this.minDecelerationPoint.x,this.maxDecelerationPoint.x);d.y=iAd.Number.clampValue(d.y,this.minDecelerationPoint.y,this.maxDecelerationPoint.y);var e=d.copy();this.delegate[iAd.ScrollView.WILL_END_DRAGGING](this,a,d);if(!e.equals(d)){var f=new iAd.Point(d.x-this._contentOffset.x,d.y-this._contentOffset.y);if(a.x<=0&&d.x<e.x||a.x>=0&&d.x>e.x)this.decelerationVelocity.x=(b.x-c*f.x)*1E3;else this.adjustedDecelerationFactor.width=Math.min(iAd.ScrollView.MIN_VELOCITY_FOR_DECELERATION,
Math.exp(-(a.x-b.x)/f.x));if(a.y<=0&&d.y<e.y||a.y>=0&&d.y>e.y)this.decelerationVelocity.y=(b.y-c*f.y)*1E3;else this.adjustedDecelerationFactor.height=Math.min(iAd.ScrollView.MIN_VELOCITY_FOR_DECELERATION,Math.exp(-(a.y-b.y)/f.y))}};iAd.ScrollView.prototype.stopDecelerationAnimation=function(){this.decelerating=false;clearTimeout(this.decelerationTimer)};
iAd.ScrollView.prototype.stepThroughDecelerationAnimation=function(){if(this.decelerating){var a=new Date,b=a-this.previousDecelerationFrame,c=this.animatedContentOffset.copy();if(this.pagingEnabled)for(var d=0;d<b;d++){this.decelerationVelocity.x+=1E3*iAd.ScrollView.PAGING_ACCELERATION*(this.nextPageContentOffset.x-c.x);this.decelerationVelocity.x*=iAd.ScrollView.PAGING_DECELERATION;c.x+=this.decelerationVelocity.x/1E3;this.decelerationVelocity.y+=1E3*iAd.ScrollView.PAGING_ACCELERATION*(this.nextPageContentOffset.y-
c.y);this.decelerationVelocity.y*=iAd.ScrollView.PAGING_DECELERATION;c.y+=this.decelerationVelocity.y/1E3}else{d=this.adjustedDecelerationFactor;b=new iAd.Size(Math.exp(Math.log(d.width)*b),Math.exp(Math.log(d.height)*b));d=new iAd.Size(d.width*((1-b.width)/(1-d.width)),d.height*((1-b.height)/(1-d.height)));c.x+=this.decelerationVelocity.x/1E3*d.width;c.y+=this.decelerationVelocity.y/1E3*d.height;this.decelerationVelocity.x*=b.width;this.decelerationVelocity.y*=b.height}if(!this.bounces){b=iAd.Number.clampValue(c.x,
0,this.maxPoint.x);if(b!=c.x){c.x=b;this.decelerationVelocity.x=0}b=iAd.Number.clampValue(c.y,0,this.maxPoint.y);if(b!=c.y){c.y=b;this.decelerationVelocity.y=0}}this.animatedContentOffset=c;if(this._contentOffset.x!=iAd.CSS.roundedPxValue(c.x)||this._contentOffset.y!=iAd.CSS.roundedPxValue(c.y))this.contentOffset=c;b=Math.abs(this.decelerationVelocity.y);b=Math.abs(this.decelerationVelocity.x)<=iAd.ScrollView.MINIMUM_VELOCITY&&b<=iAd.ScrollView.MINIMUM_VELOCITY;d=this.pagingEnabled&&b&&Math.abs(this.nextPageContentOffset.x-
c.x)<=1&&Math.abs(this.nextPageContentOffset.y-c.y)<=1;if(!this.pagingEnabled&&b||d)this.decelerationAnimationCompleted();else{if(!this.pagingEnabled&&this.bounces){b=new iAd.Point(0,0);if(c.x<this.minDecelerationPoint.x)b.x=this.minDecelerationPoint.x-c.x;else if(c.x>this.maxDecelerationPoint.x)b.x=this.maxDecelerationPoint.x-c.x;if(c.y<this.minDecelerationPoint.y)b.y=this.minDecelerationPoint.y-c.y;else if(c.y>this.maxDecelerationPoint.y)b.y=this.maxDecelerationPoint.y-c.y;if(b.x!=0)if(b.x*this.decelerationVelocity.x<=
0)this.decelerationVelocity.x+=b.x*iAd.ScrollView.PENETRATION_DECELERATION;else this.decelerationVelocity.x=b.x*iAd.ScrollView.PENETRATION_ACCELERATION;if(b.y!=0)if(b.y*this.decelerationVelocity.y<=0)this.decelerationVelocity.y+=b.y*iAd.ScrollView.PENETRATION_DECELERATION;else this.decelerationVelocity.y=b.y*iAd.ScrollView.PENETRATION_ACCELERATION}this.decelerationTimer=this.callMethodNameAfterDelay("stepThroughDecelerationAnimation",iAd.ScrollView.DESIRED_ANIMATION_FRAME_RATE);this.previousDecelerationFrame=
a}}};iAd.ScrollView.prototype.decelerationAnimationCompleted=function(){this.stopDecelerationAnimation();this.hideScrollIndicators();if(this.pagingEnabled){var a=this.pageSize;this.setContentOffsetAnimated(new iAd.Point(Math.round(this._contentOffset.x/a.width)*a.width,Math.round(this._contentOffset.y/a.height)*a.height),false)}this.snapContentOffsetToBounds(false);this.dispatchNotification(iAd.ScrollView.DID_END_DECELERATING,this.delegate)};
iAd.ScrollView.isViewInNativeScrollView=function(a){if(a=iAd.ScrollViewPanGestureRecognizer.parentScrollViewForView(a))return a.usesNativeScrolling||iAd.ScrollView.isViewInNativeScrollView(a);return false};iAd.ScrollView.viewHasTrackingNativeChildScrollView=function(a){a=a.scrollViews;for(var b=0,c=a.length;b<c;b++)if(a[b].usesNativeScrolling&&a[b].tracking)return true;return false};iAd.Class({name:"iAd.HostScrollView",superclass:iAd.ScrollView});
iAd.HostScrollView.prototype.init=function(){this.callSuper();this._usesNativeScrolling=true;var a=iAd.RootView.sharedRoot;a.addPropertyObserver("disablesDefaultScrolling",this,"rootViewDisablesDefaultScrollingDidChange");this.rootViewDisablesDefaultScrollingDidChange();a.addPropertyObserver("scrollsHorizontally",this,"rootViewScrollingAxesDidChange");a.addPropertyObserver("scrollsVertically",this,"rootViewScrollingAxesDidChange");this.rootViewScrollingAxesDidChange()};
iAd.HostScrollView.prototype.rootViewDisablesDefaultScrollingDidChange=function(){this.scrollEnabled=!iAd.RootView.sharedRoot.disablesDefaultScrolling};iAd.HostScrollView.prototype.rootViewScrollingAxesDidChange=function(){var a=iAd.RootView.sharedRoot;this.canScrollVertically=a.scrollsVertically;this.canScrollHorizontally=a.scrollsHorizontally};
iAd.HostScrollView.prototype.shouldPreventEventDefault=function(a){if(a.type==iAd.Event.MOVE_EVENT&&!this.scrollEnabled)return!iAd.ScrollViewPanGestureRecognizer.hasRecognizerTrackingNativeScrollView();return false};iAd.HostScrollView.prototype.dispatchUIEventToContent=function(){};iAd.HostScrollView.prototype.adjustContentSize=function(){};iAd.ScrollView._hostScrollView=null;
Object.defineProperty(iAd.ScrollView,"hostScrollView",{get:function(){if(iAd.ScrollView._hostScrollView==null)iAd.ScrollView._hostScrollView=new iAd.HostScrollView;return iAd.ScrollView._hostScrollView},set:function(a){iAd.ScrollView._hostScrollView=a}});iAd.Class({name:"iAd.PageController",superclass:iAd.ViewController,synthesizedProperties:["viewControllers","scrollsInfinitely","visiblePagesPerSide"],archivedProperties:["viewControllers","scrollsInfinitely","visiblePagesPerSide"]});
iAd.PageController.DEFAULT_PAGE_CONTROL_HEIGHT=38;iAd.PageController.prototype.init=function(a,b){this._scrollsInfinitely=this.shouldIgnoreCurrentPageChange=this.animatingToNewPage=this.subviewsWereCreated=false;this._visiblePagesPerSide=1;this.pageControl=this.scrollView=null;this.callSuper(a);this.viewControllers=b||[]};iAd.PageController.prototype.getView=function(){var a=this.viewWasArchived,b=this.callSuper();if(a){this.scrollView=b.subviews[0];this.pageControl=b.subviews[1]}return b};
iAd.PageController.prototype.loadView=function(){if(!this.configuration.hasOwnProperty("requiredFileURIs")){this.view=new iAd.PageControllerView;this.createSubviews()}};iAd.PageController.prototype.viewDidLoad=function(){this.callSuper();if(this.contentView!=null){this.scrollView=this.outlets.scrollView;this.pageControl=this.outlets.pageControl;this.didCreateSubviews()}this._view.layer.addEventListener(iAd.SpatialNavigationManager.NAVIGATE_EVENT,this,false)};
iAd.PageController.prototype.setViewControllers=function(a){this._viewControllers=a;if(this.subviewsWereCreated){this.pageControl.numberOfPages=a.length;this.layoutPages()}};iAd.PageController.prototype.setScrollsInfinitely=function(a){if(this._scrollsInfinitely!=a){this._scrollsInfinitely=a;this.layoutPages()}};iAd.PageController.prototype.setVisiblePagesPerSide=function(a){a=Math.max(a,1);if(this._visiblePagesPerSide!=a){this._visiblePagesPerSide=a;this.layoutPages()}};
iAd.PageController.prototype.createSubviews=function(){this._view.size=new iAd.Size(window.innerWidth,window.innerHeight);this.scrollView=this._view.addSubview(new iAd.ScrollView);this.pageControl=this._view.addSubview(new iAd.PageControl);this.didCreateSubviews()};
iAd.PageController.prototype.didCreateSubviews=function(){this.scrollView.size=this._view.size.copy();this.scrollView.showsHorizontalScrollIndicator=false;this.scrollView.autoresizingMask=iAd.View.AUTORESIZING_FLEXIBLE_WIDTH|iAd.View.AUTORESIZING_FLEXIBLE_HEIGHT;this.pageControl.position=new iAd.Point(0,this._view.size.height-iAd.PageController.DEFAULT_PAGE_CONTROL_HEIGHT);this.pageControl.size=new iAd.Size(this.scrollView.size.width,iAd.PageController.DEFAULT_PAGE_CONTROL_HEIGHT);this.pageControl.autoresizingMask=
iAd.View.AUTORESIZING_FLEXIBLE_TOP_MARGIN|iAd.View.AUTORESIZING_FLEXIBLE_WIDTH;this.scrollView.pagingEnabled=true;this.pageControl.numberOfPages=this._viewControllers.length;this.pageControl.addEventListener(iAd.Control.VALUE_CHANGE_EVENT,this,false);this.scrollView.delegate=this;this.scrollView.addPropertyObserver("tracking",this,"scrollViewTrackingDidChange");this.subviewsWereCreated=true;this.layoutPages()};
iAd.PageController.prototype.updateStateProperties=function(){this.pageWidth=this.scrollView.size.width;this.currentPage=this.pageControl.currentPage;this.canScrollLeft=this.scrollsInfinitely||this.currentPage!=0;this.canScrollRight=this.scrollsInfinitely||this.currentPage!=this._viewControllers.length-1};
iAd.PageController.prototype.layoutPages=function(){if(this.subviewsWereCreated){this.updateStateProperties();for(var a=this.pageWidth,b=this.currentPage,c=this._scrollsInfinitely,d=this._viewControllers.length,e=this.canScrollLeft?a:0,f=Math.floor(d/2),g,h,i,j,k,l=0;l<d;l++){k=this._viewControllers[l];g=l-b;h=Math.abs(g);i=c?Math.min(h,d-h):h;j=g;if(c)if(g>f)j=g-d;else if(h>f)j=d+g;g=e+a*j;if(i<=this._visiblePagesPerSide)this.positionViewAtX(k.view,g);else k.isViewLoaded()&&k.view.superview==this.scrollView&&
k.view.removeFromSuperview()}this.scrollView.contentOffset=new iAd.Point(e,0)}};iAd.PageController.prototype.positionViewAtX=function(a,b){a.position=new iAd.Point(b,0);a.size=this.scrollView.size.copy();if(a.superview!==this.scrollView){a.wantsHardwareLayerBacking=true;this.scrollView.addSubview(a)}};
iAd.PageController.prototype.handleEvent=function(a){if(a.type==iAd.SpatialNavigationManager.NAVIGATE_EVENT)this.handleNavigationEvent(a);else{this.callSuper(a);if(a.type==iAd.Control.VALUE_CHANGE_EVENT)if(this.shouldIgnoreCurrentPageChange)this.shouldIgnoreCurrentPageChange=false;else this.syncScrollViewToPageControl(this.pageControl.currentPage)}};
iAd.PageController.prototype.handleNavigationEvent=function(a){var b=false,c=this.pageControl,d=c.numberOfPages,e=a.ad.command;if(e==iAd.SpatialNavigationManager.DIRECTION_LEFT){if(this.scrollsInfinitely||c.currentPage>0){c.currentPage=(c.currentPage-1+d)%d;b=true}}else if(e==iAd.SpatialNavigationManager.DIRECTION_RIGHT)if(this.scrollsInfinitely||c.currentPage<c.numberOfPages-1){c.currentPage=(c.currentPage+1+d)%d;b=true}b&&a.preventDefault()};
iAd.PageController.prototype.syncScrollViewToPageControl=function(){var a=this.currentPage,b=this.pageControl.currentPage,c=this._viewControllers.length,d=false,e=this._viewControllers[b].view;if(Math.abs(b-a)<=1)d=true;if(this._scrollsInfinitely)if(a==0&&b==c-1||a==c-1&&b==0)d=true;if(d){this.animatingToNewPage=true;this.scrollView.setContentOffsetAnimated(new iAd.Point(e.position.x,0),true)}else this.layoutPages()};
iAd.PageController.prototype.scrollViewTrackingDidChange=function(){if(this.scrollView.tracking){this.updateStateProperties();var a=this.scrollView.contentOffset.x+(this.canScrollLeft?0:this.pageWidth),b=this.paddedIndex(this.currentPage-1+Math.round(a/this.pageWidth));if(b!=this.currentPage){this.shouldIgnoreCurrentPageChange=true;this.pageControl.currentPage=b;this.layoutPages();this.scrollView.contentOffset=new iAd.Point(this.scrollView.contentOffset.x>a?a+this.pageWidth:a-this.pageWidth,0)}}};
iAd.PageController.prototype.scrollViewMayHaveMovedToNewPage=function(){this.updateStateProperties();var a=Math.round(this.currentPage+(this.scrollView.contentOffset.x-(this.canScrollLeft?this.pageWidth:0))/this.pageWidth);if(this.currentPage!==a){this.pageControl.currentPage=this.paddedIndex(a);this.layoutPages()}};iAd.PageController.prototype.scrollViewDidEndScrollingAnimation=function(){if(this.animatingToNewPage){this.animatingToNewPage=false;this.layoutPages()}else this.scrollViewMayHaveMovedToNewPage()};
iAd.PageController.prototype.scrollViewWillBeginDecelerating=function(){if(this.scrollView.bounces){this.updateStateProperties();var a=this.scrollView.decelerationVelocity.x<0,b=this.paddedIndex(this.currentPage+(a?-1:1)),c=this.scrollsInfinitely||b!=0;b=this.scrollsInfinitely||b!=this._viewControllers.length-1;if(!(a&&!c||!a&&!b)){if(a){a=this.currentPage-2;c=-this.pageWidth}else{a=this.currentPage+2;c=this.pageWidth*(this.canScrollLeft?3:2)}this.positionViewAtX(this._viewControllers[this.paddedIndex(a)].view,
c)}}};iAd.PageController.prototype.scrollViewDidEndDecelerating=function(){this.scrollViewMayHaveMovedToNewPage()};iAd.PageController.prototype.paddedIndex=function(a){return this.scrollsInfinitely?(a+this.pageControl.numberOfPages)%this.pageControl.numberOfPages:iAd.Number.clampValue(a,0,this.pageControl.numberOfPages-1)};
iAd.PageController.pageControllerWithView=function(a){var b=new iAd.PageController({id:a.layer.hasAttribute("id")?a.layer.getAttribute("id"):"",properties:{view:a}});b.scrollView=b.outlets.scrollView;b.pageControl=b.outlets.pageControl;b.didCreateSubviews();for(var c=[],d=b.scrollView.subviews,e=0,f=d.length;e<f;e++){a=d[e];a._viewController==undefined&&a.createManagingViewController();c.push(a._viewController)}b.viewControllers=c;return b};
iAd.Class({name:"iAd.PageControllerView",superclass:iAd.View,cssClassName:"ad-page-controller-view"});iAd.PageControllerView.prototype.init=function(a){this.callSuper(a)};iAd.PageControllerView.prototype.readPropertiesFromLayerAttributes=function(a){iAd.PageController.pageControllerWithView(this);this.callSuper(a)};iAd.PageControllerView.prototype.setValueForAttribute=function(a,b){if(b=="ad-scrolls-infinitely")this._viewController.scrollsInfinitely=a!="false";else this.callSuper(a,b)};
iAd.Class({name:"iAd.PopoverView",superclass:iAd.View,cssClassName:"ad-popover-view",synthesizedProperties:["shineVisible"]});iAd.PopoverView.instanceCounter=0;iAd.PopoverView.ARROW_DIRECTION_UP=1;iAd.PopoverView.ARROW_DIRECTION_DOWN=2;iAd.PopoverView.ARROW_DIRECTION_LEFT=4;iAd.PopoverView.ARROW_DIRECTION_RIGHT=8;iAd.PopoverView.PRESENTATION_MARGIN=10;iAd.PopoverView.CONTENT_INSET=8;iAd.PopoverView.ARROW_SIZE=18;
iAd.PopoverView.prototype.init=function(a){if(!iAd.PopoverView.canvasSpriteImage)iAd.PopoverView.canvasSpriteImage=iAd.Image.imageForURL(iAd.Path.assetsPath+"popover~ipad.png",true);this._shineVisible=false;this.arrowDirection=null;this.callSuper(a)};
iAd.PopoverView.prototype.createLayer=function(){this.callSuper();this.hostView=this.addSubview(new iAd.View);this.hostView.layer.addClassName("ad-popover-hosting-layer");this.shine=this.layer.appendChild(document.createElement("div"));this.shine.className="ad-popover-shine";this.canvasContextId="ad-popover-background-"+ ++iAd.PopoverView.instanceCounter;this.layer.style.backgroundImage="-webkit-canvas("+this.canvasContextId+")"};
iAd.PopoverView.prototype.setShineVisible=function(a){this.shine.style.visibility=a?"visible":"hidden";this._shineVisible=a};iAd.PopoverView.prototype.canvasSpriteImageDidLoad=function(){iAd.PopoverView.canvasSpriteImage.removePropertyObserver("loaded",this,"canvasSpriteImageDidLoad");this.draw()};
iAd.PopoverView.prototype.sizeForContentSize=function(a,b){var c=new iAd.Size;if(b===iAd.PopoverView.ARROW_DIRECTION_UP||b===iAd.PopoverView.ARROW_DIRECTION_DOWN){c.width=a.width+2*iAd.PopoverView.CONTENT_INSET;c.height=a.height+iAd.PopoverView.ARROW_SIZE+2*iAd.PopoverView.CONTENT_INSET}else if(b===iAd.PopoverView.ARROW_DIRECTION_LEFT||b===iAd.PopoverView.ARROW_DIRECTION_RIGHT){c.width=a.width+iAd.PopoverView.ARROW_SIZE+2*iAd.PopoverView.CONTENT_INSET;c.height=a.height+2*iAd.PopoverView.CONTENT_INSET}return c};
iAd.PopoverView.prototype.updateHostViewFrameWithArrowDirection=function(a){var b=new iAd.Rect(0,0,this.size.width,this.size.height),c=new iAd.EdgeInsets(iAd.PopoverView.CONTENT_INSET+(a===iAd.PopoverView.ARROW_DIRECTION_UP?iAd.PopoverView.ARROW_SIZE:0)-1,iAd.PopoverView.CONTENT_INSET+(a===iAd.PopoverView.ARROW_DIRECTION_RIGHT?iAd.PopoverView.ARROW_SIZE:0),iAd.PopoverView.CONTENT_INSET+(a===iAd.PopoverView.ARROW_DIRECTION_DOWN?iAd.PopoverView.ARROW_SIZE:0),iAd.PopoverView.CONTENT_INSET+(a===iAd.PopoverView.ARROW_DIRECTION_LEFT?
iAd.PopoverView.ARROW_SIZE:0));b=b.inset(c);this.hostView.frame=b;this.shine.style.webkitTransform=iAd.CSS.t3d(0,b.size.height-39+(a===iAd.PopoverView.ARROW_DIRECTION_UP?iAd.PopoverView.ARROW_SIZE:0),0)};
iAd.PopoverView.prototype.applyBestFrameWithPresentationFrame=function(a,b,c,d){var e=new iAd.Rect,f=new iAd.Point(b.midX(),b.midY()),g=this.sizeForContentSize(a,iAd.PopoverView.ARROW_DIRECTION_LEFT);a=this.sizeForContentSize(a,iAd.PopoverView.ARROW_DIRECTION_UP);e=Array(4);e[0]=c&iAd.PopoverView.ARROW_DIRECTION_UP?new iAd.Rect(f.x-Math.floor(a.width/2),b.origin.y+b.size.height,a.width,a.height):iAd.Rect.ZERO_RECT;e[1]=c&iAd.PopoverView.ARROW_DIRECTION_DOWN?new iAd.Rect(f.x-Math.floor(a.width/2),
b.origin.y-a.height,a.width,a.height):iAd.Rect.ZERO_RECT;e[2]=c&iAd.PopoverView.ARROW_DIRECTION_LEFT?new iAd.Rect(b.origin.x+b.size.width,f.y-Math.floor(g.height/2),g.width,g.height):iAd.Rect.ZERO_RECT;e[3]=c&iAd.PopoverView.ARROW_DIRECTION_RIGHT?new iAd.Rect(b.origin.x-g.width,f.y-Math.floor(g.height/2),g.width,g.height):iAd.Rect.ZERO_RECT;var h,i,j,k=0;c=0;a=g=iAd.Rect.ZERO_RECT;for(var l=0;l<4;l++){i=d.copy();switch(1<<l){case iAd.PopoverView.ARROW_DIRECTION_UP:i.size.height-=b.maxY()-i.origin.y;
i.origin.y=b.maxY();break;case iAd.PopoverView.ARROW_DIRECTION_DOWN:i.size.height=b.origin.y-i.origin.y;i=i.intersectionWithRect(d);break;case iAd.PopoverView.ARROW_DIRECTION_LEFT:i.size.width-=b.maxX()-i.origin.x;i.origin.x=b.maxX();break;case iAd.PopoverView.ARROW_DIRECTION_RIGHT:i.size.width=b.origin.x-i.origin.x}h=e[l].intersectionWithRect(i);j=h.size.width*h.size.height;if(j>k){k=j;c=l;g=h;a=i}}e=e[c];if(g.origin.x>e.origin.x)e.origin.x=g.origin.x;else e.origin.x-=e.size.width-g.size.width;if(g.origin.y>
e.origin.y)e.origin.y=g.origin.y;else e.origin.y-=e.size.height-g.size.height;this.frame=e=e.intersectionWithRect(a);this.arrowDirection=1<<c;this.drawWithArrowPositionAndDirection(f,this.arrowDirection);this.updateHostViewFrameWithArrowDirection(this.arrowDirection)};
iAd.PopoverView.prototype.drawWithArrowPositionAndDirection=function(a,b){this.desiredArrowPosition=a;this.arrowDirection=b;iAd.PopoverView.canvasSpriteImage.loaded?this.draw():iAd.PopoverView.canvasSpriteImage.addPropertyObserver("loaded",this,"canvasSpriteImageDidLoad")};
iAd.PopoverView.prototype.draw=function(){var a=this.desiredArrowPosition.x-this.position.x,b=this.desiredArrowPosition.y-this.position.y,c=this.scaleFactor=iAd.Device.HAS_HIDPI_DISPLAY?2:1,d=this.size.width,e=this.size.height,f=iAd.PopoverView.canvasSpriteImage.element,g=this.context=document.getCSSCanvasContext("2d",this.canvasContextId,d*c,e*c);this.setLayerStyle({"background-size":d+"px "+e+"px"});g.clearRect(0,0,d*c,e*c);if(this.arrowDirection===iAd.PopoverView.ARROW_DIRECTION_UP)if(a<29)this.drawCanvasBackgroundForUpArrowAtLeft(g,
f,d,e);else a>this.size.width-29?this.drawCanvasBackgroundForUpArrowAtRight(g,f,d,e):this.drawCanvasBackgroundForUpArrow(g,f,d,e,a);else if(this.arrowDirection===iAd.PopoverView.ARROW_DIRECTION_DOWN)if(a<29)this.drawCanvasBackgroundForDownArrowAtLeft(g,f,d,e);else a>this.size.width-29?this.drawCanvasBackgroundForDownArrowAtRight(g,f,d,e):this.drawCanvasBackgroundForDownArrow(g,f,d,e,a);else if(this.arrowDirection===iAd.PopoverView.ARROW_DIRECTION_RIGHT)if(b<43)this.drawCanvasBackgroundForRightArrowAtTop(g,
f,d,e);else b>this.size.height-29?this.drawCanvasBackgroundForRightArrowAtBottom(g,f,d,e):this.drawCanvasBackgroundForRightArrow(g,f,d,e,b);else if(this.arrowDirection===iAd.PopoverView.ARROW_DIRECTION_LEFT)if(b<43)this.drawCanvasBackgroundForLeftArrowAtTop(g,f,d,e);else b>this.size.height-29?this.drawCanvasBackgroundForLeftArrowAtBottom(g,f,d,e):this.drawCanvasBackgroundForLeftArrow(g,f,d,e,b)};
iAd.PopoverView.prototype.drawImage=function(a,b,c,d,e,f,g,h,i){var j=this.scaleFactor;this.context.drawImage(a,b*j,c*j,d*j,e*j,f*j,g*j,h*j,i*j)};iAd.PopoverView.prototype.drawCanvasBackgroundFlippedHorizontally=function(a,b,c,d,e,f){var g=this.scaleFactor;b.scale(-1,1);b.translate(-d*g,0);this[a](b,c,d,e,f);b.scale(-1,1);b.translate(-d*g,0)};
iAd.PopoverView.prototype.drawCanvasBackgroundForUpArrowAtLeft=function(a,b,c,d){this.drawCanvasBackgroundFlippedHorizontally("drawCanvasBackgroundForUpArrowAtRight",a,b,c,d)};
iAd.PopoverView.prototype.drawCanvasBackgroundForUpArrowAtRight=function(a,b,c,d){this.drawImage(b,283,0,10,41,0,0,10,41);this.drawImage(b,293,0,1,41,10,0,c-52,41);this.drawImage(b,294,0,42,41,c-42,0,42,41);this.drawImage(b,283,41,10,1,0,41,10,d-51);this.drawImage(b,293,41,1,1,10,41,c-20,d-51);this.drawImage(b,326,41,10,1,c-10,41,10,d-51);this.drawImage(b,283,42,10,10,0,d-10,10,10);this.drawImage(b,293,42,1,10,10,d-10,c-20,10);this.drawImage(b,326,42,10,10,c-10,d-10,10,10)};
iAd.PopoverView.prototype.drawCanvasBackgroundForUpArrow=function(a,b,c,d,e){a=Math.round(e-17.5);this.drawImage(b,226,0,10,41,0,0,10,41);this.drawImage(b,236,0,1,41,10,0,a-10,41);this.drawImage(b,237,0,35,41,a,0,35,41);this.drawImage(b,272,0,1,41,a+35,0,c-10-a-35,41);this.drawImage(b,273,0,10,41,c-10,0,10,41);this.drawImage(b,226,41,10,1,0,41,10,d-51);this.drawImage(b,236,41,1,1,10,41,c-20,d-51);this.drawImage(b,273,41,10,1,c-10,41,10,d-51);this.drawImage(b,226,42,10,10,0,d-10,10,10);this.drawImage(b,
236,42,1,10,10,d-10,c-20,10);this.drawImage(b,273,42,10,10,c-10,d-10,10,10)};iAd.PopoverView.prototype.drawCanvasBackgroundForDownArrowAtLeft=function(a,b,c,d){this.drawCanvasBackgroundFlippedHorizontally("drawCanvasBackgroundForDownArrowAtRight",a,b,c,d)};
iAd.PopoverView.prototype.drawCanvasBackgroundForDownArrowAtRight=function(a,b,c,d){this.drawImage(b,58,0,10,24,0,0,10,24);this.drawImage(b,68,0,1,24,10,0,c-20,24);this.drawImage(b,102,0,10,24,c-10,0,10,24);this.drawImage(b,58,24,10,1,0,24,10,d-51);this.drawImage(b,68,24,1,1,10,24,c-20,d-51);this.drawImage(b,102,24,10,1,c-10,24,10,d-51);this.drawImage(b,58,25,10,27,0,d-27,10,27);this.drawImage(b,68,25,1,27,10,d-27,c-53,27);this.drawImage(b,69,25,43,27,c-43,d-27,43,27)};
iAd.PopoverView.prototype.drawCanvasBackgroundForDownArrow=function(a,b,c,d,e){a=Math.round(e-17.5);this.drawImage(b,0,0,10,24,0,0,10,24);this.drawImage(b,10,0,1,24,10,0,c-20,24);this.drawImage(b,48,0,10,24,c-10,0,10,24);this.drawImage(b,0,24,10,1,0,24,10,d-51);this.drawImage(b,10,24,1,1,10,24,c-20,d-51);this.drawImage(b,48,24,10,1,c-10,24,10,d-51);this.drawImage(b,0,25,10,27,0,d-27,10,27);this.drawImage(b,10,25,1,27,10,d-27,a-10,27);this.drawImage(b,11,25,37,27,a,d-27,37,27);this.drawImage(b,10,
25,1,27,a+37,d-27,c-10-a-37,27);this.drawImage(b,48,25,10,27,c-10,d-27,10,27)};
iAd.PopoverView.prototype.drawCanvasBackgroundForRightArrowAtTop=function(a,b,c,d){this.drawImage(b,188,0,10,43,0,0,10,43);this.drawImage(b,198,0,1,43,10,0,c-37,43);this.drawImage(b,199,0,27,43,c-27,0,27,43);this.drawImage(b,188,43,10,1,0,43,10,d-52);this.drawImage(b,198,43,1,1,10,43,c-37,d-52);this.drawImage(b,199,43,10,1,c-27,43,10,d-52);this.drawImage(b,188,44,10,9,0,d-9,10,9);this.drawImage(b,198,44,1,9,10,d-9,c-37,9);this.drawImage(b,199,44,27,9,c-27,d-9,27,9)};
iAd.PopoverView.prototype.drawCanvasBackgroundForRightArrowAtBottom=function(a,b,c,d){this.drawImage(b,150,0,10,24,0,0,10,24);this.drawImage(b,160,0,1,24,10,0,c-37,24);this.drawImage(b,161,0,27,24,c-27,0,27,24);this.drawImage(b,150,24,10,1,0,24,10,d-67);this.drawImage(b,160,24,1,1,10,24,c-37,d-67);this.drawImage(b,161,24,10,1,c-27,24,10,d-67);this.drawImage(b,150,25,10,43,0,d-43,10,43);this.drawImage(b,160,25,1,43,10,d-43,c-37,43);this.drawImage(b,161,25,27,43,c-27,d-43,27,43)};
iAd.PopoverView.prototype.drawCanvasBackgroundForRightArrow=function(a,b,c,d,e){a=Math.round(e-18.5);this.drawImage(b,112,0,10,24,0,0,10,24);this.drawImage(b,112,24,10,1,0,24,10,d-33);this.drawImage(b,112,63,10,9,0,d-9,10,9);this.drawImage(b,122,0,1,24,10,0,c-37,24);this.drawImage(b,122,24,1,1,10,24,c-37,d-33);this.drawImage(b,122,63,1,9,10,d-9,c-37,9);this.drawImage(b,123,0,27,24,c-27,0,27,24);this.drawImage(b,123,24,27,1,c-27,24,27,a-24);this.drawImage(b,123,25,27,37,c-27,a,27,37);this.drawImage(b,
123,62,27,1,c-27,a+37,27,d-a-46);this.drawImage(b,123,63,27,9,c-27,d-9,27,9)};iAd.PopoverView.prototype.drawCanvasBackgroundForLeftArrowAtTop=function(a,b,c,d){this.drawCanvasBackgroundFlippedHorizontally("drawCanvasBackgroundForRightArrowAtTop",a,b,c,d)};iAd.PopoverView.prototype.drawCanvasBackgroundForLeftArrowAtBottom=function(a,b,c,d){this.drawCanvasBackgroundFlippedHorizontally("drawCanvasBackgroundForRightArrowAtBottom",a,b,c,d)};
iAd.PopoverView.prototype.drawCanvasBackgroundForLeftArrow=function(a,b,c,d,e){this.drawCanvasBackgroundFlippedHorizontally("drawCanvasBackgroundForRightArrow",a,b,c,d,e)};iAd.Class({name:"iAd.BarItem",synthesizedProperties:["enabled","image","imageOffset","title"],archivedProperties:["enabled","image","imageOffset","title","tag"]});iAd.BarItem.DISABLED_CSS="ad-disabled";
iAd.BarItem.prototype.init=function(){this.callSuper();this._enabled=true;this._imageOffset=this._image=null;this._title="";this.tag=0};iAd.Class({name:"iAd.BarButton",superclass:iAd.Control,synthesizedProperties:["maxWidth","width","type","buttonStyle","image","imageOffset","title"],archivedProperties:["maxWidth","width","type","buttonStyle","image","imageOffset","title"],cssClassName:"ad-bar-button",collectionAccessor:"barButtons"});iAd.BarButton.DEFAULT_HEIGHT=30;
iAd.BarButton.DELETE_DEFAULT_HEIGHT=34;iAd.BarButton.POINTY_X_OFFSET=3;iAd.BarButton.FONT_DEFAULT="bold 12px Helvetica";iAd.BarButton.FONT_PLAIN="bold 20px Helvetica";iAd.BarButton.HAS_HIDPI_VERSION_ATTR="ad-has-hidpi-version";
iAd.BarButton.prototype.init=function(a,b){this._width=this._maxWidth=0;this._buttonStyle=this._type="";this._imageOffset=this._image=null;this._title="";this.previouslyMeasuredTitle=null;this.usesAutomaticImageOffset=true;this.callSuper(a);if(!this.usesDeclarativeBacking){this.type=b!=null?b:iAd.BarButtonItem.TYPE_SQUARE;this.buttonStyle=iAd.BarButtonItem.STYLE_DEFAULT}};
iAd.BarButton.prototype.setupLayer=function(){this.callSuper();if(this.layer.hasClassName(iAd.BarButtonItem.STYLE_BLACK))this._buttonStyle=iAd.BarButtonItem.STYLE_BLACK;else if(this.layer.hasClassName(iAd.BarButtonItem.STYLE_DEFAULT))this._buttonStyle=iAd.BarButtonItem.STYLE_DEFAULT;else if(this.layer.hasClassName(iAd.BarButtonItem.STYLE_DONE))this._buttonStyle=iAd.BarButtonItem.STYLE_DONE;if(this.layer.hasClassName(iAd.BarButtonItem.TYPE_PLAIN))this._type=iAd.BarButtonItem.TYPE_PLAIN;else if(this.layer.hasClassName(iAd.BarButtonItem.TYPE_SQUARE))this._type=
iAd.BarButtonItem.TYPE_SQUARE;else if(this.layer.hasClassName(iAd.BarButtonItem.TYPE_BACK))this._type=iAd.BarButtonItem.TYPE_BACK;else if(this.layer.hasClassName(iAd.BarButtonItem.TYPE_FLEXIBLE_SPACE))this._type=iAd.BarButtonItem.TYPE_FLEXIBLE_SPACE;else if(this.layer.hasClassName(iAd.BarButtonItem.TYPE_FIXED_SPACE))this._type=iAd.BarButtonItem.TYPE_FIXED_SPACE;this.width=this.layerHasCustomAttribute("ad-width")?parseInt(this.getLayerCustomAttributeValue("ad-width"),10):0};
iAd.BarButton.prototype.layerWasCreated=function(){this.callSuper();this.layer.setAttribute("role","button");this.background=this.layer.appendChild(document.createElement("div"));this.icon=this.layer.appendChild(document.createElement("img"))};iAd.BarButton.prototype.readPropertiesFromLayerComputedStyle=function(a){this.callSuper(a);a=parseInt(a.maxWidth,10);this.maxWidth=isNaN(a)?0:a};
iAd.BarButton.prototype.setValueForAttribute=function(a,b){switch(b){case "ad-image":this.image=iAd.Image.imageForURL(a,this.layerHasCustomAttribute(iAd.BarButton.HAS_HIDPI_VERSION_ATTR));case iAd.BarButton.HAS_HIDPI_VERSION_ATTR:break;case "ad-image-offset-x":this.imageOffset=new iAd.Point(parseInt(a,10),this.imageOffset.y);break;case "ad-image-offset-y":this.imageOffset=new iAd.Point(this.imageOffset.x,parseInt(a,10));break;default:this.callSuper(a,b)}};
iAd.BarButton.prototype.getSize=function(){return new iAd.Size(this._maxWidth==0?this._size.width:Math.min(this._maxWidth,this._size.width),this._size.height)};iAd.BarButton.prototype.setSize=function(a){a.height=this.defaultHeight;this.callSuper(a)};iAd.BarButton.prototype.touchesBegan=function(a){this.type==iAd.BarButtonItem.TYPE_FLEXIBLE_SPACE||this.type==iAd.BarButtonItem.TYPE_FIXED_SPACE?a.preventDefault():this.callSuper(a)};
iAd.BarButton.prototype.layerWasInsertedIntoDocument=function(){this.callSuper();this.imageRequiresPositioning&&this.positionImage()};iAd.BarButton.prototype.setMaxWidth=function(a){this.layer.style.maxWidth=a==0?"inherit":a+"px";this._maxWidth=a;this._width==0&&this.autoSizeTitle()};iAd.BarButton.prototype.setWidth=function(a){if(a==0){this.autoSizeTitle();this.autoSizeImage()}else{this._width=a;this.size=new iAd.Size(a,this.defaultHeight)}this.positionImage()};
iAd.BarButton.prototype.autoSizeTitle=function(){if(!(this._title==""||this._title==this.previouslyMeasuredTitle)){var a=this._type===iAd.BarButtonItem.TYPE_PLAIN,b=iAd.CSS.widthForTextAndFont(this._title,a?iAd.BarButton.FONT_PLAIN:iAd.BarButton.FONT_DEFAULT);if(!a){b+=20;if(this._type===iAd.BarButtonItem.TYPE_BACK)b+=4}this.size=new iAd.Size(b,this._size.height);this.previouslyMeasuredTitle=this._title}};
iAd.BarButton.prototype.autoSizeImage=function(){if(this._image!=null){var a=this.getBorderXOffsets();this.size=new iAd.Size(this._image.width+a.left+a.right,this._size.height)}};iAd.BarButton.prototype.setTitle=function(a){this._title=this.background.textContent=a;this._width==0&&this.autoSizeTitle()};iAd.BarButton.prototype.setImage=function(a){if(this._image=a){this.icon.src=a.resolvedURL;a.loaded?this.positionImage():a.addPropertyObserver("loaded",this)}else this.icon.src=""};
iAd.BarButton.prototype.getImageOffset=function(){return new iAd.Point(parseInt(this.icon.style.left),parseInt(this.icon.style.top))};iAd.BarButton.prototype.setImageOffset=function(a){if(a){this.icon.style.left=a.x+"px";this.icon.style.top=a.y+"px";this.usesAutomaticImageOffset=false}};
iAd.BarButton.prototype.positionImage=function(){if(!(this._image==null||!this.usesAutomaticImageOffset))if(this.layerIsInDocument){var a=Math.min(this._image.height,this.size.height),b=this.getBorderXOffsets();this.icon.height=a;this.imageOffset=new iAd.Point((this._size.width-b.left-b.right)/2-this._image.width/2,(this.defaultHeight-this._image.height)/2);this.usesAutomaticImageOffset=true;this.imageRequiresPositioning=false}else this.imageRequiresPositioning=true};
iAd.BarButton.prototype.setType=function(a){this.layer.removeClassName(this._type);this.layer.addClassName(a);this._type=a;this.positionImage()};iAd.BarButton.prototype.setButtonStyle=function(a){this.layer.removeClassName(this._buttonStyle);this.layer.addClassName(a);this._buttonStyle=a;this.defaultHeight=a==iAd.BarButtonItem.STYLE_DELETE?iAd.BarButton.DELETE_DEFAULT_HEIGHT:iAd.BarButton.DEFAULT_HEIGHT};
iAd.BarButton.prototype.getBorderXOffsets=function(){var a=window.getComputedStyle(this.layer),b=a.getPropertyCSSValue("border-left-width");a=a.getPropertyCSSValue("border-right-width");return{left:b!=null?b.getFloatValue(CSSPrimitiveValue.CSS_PX):0,right:a!=null?a.getFloatValue(CSSPrimitiveValue.CSS_PX):0}};iAd.BarButton.prototype.handlePropertyChange=function(){this._width==0&&this.autoSizeImage();this.positionImage()};
iAd.BarButton.prototype.dispatchEvent=function(a){if(this.barButtonItem)a.ad.sender=this.barButtonItem;this.callSuper(a)};iAd.Class({name:"iAd.BarButtonItem",superclass:iAd.BarItem,mixins:[iAd.EventTarget],synthesizedProperties:["maxWidth","customView","width","type","style"],archivedProperties:["maxWidth","customView","width","type","style"]});iAd.BarButtonItem.TYPE_PLAIN="ad-plain";iAd.BarButtonItem.TYPE_SQUARE="ad-square";iAd.BarButtonItem.TYPE_BACK="ad-back";
iAd.BarButtonItem.TYPE_FLEXIBLE_SPACE="ad-flexible-space";iAd.BarButtonItem.TYPE_FIXED_SPACE="ad-fixed-space";iAd.BarButtonItem.STYLE_BLACK="ad-black";iAd.BarButtonItem.STYLE_DEFAULT="ad-default";iAd.BarButtonItem.STYLE_DONE="ad-done";iAd.BarButtonItem.STYLE_DELETE="ad-delete";iAd.BarButtonItem.prototype.init=function(a,b){this.callSuper();this.view=b||new iAd.BarButton(null,a);this.view.isCustomView=!(this.view instanceof iAd.BarButton);this.view.barButtonItem=this;this.eventTarget=this.view};
iAd.BarButtonItem.restoreFromArchive=function(a){return new this(a.type,a.customView)};iAd.BarButtonItem.prototype.getEnabled=function(){return!this.view.isCustomView?this.view.enabled:this.view.userInteractionEnabled};iAd.BarButtonItem.prototype.setEnabled=function(a){if(this.view.isCustomView)this.view.userInteractionEnabled=a;else this.view.enabled=a};iAd.BarButtonItem.prototype.getMaxWidth=function(){return!this.view.isCustomView?this.view.maxWidth:0};
iAd.BarButtonItem.prototype.setMaxWidth=function(a){if(!this.view.isCustomView)this.view.maxWidth=a};iAd.BarButtonItem.prototype.getWidth=function(){return!this.view.isCustomView?this.view.width:this.view.size.width};iAd.BarButtonItem.prototype.setWidth=function(a){if(this.view.isCustomView)this.view.size=new iAd.Size(a,this.view.size.height);else this.view.width=a};iAd.BarButtonItem.prototype.getTitle=function(){return!this.view.isCustomView?this.view.title:""};
iAd.BarButtonItem.prototype.setTitle=function(a){if(!this.view.isCustomView)this.view.title=a};iAd.BarButtonItem.prototype.getImage=function(){return!this.view.isCustomView?this.view.image:null};iAd.BarButtonItem.prototype.setImage=function(a){if(a&&!this.view.isCustomView)this.view.image=a};iAd.BarButtonItem.prototype.getImageOffset=function(){return!this.view.isCustomView?this.view.imageOffset:null};
iAd.BarButtonItem.prototype.setImageOffset=function(a){if(!this.view.isCustomView)this.view.imageOffset=a};iAd.BarButtonItem.prototype.getType=function(){return!this.view.isCustomView?this.view.type:""};iAd.BarButtonItem.prototype.setType=function(a){if(!this.view.isCustomView)this.view.type=a};iAd.BarButtonItem.prototype.getStyle=function(){return!this.view.isCustomView?this.view.buttonStyle:""};iAd.BarButtonItem.prototype.setStyle=function(a){if(!this.view.isCustomView)this.view.buttonStyle=a};
iAd.BarButtonItem.prototype.getCustomView=function(){return this.view.isCustomView?this.view:null};iAd.BarButtonItem.prototype.setCustomView=function(a){if(!(!a||a==this.view)){a.isCustomView=true;a.barButtonItem=this;this.view=a}};iAd.Class({name:"iAd.PopoverController",superclass:iAd.Object,synthesizedProperties:["contentViewController","popoverContentSize","popoverLayoutMargins"],archivedProperties:["contentViewController","popoverContentSize","popoverLayoutMargins"]});
iAd.PopoverController.CONTENT_VIEW_CSS="ad-popover-content-view";iAd.PopoverController.CONTENT_IS_NAVIGATION_CSS="ad-displays-navigation-controller";iAd.PopoverController.ARROW_DIRECTION_UP=iAd.PopoverView.ARROW_DIRECTION_UP;iAd.PopoverController.ARROW_DIRECTION_DOWN=iAd.PopoverView.ARROW_DIRECTION_DOWN;iAd.PopoverController.ARROW_DIRECTION_LEFT=iAd.PopoverView.ARROW_DIRECTION_LEFT;iAd.PopoverController.ARROW_DIRECTION_RIGHT=iAd.PopoverView.ARROW_DIRECTION_RIGHT;
iAd.PopoverController.ARROW_DIRECTION_UNKNOWN=Number.MAX_VALUE;iAd.PopoverController.ARROW_DIRECTION_ANY=iAd.PopoverController.ARROW_DIRECTION_UP|iAd.PopoverController.ARROW_DIRECTION_DOWN|iAd.PopoverController.ARROW_DIRECTION_LEFT|iAd.PopoverController.ARROW_DIRECTION_RIGHT;iAd.PopoverController.ANIMATION_DURATION=0.35;iAd.PopoverController.SHOULD_DISMISS_POPOVER_DELEGATE="popoverControllerShouldDismissPopover";iAd.PopoverController.DID_DISMISS_POPOVER_DELEGATE="popoverControllerDidDismissPopover";
iAd.PopoverController.prototype.init=function(a){this.callSuper();this._contentViewController=null;this._popoverContentSize=new iAd.Size;this.popoverVisible=false;this.popoverArrowDirection=iAd.PopoverController.ARROW_DIRECTION_UNKNOWN;this.passthroughViews=[];this.delegate=null;this.popoverPresentingOrDismissing=this.hostingNavigationController=false;this.dismissingTouchIdentifier=null;this.firstTouchWillNotDismiss=false;this.barButtonItemPopoverWasPresentedFrom=null;this.view=new iAd.PopoverView;
this.contentViewController=a};iAd.PopoverController.restoreFromArchive=function(a){return new this(a.contentViewController)};
iAd.PopoverController.prototype.setContentViewController=function(a){if(this._contentViewController!==a)if(a==null)iAd.Console.error("A PopoverController should have a non-null contentViewController");else{if(this._contentViewController!=null){this._contentViewController.view.layer.removeClassName(iAd.PopoverController.CONTENT_VIEW_CSS);this._contentViewController.parentViewController=null;if(this.hostingNavigationController){this._contentViewController.removePropertyObserver("toolbarHidden",this,
"navigationControllerToolbarVisibilityChanged");this._contentViewController.navigationBar.isInPopover=false;this._contentViewController.toolbar.isInPopover=false}this._contentViewController.removePropertyObserver("contentSizeForViewInPopover",this)}a.parentViewController=this;this._contentViewController=a;this.hostingNavigationController=a instanceof iAd.NavigationController;this.view.layer.toggleClassName(iAd.PopoverController.CONTENT_IS_NAVIGATION_CSS,this.hostingNavigationController);(this.hostingNavigationController?
a.backingTransitionController:a).view.layer.addClassName(iAd.PopoverController.CONTENT_VIEW_CSS);for(var b=this.view.hostView;b.subviews.length;)b.subviews[0].removeFromSuperview();var c=b.addSubview(a.view);c.position=new iAd.Point;c.size=b.size.copy();c.autoresizingMask=iAd.View.AUTORESIZING_FLEXIBLE_WIDTH|iAd.View.AUTORESIZING_FLEXIBLE_HEIGHT;if(this.hostingNavigationController){a.navigationBar.isInPopover=true;a.toolbar.isInPopover=true;a.addPropertyObserver("toolbarHidden",this,"navigationControllerToolbarVisibilityChanged");
this.navigationControllerToolbarVisibilityChanged()}this.popoverContentSize=a.contentSizeForViewInPopover.copy();a.addPropertyObserver("contentSizeForViewInPopover",this,"contentSizeForViewInPopoverChanged")}};iAd.PopoverController.prototype.contentSizeForViewInPopoverChanged=function(a){this.popoverContentSize=a.contentSizeForViewInPopover.copy()};iAd.PopoverController.prototype.setPopoverContentSize=function(a){this.setPopoverContentSizeAnimated(a,true)};
iAd.PopoverController.prototype.setPopoverContentSizeAnimated=function(a){a.width=iAd.Number.clampValue(a.width,320,600);this._popoverContentSize=a;this.popoverVisible&&this.view.applyBestFrameWithPresentationFrame(a,this.targetRect,this.arrowDirections,this.calculatePresentationFrame())};
iAd.PopoverController.prototype.setPopoverLayoutMargins=function(a){if(this._popoverLayoutMargins!=a){this._popoverLayoutMargins=a;this.popoverVisible&&this.view.applyBestFrameWithPresentationFrame(this._popoverContentSize,this.targetRect,this.arrowDirections,this.calculatePresentationFrame())}};iAd.PopoverController.prototype.getPopoverLayoutMargins=function(){if(!this._popoverLayoutMargins)return iAd.PopoverController.DEFAULT_LAYOUT_MARGINS;return this._popoverLayoutMargins};
iAd.PopoverController.prototype.calculatePresentationFrame=function(){return(new iAd.Rect(0,0,window.innerWidth,window.innerHeight)).inset(this.popoverLayoutMargins)};iAd.PopoverController.prototype.navigationControllerToolbarVisibilityChanged=function(){this.view.shineVisible=!this._contentViewController.toolbarHidden};
iAd.PopoverController.prototype.presentPopoverFromRectInViewPermittedArrowDirectionsAnimated=function(a,b,c,d){if(b.layerIsInDocument){var e=iAd.RootView.sharedRoot;b=window.webkitConvertPointFromNodeToPage(b.layer,new WebKitPoint(0,0));a=new iAd.Rect(a.origin.x+b.x,a.origin.y+b.y,a.size.width,a.size.height);this.view.applyBestFrameWithPresentationFrame(this.popoverContentSize,a,c,this.calculatePresentationFrame());this.targetRect=a;this.arrowDirections=c;window.addEventListener(iAd.Event.START_EVENT,
this,true);if(!this.popoverVisible||this.popoverPresentingOrDismissing){if(this.transition)this.transition.delegate=null;this._contentViewController!=null&&this._contentViewController.viewWillAppear(d);this.transition=this.view.applyTransition({properties:["opacity"],from:[0],to:[1],duration:d?iAd.PopoverController.ANIMATION_DURATION:0,delegate:this,_type:iAd.PopoverController.PRESENT_TRANSITION_TYPE});d||this.didPresentPopover(false)}e.addSubview(this.view);this.popoverArrowDirection=this.view.arrowDirection}};
iAd.PopoverController.prototype.presentPopoverFromBarButtonItemPermittedArrowDirectionsAnimated=function(a,b,c){var d=a.view;if(d!=null){this.presentPopoverFromRectInViewPermittedArrowDirectionsAnimated(d.frame,d.superview,b,c);this.barButtonItemPopoverWasPresentedFrom=a}};
iAd.PopoverController.prototype.dismissPopoverAnimated=function(a){window.removeEventListener(iAd.Event.START_EVENT,this,true);window.removeEventListener(iAd.Event.END_EVENT,this,true);window.removeEventListener(iAd.Event.CANCEL_EVENT,this,true);this.dismissingTouchIdentifier=null;this.firstTouchWillNotDismiss=false;this.barButtonItemPopoverWasPresentedFrom=null;this._contentViewController!=null&&this._contentViewController.viewWillDisappear(a);if(this.transition)this.transition.delegate=null;this.popoverPresentingOrDismissing=
true;this.transition=this.view.applyTransition({properties:["opacity"],from:[1],to:[0],duration:a?iAd.PopoverController.ANIMATION_DURATION:0,removesTargetUponCompletion:false,delegate:this,_type:iAd.PopoverController.DISMISS_TRANSITION_TYPE});if(!a){this.view.removeFromSuperview();this.didDismissPopover(false)}};iAd.PopoverController.PRESENT_TRANSITION_TYPE="present";iAd.PopoverController.DISMISS_TRANSITION_TYPE="dismiss";
iAd.PopoverController.prototype.transitionDidComplete=function(a){this.popoverPresentingOrDismissing=false;this.transition=null;if(a._type==iAd.PopoverController.PRESENT_TRANSITION_TYPE)this.didPresentPopover(true);else a._type==iAd.PopoverController.DISMISS_TRANSITION_TYPE&&this.didDismissPopover(true)};iAd.PopoverController.prototype.didPresentPopover=function(a){this.popoverVisible=true;this._contentViewController!=null&&this._contentViewController.viewDidAppear(a)};
iAd.PopoverController.prototype.didDismissPopover=function(a){this.popoverVisible=false;this.popoverArrowDirection=iAd.PopoverController.ARROW_DIRECTION_UNKNOWN;iAd.Utils.objectHasMethod(this.delegate,iAd.PopoverController.DID_DISMISS_POPOVER_DELEGATE)&&this.delegate[iAd.PopoverController.DID_DISMISS_POPOVER_DELEGATE](this);this.view.removeFromSuperview();this._contentViewController!=null&&this._contentViewController.viewDidDisappear(a)};
iAd.PopoverController.prototype.handleEvent=function(a){switch(a.type){case iAd.Event.START_EVENT:this.touchesBeganInWindow(a);break;case iAd.Event.END_EVENT:case iAd.Event.CANCEL_EVENT:this.touchesEndedInWindow(a);break;default:this.callSuper(a)}};
iAd.PopoverController.prototype.touchesBeganInWindow=function(a){if(!a._synthetic){window.addEventListener(iAd.Event.END_EVENT,this,true);window.addEventListener(iAd.Event.CANCEL_EVENT,this,true);var b=iAd.Event.SUPPORTS_TOUCHES?a.changedTouches[0]:a;if(this.isTouchTargetInPassthroughView(b.target)){if(this.dismissingTouchIdentifier==null)this.firstTouchWillNotDismiss=true}else{if(this.dismissingTouchIdentifier==null)this.dismissingTouchIdentifier=b.identifier||1;a.stopPropagation()}}};
iAd.PopoverController.prototype.isTouchTargetInPassthroughView=function(a){var b=[this.view];if(this._contentViewController==null||!this._contentViewController.modalInPopover){this.barButtonItemPopoverWasPresentedFrom!=null&&b.push(this.barButtonItemPopoverWasPresentedFrom.view.superview);b=b.concat(this.passthroughViews)}for(var c=0,d=b.length;c<d;c++)if(b[c].layer.contains(a))return true;return false};
iAd.PopoverController.prototype.touchesEndedInWindow=function(a){if(!a._synthetic){if(iAd.Event.SUPPORTS_TOUCHES){if(!this.firstTouchWillNotDismiss&&this.dismissingTouchIdentifier!=null){for(var b=false,c=a.changedTouches,d=0,e=c.length;d<e;d++)if(c[d].identifier===this.dismissingTouchIdentifier){b=true;break}if(!b)return}if(this.firstTouchWillNotDismiss&&a.touches.length==0){this.firstTouchWillNotDismiss=false;this.dismissingTouchIdentifier=null;return}}else if(this.firstTouchWillNotDismiss){this.dismissingTouchIdentifier=
null;this.firstTouchWillNotDismiss=false;return}a.stopPropagation();a=this._contentViewController!=null&&this._contentViewController.modalInPopover;if((a=!this.firstTouchWillNotDismiss&&!a)&&iAd.Utils.objectHasMethod(this.delegate,iAd.PopoverController.SHOULD_DISMISS_POPOVER_DELEGATE))a=this.delegate[iAd.PopoverController.SHOULD_DISMISS_POPOVER_DELEGATE](this);a&&this.dismissPopoverAnimated(true)}};
iAd.PopoverController.DEFAULT_LAYOUT_MARGINS=function(){var a=iAd.PopoverView.PRESENTATION_MARGIN;return new iAd.EdgeInsets(a,a,a,a)}();iAd.EventTriage={};iAd.EventTriage.handleEvent=function(a){iAd.Utils.objectIsInstanceOfClass(this,iAd.Object)&&this.callSuper(a);var b=a.type;b="handle"+b.charAt(0).toUpperCase()+b.substr(1);iAd.Utils.objectHasMethod(this,b)&&this[b](a)};iAd.Utils.setupDisplayNames(iAd.EventTriage,"iAd.EventTriage");
iAd.Class({name:"iAd.Label",superclass:iAd.View,synthesizedProperties:["numberOfLines","text","verticalAlignment"],archivedProperties:["numberOfLines","text","verticalAlignment"],cssClassName:"ad-label",collectionAccessor:"labels"});iAd.Label.VERTICAL_ALIGNMENT_TOP="top";iAd.Label.VERTICAL_ALIGNMENT_MIDDLE="middle";iAd.Label.VERTICAL_ALIGNMENT_BOTTOM="bottom";iAd.Label.prototype.init=function(a){this._text="";this._numberOfLines=1;this._verticalAlignment=iAd.Label.VERTICAL_ALIGNMENT_MIDDLE;this.callSuper(a)};
iAd.Label.prototype.layerWasCreated=function(){this.callSuper();this._text=this.layer.textContent;this._textContainer=document.createElement("div");this._textContainer.textContent=this._text;this.layer.textContent="";this.layer.appendChild(this._textContainer)};iAd.Label.prototype.setText=function(a){a=a==null?"":String(a);if(a!==this._text){this._text=a;this._textContainer.textContent=a}};
iAd.Label.prototype.setNumberOfLines=function(a){this._numberOfLines=a;if(a==0){this._textContainer.style.webkitLineClamp="100%";this._textContainer.style.overflow="visible"}else{this._textContainer.style.webkitLineClamp=a;this._textContainer.style.overflow="hidden"}};iAd.Label.prototype.setVerticalAlignment=function(a){this._verticalAlignment=a;var b="center";if(a==iAd.Label.VERTICAL_ALIGNMENT_TOP)b="start";else if(a==iAd.Label.VERTICAL_ALIGNMENT_BOTTOM)b="end";this.setLayerStyle({"-webkit-box-pack":b})};
iAd.Class({name:"iAd.Button",superclass:iAd.Control,synthesizedProperties:["currentTitle","autosized"],archivedProperties:["autoSized","type","titles"],excludedProperties:["subviews"],cssClassName:"ad-button",collectionAccessor:"buttons"});iAd.Button.TYPE_CUSTOM="ad-custom-type";iAd.Button.TYPE_ROUNDED_RECT="ad-rounded-rect-type";iAd.Button.TYPE_DETAIL_DISCLOSURE="ad-detail-disclosure-type";iAd.Button.TYPE_INFO_LIGHT="ad-info-light-type";iAd.Button.TYPE_INFO_DARK="ad-info-dark-type";
iAd.Button.TYPE_CONTACT_ADD="ad-contact-add-type";iAd.Button.TYPE_DELETION_ACCESSORY="ad-deletion-accessory-type";iAd.Button.DEFAULT_HEIGHT=37;iAd.Button.prototype.init=function(a,b){this.type=b||iAd.Button.TYPE_ROUNDED_RECT;this._autosized=true;this.titles=[""];this.titleLabel=null;this.callSuper(a)};iAd.Button.restoreFromArchive=function(a){return new this(null,a.type)};
iAd.Button.prototype.initWithDeclarativeBacking=function(){this.callSuper();if(this.layer.hasClassName(iAd.Button.TYPE_ROUNDED_RECT))this.type=iAd.Button.TYPE_ROUNDED_RECT;else if(this.layer.hasClassName(iAd.Button.TYPE_CUSTOM))this.type=iAd.Button.TYPE_CUSTOM;this.layer.addClassName(this.type)};iAd.Button.prototype.createLayer=function(){this.callSuper();this.layer.addClassName(this.type)};
iAd.Button.prototype.layerWasCreated=function(){this.callSuper();var a=this.layer;a.setAttribute("role","button");if(this.type===iAd.Button.TYPE_ROUNDED_RECT||this.type===iAd.Button.TYPE_CUSTOM)this.titleLabel=this.addSubview(new iAd.Label);else this.type===iAd.Button.TYPE_DELETION_ACCESSORY&&a.appendChild(document.createElement("div"));this.syncTitleToState();this.addPropertyObserver("state",this,"syncTitleToState")};
iAd.Button.prototype.setValueForAttribute=function(a,b){switch(b){case "ad-title-for-normal-state":this.setTitleForState(a,iAd.Control.STATE_NORMAL);break;case "ad-title-for-highlighted-state":this.setTitleForState(a,iAd.Control.STATE_HIGHLIGHTED);break;case "ad-title-for-disabled-state":this.setTitleForState(a,iAd.Control.STATE_DISABLED);break;case "ad-title-for-selected-state":this.setTitleForState(a,iAd.Control.STATE_SELECTED);break;default:this.callSuper(a,b)}};
iAd.Button.prototype.getSize=function(){var a=window.getComputedStyle(this.layer);return new iAd.Size(parseInt(a.width),parseInt(a.height))};iAd.Button.prototype.setSize=function(a){this._autoSized=false;this.callSuper(a)};iAd.Button.prototype.getCurrentTitle=function(){if(this.titleLabel==null)return null;return this.titleLabel.text};iAd.Button.prototype.setAutosized=function(a){a&&this.setLayerStyle({width:"auto",height:iAd.Button.DEFAULT_HEIGHT+"px"});this._autosized=a};
iAd.Button.prototype.titleForState=function(a){return this.titles[a]||null};iAd.Button.prototype.setTitleForState=function(a,b){this.titles[b]=a;b==this.state&&this.syncTitleToState()};iAd.Button.prototype.syncTitleToState=function(){if(this.titleLabel!=null)this.titleLabel.text=this.titles[this.state]||this.titles[iAd.Control.STATE_NORMAL]};
iAd.Class({name:"iAd.SearchBar",superclass:iAd.View,mixins:[iAd.EventTriage],synthesizedProperties:["barStyle","placeholder","text","showsCancelButton","editing","showsBookmarkButton"],archivedProperties:["barStyle","placeholder","text","showsCancelButton","editing","showsBookmarkButton"],excludedProperties:["subviews"],cssClassName:"ad-search-bar",collectionAccessor:"searchBars"});iAd.SearchBar.DEFAULT_HEIGHT=44;iAd.SearchBar.STYLE_DEFAULT="ad-default";iAd.SearchBar.STYLE_BLACK="ad-black";
iAd.SearchBar.STYLE_BLACK_TRANSLUCENT="ad-black-translucent";iAd.SearchBar.TEXT_DID_CHANGE="searchBarTextDidChange";iAd.SearchBar.TEXT_DID_BEGIN_EDITING="searchBarTextDidBeginEditing";iAd.SearchBar.TEXT_DID_END_EDITING="searchBarTextDidEndEditing";iAd.SearchBar.CANCEL_BUTTON_CLICKED="searchBarCancelButtonClicked";iAd.SearchBar.BOOKMARK_BUTTON_CLICKED="searchBarBookmarkButtonClicked";iAd.SearchBar.SHOWS_CANCEL_BUTTON_CSS="ad-shows-cancel-button";iAd.SearchBar.DISPLAYS_PLACEHOLDER="ad-displays-placeholder";
iAd.SearchBar.SHOWS_BOOKMARK_BUTTON_CSS="ad-shows-bookmark-button";
iAd.SearchBar.prototype.init=function(a){this.delegate=null;this._barStyle=iAd.SearchBar.STYLE_DEFAULT;this._text=this._placeholder="";this.hasBeenExplicitelySized=this._showsBookmarkButton=this._editing=this._showsCancelButton=false;this.callSuper(a);this.field.addEventListener("focus",this,false);this.field.addEventListener("blur",this,false);this.field.addEventListener("input",this,false);this.field.parentNode.addEventListener("submit",this,false);this.button.addEventListener(iAd.View.ACTIVATE_EVENT,
this,false);this.emptyButton.addEventListener(iAd.View.ACTIVATE_EVENT,this,false);this.button.view.addPropertyObserver("size",this,"updateLayout");this.autoresizesSubviews=false;this.checkForPlaceholderDisplay()};iAd.SearchBar.prototype.setupLayer=function(){this.callSuper();if(this.layer.hasClassName(iAd.SearchBar.STYLE_BLACK))this._barStyle=iAd.SearchBar.STYLE_BLACK;else if(this.layer.hasClassName(iAd.SearchBar.STYLE_BLACK_TRANSLUCENT))this._barStyle=iAd.SearchBar.STYLE_BLACK_TRANSLUCENT};
iAd.SearchBar.prototype.layerWasCreated=function(){this.callSuper();var a=this.layer.appendChild(document.createElement("form"));this.label=a.appendChild(document.createElement("div"));this.field=a.appendChild(document.createElement("input"));this.field.type="text";this.button=new iAd.BarButtonItem;this.button.title="Cancel";this.addSubview(this.button.view);this.emptyButton=this.addSubview(new iAd.Button(null,iAd.Button.TYPE_CUSTOM))};
iAd.SearchBar.prototype.setSize=function(a){a.height=iAd.SearchBar.DEFAULT_HEIGHT;this.callSuper(a);this.hasBeenExplicitelySized=true;this.updateLayout()};iAd.SearchBar.prototype.updateLayout=function(){var a=this.showsCancelButton?this.button.view.size.width+5:0;this.field.parentNode.style.right=a+5+"px";this.emptyButton.layer.style.right=a+10+"px"};
iAd.SearchBar.prototype.didMoveToSuperview=function(){this.callSuper();if(!(this.hasBeenExplicitelySized||this.superview==null||this.usesDeclarativeBacking)){this.size=new iAd.Size(this.superview.size.width,iAd.SearchBar.DEFAULT_HEIGHT);this.hasBeenExplicitelySized=false}};iAd.SearchBar.prototype.layerWasInsertedIntoDocument=function(){this.callSuper();if(this._shouldBeEditableUponLayerInsertion!==undefined){this.editing=this._shouldBeEditableUponLayerInsertion;delete this._shouldBeEditableUponLayerInsertion}};
iAd.SearchBar.prototype.setBarStyle=function(a){this.layer.removeClassName(this._barStyle);this.layer.addClassName(a);this._barStyle=a};iAd.SearchBar.prototype.setPlaceholder=function(a){this._placeholder=a;this.checkForPlaceholderDisplay()};iAd.SearchBar.prototype.getText=function(){return this.field.value};iAd.SearchBar.prototype.setText=function(a){this.label.textContent=a;this.field.value=a;this.dispatchNotification(iAd.SearchBar.TEXT_DID_CHANGE,this.delegate,[["searchText",a]]);this.checkForPlaceholderDisplay()};
iAd.SearchBar.prototype.setShowsCancelButton=function(a){if(this._showsCancelButton!=a){this.layer.toggleClassName(iAd.SearchBar.SHOWS_CANCEL_BUTTON_CSS,a);this._showsCancelButton=a;this.updateLayout()}};iAd.SearchBar.prototype.setShowsBookmarkButton=function(a){if(this._showsBookmarkButton!=a){this._showsBookmarkButton=a;this.checkForPlaceholderDisplay()}};
iAd.SearchBar.prototype.checkForPlaceholderDisplay=function(){var a=this.text=="";this.layer.toggleClassName(iAd.SearchBar.DISPLAYS_PLACEHOLDER,a);a&&this._showsBookmarkButton&&this.layer.toggleClassName(iAd.SearchBar.SHOWS_BOOKMARK_BUTTON_CSS,this.text=="");if(a)this.label.textContent=this._placeholder};iAd.SearchBar.prototype.setEditing=function(a){if(this.layerIsInDocument)this.field[a?"focus":"blur"]();else this._shouldBeEditableUponLayerInsertion=a};
iAd.SearchBar.prototype.isInBar=function(){var a=this.superview;if(iAd.Device.IS_IPAD&&iAd.Utils.objectIsInstanceOfClass(a,iAd.NavigationBar)||iAd.Utils.objectIsInstanceOfClass(a,iAd.Toolbar))return true;return false};iAd.SearchBar.prototype.handleFocus=function(){this._editing=true;this.dispatchNotification(iAd.SearchBar.TEXT_DID_BEGIN_EDITING,this.delegate)};
iAd.SearchBar.prototype.handleBlur=function(){this.label.textContent=this.field.value;this.checkForPlaceholderDisplay();this._editing=false;this.dispatchNotification(iAd.SearchBar.TEXT_DID_END_EDITING,this.delegate)};iAd.SearchBar.prototype.handleInput=function(){this.checkForPlaceholderDisplay();this.dispatchNotification(iAd.SearchBar.TEXT_DID_CHANGE,this.delegate,[["searchText",this.field.value]])};iAd.SearchBar.prototype.handleSubmit=function(a){a.preventDefault();this.editing=false};
iAd.SearchBar.prototype.handleViewActivate=function(a){if(a.ad.sender===this.emptyButton)if(this.text=="")this.dispatchNotification(iAd.SearchBar.BOOKMARK_BUTTON_CLICKED,this.delegate);else{this.text="";this.checkForPlaceholderDisplay()}else this.dispatchNotification(iAd.SearchBar.CANCEL_BUTTON_CLICKED,this.delegate)};iAd.PropertyTriage={};iAd.PropertyTriage.handlePropertyChange=function(a,b){var c="handle"+b.charAt(0).toUpperCase()+b.substr(1)+"Change";iAd.Utils.objectHasMethod(this,c)&&this[c](a)};
iAd.Utils.setupDisplayNames(iAd.PropertyTriage,"iAd.PropertyTriage");iAd.Class({name:"iAd.TableViewCell",superclass:iAd.View,synthesizedProperties:["text","detailedText","selectionStyle","accessoryType","highlighted","selected","cellStyle","editingStyle","editing"],archivedProperties:["text","detailedText","selectionStyle","accessoryType","selected","cellStyle"],cssClassName:"ad-table-view-cell",collectionAccessor:"tableViewCells"});iAd.TableViewCell.ACCESSORY_NONE="ad-no-accessory";
iAd.TableViewCell.ACCESSORY_DISCLOSURE_INDICATOR="ad-disclosure-accessory";iAd.TableViewCell.ACCESSORY_DETAIL_DISCLOSURE_BUTTON="ad-detail-accessory";iAd.TableViewCell.ACCESSORY_CHECKMARK="ad-checkmark-accessory";iAd.TableViewCell.SELECTION_STYLE_NONE="ad-no-selection";iAd.TableViewCell.SELECTION_STYLE_BLUE="ad-blue-selection";iAd.TableViewCell.SELECTION_STYLE_GRAY="ad-gray-selection";iAd.TableViewCell.STYLE_DEFAULT="ad-style-default";iAd.TableViewCell.STYLE_VALUE_1="ad-style-value-1";
iAd.TableViewCell.STYLE_VALUE_2="ad-style-value-2";iAd.TableViewCell.STYLE_SUBTITLE="ad-style-subtitle";iAd.TableViewCell.STYLE_CUSTOM="ad-style-custom";iAd.TableViewCell.SEPARATOR_STYLE_NONE="ad-separator-none";iAd.TableViewCell.SEPARATOR_STYLE_SINGLE_LINE="ad-separator-single-line";iAd.TableViewCell.SEPARATOR_STYLE_SINGLE_LINE_ETCHED="ad-separator-single-line-etched";iAd.TableViewCell.EDITING_STYLE_NONE="ad-editing-style-none";iAd.TableViewCell.EDITING_STYLE_DELETE="ad-editing-style-delete";
iAd.TableViewCell.CSS_CLASS_CELL_IS_EDITING="ad-cell-is-editing";iAd.TableViewCell.STYLE_VALUE_1_MARGIN=10;
iAd.TableViewCell.prototype.init=function(a,b,c){this._cellStyle=b||iAd.TableViewCell.STYLE_DEFAULT;this._selectionStyle=iAd.TableViewCell.SELECTION_STYLE_BLUE;this._accessoryType=iAd.TableViewCell.ACCESSORY_NONE;this._editingStyle=iAd.TableViewCell.EDITING_STYLE_NONE;this._highlighted=this._selected=false;this.reuseIdentifier=c||this.constructor._name;this.callSuper(a);this.wantsHardwareLayerBacking=true};
iAd.TableViewCell.prototype.setupLayer=function(){this.callSuper();this.createLayerContents();if(this.layer.hasClassName(iAd.TableViewCell.STYLE_VALUE_1))this._cellStyle=iAd.TableViewCell.STYLE_VALUE_1;else if(this.layer.hasClassName(iAd.TableViewCell.STYLE_VALUE_2))this._cellStyle=iAd.TableViewCell.STYLE_VALUE_2;else if(this.layer.hasClassName(iAd.TableViewCell.STYLE_SUBTITLE))this._cellStyle=iAd.TableViewCell.STYLE_SUBTITLE;else if(this.layer.hasClassName(iAd.TableViewCell.STYLE_CUSTOM))this._cellStyle=
iAd.TableViewCell.STYLE_CUSTOM;if(this.layer.hasClassName(iAd.TableViewCell.ACCESSORY_DISCLOSURE_INDICATOR))this._accessoryType=iAd.TableViewCell.ACCESSORY_DISCLOSURE_INDICATOR;else if(this.layer.hasClassName(iAd.TableViewCell.ACCESSORY_DETAIL_DISCLOSURE_BUTTON))this._accessoryType=iAd.TableViewCell.ACCESSORY_DETAIL_DISCLOSURE_BUTTON;else if(this.layer.hasClassName(iAd.TableViewCell.ACCESSORY_CHECKMARK))this._accessoryType=iAd.TableViewCell.ACCESSORY_CHECKMARK;if(this.layer.hasClassName(iAd.TableViewCell.EDITING_STYLE_DELETE))this._editingStyle=
iAd.TableViewCell.EDITING_STYLE_DELETE};iAd.TableViewCell.prototype.createLayer=function(){this.callSuper();this.layer.addClassName(this.cellStyle);this.layer.addClassName(this.accessoryType);this.createLayerContents()};iAd.TableViewCell.prototype.layerWasCreated=function(){this.callSuper();this.cellStyle===iAd.TableViewCell.STYLE_CUSTOM&&this.layer.addClassName(iAd.TableViewCell.STYLE_CUSTOM);this.updateTextLayout()};
iAd.TableViewCell.prototype.createLayerContents=function(){if(this.cellStyle!==iAd.TableViewCell.STYLE_CUSTOM){this.layer.setAttribute("role","button");this.accessory=new iAd.Button(null,iAd.Button.TYPE_DETAIL_DISCLOSURE);this.accessory.addEventListener(iAd.View.ACTIVATE_EVENT,this,false);this.addSubview(this.accessory);this.textLabel=this.layer.appendChild(document.createElement("span"));this.textLabel.addClassName("ad-text-label");this.detailedTextLabel=this.layer.appendChild(document.createElement("span"));
this.detailedTextLabel.addClassName("ad-detailed-text-label")}};
iAd.TableViewCell.prototype.handleEvent=function(a){if(a.type==iAd.View.ACTIVATE_EVENT){var b=this.superview,c=this._tableViewDataSourceInfo.indexPath;if(b!=undefined&&c!=undefined)if(this.accessory&&a.currentTarget==this.accessory.layer)b.disclosureButtonWasSelectedAtIndexPath(c);else if(this.editAccessory&&a.currentTarget==this.editAccessory.layer)b.editAccessoryWasSelectedAtIndexPath(c);else this.deleteButton&&a.currentTarget==this.deleteButton.layer&&b.deleteButtonWasSelectedAtIndexPath(c)}else this.callSuper(a)};
iAd.TableViewCell.prototype.getText=function(){return this.cellStyle===iAd.TableViewCell.STYLE_CUSTOM?"":this.textLabel.textContent};iAd.TableViewCell.prototype.setText=function(a){if(this.cellStyle!==iAd.TableViewCell.STYLE_CUSTOM){this.textLabel.textContent=a;this.updateTextLayout()}};iAd.TableViewCell.prototype.getDetailedText=function(){return this.cellStyle===iAd.TableViewCell.STYLE_CUSTOM?"":this.detailedTextLabel.textContent};
iAd.TableViewCell.prototype.setDetailedText=function(a){if(this.cellStyle!==iAd.TableViewCell.STYLE_CUSTOM){this.detailedTextLabel.textContent=a;this.updateTextLayout()}};iAd.TableViewCell.prototype.setSelectionStyle=function(a){this.layer.removeClassName(this._selectionStyle);this.layer.addClassName(a);this._selectionStyle=a};iAd.TableViewCell.prototype.setCellStyle=function(a){this.layer.removeClassName(this._cellStyle);this.layer.addClassName(a);this._cellStyle=a};
iAd.TableViewCell.prototype.setEditingStyle=function(a){this.layer.removeClassName(this._editingStyle);this.layer.toggleClassName(a,a!=iAd.TableViewCell.EDITING_STYLE_NONE);this._editingStyle=a;if(a==iAd.TableViewCell.EDITING_STYLE_DELETE){if(!this.editAccessory){a=new iAd.Button(null,iAd.Button.TYPE_DELETION_ACCESSORY);a.addEventListener(iAd.View.ACTIVATE_EVENT,this,false);this.editAccessory=this.addSubview(a)}if(!this.deleteButton){a=new iAd.BarButton;a.buttonStyle=iAd.BarButtonItem.STYLE_DELETE;
a.title="Delete";a.addEventListener(iAd.View.ACTIVATE_EVENT,this,false);this.deleteButton=this.addSubview(a)}}};iAd.TableViewCell.prototype.setEditing=function(a){this.layer.toggleClassName(iAd.TableViewCell.CSS_CLASS_CELL_IS_EDITING,a);this._editing=a};iAd.TableViewCell.prototype.setAccessoryType=function(a){if(this.cellStyle!==iAd.TableViewCell.STYLE_CUSTOM){this.layer.removeClassName(this._accessoryType);this.layer.addClassName(a);this._accessoryType=a}};
iAd.TableViewCell.prototype.setHighlighted=function(a){this.setHighlightedAnimated(a,false)};iAd.TableViewCell.prototype.setHighlightedAnimated=function(a){if(this._highlighted!=a){this._highlighted=a;this.layer.toggleClassName(iAd.Control.STATE_HIGHLIGHTED_CSS,a)}};iAd.TableViewCell.prototype.setSelected=function(a){this.setSelectedAnimated(a,false)};
iAd.TableViewCell.prototype.setSelectedAnimated=function(a){if(this._selected!=a){this._selected=a;this.layer.toggleClassName(iAd.Control.STATE_SELECTED_CSS,a)}};iAd.TableViewCell.prototype.prepareForReuse=function(){if(this.textLabel)this.text="";if(this.detailedTextLabel)this.detailedText="";this.selectionStyle=iAd.TableViewCell.SELECTION_STYLE_BLUE;this.accessoryType=iAd.TableViewCell.ACCESSORY_NONE;this.cellStyle=iAd.TableViewCell.STYLE_DEFAULT;this.editingStyle=iAd.TableViewCell.EDITING_STYLE_NONE};
iAd.TableViewCell.prototype.layerWasInsertedIntoDocument=function(){this.callSuper();this.updateTextLayout()};
iAd.TableViewCell.prototype.updateTextLayout=function(){if(!(this.cellStyle!=iAd.TableViewCell.STYLE_VALUE_1||!this.layerIsInDocument)){var a=this.textLabel.offsetWidth-2*iAd.TableViewCell.STYLE_VALUE_1_MARGIN;this.textLabel.style.setProperty("right","auto","important");this.detailedTextLabel.style.setProperty("right","auto","important");var b=Math.min(this.textLabel.offsetWidth,a),c=Math.min(this.detailedTextLabel.offsetWidth,a);this.textLabel.setAttribute("style","");this.detailedTextLabel.setAttribute("style",
"");if(b+c>a){a=Math.floor(b/(b+c)*a);if(b>c){this.textLabel.style.width=a+"px";this.detailedTextLabel.style.left=a+iAd.TableViewCell.STYLE_VALUE_1_MARGIN*2+"px"}else{this.textLabel.style.width=a+iAd.TableViewCell.STYLE_VALUE_1_MARGIN+"px";this.detailedTextLabel.style.left=a+iAd.TableViewCell.STYLE_VALUE_1_MARGIN*3+"px"}}}};
iAd.Class({name:"iAd.TableView",superclass:iAd.ScrollView,synthesizedProperties:["tableStyle","separatorStyle","editing"],archivedProperties:["tableStyle","separatorStyle","rowHeight","allowsSelection"],excludedProperties:["subviews"],cssClassName:"ad-table-view",mixins:[iAd.PropertyTriage],collectionAccessor:"tableViews"});iAd.TableView.CELL_FOR_ROW_AT_PATH="tableViewCellForRowAtIndexPath";iAd.TableView.NUMBERS_OF_SECTIONS_IN_TABLE_VIEW="numberOfSectionsInTableView";
iAd.TableView.NUMBERS_OF_ROWS_IN_SECTION="tableViewNumberOfRowsInSection";iAd.TableView.TITLE_FOR_HEADER_IN_SECTION="tableViewTitleForHeaderInSection";iAd.TableView.TITLE_FOR_FOOTER_IN_SECTION="tableViewTitleForFooterInSection";iAd.TableView.SECTION_INDEX_TITLES="sectionIndexTitlesForTableView";iAd.TableView.SECTION_FOR_SECTION_INDEX_TITLE_AT_INDEX="tableViewSectionForSectionIndexTitleAtIndex";iAd.TableView.WILL_DESELECT_ROW_AT_PATH="tableViewWillDeselectRowAtIndexPath";
iAd.TableView.DID_DESELECT_ROW_AT_PATH="tableViewDidDeselectRowAtIndexPath";iAd.TableView.WILL_SELECT_ROW_AT_PATH="tableViewWillSelectRowAtIndexPath";iAd.TableView.DID_SELECT_ROW_AT_PATH="tableViewDidSelectRowAtIndexPath";iAd.TableView.DID_SELECT_ACCESSORY_FOR_ROW_AT_PATH="tableViewDidSelectAccessoryForRowAtIndexPath";iAd.TableView.HEIGHT_FOR_ROW_AT_INDEX_PATH="tableViewHeightForRowAtIndexPath";iAd.TableView.COMMIT_EDITING_STYLE_FOR_ROW_AT_INDEX_PATH="tableViewCommitEditingStyleForRowAtIndexPath";
iAd.TableView.TITLE_FOR_DELETE_CONFIRMATION_BUTTON_FOR_ROW_AT_INDEX_PATH="tableViewTitleForDeleteConfirmationButtonForRowAtIndexPath";iAd.TableView.STYLE_PLAIN="ad-plain";iAd.TableView.STYLE_CUSTOM="ad-custom";iAd.TableView.STYLE_GROUPED="ad-grouped";iAd.TableView.INDEX_CONTAINER_CSS_CLASS="ad-table-view-index";iAd.TableView.INDEX_CONTAINER_VISIBLE_CSS_CLASS="ad-index-visible";iAd.TableView.INDEX_INTERACTIVE_CSS_CLASS="ad-interactive-index";iAd.TableView.PLAIN_HEADER_HEIGHT=23;
iAd.TableView.DEFAULT_ROW_HEIGHT=44;iAd.TableView.GROUPED_TABLE_Y_MARGIN=10;iAd.TableView.MIN_INDEX_LETTER_HEIGHT=12;iAd.TableView.INDEX_Y_OUTER_MARGIN=6;iAd.TableView.INDEX_Y_INNER_MARGIN=4;iAd.TableView.FIRST_INDEX_TITLE_Y_OFFSET=3;iAd.TableView.INDEX_SKIPPED="\u2022";iAd.TableView.INDEX_SEARCH="{search}";iAd.TableView.INDEX_POUND="#";iAd.TableView.INDEX_SKIPPED_CSS_CLASS="ad-skipped-index";iAd.TableView.INDEX_SEARCH_CSS_CLASS="ad-search-index";iAd.TableView.INDEX_POUND_CSS_CLASS="ad-pound-index";
iAd.TableView.CSS_CLASS_FIRST_ROW_IN_SECTION="ad-first-row-in-section";iAd.TableView.CSS_CLASS_LAST_ROW_IN_SECTION="ad-last-row-in-section";iAd.TableView.CSS_CLASS_TABLE_IS_EDITING="ad-table-is-editing";iAd.TableView.TYPE_HEADER=0;iAd.TableView.TYPE_CELL=1;iAd.TableView.TYPE_FOOTER=2;
iAd.TableView.prototype.init=function(a){this._tableStyle=iAd.TableView.STYLE_CUSTOM;this._separatorStyle=iAd.TableViewCell.SEPARATOR_STYLE_SINGLE_LINE;this.dataSource=this.delegate=null;this.numberOfSections=1;this.rowHeight=iAd.TableView.DEFAULT_ROW_HEIGHT;this.allowsSelection=true;this.populatesAllCells=false;this.sectionsInfo=[];this.cellsQueuedForReuse={};this.headersQueuedForReuse=[];this.footersQueuedForReuse=[];this.visibleHeaders=[];this.visibleSubviews=[];this.usesCustomRowHeights=false;
this.selectedRowIndexPath=this.touchedCell=null;this.selectedRowsIndexPaths=[];this._editing=false;this.cellsBeingEditedPaths=[];this.callSuper(a);this.alwaysBounceVertical=true};iAd.TableView.prototype.didEncodeObjectToArchive=function(a){this.callSuper(a);a.selectedRowsIndexPaths=this.selectedRowsIndexPaths};iAd.TableView.prototype.didRestoreFromArchive=function(a){this.callSuper(a);this.archivedProperties={selectedRowsIndexPaths:a.selectedRowsIndexPaths}};
iAd.TableView.prototype.setupLayer=function(){this.dataSource=new iAd.TableViewDeclarativeDataSource(this.layer);this.callSuper();if(this.layer.hasClassName(iAd.TableView.STYLE_PLAIN))this._tableStyle=iAd.TableView.STYLE_PLAIN;else if(this.layer.hasClassName(iAd.TableView.STYLE_GROUPED))this._tableStyle=iAd.TableView.STYLE_GROUPED;if(this.layer.hasClassName(iAd.TableViewCell.SEPARATOR_STYLE_SINGLE_LINE_ETCHED))this._separatorStyle=iAd.TableViewCell.SEPARATOR_STYLE_SINGLE_LINE_ETCHED;else if(this.layer.hasClassName(iAd.TableViewCell.SEPARATOR_STYLE_NONE))this._separatorStyle=
iAd.TableViewCell.SEPARATOR_STYLE_NONE};iAd.TableView.prototype.initWithDeclarativeBacking=function(){this.callSuper();this.reloadData()};iAd.TableView.prototype.layerWasCreated=function(){this.callSuper();this.indexContainer=this.layer.appendChild(document.createElement("div"));this.indexContainer.className=iAd.TableView.INDEX_CONTAINER_CSS_CLASS};
iAd.TableView.prototype.layerWasInsertedIntoDocument=function(){this.callSuper();if(this.needsToUpdateSectionsInfoUponLayerInsertion){this.updateSectionsInfo();this.layoutSubviews()}else this.subviews.length==0&&this.dataSource!=null&&this.reloadData()};
iAd.TableView.prototype.setSize=function(a){if(!this._size.equals(a)){this.callSuper(a);this.updateIndex();if(this._tableStyle===iAd.TableView.STYLE_GROUPED)this.reloadData();else this.contentSize=new iAd.Size(this._size.width,this.contentSize.height);this.layoutSubviews()}};
iAd.TableView.prototype.handleEvent=function(a){if(!a.hasOwnProperty("_synthetic")){if(a.type==iAd.Event.START_EVENT&&a.eventPhase==Event.CAPTURING_PHASE)this.trackingTouchesOnIndex=a.target===this.indexContainer;if(this.trackingTouchesOnIndex)switch(a.type){case iAd.Event.START_EVENT:this.touchesBeganOnIndex(a);break;case iAd.Event.MOVE_EVENT:this.touchesMovedOnIndex(a);break;case iAd.Event.END_EVENT:case iAd.Event.CANCEL_EVENT:this.touchesEndedOnIndex(a)}else this.callSuper(a)}};
iAd.TableView.prototype.setContentOffsetAnimated=function(a,b){if(!a.equals(this._contentOffset)){this.callSuper(a,b);this.layoutSubviews()}};iAd.TableView.prototype.setUsesNativeScrolling=function(a){a&&iAd.Console.warn("iAd.TableView does not support setting .usesNativeScrolling to true.")};iAd.TableView.prototype.setTableStyle=function(a){this.layer.removeClassName(this._tableStyle);this.layer.addClassName(a);this._tableStyle=a};
iAd.TableView.prototype.setSeparatorStyle=function(a){this.layer.removeClassName(this._separatorStyle);this.layer.addClassName(a);this._separatorStyle=a};iAd.TableView.prototype.setEditing=function(a){if(this._editing!=a){this._editing=a;this.layer.toggleClassName(iAd.TableView.CSS_CLASS_TABLE_IS_EDITING,a);a||this.resetAllEditingCells()}};
iAd.TableView.prototype.numberOfRowsInSection=function(a){if(this.sectionsInfo.length<=a){if(!iAd.Utils.objectHasMethod(this.dataSource,iAd.TableView.NUMBERS_OF_ROWS_IN_SECTION))return null;return this.dataSource[iAd.TableView.NUMBERS_OF_ROWS_IN_SECTION](this,a)}else if(this.isSectionValid(a))return this.sectionsInfo[a].numberOfRows;return null};iAd.TableView.prototype.isSectionValid=function(a){return a>=0&&a<this.numberOfSections};
iAd.TableView.prototype.isIndexPathValid=function(a){return this.isSectionValid(a.section)&&a.row>=0&&a.row<this.sectionsInfo[a.section].numberOfRows};iAd.TableView.prototype.cellForRowAtIndexPath=function(a){var b=null;if(this.isIndexPathValid(a))for(var c=this.populatesAllCells?this.tableViewCells:this.tableViewCells.filter(iAd.TableView.queuedCellFilter),d=0,e=c.length;d<e;d++)if(this.indexPathForCell(c[d]).equals(a)){b=c[d];break}return b};iAd.TableView.prototype.indexPathForCell=function(a){return a._tableViewDataSourceInfo.indexPath};
iAd.TableView.prototype.sectionAtPoint=function(a){for(var b=0,c=this.sectionsInfo.length;b<c;b++)if(this.sectionsInfo[b].y>a.y)break;b=Math.max(0,b-1);return b>=this.numberOfSections?null:b};
iAd.TableView.prototype.indexPathForRowAtPoint=function(a){var b=this.sectionAtPoint(a);if(b==null)return null;var c=this.sectionsInfo[b];a=Math.max(a.y-c.y,0);var d=a>=c.headerHeight+c.cumulativeRowHeight;if(a<c.headerHeight||d)return null;if(this.usesCustomRowHeights){d=c.numberOfRows;var e=c.rowHeights,f=0;for(c=1;c<d;c++){f+=e[c];if(a<f){c--;break}}}else c=Math.floor((a-c.headerHeight)/this.rowHeight);return new iAd.IndexPath(b,c)};
iAd.TableView.prototype.reloadData=function(){if(this.archivedProperties){this.selectedRowsIndexPaths=this.archivedProperties.selectedRowsIndexPaths;delete this.archivedProperties}for(this.updateSectionsInfo();this.subviews.length;)this.subviews[0].removeFromSuperview();this.visibleSubviews=[];this.visibleHeaders=[];this.headersQueuedForReuse=[];this.cellsQueuedForReuse={};this.footersQueuedForReuse=[];this.layoutSubviews()};
iAd.TableView.prototype.updateSectionsInfo=function(){if(!(this.dataSource==null||!iAd.Utils.objectHasMethod(this.dataSource,iAd.TableView.NUMBERS_OF_ROWS_IN_SECTION))){var a=this._tableStyle===iAd.TableView.STYLE_CUSTOM,b=this._tableStyle===iAd.TableView.STYLE_GROUPED;if(b&&!this.layerIsInDocument)this.needsToUpdateSectionsInfoUponLayerInsertion=true;else{this.needsToUpdateSectionsInfoUponLayerInsertion=false;this.sectionsInfo=[];this.usesCustomRowHeights=this.delegate!=null&&iAd.Utils.objectHasMethod(this.delegate,
iAd.TableView.HEIGHT_FOR_ROW_AT_INDEX_PATH);this.numberOfSections=1;if(iAd.Utils.objectHasMethod(this.dataSource,iAd.TableView.NUMBERS_OF_SECTIONS_IN_TABLE_VIEW))this.numberOfSections=this.dataSource[iAd.TableView.NUMBERS_OF_SECTIONS_IN_TABLE_VIEW](this);var c=iAd.Utils.objectHasMethod(this.dataSource,iAd.TableView.TITLE_FOR_HEADER_IN_SECTION),d=iAd.Utils.objectHasMethod(this.dataSource,iAd.TableView.TITLE_FOR_FOOTER_IN_SECTION);if(b){var e=this.addSubview(new iAd.TableViewHeader);e.hidden=true;var f=
this.addSubview(new iAd.TableViewFooter);f.hidden=true}for(var g=0,h,i,j,k,l,m,n,o,p,q=0;q<this.numberOfSections;q++){h=this.numberOfRowsInSection(q);l=k=0;i=null;if(!a){if(c)i=this.dataSource[iAd.TableView.TITLE_FOR_HEADER_IN_SECTION](this,q);if(b)if(i==null)k=q==0?iAd.TableView.GROUPED_TABLE_Y_MARGIN:2*iAd.TableView.GROUPED_TABLE_Y_MARGIN+1;else{e.text=i||"";k=e.layer.offsetHeight}else if(i!=null)k=iAd.TableView.PLAIN_HEADER_HEIGHT-1;if(b&&d){j=this.dataSource[iAd.TableView.TITLE_FOR_FOOTER_IN_SECTION](this,
q);if(j!=null){f.text=j||"";l=f.layer.offsetHeight}}}i={numberOfRows:h,header:i,footer:j,y:g,headerHeight:k,footerHeight:l};if(this.usesCustomRowHeights){m=[];for(o=n=0;o<h;o++){p=this.delegate[iAd.TableView.HEIGHT_FOR_ROW_AT_INDEX_PATH](this,new iAd.IndexPath(q,o));n+=p;m.push(p)}i.rowHeights=m}else n=h*this.rowHeight;i.cumulativeRowHeight=n;this.sectionsInfo.push(i);g+=n;g+=k;g+=l}if(b){g+=iAd.TableView.GROUPED_TABLE_Y_MARGIN+1;e.removeFromSuperview();f.removeFromSuperview()}this.contentSize=new iAd.Size(this._size.width,
g)}}};iAd.TableView.prototype.layoutSubviews=function(){if(this.sectionsInfo.length!=0){var a=this._contentOffset.y,b=a+this._size.height,c=this.sectionAtPoint(this._contentOffset);!this.populatesAllCells&&a>=0&&a<=this.maxPoint.y&&this.scanSubviewsForQueuing(a,b,c);this.addSubviewsAtTop(a);this.addSubviewsAtBottom(b,c);this._tableStyle===iAd.TableView.STYLE_PLAIN&&this.updatePlainHeaderPositions(a,c)}};
iAd.TableView.prototype.scanSubviewsForQueuing=function(a,b,c){for(var d,e,f=this._tableStyle===iAd.TableView.STYLE_PLAIN,g=0,h=this.subviews.length;g<h;g++){d=this.subviews[g];if(!d._queued&&(d._position.y+d._size.height<=a||d._position.y>=b)){if(d instanceof iAd.TableViewCell)e=this.cellsQueuedForReuse[d.reuseIdentifier]||(this.cellsQueuedForReuse[d.reuseIdentifier]=[]);else if(d instanceof iAd.TableViewHeader){if(f&&d._tableViewDataSourceInfo.section==c)continue;e=this.headersQueuedForReuse;iAd.Array.removeObjectFromArray(d,
this.visibleHeaders)}else e=this.footersQueuedForReuse;this.enqueueView(e,d)}}};
iAd.TableView.prototype.addSubviewsAtTop=function(a){var b=this.visibleSubviews[0];if(b){var c=this.populatesAllCells?0:b._position.y,d=this._tableStyle===iAd.TableView.STYLE_PLAIN,e=null;if(c>=a&&d&&b===this.visibleHeaders[0]){e=this.visibleHeaders[0];b=this.visibleSubviews[1];c=b._position.y}for(;c>=a;){b=this.populatedSubviewForInfo(this.infoForPreviousView(b._tableViewDataSourceInfo));if(!b)break;c-=b._size.height;if(b==e)e=null;else{b.position=new iAd.Point(0,c);e?this.visibleSubviews.splice(1,
0,b):this.visibleSubviews.unshift(b);b instanceof iAd.TableViewHeader&&this.visibleHeaders.unshift(b)}}if(d&&this.visibleHeaders[0]!==this.visibleSubviews[0]){a=this.visibleSubviews[0]._tableViewDataSourceInfo;a=a.type==iAd.TableView.TYPE_CELL?a.indexPath.section:a.section;if(this.sectionsInfo[a].header){b=this.populatedSubviewForInfo(this.infoForHeader(a));this.visibleSubviews.unshift(b);this.visibleHeaders.unshift(b)}}}};
iAd.TableView.prototype.addSubviewsAtBottom=function(a,b){var c=this.visibleSubviews.length?this.visibleSubviews[this.visibleSubviews.length-1]:null,d;if(c)d=c._position.y+c._size.height;else{c=new iAd.TableViewFooter;if(b==0){d=0;c._tableViewDataSourceInfo=this.infoForFooter(-1)}else{d=this.sectionsInfo[b].y;c._tableViewDataSourceInfo=this.infoForFooter(b-1)}}if(this.populatesAllCells)a=this.contentSize.height;for(;d<=a;){c=this.populatedSubviewForInfo(this.infoForNextView(c._tableViewDataSourceInfo));
if(!c)break;c.position=new iAd.Point(0,d);d+=c._size.height;this.visibleSubviews.push(c);c instanceof iAd.TableViewHeader&&this.visibleHeaders.push(c)}};iAd.TableView.prototype.updatePlainHeaderPositions=function(a,b){for(var c=this.visibleHeaders,d,e,f,g=c.length-1;g>=0;g--){d=c[g];e=d._tableViewDataSourceInfo.section;if(e==b){e=(f=c[g+1])&&f._position.y<a+d._size.height?f._position.y-f._size.height:a;e=Math.max(0,e)}else e=this.sectionsInfo[e].y;d.position=new iAd.Point(0,e)}};
iAd.TableView.prototype.infoForCell=function(a){return{type:iAd.TableView.TYPE_CELL,indexPath:a}};iAd.TableView.prototype.infoForHeader=function(a){return{type:iAd.TableView.TYPE_HEADER,section:a}};iAd.TableView.prototype.infoForFooter=function(a){return{type:iAd.TableView.TYPE_FOOTER,section:a}};
iAd.TableView.prototype.infoForFirstViewInSection=function(a){var b=this.sectionsInfo[a];if(b.header||b.headerHeight)return this.infoForHeader(a);else if(b.numberOfRows>0)return this.infoForCell(new iAd.IndexPath(a,0));else if(b.footerHeight>0)return this.infoForFooter(a);return null};
iAd.TableView.prototype.infoForLastViewInSection=function(a){var b=this.sectionsInfo[a];if(b.footerHeight>0)return this.infoForFooter(a);else if(b.numberOfRows>0)return this.infoForCell(new iAd.IndexPath(a,b.numberOfRows-1));if(b.header||b.headerHeight)return this.infoForHeader(a);return null};
iAd.TableView.prototype.infoForNextView=function(a){var b=null;if(a.type==iAd.TableView.TYPE_CELL){var c=a.indexPath.copy();a=this.sectionsInfo[c.section];if(++c.row<a.numberOfRows)b=this.infoForCell(c);else if(a.footerHeight>0)b=this.infoForFooter(c.section);else if(++c.section<this.numberOfSections)b=this.infoForFirstViewInSection(c.section)}else if(a.type==iAd.TableView.TYPE_HEADER){c=a.section;a=this.sectionsInfo[c];if(a.numberOfRows>0)b=this.infoForCell(new iAd.IndexPath(c,0));else if(a.footerHeight>
0)b=this.infoForFooter(c);else if(++c<this.numberOfSections)b=this.infoForFirstViewInSection(c)}else{c=a.section;if(++c<this.numberOfSections)b=this.infoForFirstViewInSection(c)}return b};
iAd.TableView.prototype.infoForPreviousView=function(a){var b=null;if(a.type==iAd.TableView.TYPE_CELL){var c=a.indexPath.copy();a=this.sectionsInfo[c.section];if(--c.row>=0)b=this.infoForCell(c);else if(a.header||a.headerHeight)b=this.infoForHeader(c.section);else if(--c.section>=0)b=this.infoForLastViewInSection(c.section)}else if(a.type==iAd.TableView.TYPE_HEADER){c=a.section;if(--c>=0)b=this.infoForLastViewInSection(c)}else{c=a.section;a=this.sectionsInfo[c];if(a.numberOfRows>0)b=this.infoForCell(new iAd.IndexPath(c,
a.numberOfRows-1));else if(a.header||a.headerHeight)b=this.infoForHeader(c);else if(--c>=0)b=this.infoForLastViewInSection(c)}return b};iAd.TableView.prototype.rectForSection=function(a){if(!this.isSectionValid(a))return iAd.Rect.ZERO_RECT;a=this.sectionsInfo[a];return new iAd.Rect(0,a.y,this.size.width,a.y+a.headerHeight+a.cumulativeRowHeight+a.footerHeight)};
iAd.TableView.prototype.rectForRowAtIndexPath=function(a){if(!this.isIndexPathValid(a))return iAd.Rect.ZERO_RECT;var b=this.sectionsInfo[a.section],c=b.y+b.headerHeight,d=0;if(this.usesCustomRowHeights){a=a.row;b=b.rowHeights;for(d=0;d<a;d++)c+=b[d];d=b[a]}else{c+=a.row*this.rowHeight;d=this.rowHeight}return new iAd.Rect(0,c,this.size.width,d)};
iAd.TableView.prototype.rectForFooterInSection=function(a){if(!this.isSectionValid(a)||this._tableStyle!==iAd.TableView.STYLE_GROUPED)return iAd.Rect.ZERO_RECT;a=this.sectionsInfo[a];return new iAd.Rect(0,a.y+a.headerHeight+a.cumulativeRowHeight,this._size.width,a.footerHeight)};
iAd.TableView.prototype.rectForHeaderInSection=function(a){if(!this.isSectionValid(a))return iAd.Rect.ZERO_RECT;var b=this.sectionsInfo[a],c=b.y;if(this._tableStyle===iAd.TableView.STYLE_PLAIN)for(var d=this.tableViewHeaders,e=0,f=d.length;e<f;e++){header=d[e];if(header._tableViewDataSourceInfo.section==a){if(!header._queued)return header.frame;break}}return new iAd.Rect(0,c,this._size.width,b.headerHeight)};iAd.TableView.queuedCellFilter=function(a){return a._queued==undefined};
iAd.TableView.selectedCellFilter=function(a){return a.selected};iAd.TableView.indexPathSort=function(a,b){var c=a._tableViewDataSourceInfo.indexPath,d=b._tableViewDataSourceInfo.indexPath;return c.lowerThan(d)?-1:c.greaterThan(d)?1:0};iAd.TableView.prototype.visibleCells=function(){return this.tableViewCells.filter(iAd.TableView.queuedCellFilter).sort(iAd.TableView.indexPathSort)};
iAd.TableView.prototype.indexPathsForVisibleRows=function(){var a=this.visibleCells();if(a.length==0)return null;for(var b=[],c=0,d=a.length;c<d;c++)b.push(this.indexPathForCell(a[c]));return b};
iAd.TableView.prototype.populatedSubviewForInfo=function(a){if(!a)return null;var b=null;b=a.type==iAd.TableView.TYPE_CELL?this.populatedCellForRowAtIndexPath(a.indexPath):a.type==iAd.TableView.TYPE_HEADER?this.populatedHeaderForSection(a.section):this.populatedFooterForSection(a.section);if(!b)return null;b._tableViewDataSourceInfo=a;return b};
iAd.TableView.prototype.populatedHeaderForSection=function(a){var b=null;if(a>=this.numberOfSections)return null;if(this.visibleHeaders.length&&this.visibleHeaders[0]._tableViewDataSourceInfo.section==a)return this.visibleHeaders[0];a=this.sectionsInfo[a];b=this.dequeueView(this.headersQueuedForReuse);if(!b){b=this.addSubview(new iAd.TableViewHeader);b.autoresizingMask=iAd.View.AUTORESIZING_FLEXIBLE_WIDTH}b.size=new iAd.Size(this._size.width,a.headerHeight);b.text=a.header;return b};
iAd.TableView.prototype.populatedFooterForSection=function(a){var b=null;if(a>=this.numberOfSections)return null;a=this.sectionsInfo[a];(b=this.dequeueView(this.footersQueuedForReuse))||(b=this.addSubview(new iAd.TableViewFooter));b._size=new iAd.Size(this._size.width,a.footerHeight);b.text=a.footer;return b};
iAd.TableView.prototype.populatedCellForRowAtIndexPath=function(a){cell=this.dataSource[iAd.TableView.CELL_FOR_ROW_AT_PATH](this,a);cell.layer.toggleClassName(iAd.TableView.CSS_CLASS_FIRST_ROW_IN_SECTION,a.row==0);cell.layer.toggleClassName(iAd.TableView.CSS_CLASS_LAST_ROW_IN_SECTION,a.row==this.sectionsInfo[a.section].numberOfRows-1);if(cell._tableViewDataSourceInfo)cell._tableViewDataSourceInfo.indexPath=a;cell.selected=this.isRowAtIndexPathSelected(a);if(cell.superview!==this){cell.autoresizingMask=
iAd.View.AUTORESIZING_FLEXIBLE_WIDTH;this.addSubview(cell)}else cell.updateTextLayout();cell.size=new iAd.Size(this._size.width,this.usesCustomRowHeights?this.sectionsInfo[a.section].rowHeights[a.row]:this.rowHeight);return cell};iAd.TableView.prototype.dequeueReusableCell=function(){return this.dequeueReusableCellWithIdentifier(iAd.TableViewCell._name)};iAd.TableView.prototype.dequeueReusableCellWithIdentifier=function(a){(a=this.dequeueView(this.cellsQueuedForReuse[a]))&&a.prepareForReuse();return a};
iAd.TableView.prototype.enqueueView=function(a,b){iAd.Array.removeObjectFromArray(b,this.visibleSubviews);a.push(b);b.position=new iAd.Point(0,-this._size.height);b._queued=true};iAd.TableView.prototype.dequeueView=function(a){if(!a||a.length==0)return null;a=a.pop();delete a._queued;return a};
iAd.TableView.prototype.touchesBeganInCapturePhase=function(a){this.wasDeceleratingWhenTouchesBegan=this.decelerating;this.callSuper(a);if(!this.wasDeceleratingWhenTouchesBegan)if(iAd.Event.SUPPORTS_TOUCHES&&this.touchedCell!=null&&a.touches.length>1){this.touchedCell.highlighted=false;this.resetTouchedCell()}else if(this.allowsSelection)for(a=iAd.View.nearestViewForElement(a.target);a;){if(a instanceof iAd.TableViewCell){this.touchedCell=a;break}a=a.superview}};
iAd.TableView.prototype.beginTouchesInContent=function(){this.callSuper();if(this.touchedCell)if(this.targetIsCellAccessory(this.originalTarget,this.touchedCell))this.interruptTrackingInteraction(true);else this.touchedCell.highlighted=true};iAd.TableView.prototype.cancelTouchesInContent=function(){this.callSuper();this.resetTouchedCell()};
iAd.TableView.prototype.touchesEnded=function(a){this.callSuper(a);if(this.touchedCell!=null)this.targetIsCellAccessory(this.originalTarget,this.touchedCell)||this.selectRowAtIndexPath(this.touchedCell._tableViewDataSourceInfo.indexPath);this.resetTouchedCell()};iAd.TableView.prototype.touchesCancelled=function(a){this.callSuper(a);this.resetTouchedCell()};iAd.TableView.prototype.resetTouchedCell=function(){if(this.touchedCell!=null){this.touchedCell.highlighted=false;this.touchedCell=null}};
iAd.TableView.prototype.targetIsCellAccessory=function(a,b){return b.accessory&&a===b.accessory.layer||b.editAccessory&&a===b.editAccessory.layer||b.deleteButton&&a.parentElement===b.deleteButton.layer};iAd.TableView.prototype.isRowAtIndexPathSelected=function(a){for(var b=this.selectedRowsIndexPaths,c=0,d=b.length;c<d;c++)if(a.equals(b[c]))return true;return false};iAd.TableView.prototype.indexPathForSelectedRow=function(){var a=this.indexPathsForSelectedRows();return a?a[0]:null};
iAd.TableView.prototype.indexPathsForSelectedRows=function(){return this.selectedRowsIndexPaths.length>0?this.selectedRowsIndexPaths.slice():null};iAd.TableView.prototype.selectionDidChangeForRowAtIndexPath=function(a,b){var c=this.selectedRowsIndexPaths,d=c.length||0;if(b){if(!this.isRowAtIndexPathSelected(a)){for(var e=0;e<d;e++)if(c[e].greaterThan(a)){c.splice(e,0,a);return}c.push(a)}}else for(e=0;e<d;e++)if(c[e].equals(a)){c.splice(e,1);break}};
iAd.TableView.prototype.deselectRowAtIndexPathAnimated=function(a,b){if(a!=null){this.dispatchNotification(iAd.TableView.WILL_DESELECT_ROW_AT_PATH,this.delegate,[["indexPath",a]]);var c=this.cellForRowAtIndexPath(a);if(a.equals(this.selectedRowIndexPath))this.selectedRowIndexPath=null;c!=null?this.markCellAsSelectedAnimated(c,false,b):this.selectionDidChangeForRowAtIndexPath(a,false);this.dispatchNotification(iAd.TableView.DID_DESELECT_ROW_AT_PATH,this.delegate,[["indexPath",a]])}};
iAd.TableView.prototype.selectRowAtIndexPath=function(a){if(!this.isIndexPathValid(a))throw Error("Invalid index path: "+a.toString());var b=this.cellForRowAtIndexPath(a);this.dispatchNotification(iAd.TableView.WILL_SELECT_ROW_AT_PATH,this.delegate,[["indexPath",a]]);a.equals(this.selectedRowIndexPath)||this.deselectRowAtIndexPathAnimated(this.selectedRowIndexPath,false);this.selectedRowIndexPath=a;if(b){b.highlighted=false;this.markCellAsSelectedAnimated(b,true,false)}else this.selectionDidChangeForRowAtIndexPath(a,
true);this.dispatchNotification(iAd.TableView.DID_SELECT_ROW_AT_PATH,this.delegate,[["indexPath",a]])};iAd.TableView.prototype.markCellAsSelectedAnimated=function(a,b,c){a instanceof iAd.TableViewCell?a.setSelectedAnimated(b,c):a.toggleClassName(iAd.Control.STATE_SELECTED_CSS,b);this.selectionDidChangeForRowAtIndexPath(a._tableViewDataSourceInfo.indexPath,b)};
iAd.TableView.prototype.disclosureButtonWasSelectedAtIndexPath=function(a){this.cellForRowAtIndexPath(a).accessoryType===iAd.TableViewCell.ACCESSORY_DETAIL_DISCLOSURE_BUTTON&&this.dispatchNotification(iAd.TableView.DID_SELECT_ACCESSORY_FOR_ROW_AT_PATH,this.delegate,[["indexPath",a]])};
iAd.TableView.prototype.editAccessoryWasSelectedAtIndexPath=function(a){var b=this.cellsBeingEditedPaths.indexOf(a)>-1;this.resetAllEditingCells();if(!b){b=this.cellForRowAtIndexPath(a);if(iAd.Utils.objectHasMethod(this.delegate,iAd.TableView.TITLE_FOR_DELETE_CONFIRMATION_BUTTON_FOR_ROW_AT_INDEX_PATH)){var c=this.delegate[iAd.TableView.TITLE_FOR_DELETE_CONFIRMATION_BUTTON_FOR_ROW_AT_INDEX_PATH](this,a);b.deleteButton.title=c}b.editing=true;this.cellsBeingEditedPaths.push(a)}};
iAd.TableView.prototype.resetAllEditingCells=function(){this.cellsBeingEditedPaths.forEach(function(a){this.cellForRowAtIndexPath(a).editing=false},this);this.cellsBeingEditedPaths=[]};
iAd.TableView.prototype.deleteButtonWasSelectedAtIndexPath=function(a){this.resetAllEditingCells();this.cellForRowAtIndexPath(a).selected&&this.deselectRowAtIndexPathAnimated(a,false);this.dispatchNotification(iAd.TableView.COMMIT_EDITING_STYLE_FOR_ROW_AT_INDEX_PATH,this.delegate,[["editingStyle",iAd.TableViewCell.EDITING_STYLE_DELETE],["indexPath",a]])};
iAd.TableView.prototype.updateIndex=function(){this.sectionIndexTitles=null;if(iAd.Utils.objectHasMethod(this.dataSource,iAd.TableView.SECTION_INDEX_TITLES))this.sectionIndexTitles=this.dataSource[iAd.TableView.SECTION_INDEX_TITLES](this);if(this._tableStyle!==iAd.TableView.STYLE_PLAIN||this.sectionIndexTitles==null||this.sectionIndexTitles.length==0)this.layer.removeClassName(iAd.TableView.INDEX_CONTAINER_VISIBLE_CSS_CLASS);else{this.layer.addClassName(iAd.TableView.INDEX_CONTAINER_VISIBLE_CSS_CLASS);
var a=this.sectionIndexTitles;this.usableIndexContainerHeight=this._size.height-(iAd.TableView.INDEX_Y_OUTER_MARGIN+iAd.TableView.INDEX_Y_INNER_MARGIN)*2;if(Math.floor(this.usableIndexContainerHeight/this.sectionIndexTitles.length)<iAd.TableView.MIN_INDEX_LETTER_HEIGHT){var b=this.sectionIndexTitles[0];a=this.sectionIndexTitles[this.sectionIndexTitles.length-1];var c=b==iAd.TableView.INDEX_SEARCH,d=a==iAd.TableView.INDEX_SEARCH;b=b==iAd.TableView.INDEX_POUND;var e=a==iAd.TableView.INDEX_POUND,f=c+
d+b+e;a=Math.floor(this.usableIndexContainerHeight/iAd.TableView.MIN_INDEX_LETTER_HEIGHT)-f;a%2==0&&a--;f=this.sectionIndexTitles.length-f;var g=(f-1)/(Math.max(a/2+1,1)-1);a=[];c&&a.push(iAd.TableView.INDEX_SEARCH);b&&a.push(iAd.TableView.INDEX_POUND);for(c=a.length;c<f-1;c+=g){a.push(this.sectionIndexTitles[Math.round(c)]);a.push(iAd.TableView.INDEX_SKIPPED)}a.push(this.sectionIndexTitles[this.sectionIndexTitles.length-(d||e?2:1)]);d&&a.push(iAd.TableView.INDEX_SEARCH);e&&a.push(iAd.TableView.INDEX_POUND)}d=
(this.usableIndexContainerHeight-iAd.TableView.MIN_INDEX_LETTER_HEIGHT-iAd.TableView.FIRST_INDEX_TITLE_Y_OFFSET)/(a.length-1);this.indexContainer.textContent="";c=0;for(f=a.length;c<f;c++){e=document.createElement("div");b=a[c];switch(b){case iAd.TableView.INDEX_SEARCH:e.className=iAd.TableView.INDEX_SEARCH_CSS_CLASS;break;case iAd.TableView.INDEX_POUND:e.className=iAd.TableView.INDEX_POUND_CSS_CLASS;break;case iAd.TableView.INDEX_SKIPPED:e.className=iAd.TableView.INDEX_SKIPPED_CSS_CLASS;break;default:e.textContent=
b}e.style.top=c*d+iAd.TableView.INDEX_Y_INNER_MARGIN+"px";this.indexContainer.appendChild(e)}}};
iAd.TableView.prototype.touchesBeganOnIndex=function(a){this.scrollEnabledBeforeTouchesBeganOnIndex=this.scrollEnabled;this.scrollEnabled=false;a.stopPropagation();a.preventDefault();window.addEventListener(iAd.Event.MOVE_EVENT,this,true);window.addEventListener(iAd.Event.END_EVENT,this,true);window.addEventListener(iAd.Event.CANCEL_EVENT,this,true);this.previouslyTouchedIndex=null;this.stopDecelerationAnimation();this.hideScrollIndicators();this.indexContainer.addClassName(iAd.TableView.INDEX_INTERACTIVE_CSS_CLASS);
this.scrollToSectionForIndexEvent(a)};iAd.TableView.prototype.touchesMovedOnIndex=function(a){a.stopPropagation();a.preventDefault();this.scrollToSectionForIndexEvent(a)};
iAd.TableView.prototype.touchesEndedOnIndex=function(a){a.stopPropagation();a.preventDefault();window.removeEventListener(iAd.Event.MOVE_EVENT,this,true);window.removeEventListener(iAd.Event.END_EVENT,this,true);window.removeEventListener(iAd.Event.CANCEL_EVENT,this,true);this.trackingTouchesOnIndex=false;this.indexContainer.removeClassName(iAd.TableView.INDEX_INTERACTIVE_CSS_CLASS);this.scrollEnabled=this.scrollEnabledBeforeTouchesBeganOnIndex};
iAd.TableView.prototype.scrollToSectionForIndexEvent=function(a){if(iAd.Utils.objectHasMethod(this.dataSource,iAd.TableView.SECTION_FOR_SECTION_INDEX_TITLE_AT_INDEX)){var b=this.usableIndexContainerHeight+2*iAd.TableView.INDEX_Y_INNER_MARGIN,c=(this.usableIndexContainerHeight-iAd.TableView.MIN_INDEX_LETTER_HEIGHT-iAd.TableView.FIRST_INDEX_TITLE_Y_OFFSET)/(this.sectionIndexTitles.length-1),d=this.sectionIndexTitles.length*c;a=iAd.Point.fromEventInElement(a,this.indexContainer).y-(b-d)/2;c=iAd.Number.clampValue(Math.floor(a/
c),0,this.sectionIndexTitles.length-1);if(c!=this.previouslyTouchedIndex){this.previouslyTouchedIndex=c;c=this.sectionsInfo[this.dataSource[iAd.TableView.SECTION_FOR_SECTION_INDEX_TITLE_AT_INDEX](this,this.sectionIndexTitles[c],c)].y;this.contentOffset=new iAd.Point(0,c)}}};iAd.Class({name:"iAd.TableViewHeader",superclass:iAd.View,synthesizedProperties:["text"],cssClassName:"ad-table-view-header",collectionAccessor:"tableViewHeaders"});
iAd.TableViewHeader.prototype.init=function(a){this.callSuper(a);this.wantsHardwareLayerBacking=true};iAd.TableViewHeader.prototype.getText=function(){return this.layer.textContent};iAd.TableViewHeader.prototype.setText=function(a){this.layer.textContent=a};iAd.Class({name:"iAd.TableViewFooter",superclass:iAd.View,synthesizedProperties:["text"],cssClassName:"ad-table-view-footer",collectionAccessor:"tableViewFooters"});
iAd.TableViewFooter.prototype.init=function(a){this.callSuper(a);this.wantsHardwareLayerBacking=true};iAd.TableViewFooter.prototype.getText=function(){return this.layer.textContent};iAd.TableViewFooter.prototype.setText=function(a){this.layer.textContent=a};iAd.Class("iAd.IndexPath");iAd.IndexPath.prototype.init=function(a,b){this.section=a||0;this.row=b||0};iAd.IndexPath.prototype.toString=function(){return"iAd.IndexPath with section "+this.section+" and row "+this.row};
iAd.IndexPath.prototype.copy=function(){return new iAd.IndexPath(this.section,this.row)};iAd.IndexPath.prototype.lowerThan=function(a){return a!=null&&(this.section<a.section||this.section==a.section&&this.row<a.row)};iAd.IndexPath.prototype.equals=function(a){return a!=null&&this.section==a.section&&this.row==a.row};iAd.IndexPath.prototype.greaterThan=function(a){return a!=null&&(this.section>a.section||this.section==a.section&&this.row>a.row)};iAd.Class("iAd.TableViewDeclarativeDataSource");
iAd.TableViewDeclarativeDataSource.ATTR_HEADER="ad-header";iAd.TableViewDeclarativeDataSource.ATTR_FOOTER="ad-footer";
iAd.TableViewDeclarativeDataSource.prototype.init=function(a){this.callSuper();this.data=[];for(var b,c,d;a.childElementCount;){b=a.removeChild(a.firstElementChild);c={cells:[]};if(iAd.Element.hasCustomAttribute(b,iAd.TableViewDeclarativeDataSource.ATTR_HEADER))c.header=iAd.Element.getCustomAttribute(b,iAd.TableViewDeclarativeDataSource.ATTR_HEADER);if(iAd.Element.hasCustomAttribute(b,iAd.TableViewDeclarativeDataSource.ATTR_FOOTER))c.footer=iAd.Element.getCustomAttribute(b,iAd.TableViewDeclarativeDataSource.ATTR_FOOTER);
for(;b.childElementCount;){d=new iAd.TableViewCell(b.removeChild(b.firstElementChild));d.initWithDeclarativeBacking();c.cells.push({text:d.text,detailedText:d.detailedText,cellStyle:d.cellStyle,editingStyle:d.editingStyle,selectionStyle:d.selectionStyle,accessoryType:d.accessoryType})}this.data.push(c)}};iAd.TableViewDeclarativeDataSource.prototype.numberOfSectionsInTableView=function(){return this.data.length};
iAd.TableViewDeclarativeDataSource.prototype.tableViewNumberOfRowsInSection=function(a,b){return this.data[b].cells.length};iAd.TableViewDeclarativeDataSource.prototype.tableViewCellForRowAtIndexPath=function(a,b){var c=this.data[b.section].cells[b.row],d=a.dequeueReusableCellWithIdentifier(iAd.TableViewCell._name)||new iAd.TableViewCell;iAd.Utils.copyPropertiesFromSourceToTarget(c,d);return d};
iAd.TableViewDeclarativeDataSource.prototype.tableViewTitleForHeaderInSection=function(a,b){return this.data[b].header||null};iAd.TableViewDeclarativeDataSource.prototype.tableViewTitleForFooterInSection=function(a,b){return this.data[b].footer||null};
iAd.TableView.prototype.dumpSubviews=function(){var a=this.visibleSubviews;console.group(a.length+" subviews");for(var b,c,d,e=0,f=a.length;e<f;e++){b=a[e];c=b._tableViewDataSourceInfo;if(c.type==iAd.TableView.TYPE_FOOTER){d="Footer";c="section = "+c.section}else if(c.type==iAd.TableView.TYPE_HEADER){d="Header";c="section = "+c.section}else{d="Cell";c="section = "+c.indexPath.section+" row = "+c.indexPath.row}console.log(e,d,b.text,c)}console.groupEnd()};
iAd.Class({name:"iAd.SearchDisplayController",superclass:iAd.Object,mixins:[iAd.EventTarget],synthesizedProperties:["searchResultsTableView","searchResultsDataSource","searchResultsDelegate","searchResultsTitle","active","dimTableViewOnEmptySearchString","automaticallyShowsNoResultsMessage","noResultsMessage","noResultsMessageVisible"],archivedProperties:["searchBar","searchContentsController","searchResultsDataSource","searchResultsDelegate","searchResultsTitle","active"]});
iAd.SearchDisplayController.SEARCHBAR_PLACEHOLDER_TEXT="Search";iAd.SearchDisplayController.NO_RESULTS_MESSAGE_DEFAULT="No Results.";iAd.SearchDisplayController.SEARCH_RESULTS_TITLE_DEFAULT="Results";iAd.SearchDisplayController.KEYBOARD_RECTS={landscape:new iAd.Rect(0,0,1024,396),portrait:new iAd.Rect(0,0,768,308)};iAd.SearchDisplayController.WILL_BEGIN_SEARCH="searchDisplayControllerWillBeginSearch";iAd.SearchDisplayController.DID_BEGIN_SEARCH="searchDisplayControllerDidBeginSearch";
iAd.SearchDisplayController.WILL_END_SEARCH="searchDisplayControllerWillEndSearch";iAd.SearchDisplayController.DID_END_SEARCH="searchDisplayControllerDidEndSearch";iAd.SearchDisplayController.DID_LOAD_SEARCH_RESULTS_TABLE_VIEW="searchDisplayControllerDidLoadSearchResultsTableView";iAd.SearchDisplayController.WILL_UNLOAD_SEARCH_RESULTS_TABLE_VIEW="searchDisplayControllerWillUnloadSearchResultsTableView";iAd.SearchDisplayController.WILL_SHOW_SEARCH_RESULTS_TABLE_VIEW="searchDisplayControllerWillShowSearchResultsTableView";
iAd.SearchDisplayController.DID_SHOW_SEARCH_RESULTS_TABLE_VIEW="searchDisplayControllerDidShowSearchResultsTableView";iAd.SearchDisplayController.WILL_HIDE_SEARCH_RESULTS_TABLE_VIEW="searchDisplayControllerWillHideSearchResultsTableView";iAd.SearchDisplayController.DID_HIDE_SEARCH_RESULTS_TABLE_VIEW="searchDisplayControllerDidHideSearchResultsTableView";iAd.SearchDisplayController.SHOULD_RELOAD_TABLE_FOR_SEARCH_STRING="searchDisplayControllerShouldReloadTableForSearchString";
iAd.SearchDisplayController.SHOULD_DEACTIVATE_ON_CANCEL_BUTTON_CLICK="shouldDeactivateOnCancelButtonClick";
iAd.SearchDisplayController.prototype.init=function(a,b){this.delegate=null;this.searchBar=a;this.searchBar.delegate=this;if(this.searchBar.placeholder.length==0)this.searchBar.placeholder=iAd.SearchDisplayController.SEARCHBAR_PLACEHOLDER_TEXT;this.searchContentsController=b;this._searchResultsTitle=this._searchResultsDelegate=this._searchResultsDataSource=this._searchResultsTableView=null;this._active=false;this._automaticallyShowsNoResultMessage=true;this._noResultsMessage=iAd.SearchDisplayController.NO_RESULTS_MESSAGE_DEFAULT;
this._dimTableViewOnEmptySearchString=this._noResultsMessageVisibile=true;this.eventTarget=document;this.callSuper()};iAd.SearchDisplayController.restoreFromArchive=function(a){return new this(a.searchBar,a.searchContentsController)};iAd.SearchDisplayController.prototype.setSearchResultsDataSource=function(a){if(this._searchResultsTableView)this._searchResultsTableView.dataSource=a;this._searchResultsDataSource=a};
iAd.SearchDisplayController.prototype.setSearchResultsDelegate=function(a){if(this._searchResultsTableView)this._searchResultsTableView.delegate=a;this._searchResultsDelegate=a};iAd.SearchDisplayController.prototype.setNoResultsMessageVisible=function(a){if(this._noResultsMessageVisible!=a){this._noResultsMessageVisible=a;this.updateNoSearchResultsMessageVisibility()}};
iAd.SearchDisplayController.prototype.setAutomaticallyShowsNoResultsMessage=function(a){if(this._automaticallyShowsNoResultsMessage!=a){this._automaticallyShowsNoResultsMessage=a;this.updateNoSearchResultsMessageVisibility()}};iAd.SearchDisplayController.prototype.setNoResultsMessage=function(a){this._noResultsMessage=a};iAd.SearchDisplayController.prototype.setActive=function(a){this.setActiveAnimated(a,false)};
iAd.SearchDisplayController.prototype.setActiveAnimated=function(a,b){if(this._active!=a){this._active=a;this.dispatchNotification(a?iAd.SearchDisplayController.WILL_BEGIN_SEARCH:iAd.SearchDisplayController.WILL_END_SEARCH,this.delegate);var c=this.searchBar.isInBar();if(!c){b=false;var d=this.searchContentsController.view,e=new iAd.Rect,f=d.frame;e=this.searchBar.convertRectToView(this.searchBar.frame,d);if(!this._dimmingView){this._dimmingView=new iAd.View;this._dimmingView.userInteractionEnabled=
true;this._dimmingView.addEventListener(iAd.View.ACTIVATE_EVENT,this,false);this._dimmingView.layer.style.setProperty("background-color","black");this._dimmingView.opacity=0.5}this._dimTableViewOnEmptySearchString&&d.addSubview(this._dimmingView);this._dimmingView.frame=new iAd.Rect(f.origin.x,e.maxY(),f.size.width,f.size.height-e.maxY());if(this._searchResultsTableView)this._searchResultsTableView.frame=this._dimmingView.frame}if(!this._active)this.searchBar.editing=false;this.notifyPropertyChange("active");
if(!b||c)this.showHideAnimationDidFinish()}};
iAd.SearchDisplayController.prototype.showHideAnimationDidFinish=function(){if(this._active)this.searchBar.isInBar()&&this.setSearchResultsTableViewVisible(this.searchBar.text.length>0,this.searchContentsController.view);else{this.setSearchResultsTableViewVisible(false,this.searchContentsController.view);this.destroyManagedTableView();if(this._dimmingView){this._dimmingView.removeFromSuperview();this._dimmingView=null}}this.dispatchNotification(this._active?iAd.SearchDisplayController.DID_BEGIN_SEARCH:
iAd.SearchDisplayController.DID_END_SEARCH,this.delegate)};iAd.SearchDisplayController.prototype.setSearchResultsTableView=function(){};iAd.SearchDisplayController.prototype.getSearchResultsTableView=function(){if(!this._searchResultsTableView)this._searchResultsTableView=this.createSearchResultsTableView();return this._searchResultsTableView};
iAd.SearchDisplayController.prototype.createSearchResultsTableView=function(){var a=new iAd.SearchResultsTableView;a._searchDisplayController=this;a.tableStyle=iAd.TableView.STYLE_PLAIN;a.dataSource=this.searchResultsDataSource;a.delegate=this.searchResultsDelegate;a.autoresizingMask=iAd.View.AUTORESIZING_FLEXIBLE_WIDTH|iAd.View.AUTORESIZING_FLEXIBLE_HEIGHT;this.dispatchNotification(iAd.SearchDisplayController.DID_LOAD_SEARCH_RESULTS_TABLE_VIEW,this.delegate,[["tableView",a]]);return a};
iAd.SearchDisplayController.prototype.tableViewFrame=function(){var a=this.searchContentsController.view,b=a.frame;a=this.searchBar.convertRectToView(this.searchBar.frame,a);return new iAd.Rect(b.origin.x,a.maxY(),b.size.width,b.maxY()-a.maxY())};
iAd.SearchDisplayController.prototype.setSearchResultsTableViewVisible=function(a,b){var c=this.searchBar.isInBar(),d=b||this.searchContentsController.view;if(a&&(!this._searchResultsTableView||this._searchResultsTableView.superview==null||c&&(!this._popoverController||!this._popoverController.popoverVisible))){var e=this.searchResultsTableView;this.dispatchNotification(iAd.SearchDisplayController.WILL_SHOW_SEARCH_RESULTS_TABLE_VIEW,this.delegate,[["tableView",e]]);if(c){if(!this._popoverController)this._popoverController=
this.createPopoverController();this._popoverController.passthroughViews=[this.searchBar];this.updatePopoverControllerLayoutMargins();this._popoverController.presentPopoverFromBarButtonItemPermittedArrowDirectionsAnimated(this.searchBar.barButtonItem,iAd.PopoverController.ARROW_DIRECTION_UP|iAd.PopoverController.ARROW_DIRECTION_DOWN,true)}else{e.frame=this.tableViewFrame();d.addSubview(e)}this.dispatchNotification(iAd.SearchDisplayController.DID_SHOW_SEARCH_RESULTS_TABLE_VIEW,this.delegate,[["tableView",
e]])}else if(!a&&(this._searchResultsTableView&&this._searchResultsTableView.superview||c)){this.dispatchNotification(iAd.SearchDisplayController.WILL_HIDE_SEARCH_RESULTS_TABLE_VIEW,this.delegate,[["tableView",this._searchResultsTableView]]);if(c){this._popoverController&&this._popoverController.popoverVisible&&this._popoverController.dismissPopoverAnimated(false);this._popoverController=null}else{this._dimTableViewOnEmptySearchString&&this._dimmingView&&d.addSubview(this._dimmingView);this._searchResultsTableView.removeFromSuperview()}this.dispatchNotification(iAd.SearchDisplayController.DID_HIDE_SEARCH_RESULTS_TABLE_VIEW,
this.delegate,[["tableView",this._searchResultsTableView]])}};
iAd.SearchDisplayController.prototype.updatePopoverControllerLayoutMargins=function(){if(this._popoverController){var a=iAd.PopoverController.DEFAULT_LAYOUT_MARGINS.copy();if(this.searchBar.editing&&iAd.Device.iOS_VERSION){var b="portrait";if(iAd.Device.orientation==iAd.Device.ORIENTATION_LANDSCAPE_LEFT||iAd.Device.orientation==iAd.Device.ORIENTATION_LANDSCAPE_RIGHT)b="landscape";a.bottom+=iAd.SearchDisplayController.KEYBOARD_RECTS[b].size.height}this._popoverController.popoverLayoutMargins=a}};
iAd.SearchDisplayController.prototype.createPopoverController=function(){var a=new iAd.ViewController;a.title=this.searchResultsTitle||iAd.SearchDisplayController.SEARCH_RESULTS_TITLE_DEFAULT;a.view=this.searchResultsTableView;a=new iAd.NavigationController(null,a);a=new iAd.PopoverController(a);a.delegate=this;return a};
iAd.SearchDisplayController.prototype.destroyManagedTableView=function(){if(this._searchResultsTableView){this.dispatchNotification(iAd.SearchDisplayController.WILL_UNLOAD_SEARCH_RESULTS_TABLE_VIEW,this.delegate,[["tableView",this._searchResultsTableView]]);this._searchResultsTableView.removeFromSuperview();this._searchResultsTableView=null}if(this._popoverController){this._popoverController.isPopoverVisible&&this._popoverController.dismissPopoverAnimated(false);this._popoverController=null}};
iAd.SearchDisplayController.prototype.updateNoSearchResultsMessageVisibility=function(){this._automaticallyDisplayNoResultsMessage&&this.searchResultsTableViewRowCount()};iAd.SearchDisplayController.prototype.searchResultsTableViewRowCount=function(){return this._searchResultsTableView.calculateNumberOfRows()};
iAd.SearchDisplayController.prototype.searchBarCancelButtonClicked=function(){var a=true;if(iAd.Utils.objectHasMethod(this.delegate,iAd.SearchDisplayController.SHOULD_DEACTIVATE_ON_CANCEL_BUTTON_CLICKED))a=this.delegate[iAd.SearchDisplayController.SHOULD_DEACTIVATE_ON_CANCEL_BUTTON_CLICKED]();a&&this.setActiveAnimated(false,true)};
iAd.SearchDisplayController.prototype.searchBarTextDidBeginEditing=function(){this.setActiveAnimated(true,true);this._popoverController&&this._popoverController.popoverVisible&&this.updatePopoverControllerLayoutMargins()};iAd.SearchDisplayController.prototype.searchBarTextDidEndEditing=function(){this._popoverController&&this.updatePopoverControllerLayoutMargins()};
iAd.SearchDisplayController.prototype.searchBarTextDidChange=function(a,b){var c=this.searchResultsTableView,d=true;if(iAd.Utils.objectHasMethod(this.delegate,iAd.SearchDisplayController.SHOULD_RELOAD_TABLE_FOR_SEARCH_STRING))d=this.delegate[iAd.SearchDisplayController.SHOULD_RELOAD_TABLE_FOR_SEARCH_STRING](this,b);d&&c.reloadData();this.setSearchResultsTableViewVisible(b.length||this._popoverController&&this._popoverController.popoverVisible)};
iAd.SearchDisplayController.prototype.popoverControllerDidDismissPopover=function(){this.setActiveAnimated(false,false)};iAd.SearchDisplayController.prototype.popoverControllerShouldDismissPopover=function(){if(this.searchBar.editing)this.searchBar.editing=false;return true};iAd.SearchDisplayController.prototype.searchResultsTableViewNumberOfRowsDidChange=function(){this.updateNoSearchResultsMessageVisibility()};
iAd.SearchDisplayController.prototype.handleEvent=function(a){var b=a.ad?a.ad.sender:null;a.type==iAd.View.ACTIVATE_EVENT&&b&&b==this._dimmingView&&this.searchBarCancelButtonClicked()};iAd.Class({name:"iAd.SearchResultsTableView",superclass:iAd.TableView});iAd.SearchResultsTableView.NUMBER_OF_ROWS_DID_CHANGE="searchResultsTableViewNumberOfRowsDidChange";iAd.SearchResultsTableView.prototype.init=function(a){this._searchDisplayController=null;this.callSuper(a)};
iAd.SearchResultsTableView.prototype.reloadData=function(){var a=this.calculateNumberOfRows();this.callSuper();var b=this.calculateNumberOfRows();a!=b&&this._searchDisplayController&&this._searchDisplayController[iAd.SearchResultsTableView.NUMBER_OF_ROWS_DID_CHANGE]()};iAd.SearchResultsTableView.prototype.calculateNumberOfRows=function(){for(var a=this.numberOfSections,b=0,c=0;c<a;c++)b+=this.numberOfRowsInSection(c);return b};iAd.Class({name:"iAd.SpatialNavigationViewProcessor",superclass:iAd.ViewProcessor});
iAd.SpatialNavigationViewProcessor.prototype.processView=function(a){iAd.SpatialNavigationManager.sharedManager.registerSubtree(a.layer)};iAd.SpatialNavigationViewProcessor.prototype.cleanUp=function(){iAd.SpatialNavigationManager.sharedManager.unregisterSubtree(this.viewController.view.layer)};iAd.ViewController.addViewProcessor(iAd.SpatialNavigationViewProcessor);iAd.Class({name:"iAd.StackController",superclass:iAd.NavigationController});
iAd.StackController.prototype.init=function(a,b){iAd.Console.warn("The iAd.StackController class was deprecated in iAd JS 1.6. Use the iAd.NavigationController class instead.");this.callSuper(a,b)};iAd.RootViewController.prototype.getStackController=function(){iAd.Console.warn("The .stackController property on iAd.RootViewController was deprecated in iAd JS 1.6. Use the .navigationController property instead.");return this.navigationController};
iAd.Class.synthesizeProperties(iAd.RootViewController,["stackController"]);iAd.Class({name:"iAd.TabBarItemView",superclass:iAd.Control,synthesizedProperties:["title","image","badgeValue"],cssClassName:"ad-tab-bar-item"});iAd.TabBarItemView.HEIGHT=44;iAd.TabBarItemView.SELECTED_MASK_IMAGE_WIDTH=48;iAd.TabBarItemView.HAS_HIDPI_VERSION_ATTR="ad-has-hidpi-version";
iAd.TabBarItemView.prototype.init=function(a){if(!iAd.TabBarItemView.selectedMaskImage)iAd.TabBarItemView.selectedMaskImage=iAd.Image.imageForURL(iAd.Path.assetsPath+"tab-bar-blue-gradient-mask.png",true);this._image=this._title="";this._badgeValue=null;this.callSuper(a)};
iAd.TabBarItemView.prototype.layerWasCreated=function(){this.callSuper();this.canvasContainer=this.layer.appendChild(document.createElement("div"));this.defaultCanvas=this.canvasContainer.appendChild(document.createElement("canvas"));this.selectedCanvas=this.canvasContainer.appendChild(document.createElement("canvas"));this.canvasContainer.className="ad-image";this.label=this.layer.appendChild(document.createElement("div"));this.label.className="ad-title";this.badge=this.layer.appendChild(document.createElement("div"));
this.badge.className="ad-badge";this.badgeContent=this.badge.appendChild(document.createElement("span"))};iAd.TabBarItemView.prototype.setValueForAttribute=function(a,b){if(b=="ad-image")this.image=iAd.Image.imageForURL(a,this.layerHasCustomAttribute(iAd.TabBarItemView.HAS_HIDPI_VERSION_ATTR));else b!=iAd.TabBarItemView.HAS_HIDPI_VERSION_ATTR&&this.callSuper(a,b)};
iAd.TabBarItemView.prototype.setSize=function(a){this.callSuper(a);this.badgeContent.style.maxWidth=this.size.width-12+"px";this.updateBadgePosition();this.updateImagePosition()};iAd.TabBarItemView.prototype.layerWasInsertedIntoDocument=function(){this.callSuper();this.updateBadgePosition()};iAd.TabBarItemView.prototype.setTitle=function(a){this._title=this.label.textContent=a};
iAd.TabBarItemView.prototype.setImage=function(a){this._image&&this._image.removePropertyObserver("loaded",this);if(this._image=a)a.loaded?this.updateCanvasImages():a.addPropertyObserver("loaded",this,"updateCanvasImages")};iAd.TabBarItemView.prototype.setBadgeValue=function(a){this._badgeValue=a;if(a!=null){this.badge.style.display="block";this.badgeContent.textContent=a;this.updateBadgePosition()}else this.badge.style.display="none"};
iAd.TabBarItemView.prototype.updateBadgePosition=function(){if(!(!this.layerIsInDocument||this._badgeValue==null))if(this.badge.offsetWidth<this.size.width/2){this.badge.style.left=Math.round(this.size.width/2)+"px";this.badge.style.right=""}else{this.badge.style.right="-4px";this.badge.style.left=""}};iAd.TabBarItemView.prototype.updateImagePosition=function(){this.canvasContainer.style.left=(this._size.width-iAd.TabBarItemView.SELECTED_MASK_IMAGE_WIDTH)/2-3+"px"};
iAd.TabBarItemView.prototype.maskImageDidLoad=function(a){if(a.loaded){a.removePropertyObserver("loaded",this);this.updateCanvasImages()}};iAd.TabBarItemView.prototype.updateCanvasImages=function(){if(!(this._image==null||!this._image.loaded)){var a=iAd.TabBarItemView.selectedMaskImage;if(a.loaded){this.drawImage(this.defaultCanvas,false);this.drawImage(this.selectedCanvas,true)}else a.addPropertyObserver("loaded",this,"maskImageDidLoad")}};
iAd.TabBarItemView.prototype.drawImage=function(a,b){var c=iAd.TabBarItemView.selectedMaskImage,d=c.element.width,e=c.element.height;a.width=d;a.height=e;var f=a.getContext("2d");f.clearRect(0,0,d,e);f.globalCompositeOperation="source-over";f.drawImage(this._image.element,(d-this._image.element.width)/2,(e-this._image.element.height)/2);f.globalCompositeOperation="source-in";if(b)f.drawImage(c.element,0,0);else{c=f.createLinearGradient(0,0,0,e);c.addColorStop(0,"rgb(69%, 69%, 69%)");c.addColorStop(1,
"rgb(31%, 31%, 31%)");f.fillStyle=c;f.fillRect(0,0,d,e)}};iAd.Class({name:"iAd.TabBarItem",superclass:iAd.BarItem,synthesizedProperties:["badgeValue"],archivedProperties:["badgeValue"]});iAd.TabBarItem.prototype.init=function(a){this.callSuper();this.view=a||new iAd.TabBarItemView(null);this.view.tabBarItem=this};iAd.TabBarItem.initWithTitleImageAndTag=function(a,b,c){var d=new iAd.TabBarItem;d.title=a;d.image=b;d.tag=c;return d};iAd.TabBarItem.prototype.getTitle=function(){return this.view.title};
iAd.TabBarItem.prototype.setTitle=function(a){this.view.title=a};iAd.TabBarItem.prototype.getImage=function(){return this.view.image};iAd.TabBarItem.prototype.setImage=function(a){this.view.image=a};iAd.TabBarItem.prototype.getBadgeValue=function(){return this.view.badgeValue};iAd.TabBarItem.prototype.setBadgeValue=function(a){this.view.badgeValue=a};iAd.TabBarItem.prototype.getEnabled=function(){return this.view.enabled};iAd.TabBarItem.prototype.setEnabled=function(a){this.view.enabled=a};
iAd.Class({name:"iAd.TabBar",superclass:iAd.View,synthesizedProperties:["items","selectedItem"],archivedProperties:["items","selectedItem"],cssClassName:"ad-tab-bar",collectionAccessor:"tabBars"});iAd.TabBar.DEFAULT_HEIGHT=49;iAd.TabBar.X_MARGIN=2;iAd.TabBar.DEFAULT_IPAD_ITEM_WIDTH=80;iAd.TabBar.DEFAULT_IPAD_ITEM_SPACING=30;iAd.TabBar.CUSTOMIZE_GRID_CELL_SIZE=80;iAd.TabBar.DID_SELECT_ITEM="tabBarDidSelectItem";iAd.TabBar.WILL_BEGIN_CUSTOMIZING_ITEMS="tabBarWillBeginCustomizingItems";
iAd.TabBar.DID_BEGIN_CUSTOMIZING_ITEMS="tabBarDidBeginCustomizingItems";iAd.TabBar.WILL_END_CUSTOMIZING_ITEMS_CHANGED="tabBarWillEndCustomizingItemsChanged";iAd.TabBar.DID_END_CUSTOMIZING_ITEMS_CHANGED="tabBarDidEndCustomizingItemsChanged";iAd.TabBar.prototype.init=function(a){this.delegate=null;this.isCustomizing=false;this._items=[];this._selectedItem=null;this.callSuper(a);this.layer.addEventListener("webkitTransitionEnd",this,false)};
iAd.TabBar.prototype.readPropertiesFromLayerComputedStyle=function(a){this.callSuper(a);a=[];for(var b=this.layer.querySelectorAll("."+iAd.TabBarItemView.cssClassName),c,d=0,e=b.length;d<e;d++){c=b[d]._view;c.addEventListener(iAd.View.TOUCH_DOWN_EVENT,this,false);a.push(new iAd.TabBarItem(c))}this.items=a};iAd.TabBar.prototype.setSize=function(a){a.height=iAd.TabBar.DEFAULT_HEIGHT;this.callSuper(a);this.updateLayout()};
iAd.TabBar.prototype.willMoveToSuperview=function(a){if(a!=null){if(this._size.width==0)this.size=new iAd.Size(a.size.width,iAd.TabBar.DEFAULT_HEIGHT);if(this._position.y==0)this.position=new iAd.Point(0,a.size.height-iAd.TabBar.DEFAULT_HEIGHT)}};
iAd.TabBar.prototype.setSelectedItem=function(a){if(a){if(this._selectedItem!==a){if(this._selectedItem!=null)this._selectedItem.view.selected=false;a.view.selected=true;this._selectedItem=a}this.dispatchNotification(iAd.TabBar.DID_SELECT_ITEM,this.delegate,[["item",a]])}};iAd.TabBar.prototype.setItems=function(a){this.setItemsAnimated(a,false)};
iAd.TabBar.prototype.setItemsAnimated=function(a,b){if(iAd.Utils.objectIsArray(a)){for(var c=0,d=this._items.length;c<d;c++){var e=this._items[c],f=e.view;if(a.indexOf(e)==-1)if(f.transitionsEnabled=b){f.needsRemoval=true;f.transform="scale(0.001)";f.opacity=0}else f.removeFromSuperview()}d=a.length;e=Math.round((this.size.width-2*iAd.TabBar.X_MARGIN)/d);var g=0,h=iAd.TabBar.X_MARGIN;if(iAd.Device.IS_IPAD&&e>iAd.TabBar.DEFAULT_IPAD_ITEM_WIDTH+iAd.TabBar.DEFAULT_IPAD_ITEM_SPACING){e=iAd.TabBar.DEFAULT_IPAD_ITEM_WIDTH;
g=iAd.TabBar.DEFAULT_IPAD_ITEM_SPACING;h=Math.round((this._size.width-d*e-(d-1)*g)/2)}for(c=0;c<d;c++){f=a[c].view;f.position=new iAd.Point(h,0);f.size=new iAd.Size(e,iAd.TabBarItemView.HEIGHT);f.transitionsEnabled=b;if(f.superview!==this){this.addSubview(f);f.addEventListener(iAd.View.TOUCH_DOWN_EVENT,this,false)}h+=e+g}this._items=a;if((this.selectedItem==null||this.selectedItem.view.superview!==this||this.selectedItem.view.needsRemoval)&&d>0)this.selectedItem=a[0]}};
iAd.TabBar.prototype.updateLayout=function(){this._items.length>0&&this.setItemsAnimated(this._items,false)};iAd.TabBar.prototype.handleEvent=function(a){this.callSuper(a);switch(a.type){case iAd.View.TOUCH_DOWN_EVENT:this.selectedItem=a.ad.sender.tabBarItem;break;case "webkitTransitionEnd":this.removeItemViewIfNeeded(a.target._control)}};
iAd.TabBar.prototype.removeItemViewIfNeeded=function(a){if(a.needsRemoval){a.removeFromSuperview();a.needsRemoval=false;a.transitionsEnabled=false;a.transform="scale(1)";a.opacity=1}};
iAd.TabBar.prototype.beginCustomizingItems=function(a){this.dispatchNotification(iAd.TabBar.WILL_BEGIN_CUSTOMIZING_ITEMS,this.delegate,[["items",a]]);this.isCustomizing=true;this.itemsPriorToCustomization=this._items;this.customizingItems=a;this.dispatchNotification(iAd.TabBar.DID_BEGIN_CUSTOMIZING_ITEMS,this.delegate,[["items",a]])};
iAd.TabBar.prototype.endCustomizingAnimated=function(){this.dispatchNotification(iAd.TabBar.WILL_END_CUSTOMIZING_ITEMS_CHANGED,this.delegate,[["items",this.customizingItems],["changed",true]]);this.isCustomizing=false;this.dispatchNotification(iAd.TabBar.DID_END_CUSTOMIZING_ITEMS_CHANGED,this.delegate,[["items",this.customizingItems],["changed",true]])};
iAd.Class({name:"iAd.TabBarController",superclass:iAd.ViewController,synthesizedProperties:["viewControllers","selectedViewController","selectedIndex"],archivedProperties:["viewControllers","selectedViewController"]});iAd.TabBarController.SHOULD_SELECT_VIEW_CONTROLLER="tabBarControllerShouldSelectViewController";iAd.TabBarController.DID_SELECT_VIEW_CONTROLLER="tabBarControllerDidSelectViewController";iAd.TabBarControllerMaxItems=5;
iAd.TabBarController.prototype.init=function(a){this.callSuper(a);this.delegate=null;this.tabBar=new iAd.TabBar;this.viewAppearancePropagationProperty="selectedViewController";this.shouldArchiveView=false;this._viewControllers=[];this._selectedViewController=null;this.tabBar.delegate=this};
iAd.TabBarController.prototype.loadView=function(){this.callSuper();this._view.layer.addClassName("ad-tab-bar-controller-view");this._view.size=new iAd.Size(window.innerWidth,window.innerHeight);this._view.autoresizingMask=iAd.View.AUTORESIZING_FLEXIBLE_WIDTH|iAd.View.AUTORESIZING_FLEXIBLE_HEIGHT;this.hostView=this._view.addSubview(new iAd.View);this.hostView.layer.addClassName("ad-tab-bar-controller-host-view");this.hostView.size=new iAd.Size(this._view.size.width,this._view.size.height-iAd.TabBar.DEFAULT_HEIGHT);
this.hostView.autoresizingMask=iAd.View.AUTORESIZING_FLEXIBLE_WIDTH|iAd.View.AUTORESIZING_FLEXIBLE_HEIGHT;this._view.addSubview(this.tabBar);this.tabBar.autoresizingMask=iAd.View.AUTORESIZING_FLEXIBLE_WIDTH|iAd.View.AUTORESIZING_FLEXIBLE_TOP_MARGIN;this.showSelectedViewController(this._viewControllers[this.selectedIndex])};iAd.TabBarController.prototype.unloadView=function(){this.tabBar&&this.tabBar.removeFromSuperview();if(this.hostView){this.hostView.removeFromSuperview();this.hostView=null}this.callSuper()};
iAd.TabBarController.prototype.didReceiveMemoryWarning=function(){this.callSuper();for(var a=this._viewControllers,b=this._view?this.selectedIndex:-1,c=0,d=a.length;c<d;c++)c!=b&&a[c].unloadView()};iAd.TabBarController.prototype.tabBarDidSelectItem=function(){this.showSelectedViewController(this._viewControllers[this.selectedIndex])};
iAd.TabBarController.prototype.showSelectedViewController=function(a){if(this.isViewLoaded()){var b=this._selectedViewController;if(a===b)iAd.Utils.objectIsInstanceOfClass(a,iAd.NavigationController)&&a.popToRootViewControllerAnimated(true);else{this._selectedViewController=a;a!=null&&a.viewWillAppear(false);if(b!=null){b.viewWillDisappear(false);b.view.removeFromSuperview();b.viewDidDisappear(false)}if(a!=null){b=a.view;b.size=this.hostView.size.copy();b.autoresizingMask=iAd.View.AUTORESIZING_FLEXIBLE_WIDTH|
iAd.View.AUTORESIZING_FLEXIBLE_HEIGHT;this.hostView.addSubview(b);a.viewDidAppear(false);iAd.Utils.objectHasMethod(this.delegate,iAd.TabBarController.DID_SELECT_VIEW_CONTROLLER)&&this.delegate[iAd.TabBarController.DID_SELECT_VIEW_CONTROLLER](this,a)}}}};iAd.TabBarController.prototype.setViewControllers=function(a){this.setViewControllersAnimated(a,false)};
iAd.TabBarController.prototype.setViewControllersAnimated=function(a,b){this._viewControllers=a;for(var c=[],d=0,e=a.length;d<e;d++)c.push(a[d].tabBarItem);this.tabBar.setItemsAnimated(c,b)};iAd.TabBarController.prototype.setSelectedViewController=function(a){if(this._viewControllers.indexOf(a)!=-1)this.tabBar.selectedItem=a.tabBarItem};iAd.TabBarController.prototype.getSelectedIndex=function(){return this.tabBar.items.indexOf(this.tabBar.selectedItem)};
iAd.TabBarController.prototype.setSelectedIndex=function(a){if(a>=0&&a<this._viewControllers.length)this.tabBar.selectedItem=this._viewControllers[a].tabBarItem};iAd.ViewController.prototype.getTabBarController=function(){return this.parentControllerOfKind(iAd.TabBarController)};iAd.ViewController.prototype.getTabBarItem=function(){if(this._tabBarItem==null){this._tabBarItem=new iAd.TabBarItem;this._tabBarItem.title=this.title;this._tabBarItem.viewController=this}return this._tabBarItem};
iAd.Class.synthesizeProperties(iAd.ViewController,["tabBarController","tabBarItem"]);iAd.Class({name:"iAd.TransitionsViewProcessor",superclass:iAd.ViewControllerReferencingViewProcessor});iAd.TransitionsViewProcessor.ATTR_NAME="ad-transitions-to";iAd.TransitionsViewProcessor.PROCESSED_KEY="_adProcessedTransitionsTo";
iAd.TransitionsViewProcessor.prototype.handleEvent=function(a){if(this.shouldHandleEvent(a)){a=iAd.Element.getCustomAttribute(a.currentTarget,iAd.TransitionsViewProcessor.ATTR_NAME);if(a=iAd.ViewController.instances[a])iAd.RootViewController.sharedRootViewController.transitionController.visibleViewController=a}};iAd.ViewController.addViewProcessor(iAd.TransitionsViewProcessor);
iAd.Class({name:"iAd.RatingControl",superclass:iAd.Control,synthesizedProperties:["width","value"],archivedProperties:["value"],cssClassName:"ad-rating-control",collectionAccessor:"ratingControls"});iAd.RatingControl.STAR_HEIGHT=21;iAd.RatingControl.STAR_WIDTH=21;iAd.RatingControl.MIN_VALUE=0;iAd.RatingControl.MAX_VALUE=5;iAd.RatingControl.MIN_MARGIN=10;iAd.RatingControl.FILLED_CSS="ad-filled";
iAd.RatingControl.prototype.init=function(a){this.margin=iAd.RatingControl.MIN_MARGIN;this.numStars=iAd.RatingControl.MAX_VALUE-iAd.RatingControl.MIN_VALUE;this.minWidth=this.numStars*iAd.RatingControl.STAR_WIDTH+(this.numStars-1)*iAd.RatingControl.MIN_MARGIN;this.stars=[];this._value=0;this.callSuper(a);this.size=new iAd.Size};iAd.RatingControl.prototype.layerWasCreated=function(){this.callSuper();for(var a=0;a<this.numStars;a++)this.stars.push(this.layer.appendChild(document.createElement("div")))};
iAd.RatingControl.prototype.setSize=function(a){a.width=Math.max(this.minWidth,a.width);a.height=iAd.RatingControl.STAR_HEIGHT;this.callSuper(a);this.margin=(this.size.width-this.numStars*iAd.RatingControl.STAR_WIDTH)/(this.numStars-1);for(a=0;a<this.numStars-1;a++)this.stars[a].style.marginRight=this.margin+"px"};iAd.RatingControl.prototype.getWidth=function(){return this.size.width};iAd.RatingControl.prototype.setWidth=function(a){this.size=new iAd.Size(a,0)};
iAd.RatingControl.prototype.setValue=function(a){a=iAd.Number.clampValue(a,iAd.RatingControl.MIN_VALUE,iAd.RatingControl.MAX_VALUE);if(a!=this._value){this._value=a;for(var b=0;b<this.numStars;b++)this.stars[b].className=b>=a-iAd.RatingControl.MIN_VALUE?"":iAd.RatingControl.FILLED_CSS;this.createAndDispatchEvent(iAd.Control.VALUE_CHANGE_EVENT)}};
iAd.RatingControl.prototype.touchesBegan=function(a){this.callSuper(a);this.touchesHaveMoved=false;this.startX=iAd.Point.fromEventInElement(a,this.layer).x;this.startValue=this.value};iAd.RatingControl.prototype.touchesMoved=function(a){this.callSuper(a);this.touchesHaveMoved=true;this.setValueFromX(iAd.Point.fromEventInElement(a,this.layer).x)};iAd.RatingControl.prototype.touchesEnded=function(a){this.touchesHaveMoved||this.setValueFromX(this.startX);this.callSuper(a)};
iAd.RatingControl.prototype.touchesCancelled=function(a){this.callSuper(a);this.value=this.startValue};iAd.RatingControl.prototype.setValueFromX=function(a){this.value=Math.floor((a+iAd.RatingControl.STAR_WIDTH+this.margin+this.margin/2)/(iAd.RatingControl.STAR_WIDTH+this.margin))};
iAd.Class({name:"iAd.SegmentedControl",superclass:iAd.Control,synthesizedProperties:["width","segmentedControlStyle","numberOfSegments","selectedSegmentIndex","momentary"],archivedProperties:["segmentedControlStyle","selectedSegmentIndex","momentary"],cssClassName:"ad-segmented-control",collectionAccessor:"segmentedControls"});iAd.SegmentedControl.cachedCanvasBackgroundImages=[];iAd.SegmentedControl.NO_SEGMENT=-1;iAd.SegmentedControl.STYLE_PLAIN="ad-plain";iAd.SegmentedControl.STYLE_BORDERED="ad-bordered";
iAd.SegmentedControl.STYLE_BAR="ad-bar";iAd.SegmentedControl.STYLE_BAR_BLACK="ad-bar-black";iAd.SegmentedControl.STYLE_BAR_POPOVER="ad-bar-popover";iAd.SegmentedControl.SEGMENT_SELECTED_CSS="ad-selected";iAd.SegmentedControl.SEGMENT_MOMENTARY_SELECTION_TIMER=0.2;
iAd.SegmentedControl.prototype.init=function(a,b){this._width=0;this._segmentedControlStyle="";this._numberOfSegments=0;this._selectedSegmentIndex=iAd.SegmentedControl.NO_SEGMENT;this._momentary=false;this.canvasBackgroundImage=null;this.hasBarStyle=false;this.callSuper(a);b!=undefined&&iAd.Utils.objectIsArray(b)&&this.populateWithItems(b)};iAd.SegmentedControl.prototype.createLayer=function(){this.callSuper();this.segmentedControlStyle=iAd.SegmentedControl.STYLE_PLAIN};
iAd.SegmentedControl.prototype.readPropertiesFromLayerComputedStyle=function(a){this.callSuper(a);this.segmentedControlStyle=this.layer.hasClassName(iAd.SegmentedControl.STYLE_BORDERED)?iAd.SegmentedControl.STYLE_BORDERED:this.layer.hasClassName(iAd.SegmentedControl.STYLE_BAR)?iAd.SegmentedControl.STYLE_BAR:this.layer.hasClassName(iAd.SegmentedControl.STYLE_BAR_BLACK)?iAd.SegmentedControl.STYLE_BAR_BLACK:iAd.SegmentedControl.STYLE_PLAIN};
iAd.SegmentedControl.prototype.setSize=function(a){a.height=this.hasBarStyle?30:44;this.callSuper(a);this.updateLayout()};iAd.SegmentedControl.prototype.layerWasInsertedIntoDocument=function(){this.callSuper();this.updateLayout();if(this.isInBar()&&this.superview.isInPopover)this.segmentedControlStyle=iAd.SegmentedControl.STYLE_BAR_POPOVER};
iAd.SegmentedControl.prototype.didAddSubview=function(a){this.updateLayout();this._selectedSegmentIndex!=iAd.SegmentedControl.NO_SEGMENT&&a._indexInSuperviewSubviews<=this._selectedSegmentIndex&&this.selectedSegmentIndex++};iAd.SegmentedControl.prototype.willMoveToSuperview=function(a){if(iAd.Utils.objectIsInstanceOfClass(a,iAd.Toolbar))this.segmentedControlStyle=a.barStyle===iAd.Toolbar.STYLE_DEFAULT?iAd.SegmentedControl.STYLE_BAR:iAd.SegmentedControl.STYLE_BAR_BLACK};
iAd.SegmentedControl.prototype.isInBar=function(){var a=this.superview;if(iAd.Utils.objectIsInstanceOfClass(a,iAd.NavigationBar)||iAd.Utils.objectIsInstanceOfClass(a,iAd.Toolbar))return true;return false};iAd.SegmentedControl.prototype.getWidth=function(){return this.size.width};iAd.SegmentedControl.prototype.setWidth=function(a){this.size=new iAd.Size(a,0)};
iAd.SegmentedControl.prototype.setSegmentedControlStyle=function(a){if(a){this.hasBarStyle=!(a===iAd.SegmentedControl.STYLE_PLAIN||a===iAd.SegmentedControl.STYLE_BORDERED);this.layer.removeClassName(this._segmentedControlStyle);this.layer.addClassName(a);this._segmentedControlStyle=a;this.updateCanvasBackgroundImage();this.width=this.width;this.updateAllSegmentBackgrounds()}};iAd.SegmentedControl.prototype.getNumberOfSegments=function(){return this.subviews.length};
iAd.SegmentedControl.prototype.setSelectedSegmentIndex=function(a){if(!(a==null||a<-1||a>=this.subviews.length||a==this._selectedSegmentIndex)){if(this._selectedSegmentIndex!=iAd.SegmentedControl.NO_SEGMENT&&this._selectedSegmentIndex>=0&&this._selectedSegmentIndex<this.subviews.length){var b=this.subviews[this._selectedSegmentIndex];b.layer.removeClassName(iAd.SegmentedControl.SEGMENT_SELECTED_CSS);b.drawBackgroundCanvas(this._selectedSegmentIndex,this.subviews.length,false)}if(a!=iAd.SegmentedControl.NO_SEGMENT){b=
this.subviews[a];b.layer.addClassName(iAd.SegmentedControl.SEGMENT_SELECTED_CSS);b.drawBackgroundCanvas(a,this.subviews.length,true)}this._selectedSegmentIndex=a;if(!this._momentary||a!=iAd.SegmentedControl.NO_SEGMENT)this.createAndDispatchEvent(iAd.Control.VALUE_CHANGE_EVENT)}};iAd.SegmentedControl.prototype.setMomentary=function(a){if(this._momentary!=a){this._momentary=a;this.selectedSegmentIndex=iAd.SegmentedControl.NO_SEGMENT}};
iAd.SegmentedControl.prototype.updateCanvasBackgroundImage=function(){var a="";if(iAd.Device.IS_IPAD&&this._segmentedControlStyle===iAd.SegmentedControl.STYLE_BAR||this._segmentedControlStyle===iAd.SegmentedControl.STYLE_BAR_POPOVER)a="~ipad";a=iAd.Path.assetsPath+"segmented-control-"+this._segmentedControlStyle.substr(3)+a+".png";if(!(this.canvasBackgroundImage!=null&&a==this.canvasBackgroundImage.url)){for(var b=iAd.SegmentedControl.cachedCanvasBackgroundImages,c=null,d,e=0,f=b.length;e<f;e++){d=
b[e];if(d.url==a){c=d;break}}if(c!=null)this.canvasBackgroundImage=c;else{this.canvasBackgroundImage=iAd.Image.imageForURL(a,true);this.canvasBackgroundImage.loaded||this.canvasBackgroundImage.addPropertyObserver("loaded",this,"canvasBackgroundImageDidLoad")}}};iAd.SegmentedControl.prototype.canvasBackgroundImageDidLoad=function(a){var b=iAd.SegmentedControl.cachedCanvasBackgroundImages;b.indexOf(a)==-1&&b.push(a);a===this.canvasBackgroundImage&&this.updateAllSegmentBackgrounds()};
iAd.SegmentedControl.prototype.populateWithItems=function(a){for(var b=0,c=a.length;b<c;b++){var d=a[b];if(d instanceof iAd.Image)this.insertSegmentWithImageAtIndexAnimated(d,this.numberOfSegments,false);else iAd.Utils.objectIsString(d)&&this.insertSegmentWithTitleAtIndexAnimated(d,this.numberOfSegments,false)}this.updateLayout()};
iAd.SegmentedControl.prototype.updateLayout=function(){if(!(this.size.width<=0)){for(var a=0,b=0,c=0,d=this.subviews.length;c<d;c++){var e=this.subviews[c];if(e.width>0)a+=e.width;else b++}a=Math.round(b>0?(this.size.width-a)/b:0);b=this.hasBarStyle?6:10;var f=-b;for(c=0;c<d;c++){e=this.subviews[c];var g=e.width==0?a:e.width;e.setLayerStyle({left:f+"px"});if(c==d-1)g=this.size.width-f-b;this.setActualWidthForSegmentAtIndex(g,c);f+=g;e.drawBackgroundCanvas(c,d,c==this._selectedSegmentIndex)}}};
iAd.SegmentedControl.prototype.updateAllSegmentBackgrounds=function(){for(var a=this.subviews,b=0,c=a.length;b<c;b++)a[b].drawBackgroundCanvas(b,a.length,b==this._selectedSegmentIndex)};iAd.SegmentedControl.prototype.setImageForSegmentAtIndex=function(a,b){b=iAd.Number.clampValue(b,0,this.subviews.length-1);this.subviews[b].image=a};iAd.SegmentedControl.prototype.imageForSegmentAtIndex=function(a){a=Math.min(a,this.subviews.length-1);return a>=0?this.subviews[a].image:null};
iAd.SegmentedControl.prototype.setTitleForSegmentAtIndex=function(a,b){b=iAd.Number.clampValue(b,0,this.subviews.length-1);this.subviews[b].title=a};iAd.SegmentedControl.prototype.titleForSegmentAtIndex=function(a){a=Math.min(a,this.subviews.length-1);return a>=0?this.subviews[a].title:null};
iAd.SegmentedControl.prototype.insertSegmentWithImageAtIndexAnimated=function(a,b){b=iAd.Number.clampValue(b,0,this.subviews.length);var c=new iAd.Segment;this.insertSubviewAtIndex(c,b);this.setImageForSegmentAtIndex(a,b);c.drawBackgroundCanvas(b,this.subviews.length,false)};
iAd.SegmentedControl.prototype.insertSegmentWithTitleAtIndexAnimated=function(a,b){b=iAd.Number.clampValue(b,0,this.subviews.length);var c=new iAd.Segment;this.insertSubviewAtIndex(c,b);this.setTitleForSegmentAtIndex(a,b);c.drawBackgroundCanvas(b,this.subviews.length,false)};
iAd.SegmentedControl.prototype.removeSegmentAtIndexAnimated=function(a){a=iAd.Number.clampValue(a,0,this.subviews.length-1);if(!(a>=this.subviews.length)){this.subviews[a].removeFromSuperview();this.updateLayout();if(this._selectedSegmentIndex!=iAd.SegmentedControl.NO_SEGMENT)if(a<this._selectedSegmentIndex)this.selectedSegmentIndex--;else if(a==this._selectedSegmentIndex)this.selectedSegmentIndex=iAd.SegmentedControl.NO_SEGMENT}};iAd.SegmentedControl.prototype.removeAllSegments=function(){for(;this.subviews.length;)this.subviews[0].removeFromSuperview()};
iAd.SegmentedControl.prototype.setWidthForSegmentAtIndex=function(a,b){b=iAd.Number.clampValue(b,0,this.subviews.length-1);this.subviews[b].width=a;this.setActualWidthForSegmentAtIndex(a,b);this.updateLayout()};iAd.SegmentedControl.prototype.widthForSegmentAtIndex=function(a){a=iAd.Number.clampValue(a,0,this.subviews.length-1);return this.subviews[a].width};
iAd.SegmentedControl.prototype.setActualWidthForSegmentAtIndex=function(a,b){b=iAd.Number.clampValue(b,0,this.subviews.length-1);this.subviews[b].size=new iAd.Size(a,this.size.height)};
iAd.SegmentedControl.prototype.touchesBegan=function(a){this.callSuper(a);this.selectedSegmentIndex=iAd.View.nearestViewForElement(a.target)._indexInSuperviewSubviews;if(this._momentary){var b=this;setTimeout(function(){b.selectedSegmentIndex=iAd.SegmentedControl.NO_SEGMENT},iAd.SegmentedControl.SEGMENT_MOMENTARY_SELECTION_TIMER*1E3)}};iAd.Class({name:"iAd.Segment",superclass:iAd.View,synthesizedProperties:["title","image"],archivedProperties:["title","image"],cssClassName:"ad-segment"});
iAd.Segment.canvasInstances=0;iAd.Segment.prototype.init=function(a){this._title="";this._image=null;this.width=0;this.callSuper(a)};iAd.Segment.prototype.layerWasCreated=function(){this.callSuper();this.label=this.layer.appendChild(document.createElement("span"));this.icon=this.layer.appendChild(document.createElement("img"));this.backgroundCanvasId="ad-segment-"+iAd.Segment.canvasInstances++;this.setLayerStyle({"background-image":"-webkit-canvas("+this.backgroundCanvasId+")"})};
iAd.Segment.prototype.setValueForAttribute=function(a,b){if(b=="ad-image")this.image=iAd.Image.imageForURL(a);else this.callSuper(a,b)};iAd.Segment.prototype.setSize=function(a){this.callSuper(a);this._image!=null&&this.positionImage()};iAd.Segment.prototype.setTitle=function(a){this._title=this.label.textContent=a};iAd.Segment.prototype.setImage=function(a){if(this._image=a){this.icon.src=a.resolvedURL;a.loaded?this.positionImage():a.addPropertyObserver("loaded",this)}else this.icon.src=""};
iAd.Segment.prototype.handlePropertyChange=function(){this.positionImage()};iAd.Segment.prototype.positionImage=function(){this.icon.style.left=(this.size.width-this._image.width)/2+"px";this.icon.style.top=(this.size.height-this._image.height)/2+"px"};
iAd.Segment.prototype.drawBackgroundCanvas=function(a,b,c){var d=this.superview.canvasBackgroundImage;if(!(d==null||!d.loaded)){d=d.element;var e=this.scaleFactor=iAd.Device.HAS_HIDPI_DISPLAY?2:1,f=this.size.width,g=this.size.height,h=this.superview.hasBarStyle,i=this.context=document.getCSSCanvasContext("2d",this.backgroundCanvasId,f*e,g*e);this.setLayerStyle({"background-size":f+"px "+g+"px"});i.clearRect(0,0,f*e,g*e);if(b==1){if(c)if(h){this.drawImage(d,0,0,6,g,0,0,6,g);this.drawImage(d,5,0,1,
g,6,0,f-12,g);this.drawImage(d,6,0,6,g,f-6,0,6,g)}else{this.drawImage(d,0,0,11,g,0,0,11,g);this.drawImage(d,27,0,1,g,11,0,f-22,g);this.drawImage(d,11,0,11,g,f-11,0,11,g)}}else if(a==0)if(h){if(c){this.drawImage(d,0,0,6,g,0,0,6,g);this.drawImage(d,5,0,1,g,6,0,f-6,g)}this.drawImage(d,12,0,1,g,f-1,0,1,g)}else{if(c){this.drawImage(d,0,0,11,g,0,0,11,g);this.drawImage(d,27,0,1,g,11,0,f-18,g);this.drawImage(d,28,0,6,g,f-7,0,6,g)}this.drawImage(d,34,0,1,g,f-1,0,1,g)}else if(a==b-1){if(c)if(h){this.drawImage(d,
5,0,1,g,0,0,f-6,g);this.drawImage(d,6,0,6,g,f-6,0,6,g)}else{this.drawImage(d,22,0,6,g,0,0,6,g);this.drawImage(d,27,0,1,g,6,0,f-17,g);this.drawImage(d,11,0,11,g,f-11,0,11,g)}}else if(h){c&&this.drawImage(d,5,0,1,g,0,0,f,g);this.drawImage(d,12,0,1,g,f-1,0,1,g)}else{if(c){this.drawImage(d,22,0,6,g,0,0,6,g);this.drawImage(d,27,0,1,g,6,0,f-13,g);this.drawImage(d,28,0,6,g,f-7,0,6,g)}this.drawImage(d,34,0,1,g,f-1,0,1,g)}}};
iAd.Segment.prototype.drawImage=function(a,b,c,d,e,f,g,h,i){var j=this.scaleFactor;this.context.drawImage(a,b*j,c*j,d*j,e*j,f*j,g*j,h*j,i*j)};iAd.Class({name:"iAd.Slider",superclass:iAd.Control,synthesizedProperties:["minimumValue","maximumValue","value"],archivedProperties:["maximumValue","minimumValue","value","continuous"],cssClassName:"ad-slider",collectionAccessor:"sliders"});iAd.Slider.DEFAULT_HEIGHT=23;iAd.Slider.TOUCHED_CSS="ad-touched";
iAd.Slider.prototype.init=function(a){this.continuous=true;this._minimumValue=0;this._maximumValue=1;this._value=0;this.thumbSize=new iAd.Size(23,23);this.callSuper(a)};iAd.Slider.prototype.readPropertiesFromLayerAttributes=function(a){this.callSuper(a);this.layerHasCustomAttribute("ad-minimum-value")&&this.setValueForAttribute(iAd.Element.getCustomAttribute(this.layer,"ad-minimum-value"),"ad-minimum-value")};
iAd.Slider.prototype.layerWasCreated=function(){this.callSuper();this.fill=this.layer.appendChild(document.createElement("div"));this.fill.className="ad-slider-fill";this.leftFill=this.fill.appendChild(document.createElement("div"));this.middleFill=this.fill.appendChild(document.createElement("div"));this.rightFill=this.fill.appendChild(document.createElement("div"));this.thumb=this.layer.appendChild(document.createElement("div"));this.thumb.className="ad-slider-thumb";this._touchLayer=this.thumb};
iAd.Slider.prototype.setSize=function(a){a.height=iAd.Slider.DEFAULT_HEIGHT;this.callSuper(a);this.updateThumb()};iAd.Slider.prototype.setMinimumValue=function(a){if(!(a>=this.maximumValue)){this._minimumValue=a;if(this.value<a)this.value=a;else this.updateThumb()}};iAd.Slider.prototype.setMaximumValue=function(a){if(!(a<=this.minimumValue)){this._maximumValue=a;if(this.value>a)this.value=a;else this.updateThumb()}};iAd.Slider.prototype.setValue=function(a){this.setValueAnimated(a,false)};
iAd.Slider.prototype.setValueAnimated=function(a,b){a=iAd.Number.clampValue(a,this.minimumValue,this.maximumValue);if(a!=this._value){var c=b?"0.25s":"0s";this.thumb.style.webkitTransitionDuration=c;this.middleFill.style.webkitTransitionDuration=c;this.rightFill.style.webkitTransitionDuration=c;this._value=a;this.updateThumb();this.continuous&&this.notifyValueChanged()}};
iAd.Slider.prototype.updateThumb=function(){var a=(this.value-this.minimumValue)/(this.maximumValue-this.minimumValue),b=a*(this.size.width+2-this.thumbSize.width);this.updateGutterWithOffset(a);this.thumb.style.webkitTransform=iAd.CSS.t(b,0)};iAd.Slider.prototype.updateGutterWithOffset=function(a){a=a*(this.size.width-16);this.middleFill.style.webkitTransform="scale("+(a+1)+", 1)";this.rightFill.style.webkitTransform=iAd.CSS.t(a,0)};iAd.Slider.prototype.notifyValueChanged=function(){this.createAndDispatchEvent(iAd.Control.VALUE_CHANGE_EVENT)};
iAd.Slider.prototype.touchesBegan=function(a){this.callSuper(a);var b=window.getComputedStyle(this.thumb);this.thumbSize=new iAd.Size(parseInt(b.width,10),parseInt(b.height,10));this.maxX=this.size.width-this.thumbSize.width;this.internalX=iAd.Point.fromEventInElement(a,this.touchLayer).x;this.startValue=this.value;this.valueRange=this.maximumValue-this.minimumValue;this.thumb.addClassName(iAd.Slider.TOUCHED_CSS)};
iAd.Slider.prototype.touchesMoved=function(a){this.callSuper(a);this.value=this.minimumValue+(iAd.Point.fromEventInElement(a,this.layer).x-this.internalX)/this.maxX*this.valueRange};iAd.Slider.prototype.touchesEnded=function(a){this.callSuper(a);!this.continuous&&this.startValue!=this.value&&this.notifyValueChanged();this.thumb.removeClassName(iAd.Slider.TOUCHED_CSS)};iAd.Slider.prototype.touchesCancelled=function(a){this.callSuper(a);this.setValue(this.startValue,true);this.thumb.removeClassName(iAd.Slider.TOUCHED_CSS)};
iAd.Class({name:"iAd.Stepper",superclass:iAd.Control,synthesizedProperties:["continuous","autorepeat","wraps","value","minimumValue","maximumValue","stepValue"],archivedProperties:["continuous","autorepeat","wraps","maximumValue","minimumValue","value","stepValue"],cssClassName:"ad-stepper",collectionAccessor:"steppers"});iAd.Stepper.DEFAULT_SIZE=new iAd.Size(94,27);iAd.Stepper.LEFT_BUTTON_PRESSED_CSS="ad-left-button-pressed";iAd.Stepper.RIGHT_BUTTON_PRESSED_CSS="ad-right-button-pressed";
iAd.Stepper.MIDDLE_CSS="ad-middle";iAd.Stepper.LEFT_BUTTON_CSS="ad-left-button";iAd.Stepper.RIGHT_BUTTON_CSS="ad-right-button";iAd.Stepper.MINUS_SIGN_CSS="ad-minus-sign";iAd.Stepper.PLUS_SIGN_CSS="ad-plus-sign";iAd.Stepper.MINIMUM_VALUE_CSS="ad-minimum-value";iAd.Stepper.MAXIMUM_VALUE_CSS="ad-maximum-value";iAd.Stepper.TIMER_DELAY=0.5;iAd.Stepper.FAST_START_REPEAT_COUNT=5;iAd.Stepper.FAST_TIMER_DELAY=0.1;iAd.Stepper.SUPER_FAST_START_REPEAT_COUNT=20;iAd.Stepper.SUPER_FAST_TIMER_DELAY=0.05;
iAd.Stepper.DEFAULT_MINIMUM_VALUE=0;iAd.Stepper.DEFAULT_MAXIMUM_VALUE=100;iAd.Stepper.prototype.init=function(a){this._autorepeat=this._continuous=true;this._wraps=false;this._value=0;this._minimumValue=iAd.Stepper.DEFAULT_MINIMUM_VALUE;this._maximumValue=iAd.Stepper.DEFAULT_MAXIMUM_VALUE;this._stepValue=1;this.rightButtonPressed=this.leftButtonPressed=false;this.callSuper(a);this._size=iAd.Stepper.DEFAULT_SIZE;this.updateButtonState()};
iAd.Stepper.prototype.layerWasCreated=function(){for(var a=[iAd.Stepper.MIDDLE_CSS,iAd.Stepper.LEFT_BUTTON_CSS,iAd.Stepper.RIGHT_BUTTON_CSS,iAd.Stepper.MINUS_SIGN_CSS,iAd.Stepper.PLUS_SIGN_CSS],b=0;b<a.length;b++)this.layer.appendChild(document.createElement("div")).className=a[b]};iAd.Stepper.prototype.setSize=function(){this.callSuper(iAd.Stepper.DEFAULT_SIZE)};
iAd.Stepper.prototype.initWithDeclarativeBacking=function(){this._minimumValue=-Number.MAX_VALUE;this._maximumValue=Number.MAX_VALUE;this.callSuper();if(this._minimumValue==-Number.MAX_VALUE)this._minimumValue=iAd.Stepper.DEFAULT_MINIMUM_VALUE;if(this._maximumValue==Number.MAX_VALUE)this._maximumValue=iAd.Stepper.DEFAULT_MAXIMUM_VALUE;if(this._minimumValue>=this._maximumValue){iAd.Console.warn("A stepper's minimumValue must be smaller than its maximumValue");this._minimumValue=iAd.Stepper.DEFAULT_MINIMUM_VALUE;
this._maximumValue=iAd.Stepper.DEFAULT_MAXIMUM_VALUE}if(this._value<this._minimumValue||this._value>this._maximumValue){iAd.Console.warn("A stepper's value must be larger than the minimumValue and smaller than its maximumValue");this._value=iAd.Number.clampValue(this._value,this._minimumValue,this._maximumValue)}};iAd.Stepper.prototype.setWraps=function(a){this._wraps=a;this.updateButtonState()};
iAd.Stepper.prototype.setValue=function(a){a=iAd.Number.clampValue(a,this._minimumValue,this._maximumValue);if(a!=this._value){this._value=a;this.updateButtonState();if(!this._autorepeat||this._continuous)this.createAndDispatchEvent(iAd.Control.VALUE_CHANGE_EVENT)}};
iAd.Stepper.prototype.setMinimumValue=function(a){if(!(this._minimumValue==a||a==null))if(a>=this._maximumValue)iAd.Console.warn("A stepper's minimumValue must be smaller than its maximumValue");else{this._minimumValue=a;this.value=Math.max(this._value,a)}};
iAd.Stepper.prototype.setMaximumValue=function(a){if(!(this._maximumValue==a||a==null))if(a<=this._minimumValue)iAd.Console.warn("A stepper's maximumValue must be larger than its minimumValue");else{this._maximumValue=a;this.value=Math.min(this._value,a)}};iAd.Stepper.prototype.touchesBegan=function(a){this.valueWhenTouchesBegan=this._value;this.callSuper(a);this.touchChanged(a)};iAd.Stepper.prototype.touchesMoved=function(a){this.callSuper(a);this.touchChanged(a)};
iAd.Stepper.prototype.touchesEnded=function(a){this.callSuper(a);this.touchChanged(a);this.stopTimer();this.dispatchNonContinuousValueChangeNotification()};iAd.Stepper.prototype.touchesCancelled=function(a){this.callSuper(a);this.touchChanged(a);this.stopTimer();this.dispatchNonContinuousValueChangeNotification()};
iAd.Stepper.prototype.touchChanged=function(a){var b=iAd.Point.fromEventInElement(a,this.layer),c=this._size.width/2;a=this.touchInside&&(this._wraps||this._value>this._minimumValue)&&b.x<=c;b=this.touchInside&&(this._wraps||this._value<this._maximumValue)&&b.x>c;if(a!=this.leftButtonPressed){this.leftButtonPressed=a;this.layer.toggleClassName(iAd.Stepper.LEFT_BUTTON_PRESSED_CSS,a);a&&this.updateValue();this.startTimer()}if(b!=this.rightButtonPressed){this.rightButtonPressed=b;this.layer.toggleClassName(iAd.Stepper.RIGHT_BUTTON_PRESSED_CSS,
b);b&&this.updateValue();this.startTimer()}};
iAd.Stepper.prototype.updateButtonState=function(){var a=!this._wraps&&this._value==this._minimumValue;if(this.leftButtonPressed&&a){this.leftButtonPressed=false;this.layer.toggleClassName(iAd.Stepper.LEFT_BUTTON_PRESSED_CSS,this.leftButtonPressed)}var b=!this._wraps&&this._value==this._maximumValue;if(this.rightButtonPressed&&b){this.rightButtonPressed=false;this.layer.toggleClassName(iAd.Stepper.RIGHT_BUTTON_PRESSED_CSS,this.rightButtonPressed)}this.layer.toggleClassName(iAd.Stepper.MINIMUM_VALUE_CSS,a);
this.layer.toggleClassName(iAd.Stepper.MAXIMUM_VALUE_CSS,b)};iAd.Stepper.prototype.dispatchNonContinuousValueChangeNotification=function(){this._continuous||this._value!==this.valueWhenTouchesBegan&&this.createAndDispatchEvent(iAd.Control.VALUE_CHANGE_EVENT)};iAd.Stepper.prototype.startTimer=function(){this.stopTimer();if(this._autorepeat){this.repeatCount=0;this.repeatTimer=this.callMethodNameAfterDelay("updateRepeatCount",iAd.Stepper.TIMER_DELAY)}};iAd.Stepper.prototype.stopTimer=function(){window.clearTimeout(this.repeatTimer)};
iAd.Stepper.prototype.updateValue=function(){var a=this._value+(this.rightButtonPressed?this._stepValue:-this._stepValue);if(this._wraps&&a>this._maximumValue)a=this._minimumValue;if(this._wraps&&a<this._minimumValue)a=this._maximumValue;this.value=a};
iAd.Stepper.prototype.updateRepeatCount=function(){if(this.leftButtonPressed||this.rightButtonPressed){this.updateValue();this.repeatCount++;var a=iAd.Stepper.TIMER_DELAY;if(this.repeatCount>=iAd.Stepper.FAST_START_REPEAT_COUNT){a=iAd.Stepper.FAST_TIMER_DELAY;if(this.repeatCount>=iAd.Stepper.SUPER_FAST_START_REPEAT_COUNT)a=iAd.Stepper.SUPER_FAST_TIMER_DELAY}this.repeatTimer=this.callMethodNameAfterDelay("updateRepeatCount",a)}};
iAd.Class({name:"iAd.Switch",superclass:iAd.Control,synthesizedProperties:["on","onTintColor"],archivedProperties:["on","onTintColor"],cssClassName:"ad-switch",collectionAccessor:"switches"});iAd.Switch.IS_ROUND=iAd.Device.iOS_VERSION?!iAd.Device.iOSVersionLessThan("5.0"):true;iAd.Switch.ROUND_CSS="ad-round";iAd.Switch.ROUND_PADDING=16;iAd.Switch.DOWN_CSS="ad-dragging";iAd.Switch.SNAP_CSS="ad-snap";iAd.Switch.WIDTH=93;iAd.Switch.HEIGHT=27;iAd.Switch.DRAG_IDLE=0;iAd.Switch.CAN_DRAG=1;
iAd.Switch.IS_DRAGGING=2;iAd.Switch.SLIDE_DISTANCE=iAd.Switch.IS_ROUND?50:54;iAd.Switch.BUTTON_WIDTH=iAd.Switch.IS_ROUND?29:40;iAd.Switch.DRAG_MAX=iAd.Switch.IS_ROUND?64:70;iAd.Switch.DRAG_MIN=iAd.Switch.IS_ROUND?14:16;iAd.Switch.DRAG_GUTTER=iAd.Switch.IS_ROUND?0:5;iAd.Switch.CAP_WIDTH=4;iAd.Switch.HALF_WIDTH=(iAd.Switch.IS_ROUND?77:93)/2;iAd.Switch.LEFT_CAP_TRACK_CSS="ad-left-cap ad-track-cap";iAd.Switch.LEFT_CAP_BUTTON_CSS="ad-left-cap ad-button-cap";iAd.Switch.RIGHT_CAP_TRACK_CSS="ad-right-cap ad-track-cap";
iAd.Switch.RIGHT_CAP_BUTTON_CSS="ad-right-cap ad-button-cap";iAd.Switch.prototype.init=function(a){this._setOnAnimatedCalledFromSetter=this._on=false;this.callSuper(a);this.dragOffsetX=iAd.Switch.DRAG_MAX;if(!this.usesDeclarativeBacking)this.size=new iAd.Size(iAd.Switch.WIDTH,iAd.Switch.HEIGHT);this._onTintColor="rgb(0, 127, 234)";this.on=this._on;this.initialized=true};
iAd.Switch.prototype.layerWasCreated=function(){this.callSuper();var a=iAd.Switch.IS_ROUND;if(a){this.layer.addClassName(iAd.Switch.ROUND_CSS);this.labelSlider=this.layer.appendChild(document.createElement("div"));this.labelSlider.className="ad-switch-label-slider"}else{this.leftCap=this.layer.appendChild(document.createElement("div"));this.leftCap.className=iAd.Switch.LEFT_CAP_TRACK_CSS;this.rightCap=this.layer.appendChild(document.createElement("div"));this.rightCap.className=iAd.Switch.RIGHT_CAP_BUTTON_CSS}if(a)this.layer.appendChild(document.createElement("div")).className=
"ad-switch-shadow";this.slideContainer=this.layer.appendChild(document.createElement("div"));this.slideContainer.className="ad-slide-container";this.slider=this.slideContainer.appendChild(document.createElement("div"));this.slider.className="ad-switch-slider";this.slider.addEventListener("webkitTransitionEnd",this,false);if(a){this.labelSlider.appendChild(document.createElement("div")).className="ad-label-off";this.tintLayer=this.labelSlider.appendChild(document.createElement("div"));this.tintLayer.className=
"ad-switch-tint";this.labelSlider.appendChild(document.createElement("div")).className="ad-label-on"}else{this.slider.appendChild(document.createElement("div")).className="ad-label-off";this.slider.appendChild(document.createElement("div")).className="ad-label-on"}this.button=this.slider.appendChild(document.createElement("div"));this.button.className="ad-switch-button"};iAd.Switch.prototype.setSize=function(a){a.width=iAd.Switch.WIDTH;a.height=iAd.Switch.HEIGHT;this.callSuper(a)};
iAd.Switch.prototype.setOnAnimated=function(a,b){var c=iAd.Switch.IS_ROUND;if(b){this.slider.addClassName(iAd.Switch.SNAP_CSS);if(c)this.labelSlider.addClassName(iAd.Switch.SNAP_CSS);else if(!(a&&this.dragOffsetX==iAd.Switch.DRAG_MAX||!a&&this.dragOffsetX==iAd.Switch.DRAG_MIN)){this.leftCap.className=iAd.Switch.LEFT_CAP_TRACK_CSS;this.rightCap.className=iAd.Switch.RIGHT_CAP_TRACK_CSS}}else{this.slider.removeClassName(iAd.Switch.SNAP_CSS);if(c)this.labelSlider.removeClassName(iAd.Switch.SNAP_CSS);
else if(a){this.leftCap.className=iAd.Switch.LEFT_CAP_TRACK_CSS;this.rightCap.className=iAd.Switch.RIGHT_CAP_BUTTON_CSS}else{this.leftCap.className=iAd.Switch.LEFT_CAP_BUTTON_CSS;this.rightCap.className=iAd.Switch.RIGHT_CAP_TRACK_CSS}}if(a){if(c){this.slider.style.webkitTransform=iAd.CSS.t(0,0);this.labelSlider.style.webkitTransform=this.slider.style.webkitTransform;this.tintLayer.style.visibility=""}else this.slider.style.webkitTransform=iAd.CSS.t(-iAd.Switch.CAP_WIDTH,0);this.dragOffsetX=iAd.Switch.DRAG_MAX}else{if(c){this.slider.style.webkitTransform=
iAd.CSS.t(-iAd.Switch.SLIDE_DISTANCE,0);this.labelSlider.style.webkitTransform=this.slider.style.webkitTransform;if(!b)this.tintLayer.style.visibility="hidden"}else this.slider.style.webkitTransform=iAd.CSS.t(-iAd.Switch.SLIDE_DISTANCE-iAd.Switch.CAP_WIDTH,0);this.dragOffsetX=iAd.Switch.DRAG_MIN}c=this._on!=a;this._on=a;if(this.initialized&&c){this.createAndDispatchEvent(iAd.Control.VALUE_CHANGE_EVENT);this._setOnAnimatedCalledFromSetter||this.notifyPropertyChange("on")}this._setOnAnimatedCalledFromSetter=
false};iAd.Switch.prototype.setOn=function(a){this._setOnAnimatedCalledFromSetter=true;this.setOnAnimated(a,false)};iAd.Switch.prototype.setOnTintColor=function(a){this._onTintColor=a;if(iAd.Switch.IS_ROUND)this.tintLayer.style.backgroundColor=a};iAd.Switch.prototype.handleEvent=function(a){this.callSuper(a);a.type=="webkitTransitionEnd"&&this.transitionEnded()};
iAd.Switch.prototype.transitionEnded=function(){var a=iAd.Switch.IS_ROUND;this.slider.removeClassName(iAd.Switch.SNAP_CSS);a&&this.labelSlider.removeClassName(iAd.Switch.SNAP_CSS);if(this._on)if(a){this.slider.style.webkitTransform=iAd.CSS.t(0,0);this.labelSlider.style.webkitTransform=this.slider.style.webkitTransform}else{this.slider.style.webkitTransform=iAd.CSS.t(-iAd.Switch.CAP_WIDTH,0);this.rightCap.className=iAd.Switch.RIGHT_CAP_BUTTON_CSS}else if(a){this.tintLayer.style.visibility="hidden";
this.slider.style.webkitTransform=iAd.CSS.t(-iAd.Switch.SLIDE_DISTANCE,0);this.labelSlider.style.webkitTransform=this.slider.style.webkitTransform}else{this.slider.style.webkitTransform=iAd.CSS.t(-iAd.Switch.SLIDE_DISTANCE-iAd.Switch.CAP_WIDTH,0);this.leftCap.className=iAd.Switch.LEFT_CAP_BUTTON_CSS}};
iAd.Switch.prototype.touchesBegan=function(a){this.callSuper(a);a=iAd.Point.fromEventInElement(a,this.layer);var b=iAd.Switch.IS_ROUND?iAd.Switch.ROUND_PADDING:0;this._touchBeganInPadding=a.x<b;if(!this._on&&a.x>b&&a.x<b+iAd.Switch.BUTTON_WIDTH||this.on&&a.x>b+iAd.Switch.SLIDE_DISTANCE){this.layer.addClassName(iAd.Switch.DOWN_CSS);this.dragState=iAd.Switch.CAN_DRAG}};
iAd.Switch.prototype.touchesMoved=function(a){this.callSuper(a);var b=iAd.Switch.IS_ROUND,c=iAd.Switch.LEFT_CAP_TRACK_CSS,d=iAd.Switch.RIGHT_CAP_TRACK_CSS;if(this.dragState>=iAd.Switch.CAN_DRAG){this.slider.removeClassName(iAd.Switch.SNAP_CSS);this.dragState=iAd.Switch.IS_DRAGGING;if(b){this.labelSlider.removeClassName(iAd.Switch.SNAP_CSS);this.tintLayer.style.visibility=""}a=iAd.Point.fromEventInElement(a,this.layer);this.dragOffsetX=b?a.x-iAd.Switch.ROUND_PADDING:a.x;a=Math.floor(iAd.Switch.BUTTON_WIDTH/
2);if(this.dragOffsetX>iAd.Switch.DRAG_MAX-iAd.Switch.DRAG_GUTTER)if(this.dragOffsetX>=iAd.Switch.DRAG_MAX){this.dragOffsetX=iAd.Switch.DRAG_MAX;if(!b)d=iAd.Switch.RIGHT_CAP_BUTTON_CSS}else this.dragOffsetX=iAd.Switch.DRAG_MAX-iAd.Switch.DRAG_GUTTER;else if(this.dragOffsetX<iAd.Switch.DRAG_MIN+iAd.Switch.DRAG_GUTTER)if(this.dragOffsetX<=iAd.Switch.DRAG_MIN){this.dragOffsetX=iAd.Switch.DRAG_MIN;if(b)this.tintLayer.style.visibility="hidden";else c=iAd.Switch.LEFT_CAP_BUTTON_CSS}else this.dragOffsetX=
iAd.Switch.DRAG_MIN+iAd.Switch.DRAG_GUTTER;this.slider.style.webkitTransform=iAd.CSS.t(-iAd.Switch.SLIDE_DISTANCE-(a-this.dragOffsetX),0);if(b)this.labelSlider.style.webkitTransform=this.slider.style.webkitTransform;else{this.rightCap.className=d;this.leftCap.className=c}}};
iAd.Switch.prototype.touchesEnded=function(a){this.callSuper(a);if(!this._touchBeganInPadding){if(this.dragState===iAd.Switch.IS_DRAGGING)if(this.dragOffsetX<iAd.Switch.HALF_WIDTH)this.setOnAnimated(false,true);else this.dragOffsetX>iAd.Switch.HALF_WIDTH?this.setOnAnimated(true,true):this.setOnAnimated(this.on,true);else this.setOnAnimated(!this._on,true);this.layer.removeClassName(iAd.Switch.DOWN_CSS);this.dragState=iAd.Switch.DRAG_IDLE}};iAd.Class("iAd.Animation");
iAd.Animation.DID_COMPLETE_DELEGATE="animationDidComplete";iAd.Animation.DEFAULTS={duration:1,delay:0,removesTargetUponCompletion:false,timingFunction:"ease"};iAd.Animation.STYLES=["-webkit-animation-name","-webkit-animation-timing-function","-webkit-animation-duration","-webkit-animation-iteration-count","-webkit-animation-direction","-webkit-animation-delay","-webkit-animation"];
iAd.Animation.prototype.init=function(a){this.rule=iAd.Animation.createRule();this.delay=this.duration=this.target=null;this.keyframes=[];this.removesTargetUponCompletion=this.delegate=this.timingFunction=null;iAd.Utils.copyPropertiesFromSourceToTarget(a,this);this.setup()};
iAd.Animation.prototype.setup=function(){for(var a in iAd.Animation.DEFAULTS)if(this[a]==null)this[a]=iAd.Animation.DEFAULTS[a];this.archiveAnimationStyles();var b=this.target.layer.style;for(a=0;a<iAd.Animation.STYLES;a++)b.setProperty(iAd.Animation.STYLES[a],"","");a=0;for(b=this.keyframes.length;a<b;a++){for(var c=this.keyframes[a],d=c.offset*100+"% {",e=0,f=c.values.length;e<f;e+=2)d+=this.target.cssPropertyNameForJSProperty(c.values[e])+": "+c.values[e+1]+";";d+="}";this.rule.insertRule(d)}};
iAd.Animation.prototype.start=function(){var a=this.target.layer.style;a.webkitAnimationName=this.rule.name;a.webkitAnimationDuration=this.duration+"s";a.webkitAnimationDelay=this.delay+"s";a.webkitAnimationTimingFunction=this.timingFunction;this.target.layer.addEventListener("webkitAnimationEnd",this,false)};iAd.Animation.prototype.archiveAnimationStyles=function(){this.archivedStyles=[];for(var a=0,b=iAd.Animation.STYLES.length;a<b;a++)this.archivedStyles.push(this.target.layer.style.getPropertyValue(iAd.Animation.STYLES[a]))};
iAd.Animation.prototype.restoreAnimationStyles=function(){for(var a=0,b=iAd.Animation.STYLES.length;a<b;a++)this.target.layer.style.setProperty(iAd.Animation.STYLES[a],this.archivedStyles[a],"")};
iAd.Animation.prototype.handleEvent=function(a){if(a.currentTarget===this.target.layer){a=this.keyframes[this.keyframes.length-1].values;for(var b=0,c=a.length;b<c;b+=2)this.target[a[b]]=a[b+1];iAd.Utils.objectHasMethod(this.delegate,iAd.Animation.DID_COMPLETE_DELEGATE)&&this.delegate[iAd.Animation.DID_COMPLETE_DELEGATE](this);this.removesTargetUponCompletion?this.target.removeFromSuperview():this.restoreAnimationStyles()}};iAd.Animation.counter=0;
iAd.Animation.createRule=function(){var a=document.styleSheets[0],b="iAd-Animation-"+this.counter++;b=a.insertRule("@-webkit-keyframes "+b+" { }",a.rules.length);return a.rules.item(b)};iAd.Class("iAd.Animator");iAd.Animator.LINEAR_TYPE=0;iAd.Animator.SPLINES_TYPE=1;iAd.Animator.INVALID_ARGS_EXCEPTION=2;iAd.Animator.ANIMATION_DID_ITERATE="animationDidIterate";iAd.Animator.ANIMATION_DID_END="animationDidEnd";
iAd.Animator.prototype.init=function(a,b,c){if(arguments.length<2)throw iAd.Animator.INVALID_ARGS_EXCEPTION;this.animating=this.ready=false;this.timer=null;this.duration=a;this.delegate=b;if(iAd.Utils.objectHasMethod(this.delegate,iAd.Animator.ANIMATION_DID_ITERATE)){if(iAd.Utils.objectIsArray(c)){this.type=iAd.Animator.SPLINES_TYPE;this.spline=new iAd.UnitBezier(c[0],c[1],c[2],c[3])}else this.type=iAd.Animator.LINEAR_TYPE;this.ready=true}};
iAd.Animator.prototype.start=function(){if(this.ready){this.animating=true;this.lastIndex=0;this.startTime=Date.now();this.iterate()}else this.timer=this.callMethodNameAfterDelay("start",0)};iAd.Animator.prototype.stop=function(){this.animating=false;clearTimeout(this.timer)};
iAd.Animator.prototype.iterate=function(){var a=(Date.now()-this.startTime)/1E3;if(a<this.duration){a=this.type==iAd.Animator.SPLINES_TYPE?this.spline.solve(iAd.Number.clampValue(a/this.duration,0,1),1/(200*this.duration)):a/this.duration;this.delegate[iAd.Animator.ANIMATION_DID_ITERATE](this,a);this.timer=this.callMethodNameAfterDelay("iterate",0)}else{this.delegate[iAd.Animator.ANIMATION_DID_ITERATE](this,1);iAd.Utils.objectHasMethod(this.delegate,iAd.Animator.ANIMATION_DID_END)&&this.delegate[iAd.Animator.ANIMATION_DID_END](this);
this.animating=false}};iAd.Class("iAd.UnitBezier");iAd.UnitBezier.prototype.init=function(a,b,c,d){this.cx=3*a;this.bx=3*(c-a)-this.cx;this.ax=1-this.cx-this.bx;this.cy=3*b;this.by=3*(d-b)-this.cy;this.ay=1-this.cy-this.by};iAd.UnitBezier.prototype.sampleCurveX=function(a){return((this.ax*a+this.bx)*a+this.cx)*a};iAd.UnitBezier.prototype.sampleCurveY=function(a){return((this.ay*a+this.by)*a+this.cy)*a};iAd.UnitBezier.prototype.sampleCurveDerivativeX=function(a){return(3*this.ax*a+2*this.bx)*a+this.cx};
iAd.UnitBezier.prototype.solveCurveX=function(a,b){for(var c=a,d,e=0;e<8;e++){d=this.sampleCurveX(c)-a;if(Math.abs(d)<b)return c;var f=this.sampleCurveDerivativeX(c);if(Math.abs(f)<1.0E-6)break;c-=d/f}e=0;f=1;c=a;if(c<e)return e;if(c>f)return f;for(;e<f;){d=this.sampleCurveX(c);if(Math.abs(d-a)<b)break;if(a>d)e=c;else f=c;c=(f+e)*0.5}return c};iAd.UnitBezier.prototype.solve=function(a,b){return this.sampleCurveY(this.solveCurveX(a,b))};iAd.Rect.TOP_LEFT_CORNER=0;iAd.Rect.MIDDLE_OF_TOP_EDGE=1;
iAd.Rect.TOP_RIGHT_CORNER=2;iAd.Rect.MIDDLE_OF_RIGHT_EDGE=3;iAd.Rect.BOTTOM_RIGHT_CORNER=4;iAd.Rect.MIDDLE_OF_BOTTOM_EDGE=5;iAd.Rect.BOTTOM_LEFT_CORNER=6;iAd.Rect.MIDDLE_OF_LEFT_EDGE=7;iAd.Rect.CENTER=8;iAd.Rect.TOP_EDGE=9;iAd.Rect.RIGHT_EDGE=10;iAd.Rect.BOTTOM_EDGE=11;iAd.Rect.LEFT_EDGE=12;
iAd.Rect.prototype.pointAtPosition=function(a){var b,c=this.origin,d=this.size;if(a==iAd.Rect.TOP_LEFT_CORNER)b=new iAd.Point(c.x,c.y);else if(a==iAd.Rect.MIDDLE_OF_TOP_EDGE)b=new iAd.Point(c.x+d.width/2,c.y);else if(a==iAd.Rect.TOP_RIGHT_CORNER)b=new iAd.Point(c.x+d.width,c.y);else if(a==iAd.Rect.MIDDLE_OF_RIGHT_EDGE)b=new iAd.Point(c.x+d.width,c.y+d.height/2);else if(a==iAd.Rect.BOTTOM_RIGHT_CORNER)b=new iAd.Point(c.x+d.width,c.y+d.height);else if(a==iAd.Rect.MIDDLE_OF_BOTTOM_EDGE)b=new iAd.Point(c.x+
d.width/2,c.y+d.height);else if(a==iAd.Rect.BOTTOM_LEFT_CORNER)b=new iAd.Point(c.x,c.y+d.height);else if(a==iAd.Rect.MIDDLE_OF_LEFT_EDGE)b=new iAd.Point(c.x,c.y+d.height/2);else if(a==iAd.Rect.CENTER)b=new iAd.Point(c.x+d.width/2,c.y+d.height/2);return b};
iAd.Rect.prototype.edge=function(a){var b;if(a==iAd.Rect.TOP_EDGE)b=new iAd.LineSegment(this.pointAtPosition(iAd.Rect.TOP_LEFT_CORNER),this.pointAtPosition(iAd.Rect.TOP_RIGHT_CORNER));else if(a==iAd.Rect.RIGHT_EDGE)b=new iAd.LineSegment(this.pointAtPosition(iAd.Rect.TOP_RIGHT_CORNER),this.pointAtPosition(iAd.Rect.BOTTOM_RIGHT_CORNER));else if(a==iAd.Rect.BOTTOM_EDGE)b=new iAd.LineSegment(this.pointAtPosition(iAd.Rect.BOTTOM_LEFT_CORNER),this.pointAtPosition(iAd.Rect.BOTTOM_RIGHT_CORNER));else if(a==
iAd.Rect.LEFT_EDGE)b=new iAd.LineSegment(this.pointAtPosition(iAd.Rect.TOP_LEFT_CORNER),this.pointAtPosition(iAd.Rect.BOTTOM_LEFT_CORNER));return b};iAd.Rect.rectWithClientRect=function(a){return new iAd.Rect(a.left,a.top,a.width,a.height)};iAd.Point.prototype.distanceToPoint=function(a){return Math.sqrt(Math.pow(a.x-this.x,2)+Math.pow(a.y-this.y,2))};iAd.Class("iAd.LineSegment");iAd.LineSegment.prototype.init=function(a,b){this.a=a;this.b=b;this.ab=new iAd.Point(b.x-a.x,b.y-a.y);this.length=b.distanceToPoint(a)};
iAd.LineSegment.prototype.closestPointToPoint=function(a){var b=[a.x-this.a.x,a.y-this.a.y];a=[this.b.x-this.a.x,this.b.y-this.a.y];b=(b[0]*a[0]+b[1]*a[1])/(Math.pow(a[0],2)+Math.pow(a[1],2));b=Math.max(0,Math.min(1,b));return new iAd.Point(a[0]*b+this.a.x,a[1]*b+this.a.y)};iAd.LineSegment.prototype.distanceToPoint=function(a){return this.closestPointToPoint(a).distanceToPoint(a)};iAd.Class("iAd.SpatialNavigationManager");iAd.SpatialNavigationManager.ENABLED=!iAd.Event.SUPPORTS_TOUCHES||window.layoutTestController;
iAd.SpatialNavigationManager.FOCUSED_CSS_CLASS="ad-focused";iAd.SpatialNavigationManager.INACTIVE_CSS_CLASS="ad-inactive";iAd.SpatialNavigationManager.NAVIGABLE_CSS_CLASS="ad-navigable";iAd.SpatialNavigationManager.BACK_CSS_CLASS="ad-back-button";iAd.SpatialNavigationManager.ENABLED_CSS_CLASS="ad-supports-spatial-navigation";iAd.SpatialNavigationManager.INITIALLY_FOCUSED_ATTR="ad-initially-focused";iAd.SpatialNavigationManager.EXPLICIT_LEFT_ATTR="ad-left-navigable-element";
iAd.SpatialNavigationManager.EXPLICIT_RIGHT_ATTR="ad-right-navigable-element";iAd.SpatialNavigationManager.EXPLICIT_UP_ATTR="ad-top-navigable-element";iAd.SpatialNavigationManager.EXPLICIT_DOWN_ATTR="ad-bottom-navigable-element";iAd.SpatialNavigationManager.FOCUS_IN_EVENT="ad-focus-in";iAd.SpatialNavigationManager.FOCUS_OUT_EVENT="ad-focus-out";iAd.SpatialNavigationManager.ACTIVATE_EVENT="ad-activate";iAd.SpatialNavigationManager.NAVIGATE_EVENT="ad-navigate";
iAd.SpatialNavigationManager.DIRECTION_UP=iAd.Event.KEYBOARD_UP;iAd.SpatialNavigationManager.DIRECTION_RIGHT=iAd.Event.KEYBOARD_RIGHT;iAd.SpatialNavigationManager.DIRECTION_DOWN=iAd.Event.KEYBOARD_DOWN;iAd.SpatialNavigationManager.DIRECTION_LEFT=iAd.Event.KEYBOARD_LEFT;iAd.SpatialNavigationManager.KNOWN_KEYS=[iAd.Event.KEYBOARD_UP,iAd.Event.KEYBOARD_RIGHT,iAd.Event.KEYBOARD_DOWN,iAd.Event.KEYBOARD_LEFT,iAd.Event.KEYBOARD_BACKSPACE,iAd.Event.KEYBOARD_RETURN];
iAd.SpatialNavigationManager.prototype.init=function(){this.callSuper();this.navigableElements=[];this.backButton=this.previousNavigation=this.focusedElement=null;if(iAd.SpatialNavigationManager.ENABLED){window.addEventListener("keydown",this,true);window.addEventListener(iAd.SpatialNavigationManager.NAVIGATE_EVENT,this,false)}};iAd.SpatialNavigationManager.prototype.navigableElementsInSubtree=function(a){return a.querySelectorAll("."+iAd.SpatialNavigationManager.NAVIGABLE_CSS_CLASS+", a")};
iAd.SpatialNavigationManager.prototype.registerSubtree=function(a){for(var b=this.navigableElementsInSubtree(a),c,d,e=0,f=b.length;e<f;e++){c=b[e];if(iAd.Element.hasCustomAttribute(c,iAd.SpatialNavigationManager.INITIALLY_FOCUSED_ATTR))d=c;this.addNavigableElement(b[e])}if(!this.focusedElement)if(b=a.querySelector("."+iAd.SpatialNavigationManager.FOCUSED_CSS_CLASS))this.focusElement(b);else d&&this.focusElement(d);if(a=a.querySelector("."+iAd.SpatialNavigationManager.BACK_CSS_CLASS))this.backButton=
a};iAd.SpatialNavigationManager.prototype.unregisterSubtree=function(a){this.navigableElements=this.navigableElements.filter(function(b){return!a.contains(b)});if(this.navigableElements.indexOf(this.focusedElement)==-1)this.focusedElement=null;if(this.backButton&&a.contains(this.backButton))this.backButton=null};iAd.SpatialNavigationManager.prototype.addNavigableElement=function(a){if(!(this.navigableElements.indexOf(a)>-1)){this.navigableElements.push(a);a.addClassName(iAd.SpatialNavigationManager.NAVIGABLE_CSS_CLASS)}};
iAd.SpatialNavigationManager.prototype.removeNavigableElement=function(a){iAd.Array.removeObjectFromArray(a,this.navigableElements)};iAd.SpatialNavigationManager.prototype.handleEvent=function(a){switch(a.type){case "keydown":this.handleKeydown(a);break;case iAd.SpatialNavigationManager.NAVIGATE_EVENT:this.handleNavigationEvent(a)}};
iAd.SpatialNavigationManager.prototype.handleKeydown=function(a){if(!(a.altKey||a.shiftKey||a.ctrlKey||a.metaKey)){var b=a.keyCode;if(iAd.SpatialNavigationManager.KNOWN_KEYS.indexOf(b)!=-1){a.stopPropagation();a.preventDefault();if(this.focusedElement){a=document.createEvent("Event");a.initEvent(iAd.SpatialNavigationManager.NAVIGATE_EVENT,true,true);a.ad={sender:this,command:b};this.focusedElement.dispatchEvent(a)}else this.handleNavigationCommand(b)}}};
iAd.SpatialNavigationManager.prototype.handleNavigationEvent=function(a){a.defaultPrevented||this.handleNavigationCommand(a.ad.command)};iAd.SpatialNavigationManager.prototype.handleNavigationCommand=function(a){if(a==iAd.Event.KEYBOARD_BACKSPACE)this.navigateBack();else a==iAd.Event.KEYBOARD_RETURN?this.activateFocusedElement():this.navigateInDirection(a)};iAd.SpatialNavigationManager.prototype.navigateBack=function(){this.backButton&&this.backButton.dispatchEvent(iAd.EventTarget.createEvent(iAd.SpatialNavigationManager.ACTIVATE_EVENT))};
iAd.SpatialNavigationManager.prototype.activateFocusedElement=function(){this.focusedElement!==null&&this.focusedElement.dispatchEvent(iAd.EventTarget.createEvent(iAd.SpatialNavigationManager.ACTIVATE_EVENT))};
iAd.SpatialNavigationManager.prototype.navigateInDirection=function(a){var b=iAd.SpatialNavigationManager.KNOWN_KEYS.indexOf(a);if(!(this.navigableElements.length==0||b==-1)){var c=-1;if(this.focusedElement){var d=this.preferredElementInDirection(a);if(d){d=this.navigableElements.indexOf(d);if(d>=0&&this.isElementAtIndexNavigable(d))c=d}else if(this.previousNavigation&&b==(this.previousNavigation.keyIndex+2)%4){d=this.navigableElements.indexOf(this.previousNavigation.element);if(d>-1&&this.isElementAtIndexNavigable(d))c=
d}}if(c==-1)c=this.nearestElementIndexInDirection(a);if(c>-1&&this.isElementAtIndexNavigable(c)){if(this.focusedElement)this.previousNavigation={element:this.focusedElement,keyIndex:b};this.focusElement(this.navigableElements[c])}}};
iAd.SpatialNavigationManager.prototype.preferredElementInDirection=function(a){var b=this.focusedElement;if(b){var c;if(a==iAd.SpatialNavigationManager.DIRECTION_UP)c=iAd.SpatialNavigationManager.EXPLICIT_UP_ATTR;else if(a==iAd.SpatialNavigationManager.DIRECTION_RIGHT)c=iAd.SpatialNavigationManager.EXPLICIT_RIGHT_ATTR;else if(a==iAd.SpatialNavigationManager.DIRECTION_DOWN)c=iAd.SpatialNavigationManager.EXPLICIT_DOWN_ATTR;else if(a==iAd.SpatialNavigationManager.DIRECTION_LEFT)c=iAd.SpatialNavigationManager.EXPLICIT_LEFT_ATTR;
if(a=iAd.Element.getCustomAttribute(b,c))return document.querySelector(a)}};
iAd.SpatialNavigationManager.prototype.nearestElementIndexInDirection=function(a){if(!this.focusedElement)if(a==iAd.SpatialNavigationManager.DIRECTION_UP)return this.bottomMostIndex();else if(a==iAd.SpatialNavigationManager.DIRECTION_RIGHT)return this.leftMostIndex();else if(a==iAd.SpatialNavigationManager.DIRECTION_DOWN)return this.topMostIndex();else if(a==iAd.SpatialNavigationManager.DIRECTION_LEFT)return this.rightMostIndex();var b,c;if(a==iAd.SpatialNavigationManager.DIRECTION_UP){b=iAd.Rect.MIDDLE_OF_TOP_EDGE;
c=iAd.Rect.BOTTOM_EDGE}else if(a==iAd.SpatialNavigationManager.DIRECTION_RIGHT){b=iAd.Rect.MIDDLE_OF_RIGHT_EDGE;c=iAd.Rect.LEFT_EDGE}else if(a==iAd.SpatialNavigationManager.DIRECTION_DOWN){b=iAd.Rect.MIDDLE_OF_BOTTOM_EDGE;c=iAd.Rect.TOP_EDGE}else if(a==iAd.SpatialNavigationManager.DIRECTION_LEFT){b=iAd.Rect.MIDDLE_OF_LEFT_EDGE;c=iAd.Rect.RIGHT_EDGE}var d=-1,e=Number.MAX_VALUE,f=this.navigableElements.indexOf(this.focusedElement),g=this.metricsForElement(this.focusedElement);b=g.pointAtPosition(b);
g=g.pointAtPosition(iAd.Rect.CENTER);for(var h,i=0,j=this.navigableElements.length;i<j;i++)if(!(!this.isElementAtIndexNavigable(i)||i==f)){h=this.metricsForElement(this.navigableElements[i]);if(!(a==iAd.SpatialNavigationManager.DIRECTION_UP&&h.pointAtPosition(iAd.Rect.BOTTOM_LEFT_CORNER).y>g.y||a==iAd.SpatialNavigationManager.DIRECTION_RIGHT&&h.pointAtPosition(iAd.Rect.TOP_LEFT_CORNER).x<g.x||a==iAd.SpatialNavigationManager.DIRECTION_DOWN&&h.pointAtPosition(iAd.Rect.TOP_LEFT_CORNER).y<g.y||a==iAd.SpatialNavigationManager.DIRECTION_LEFT&&
h.pointAtPosition(iAd.Rect.TOP_RIGHT_CORNER).x>g.x)){h=h.edge(c).distanceToPoint(b);if(h<e){e=h;d=i}}}return d};iAd.SpatialNavigationManager.prototype.topMostIndex=function(){if(this.navigableElements.length==0)return-1;for(var a=0,b=Number.MAX_VALUE,c,d=0,e=this.navigableElements.length;d<e;d++)if(this.isElementAtIndexNavigable(d)){c=this.metricsForElementAtIndex(d).origin.y;if(c<b){b=c;a=d}}return a};
iAd.SpatialNavigationManager.prototype.rightMostIndex=function(){if(this.navigableElements.length==0)return-1;for(var a=0,b=0,c,d=0,e=this.navigableElements.length;d<e;d++)if(this.isElementAtIndexNavigable(d)){c=this.metricsForElementAtIndex(d).pointAtPosition(iAd.Rect.TOP_RIGHT_CORNER).x;if(c>b){b=c;a=d}}return a};
iAd.SpatialNavigationManager.prototype.bottomMostIndex=function(){if(this.navigableElements.length==0)return-1;for(var a=0,b=0,c,d=0,e=this.navigableElements.length;d<e;d++)if(this.isElementAtIndexNavigable(d)){c=this.metricsForElementAtIndex(d).pointAtPosition(iAd.Rect.BOTTOM_RIGHT_CORNER).y;if(c>b){b=c;a=d}}return a};
iAd.SpatialNavigationManager.prototype.leftMostIndex=function(){if(this.navigableElements.length==0)return-1;for(var a=0,b=Number.MAX_VALUE,c,d=0,e=this.navigableElements.length;d<e;d++)if(this.isElementAtIndexNavigable(d)){c=this.metricsForElementAtIndex(d).origin.x;if(c<b){b=c;a=d}}return a};iAd.SpatialNavigationManager.prototype.metricsForElement=function(a){return iAd.Rect.rectWithClientRect(a.getBoundingClientRect())};iAd.SpatialNavigationManager.prototype.metricsForElementAtIndex=function(a){return this.metricsForElement(this.navigableElements[a])};
iAd.SpatialNavigationManager.prototype.isElementAtIndexNavigable=function(a){return iAd.SpatialNavigationManager.isElementNavigable(this.navigableElements[a])};iAd.SpatialNavigationManager.isElementNavigable=function(a){var b=window.getComputedStyle(a);return b.display!="none"&&b.visibility!="hidden"&&!a.hasClassName(iAd.SpatialNavigationManager.INACTIVE_CSS_CLASS)};
iAd.SpatialNavigationManager.prototype.focusElement=function(a){var b=this.focusedElement;if(!(a===b||!(a instanceof Element)&&a!==null)){if(a){var c=this.navigableElements.indexOf(a);if(c==-1||!this.isElementAtIndexNavigable(c))return}if(b!==null){iAd.SpatialNavigationManager.ENABLED&&b.removeClassName(iAd.SpatialNavigationManager.FOCUSED_CSS_CLASS);b.dispatchEvent(iAd.EventTarget.createEvent(iAd.SpatialNavigationManager.FOCUS_OUT_EVENT))}if(a){iAd.SpatialNavigationManager.ENABLED&&a.addClassName(iAd.SpatialNavigationManager.FOCUSED_CSS_CLASS);
a.dispatchEvent(iAd.EventTarget.createEvent(iAd.SpatialNavigationManager.FOCUS_IN_EVENT))}this.focusedElement=a}};Object.defineProperty(iAd.SpatialNavigationManager,"sharedManager",{get:function(){if(!iAd.SpatialNavigationManager.hasOwnProperty("_sharedManager"))this._sharedManager=new iAd.SpatialNavigationManager;return this._sharedManager}});
window.addEventListener("DOMContentLoaded",function(){iAd.SpatialNavigationManager.ENABLED&&document.body.addClassName(iAd.SpatialNavigationManager.ENABLED_CSS_CLASS)},false);iAd.TestProbeSender={};
iAd.TestProbeSender.init=function(){if(window.hasOwnProperty("ad")&&window.ad.hasOwnProperty("fireTestProbe"))for(var a=[iAd.ViewController.VIEW_WILL_APPEAR_EVENT,iAd.ViewController.VIEW_DID_APPEAR_EVENT,iAd.ViewController.VIEW_WILL_DISAPPEAR_EVENT,iAd.ViewController.VIEW_DID_DISAPPEAR_EVENT,iAd.ViewController.VIEW_DID_LOAD,iAd.ViewController.VIEW_DID_UNLOAD],b;a.length;){b=a.pop();iAd.Event.registerForNotificationEvent(b);document.addEventListener(b,iAd.TestProbeSender,true)}};
iAd.TestProbeSender.handleEvent=function(a){window.ad.fireTestProbe(a.type,{title:a.ad.sender.title})};window.addEventListener("load",iAd.TestProbeSender.init);iAd.Class("iAd.TimeLogger");iAd.TimeLogger.prototype.init=function(a){this.callSuper();this.label=a};iAd.TimeLogger.prototype.start=function(){this.startTime=new Date;this.times=[];return this};iAd.TimeLogger.prototype.log=function(a){this.times.push({label:a,time:new Date})};
iAd.TimeLogger.prototype.stop=function(){console.group(this.label,new Date-this.startTime);for(var a=this.startTime,b;this.times.length;){b=this.times.shift();console.log(b.label,b.time-a);a=b.time}console.groupEnd()};iAd.Class({name:"iAd.ImageView",superclass:iAd.View,synthesizedProperties:["autoSized","image","highlightedImage","highlighted"],archivedProperties:["autoSized","image","highlightedImage","highlighted"],cssClassName:"ad-image-view",collectionAccessor:"imageViews"});
iAd.ImageView.prototype.init=function(a){this._autoSized=true;this._highlighted=false;this._highlightedImage=this._image=null;this.callSuper(a);this.addEventListener(iAd.View.TOUCH_DOWN_EVENT,this,false);this.addEventListener(iAd.View.TOUCH_DRAG_ENTER_EVENT,this,false);this.addEventListener(iAd.View.TOUCH_DRAG_EXIT_EVENT,this,false);this.addEventListener(iAd.View.ACTIVATE_EVENT,this,false);this.addEventListener(iAd.View.TOUCH_CANCEL_EVENT,this,false)};
iAd.ImageView.prototype.layerWasCreated=function(){this._img=this.layer.appendChild(document.createElement("img"))};iAd.ImageView.prototype.setValueForAttribute=function(a,b){switch(b){case "ad-image":this.image=iAd.Image.imageForURL(a,this.layerHasCustomAttribute("ad-has-hidpi-version"));break;case "ad-highlighted-image":this.highlightedImage=iAd.Image.imageForURL(a,this.layerHasCustomAttribute("ad-has-hidpi-version"));break;default:this.callSuper(a,b)}};
iAd.ImageView.prototype.layerWasInsertedIntoDocument=function(){this.callSuper();this.syncImageToCurrentState()};iAd.ImageView.prototype.setImage=function(a){this._image=a;this.syncImageToCurrentState()};iAd.ImageView.prototype.setHighlightedImage=function(a){this.userInteractionEnabled=a!=null;this._highlightedImage=a;this.syncImageToCurrentState()};iAd.ImageView.prototype.setHighlighted=function(a){if(a!=this._highlighted){this._highlighted=a;this.syncImageToCurrentState()}};
iAd.ImageView.prototype.setAutoSized=function(a){if(this._autoSized!=a){this._autoSized=a;this.syncImageToCurrentState()}};
iAd.ImageView.prototype.syncImageToCurrentState=function(){var a=this.highlighted&&this.highlightedImage?this.highlightedImage:this.image;if(a)if(a.loaded){this._img.style.visibility="visible";this._img.src=a.element.src;if(this._autoSized)this.size=new iAd.Size(a.width,a.height);if(iAd.ImageEffects&&this._effect){this._effect.inputImage=this._img;this._effect.render()}}else a.addPropertyObserver("loaded",this,"syncImageToCurrentState");else{this._img.src="";this._img.style.removeProperty("visibility")}};
iAd.ImageView.prototype.handleEvent=function(a){this.callSuper(a);switch(a.type){case iAd.View.TOUCH_DOWN_EVENT:case iAd.View.TOUCH_DRAG_ENTER_EVENT:this.highlighted=true;break;case iAd.View.TOUCH_DRAG_EXIT_EVENT:case iAd.View.ACTIVATE_EVENT:case iAd.View.TOUCH_CANCEL_EVENT:this.highlighted=false}};
iAd.ImageEffects={version:"1.0",effects:{},defaultVertexShaderSource:"attribute vec2 a_pos;\nvarying vec2 v_pos;\nuniform mat4 u_mvpMatrix;\nvoid main()\n{\n  v_pos = vec2((a_pos.x + 1.0) / 2.0, (a_pos.y + 1.0) / 2.0);\n  gl_Position = u_mvpMatrix * vec4(a_pos.x, a_pos.y, 0.0, 1.0);\n}",defaultFragmentShaderSource:"#ifdef GL_ES\n  precision mediump float;\n#endif\nuniform mat4 u_mvpMatrix;\nuniform sampler2D tex0;\nvarying vec2 v_pos;\n\nvoid main(void) {\n  gl_FragColor = texture2D(tex0, v_pos);\n}"};
iAd.Class({name:"iAd.ImageEffects.Effect",synthesizedProperties:["inputImage"]});iAd.ImageEffects.PARAMETER_TYPE_NUMBER="Number";iAd.ImageEffects.PARAMETER_TYPE_ANGLE_IN_RADIANS="AngleInRadians";iAd.ImageEffects.PARAMETER_TYPE_ANGLE_IN_DEGREES="AngleInDegrees";iAd.ImageEffects.PARAMETER_TYPE_TEXTURE_POSITION="TexturePosition";iAd.ImageEffects.PARAMETER_TYPE_POSITION="Position";iAd.ImageEffects.PARAMETER_TYPE_TEXTURE="Texture";iAd.ImageEffects.PARAMETER_TYPE_COLOR="Color";
iAd.ImageEffects.PARAMETER_TYPE_VECTOR="Vector";iAd.ImageEffects.PARAMETER_TYPE_MATRIX="Matrix";
iAd.ImageEffects.Effect.prototype.init=function(a,b){this.callSuper();this.config=a;this.element=b||document.createElement("canvas");for(var c=this.parameters={__effect:this},d=this.textureParameters={},e=1,f,g=0,h=a.parameters.length;g<h;g++){f=a.parameters[g];this.synthesizeParameter(c,f.name);if(f.type==iAd.ImageEffects.PARAMETER_TYPE_TEXTURE)d[f.name]={texture:null,index:e++};else c[f.name]=f.defaultValue}c=this.meshWidth=a.meshWidth||1;d=this.meshHeight=a.meshHeight||1;e=[];f=2/c;g=2/d;for(var i,
j,k,l=0;l<c;l++)for(var m=0;m<d;m++){h=-1+l*f;i=-1+m*g;j=h+f;k=i+g;e.push(h,k,j,k,h,i,j,k,j,i,h,i)}this.quadVertices=new Float32Array(e);this.quadSizePerPoint=2;this.quadNumPoints=e.length/this.quadSizePerPoint;this.setupSucceeded=false};iAd.ImageEffects.Effect.prototype.setInputImage=function(a){var b=this.gl;this._inputImage&&b.deleteTexture(this._inputImage);b=b.createTexture();this.loadImageIntoTexture(b,a);this._inputImage=b};
iAd.ImageEffects.Effect.prototype.synthesizeParameter=function(a,b,c,d){var e="_"+b;a[e]=null;c=c||function(){return this[e]};c.displayName="Getter for ."+b;d=d||function(f){var g=this.__effect,h=g.parameterForName(b);switch(h.type){case iAd.ImageEffects.PARAMETER_TYPE_NUMBER:case iAd.ImageEffects.PARAMETER_TYPE_ANGLE_IN_RADIANS:case iAd.ImageEffects.PARAMETER_TYPE_ANGLE_IN_DEGREES:if(typeof f!="number")return;f=iAd.Number.clampValue(f,h.minValue!==undefined?h.minValue:-Number.MAX_VALUE,h.maxValue!==
undefined?h.maxValue:Number.MAX_VALUE);break;case iAd.ImageEffects.PARAMETER_TYPE_TEXTURE_POSITION:case iAd.ImageEffects.PARAMETER_TYPE_POSITION:if(typeof f!="object"||f.length!=2||typeof f[0]!="number"||typeof f[1]!="number")return;break;case iAd.ImageEffects.PARAMETER_TYPE_TEXTURE:this[e]&&g.destroyTextureWithName(b);h=g.textureParameters[b].texture=g.gl.createTexture();g.loadImageIntoTexture(h,f);break;case iAd.ImageEffects.PARAMETER_TYPE_COLOR:if(!(Array.isArray(f)||f instanceof Float32Array)||
f.length!=4)return;f[0]=iAd.Number.clampValue(f[0],0,1);f[1]=iAd.Number.clampValue(f[1],0,1);f[2]=iAd.Number.clampValue(f[2],0,1);f[3]=iAd.Number.clampValue(f[3],0,1);break;case iAd.ImageEffects.PARAMETER_TYPE_VECTOR:if(!(Array.isArray(f)||f instanceof Float32Array)||f.length!=4)return;break;case iAd.ImageEffects.PARAMETER_TYPE_MATRIX:if(!(Array.isArray(f)||f instanceof Float32Array)||f.length!=16)return;break;default:iAd.Console.error("Unhandled parameter type - "+h.type)}this[e]=f};d.displayName=
"Setter for ."+b;Object.defineProperty(a,b,{get:c,set:d})};iAd.ImageEffects.Effect.prototype.parameterForName=function(a){for(var b=this.config.parameters,c=0,d=b.length;c<d;c++)if(b[c].name==a)return b[c]};iAd.ImageEffects.Effect.prototype.typeForParameterName=function(a){a=this.parameterForName(a);return a!==undefined?a.type:undefined};
iAd.ImageEffects.Effect.prototype.setupGL=function(){var a=this.gl=this.element.getContext("experimental-webgl");if(a){a.enable(a.TEXTURE_2D);a.viewport(0,0,this.element.width,this.element.height);this.vbo=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,this.vbo);a.bufferData(a.ARRAY_BUFFER,this.quadVertices,a.STATIC_DRAW);var b=this.program=a.createProgram(),c=this.config,d=a.createShader(a.VERTEX_SHADER);a.shaderSource(d,c.vertexShaderSource||iAd.ImageEffects.defaultVertexShaderSource);a.compileShader(d);
if(a.getShaderParameter(d,a.COMPILE_STATUS)){var e=a.createShader(a.FRAGMENT_SHADER);a.shaderSource(e,c.fragmentShaderSource||iAd.ImageEffects.defaultFragmentShaderSource);a.compileShader(e);if(a.getShaderParameter(e,a.COMPILE_STATUS)){a.attachShader(b,d);a.attachShader(b,e);a.deleteShader(d);a.deleteShader(e);a.linkProgram(b);a.useProgram(b);c=a.getAttribLocation(b,"a_pos");a.vertexAttribPointer(c,this.quadSizePerPoint,a.FLOAT,false,0,0);a.enableVertexAttribArray(c);c=this.createPerspectiveArray(5);
b=a.getUniformLocation(b,"u_mvpMatrix");a.uniformMatrix4fv(b,false,c);this.setupSucceeded=true}else{a.deleteProgram(b);iAd.Console.error("Fragment Compile ERROR: "+a.getShaderInfoLog(e))}}else{a.deleteProgram(b);iAd.Console.error("Vertex Compile ERROR: "+a.getShaderInfoLog(d))}}else iAd.Console.error("iAd.ImageEffects requires a system with WebGL")};
iAd.ImageEffects.Effect.prototype.createPerspectiveArray=function(a){for(var b=new Float32Array(16),c=0;c<32;c++)b[c]=c===0||c==5||c==10||c==15?1:c==11?-1/a:0;return b};
iAd.ImageEffects.Effect.prototype.loadImageIntoTexture=function(a,b){var c=this.gl;c.bindTexture(c.TEXTURE_2D,a);c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,true);c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,b);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.LINEAR);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.LINEAR);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE);c.bindTexture(c.TEXTURE_2D,null)};
iAd.ImageEffects.Effect.prototype.destroyTextureWithName=function(a){var b=this.gl;if(this.textureParameters[a].texture){b.deleteTexture(this.textureParameters[a].texture);this.textureParameters[a].texture=null}};
iAd.ImageEffects.Effect.prototype.bindParameterToLocation=function(a,b,c,d){var e=this.gl;switch(c){case iAd.ImageEffects.PARAMETER_TYPE_NUMBER:case iAd.ImageEffects.PARAMETER_TYPE_ANGLE_IN_RADIANS:e.uniform1f(d,b);break;case iAd.ImageEffects.PARAMETER_TYPE_TEXTURE_POSITION:e.uniform2f(d,b[0],1-b[1]);break;case iAd.ImageEffects.PARAMETER_TYPE_POSITION:e.uniform2f(d,b[0]*2-1,(1-b[1])*2-1);break;case iAd.ImageEffects.PARAMETER_TYPE_ANGLE_IN_DEGREES:e.uniform1f(d,b*Math.PI/180);break;case iAd.ImageEffects.PARAMETER_TYPE_TEXTURE:this.bindTexture(a,
this.textureParameters[a].index,this.textureParameters[a].texture);break;case iAd.ImageEffects.PARAMETER_TYPE_COLOR:case iAd.ImageEffects.PARAMETER_TYPE_VECTOR:e.uniform4fv(d,b);break;case iAd.ImageEffects.PARAMETER_TYPE_MATRIX:e.uniformMatrix4fv(d,false,b);break;default:iAd.Console.error("Unhandled parameter type - "+c)}};
iAd.ImageEffects.Effect.prototype.bindTexture=function(a,b,c){var d=this.gl;a=d.getUniformLocation(this.program,a);d.uniform1i(a,b);d.activeTexture(d.TEXTURE0+b);d.bindTexture(d.TEXTURE_2D,c)};
iAd.ImageEffects.Effect.prototype.render=function(){var a=this.gl,b=this.element,c=this.config,d=this.program,e=this.parameters;a.viewport(0,0,b.width,b.height);a.useProgram(d);this.bindTexture("tex0",0,this._inputImage);for(var f,g,h,i=0,j=c.parameters.length;i<j;i++){b=c.parameters[i];f=b.name;g="_"+f;h=a.getUniformLocation(d,f);e[g]!==null&&e[g]!==undefined?this.bindParameterToLocation(f,e[g],b.type,h):this.bindParameterToLocation(f,b.defaultValue,b.type,h)}a.clear(a.COLOR_BUFFER_BIT);a.bindBuffer(a.ARRAY_BUFFER,
this.vbo);a.drawArrays(a.TRIANGLES,0,this.quadNumPoints)};iAd.ImageEffects.Effect.prototype.close=function(){var a=this.gl;if(a){a.deleteProgram(this.program);this.program=null;if(this._inputImage){a.deleteTexture(this._inputImage);this._inputImage=null}for(var b,c=0,d=this.config.parameters.length;c<d;c++){b=this.config.parameters[c];b.type=="Texture"&&this.destroyTextureWithName(b.name)}a.deleteBuffer(this.vbo);this.gl=this.vbo=null}};
iAd.ImageEffects.effectForName=function(a,b){var c=iAd.ImageEffects.effects[a];if(c){c=new iAd.ImageEffects.Effect(c,b);c.setupGL();return c.setupSucceeded?c:null}else{iAd.Console.error("No effect with name "+a+" found");return null}};iAd.ImageEffects.registerEffect=function(a,b){iAd.ImageEffects.effects[a]=b};iAd.Class.synthesizeProperties(iAd.ImageView,["effect"]);iAd.ImageView.prototype.getEffect=function(){return this._effect};
iAd.ImageView.prototype.setEffect=function(a){this._effect&&this._effect!=a&&this.layer.removeChild(this._effect.element);if(a){this._effect||this.layer.removeChild(this._img);a.inputImage=this._img;var b=a.element;b.style.width="100%";b.style.height="100%";b.width=this._img.width;b.height=this._img.height;this.layer.appendChild(b);a.render()}else this._effect&&this.layer.appendChild(this._img);this._effect=a};
iAd.Class({name:"iAd.LoaderQueue",superclass:iAd.LoaderManager,synthesizedProperties:["currentLoader","nextLoader"]});iAd.LoaderQueue.WILL_LOAD_NEXT_ITEM="loaderWillLoadNextItem";iAd.LoaderQueue.prototype.init=function(a){this.callSuper(a);this.continueOnError=true};iAd.LoaderQueue.prototype.add=function(a){(a=this.callSuper(a))&&this.loading&&this.notifyLoaderDidProgress();return a};iAd.LoaderQueue.prototype.getCurrentLoader=function(){return this.openLoaders.length?this.openLoaders[0]:null};
iAd.LoaderQueue.prototype.setCurrentLoader=function(){};iAd.LoaderQueue.prototype.getNextLoader=function(){return this.pendingLoaders.length>0?this.pendingLoaders[0]:null};iAd.LoaderQueue.prototype.setNextLoader=function(){};iAd.LoaderQueue.prototype.startLoad=function(){this.callSuper();this.loadNextItem()};iAd.LoaderQueue.prototype.loadNextItem=function(a){if(this.pendingLoaders.length==0)this.notifyLoaderDidComplete();else{this.notifyLoaderWillLoadNextItem(a);this.callSuper()}};
iAd.LoaderQueue.prototype.loaderDidComplete=function(a){this.callSuper(a);this.loadNextItem(a)};iAd.LoaderQueue.prototype.loaderDidFail=function(a,b){this.callSuper(a,b);this.continueOnError?this.loadNextItem(a):this.notifyLoaderDidFail()};iAd.LoaderQueue.prototype.notifyLoaderWillLoadNextItem=function(a){this.dispatchNotification(iAd.LoaderQueue.WILL_LOAD_NEXT_ITEM,this.delegate,[["previousLoader",a],["nextLoader",this.nextLoader]])};
iAd.Class({name:"iAd.Media",mixins:[iAd.EventTarget,iAd.EventTriage],synthesizedProperties:["url","element","time","duration","percentLoaded","bufferedStartTime","bufferedEndTime","canPlay","canPlayThrough","seeking","renderable","loop","error","playbackState","loadState","loadReady"],archivedProperties:["url"]});iAd.Media.PLAYBACK_WILL_START="mediaPlaybackWillStart";iAd.Media.PLAYBACK_DID_START="mediaPlaybackDidStart";iAd.Media.PLAYBACK_DID_PAUSE="mediaPlaybackDidPause";
iAd.Media.PLAYBACK_DID_BEGIN_WAITING="mediaPlaybackDidBeginWaiting";iAd.Media.PLAYBACK_DID_END_WAITING="mediaPlaybackDidEndWaiting";iAd.Media.PLAYBACK_DID_END="mediaPlaybackDidEnd";iAd.Media.WILL_SEEK="mediaWillSeek";iAd.Media.DID_SEEK="mediaDidSeek";iAd.Media.DID_UPDATE_TIME="mediaDidUpdateTime";iAd.Media.LOAD_WILL_START="mediaLoadWillStart";iAd.Media.LOAD_DID_START="mediaLoadDidStart";iAd.Media.LOAD_DID_PROGRESS="mediaLoadDidProgress";iAd.Media.LOAD_DATA_AVAILABLE="mediaLoadDataAvailable";
iAd.Media.LOAD_DID_STALL="mediaLoadDidStall";iAd.Media.LOAD_DID_SUSPEND="mediaLoadDidSuspend";iAd.Media.LOAD_DID_RESUME="mediaLoadDidResume";iAd.Media.LOAD_DID_FAIL="mediaLoadDidFail";iAd.Media.LOAD_IS_READY="mediaLoadIsReady";iAd.Media.LOAD_CAN_PLAY="mediaLoadCanPlay";iAd.Media.LOAD_CAN_PLAY_THROUGH="mediaLoadCanPlayThrough";iAd.Media.WILL_UNLOAD="mediaWillUnload";iAd.Media.DID_UNLOAD="mediaDidUnload";iAd.Media.PLAYBACK_STATE_DID_UPDATE="mediaPlaybackStateDidUpdate";
iAd.Media.PLAYBACK_STATE_NONE=0;iAd.Media.PLAYBACK_STATE_WAITING=1;iAd.Media.PLAYBACK_STATE_PLAYING=2;iAd.Media.PLAYBACK_STATE_PAUSED=3;iAd.Media.PLAYBACK_STATE_ENDED=4;iAd.Media.LOAD_STATE_DID_UPDATE="mediaLoadStateDidUpdate";iAd.Media.LOAD_STATE_NONE=0;iAd.Media.LOAD_STATE_LOADING=1;iAd.Media.LOAD_STATE_STALLED=2;iAd.Media.LOAD_STATE_SUSPENDED=3;iAd.Media.LOAD_STATE_FAILED=4;iAd.Media.READY_STATE_NOTHING=0;iAd.Media.READY_STATE_METADATA=1;iAd.Media.READY_STATE_CURRENT_DATA=2;
iAd.Media.READY_STATE_FUTURE_DATA=3;iAd.Media.READY_STATE_ENOUGH_DATA=4;iAd.Media.HTML_MEDIA_EVENTS=["emptied","loadstart","durationchange","loadedmetadata","loadeddata","canplay","canplaythrough","progress","play","waiting","playing","timeupdate","pause","seeking","seeked","stalled","suspend","ended","abort","error"];
iAd.Media.prototype.init=function(a){this.callSuper();this._playbackState=iAd.Media.PLAYBACK_STATE_NONE;this._loadState=iAd.Media.LOAD_STATE_NONE;this.reset();if(!this._loadReadyStrategy)this._loadReadyStrategy=iAd.Media.defaultLoadReadyStrategy;this.eventTarget=document;this._url=a;this.resolvedURL=this.urlStrategy(a)};iAd.Media.prototype.getDuration=function(){return this._element?this._element.duration:NaN};
iAd.Media.prototype.getBufferedStartTime=function(){var a=this.closestBufferedIndex();return a>=0?this._element.buffered.start(a):0};iAd.Media.prototype.getBufferedEndTime=function(){var a=this.closestBufferedIndex();return a>=0?this._element.buffered.end(a):0};iAd.Media.prototype.getPercentLoaded=function(){return this.duration?(this.bufferedEndTime-this.bufferedStartTime)/this.duration:0};
iAd.Media.prototype.closestBufferedIndex=function(){if(!this._element)return-1;for(var a=this.time,b=this.element.buffered,c=0,d=b.length;c<d;c++)if(b.start(c)<=a&&b.end(c)>=a)return c;return-1};iAd.Media.prototype.setLoop=function(a){this._loop=a;if(this._element)this._element.loop=a};iAd.Media.prototype.getCanPlay=function(){if(!this._element)return false;return this._element.readyState>=iAd.Media.READY_STATE_FUTURE_DATA};
iAd.Media.prototype.getCanPlayThrough=function(){if(!this._element)return false;return this._element.readyState>=iAd.Media.READY_STATE_ENOUGH_DATA};iAd.Media.prototype.getSeeking=function(){return this._element&&this._element.seeking};iAd.Media.prototype.getError=function(){var a=this._element;return a&&a.error?a.error.code:null};iAd.Media.prototype.getRenderable=function(){if(!this._element)return false;return this._element.readyState>=iAd.Media.READY_STATE_CURRENT_DATA};
iAd.Media.prototype.setUrl=function(){};iAd.Media.prototype.setElement=function(){};iAd.Media.prototype.setPlaybackState=function(){};iAd.Media.prototype.setLoadState=function(){};iAd.Media.prototype.setLoadReady=function(){};iAd.Media.prototype.setTime=function(){};
iAd.Media.prototype.load=function(){if(this._loadState!=iAd.Media.LOAD_STATE_NONE&&this._loadState!=iAd.Media.LOAD_STATE_FAILED||this._attemptingLoad)return false;this.element.setAttribute("src",this.resolvedURL);this.element.loop=this._loop;this.addMediaEventListeners();this.dispatchMediaNotification(iAd.Media.LOAD_WILL_START);this._attemptingLoad=true;this.loadElement();return true};
iAd.Media.prototype.unload=function(){if(this._loadState!=iAd.Media.LOAD_STATE_NONE){this.dispatchMediaNotification(iAd.Media.WILL_UNLOAD);this.removeMediaEventListeners();this.reset();this.unloadElement();this.dispatchMediaNotification(iAd.Media.DID_UNLOAD)}};
iAd.Media.prototype.play=function(){if(this._playbackState==iAd.Media.PLAYBACK_STATE_PLAYING||this._playbackState==iAd.Media.PLAYBACK_STATE_WAITING)if(this._targetPlaybackState!=iAd.Media.PLAYBACK_STATE_PAUSED)return false;if(this._loadState==iAd.Media.LOAD_STATE_NONE||this._loadState==iAd.Media.LOAD_STATE_FAILED)this.load();this._playbackState!=iAd.Media.PLAYBACK_STATE_PLAYING&&this._targetPlaybackState!=iAd.Media.PLAYBACK_STATE_PLAYING&&this.dispatchMediaNotification(iAd.Media.PLAYBACK_WILL_START);
this.playElement();return true};iAd.Media.prototype.pause=function(){if(this._playbackState==iAd.Media.PLAYBACK_STATE_PAUSED)return false;this.pauseElement();return true};iAd.Media.prototype.stop=function(){if(this._playbackState==iAd.Media.PLAYBACK_STATE_PAUSED&&this.time==0)return false;this.pause();this.seekToTime(0);return true};
iAd.Media.prototype.seekToTime=function(a){if(!this.canSeekToTime(a))return false;this.seekElement(a);this.playbackState==iAd.Media.PLAYBACK_STATE_ENDED&&this.enterPlaybackState(iAd.Media.PLAYBACK_STATE_PAUSED);return true};iAd.Media.prototype.canSeekToTime=function(a){if(!this._element)return false;for(var b=this._element.seekable,c=0,d=b.length;c<d;c++)if(b.start(c)<=a&&b.end(c)>=a)return true;return false};
iAd.Media.prototype.isTimeInBufferedRange=function(a){return this.bufferedStartTime<=a&&this.bufferedEndTime>=a};iAd.Media.prototype.loadElement=function(){this.element.load()};iAd.Media.prototype.unloadElement=function(){this.element.setAttribute("src","null")};iAd.Media.prototype.playElement=function(){this._targetPlaybackState=iAd.Media.PLAYBACK_STATE_PLAYING;this.element.play()};iAd.Media.prototype.pauseElement=function(){this._targetPlaybackState=iAd.Media.PLAYBACK_STATE_PAUSED;this.element.pause()};
iAd.Media.prototype.seekElement=function(a){this.element.currentTime=a};iAd.Media.prototype.reset=function(){this.enterPlaybackState(iAd.Media.PLAYBACK_STATE_NONE);this.enterLoadState(iAd.Media.LOAD_STATE_NONE);this._attemptingLoad=this._loadReady=false;this._time=0};iAd.Media.prototype.executeLoadReadyStrategy=function(a){if(!this._loadReady&&this.loadReadyStrategy(this,a)){this._loadReady=true;this.dispatchMediaNotification(iAd.Media.LOAD_IS_READY)}};iAd.Media.prototype.prepareForCompetition=function(){};
iAd.Media.prototype.enterPlaybackState=function(a){if(a==iAd.Media.PLAYBACK_STATE_PLAYING||a==iAd.Media.PLAYBACK_STATE_PAUSED)delete this._targetPlaybackState;if(this._playbackState!=a){var b=this._playbackState;this._playbackState=a;this.dispatchMediaNotification(iAd.Media.PLAYBACK_STATE_DID_UPDATE);b==iAd.Media.PLAYBACK_STATE_WAITING&&this.dispatchMediaNotification(iAd.Media.PLAYBACK_DID_END_WAITING);switch(a){case iAd.Media.PLAYBACK_STATE_PLAYING:this.dispatchMediaNotification(iAd.Media.PLAYBACK_DID_START);
break;case iAd.Media.PLAYBACK_STATE_PAUSED:this.dispatchMediaNotification(iAd.Media.PLAYBACK_DID_PAUSE);break;case iAd.Media.PLAYBACK_STATE_WAITING:this.dispatchMediaNotification(iAd.Media.PLAYBACK_DID_BEGIN_WAITING);break;case iAd.Media.PLAYBACK_STATE_ENDED:this.dispatchMediaNotification(iAd.Media.PLAYBACK_DID_END)}}};
iAd.Media.prototype.enterLoadState=function(a){if(this._loadState!=a){this.clearLoadStateTimeout();this.clearTimeupdateWatchdogTimeout();var b=this._loadState;this._loadState=a;this.dispatchMediaNotification(iAd.Media.LOAD_STATE_DID_UPDATE);this._attemptingLoad=false;switch(a){case iAd.Media.LOAD_STATE_LOADING:this.dispatchMediaNotification(b?iAd.Media.LOAD_DID_RESUME:iAd.Media.LOAD_DID_START);break;case iAd.Media.LOAD_STATE_STALLED:this.dispatchMediaNotification(iAd.Media.LOAD_DID_STALL);this._playbackState==
iAd.Media.PLAYBACK_STATE_PLAYING&&this.beginTimeupdateWatchdogTimeout();break;case iAd.Media.LOAD_STATE_SUSPENDED:this.dispatchMediaNotification(iAd.Media.LOAD_DID_SUSPEND);break;case iAd.Media.LOAD_STATE_FAILED:this.dispatchMediaNotification(iAd.Media.LOAD_DID_FAIL,[["errorCode",this.error]])}}};iAd.Media.prototype.elementWasRemovedFromDocument=function(){};iAd.Media.prototype.elementWasInsertedIntoDocument=function(){};
iAd.Media.prototype.addMediaEventListeners=function(){for(var a=iAd.Media.HTML_MEDIA_EVENTS,b=this.element,c=0,d=a.length;c<d;c++)b.addEventListener(a[c],this)};iAd.Media.prototype.removeMediaEventListeners=function(){for(var a=iAd.Media.HTML_MEDIA_EVENTS,b=this.element,c=0,d=a.length;c<d;c++)b.removeEventListener(a[c],this)};
iAd.Media.prototype.dispatchMediaNotification=function(a,b){this.notifyDelegate(a,iAd.Media,b);this.notifyDelegate(a,this._mediaPlayer,b);this.dispatchNotification(a,this.delegate,b)};iAd.Media.prototype.processDelegateArguments=function(a){var b=[this];if(a)b=b.concat(a.map(function(c){return c[1]}));return b};iAd.Media.prototype.handlePlay=function(){if(this._targetPlaybackState!=iAd.Media.PLAYBACK_STATE_PLAYING){this._targetPlaybackState=iAd.Media.PLAYBACK_STATE_PLAYING;this.dispatchMediaNotification(iAd.Media.PLAYBACK_WILL_START)}};
iAd.Media.prototype.handlePlaying=function(){this.enterPlaybackState(iAd.Media.PLAYBACK_STATE_PLAYING)};iAd.Media.prototype.handlePause=function(){this.playbackState!=iAd.Media.PLAYBACK_STATE_ENDED&&!this._element.ended&&this.enterPlaybackState(iAd.Media.PLAYBACK_STATE_PAUSED)};iAd.Media.prototype.handleWaiting=function(){this.enterPlaybackState(iAd.Media.PLAYBACK_STATE_WAITING)};iAd.Media.prototype.handleSeeking=function(){this.dispatchMediaNotification(iAd.Media.WILL_SEEK)};
iAd.Media.prototype.handleSeeked=function(){this.dispatchMediaNotification(iAd.Media.DID_SEEK)};iAd.Media.prototype.handleEnded=function(){this.pauseElement();this.enterPlaybackState(iAd.Media.PLAYBACK_STATE_ENDED)};iAd.Media.prototype.handleTimeupdate=function(){var a=this._element.currentTime;this.clearTimeupdateWatchdogTimeout();if(this._time!=a){this._time=a;this.dispatchMediaNotification(iAd.Media.DID_UPDATE_TIME,[["time",this._time]])}};
iAd.Media.prototype.handleDurationchange=function(){this.notifyPropertyChange("duration");this.enterLoadState(iAd.Media.LOAD_STATE_LOADING)};iAd.Media.prototype.handleLoadstart=function(){this.enterLoadState(iAd.Media.LOAD_STATE_LOADING)};iAd.Media.prototype.handleLoadedmetadata=function(){this.enterLoadState(iAd.Media.LOAD_STATE_LOADING)};
iAd.Media.prototype.handleLoadeddata=function(){this.dispatchMediaNotification(iAd.Media.LOAD_DATA_AVAILABLE);this.enterLoadState(iAd.Media.LOAD_STATE_LOADING);this.notifyPropertyChange("renderable")};iAd.Media.prototype.handleProgress=function(a){this.enterLoadState(iAd.Media.LOAD_STATE_LOADING);this.dispatchMediaNotification(iAd.Media.LOAD_DID_PROGRESS,[["percentLoaded",this.percentLoaded]]);this.executeLoadReadyStrategy(a)};iAd.Media.prototype.handleSuspend=function(){this.beginLoadStateTimeout(iAd.Media.LOAD_STATE_SUSPENDED)};
iAd.Media.prototype.handleStalled=function(){this.beginLoadStateTimeout(iAd.Media.LOAD_STATE_STALLED)};iAd.Media.prototype.handleError=function(){this.enterLoadState(iAd.Media.LOAD_STATE_FAILED)};iAd.Media.prototype.handleCanplay=function(a){this.dispatchMediaNotification(iAd.Media.LOAD_CAN_PLAY);this.executeLoadReadyStrategy(a)};iAd.Media.prototype.handleCanplaythrough=function(a){this.dispatchMediaNotification(iAd.Media.LOAD_CAN_PLAY_THROUGH);this.executeLoadReadyStrategy(a)};
iAd.Media.prototype.handleAbort=function(){this._loadState!=iAd.Media.LOAD_STATE_NONE&&this.enterLoadState(iAd.Media.LOAD_STATE_FAILED)};iAd.Media.prototype.handleEmptied=function(){this.notifyPropertyChange("renderable");this._loadState!=iAd.Media.LOAD_STATE_NONE&&this.handleUnloadEvent()};iAd.Media.prototype.handleUnloadEvent=function(){this.removeMediaEventListeners();this.reset();this.dispatchMediaNotification(iAd.Media.DID_UNLOAD)};
iAd.Media.prototype.beginLoadStateTimeout=function(a){this.clearLoadStateTimeout();this.loadStateTimeout=this.callMethodNameAfterDelay("enterLoadState",0.05,a)};iAd.Media.prototype.clearLoadStateTimeout=function(){if(this.loadStateTimeout){clearTimeout(this.loadStateTimeout);this.loadStateTimeout=null}};iAd.Media.TIMEUPDATE_WATCHDOG_DELAY=0.3;
iAd.Media.prototype.beginTimeupdateWatchdogTimeout=function(){this.clearTimeupdateWatchdogTimeout();this.timeupdateWatchdogTimeout=this.callMethodNameAfterDelay("timeupdateWatchdogDidTimeout",iAd.Media.TIMEUPDATE_WATCHDOG_DELAY)};iAd.Media.prototype.clearTimeupdateWatchdogTimeout=function(){if(this.timeupdateWatchdogTimeout){clearTimeout(this.timeupdateWatchdogTimeout);delete this.timeupdateWatchdogTimeout}};
iAd.Media.prototype.timeupdateWatchdogDidTimeout=function(){if(this._loadState==iAd.Media.LOAD_STATE_STALLED){delete this.timeupdateWatchdogTimeout;this.pause()}};iAd.Media.defaultLoadReadyStrategy=function(a){return a.canPlayThrough||!iAd.Device.iOS_VERSION&&a.percentLoaded==1};iAd.Media.defaultUrlStrategy=function(a){return a};iAd.Media.loadReadyStrategy=iAd.Media.defaultLoadReadyStrategy;iAd.Media.urlStrategy=iAd.Media.defaultUrlStrategy;
iAd.Media.prototype.loadReadyStrategy=function(a,b){return iAd.Media.loadReadyStrategy(a,b)};iAd.Media.prototype.urlStrategy=function(a){return iAd.Media.urlStrategy?iAd.Media.urlStrategy(a):a};iAd.Media.mediaTypeForURL=function(a,b){return new (this.resolveMediaClass(a))(b)};iAd.Media.resolveMediaClass=function(a){return a};iAd.Media.activeMedia=[];iAd.Media.mediaPlaybackWillStart=function(a){this.registerActiveMedia(a)};iAd.Media.mediaLoadWillStart=function(a){this.registerActiveMedia(a)};
iAd.Media.mediaDidUnload=function(a){this.unregisterActiveMedia(a)};iAd.Media.registerActiveMedia=function(a){var b=this.activeMedia[0];this.unregisterActiveMedia(a);this.activeMedia.unshift(a);b&&b!=a&&b.prepareForCompetition()};iAd.Media.unregisterActiveMedia=function(a){iAd.Array.removeObjectFromArray(a,this.activeMedia)};iAd.Media.resolveMediaClass=function(a){return this._adapterByClassType[a.displayName]||a};iAd.Media._adapterByClassType=[];
iAd.Media.registerMediaAdapter=function(a,b){var c=a.displayName;if(!iAd.Device.iOS_VERSION)if(window.iTunes&&b.context=="iTunes"){this._adapterByClassType[c]=b;return true}else return false;var d=b.iOSVersion;if(!d||iAd.Device.iOSVersionLessThan(d))return false;var e=this._adapterByClassType[c];if(!e||iAd.Device.compareiOSVersions(d,e.iOSVersion)>=0){this._adapterByClassType[c]=b;return true}return false};iAd.Class({name:"iAd.Audio",superclass:iAd.Media});
iAd.Audio.prototype.getElement=function(){if(!this._element)this._element=document.createElement("audio");return this.callSuper()};iAd.Audio.prototype.play=function(){if(iAd.Audio.playEnabled)return this.callSuper();return false};iAd.Audio.updatePlayEnabled=function(){if(!this._playEnabled)for(var a,b=iAd.Media.activeMedia,c=0,d=b.length;c<d;c++){a=b[c];a instanceof iAd.Audio&&a.playbackState==iAd.Media.PLAYBACK_STATE_PLAYING&&a.pause()}};
Object.defineProperty(iAd.Audio,"playEnabled",{get:function(){return iAd.Audio._playEnabled},set:function(a){if(iAd.Audio._playEnabled!=a){iAd.Audio._playEnabled=a;iAd.Audio.updatePlayEnabled()}}});iAd.Audio.playEnabled=true;iAd.Audio.audioForURL=function(a){return iAd.Media.mediaTypeForURL(iAd.Audio,a)};iAd.Audio.restoreFromArchive=function(a){return this.audioForURL(a.url)};iAd.Audio.prototype.urlStrategy=function(a){return iAd.Audio.urlStrategy?iAd.Audio.urlStrategy(a):this.callSuper(a)};
iAd.Audio.prototype.loadReadyStrategy=function(a,b){return iAd.Audio.loadReadyStrategy?iAd.Audio.loadReadyStrategy(a,b):this.callSuper(a,b)};iAd.Audio.loadReadyStrategy=null;iAd.Audio.urlStrategy=null;iAd.VideoDOMReconstruct={};iAd.VideoDOMReconstruct.elementWasRemovedFromDocument=function(){this.unload(false);this._element=null};iAd.VideoTouchEvents={};
iAd.VideoTouchEvents.updateElementAttributes=function(){this.callSuper();if(this._element)this._element.style.webkitTransform=this._showsControls?"none":iAd.CSS.t(0,0)};iAd.VideoFullscreen={};iAd.VideoFullscreen.enterFullscreen=function(){try{return this.callSuper()}catch(a){iAd.Console.warn("Fullscreen playback is not supported without user interaction.");return false}};
iAd.VideoFullscreen.setPlaysInline=function(a){if(!a&&iAd.Device.IS_IPAD){iAd.Console.warn("Fullscreen playback is not supported on iPad.");a=true}this.callSuper(a)};iAd.VideoFullscreenLaunch={};iAd.VideoFullscreenLaunch.handlePlaying=function(){this.callSuper();!this.playsInline&&iAd.Device.IS_IPAD&&this.enterFullscreen()};iAd.VideoInlineLock={};
iAd.VideoInlineLock.setPlaysInline=function(a){if(this.playsInline!=a)this._loadState!=iAd.Media.LOAD_STATE_NONE?iAd.Console.warn('iAd.Video: Adjusting "playsInline" after loading is not supported on this iOS version.'):this.callSuper(a)};iAd.MediaCompetitionPause={};iAd.MediaCompetitionPause.prepareForCompetition=function(){this.pause();this.callMethodNameAfterDelay("setPausedForCompetition",0)};iAd.MediaCompetitionPause.setPausedForCompetition=function(){this._pausedForCompetition=true};
iAd.MediaCompetitionUnload={};iAd.MediaCompetitionUnload.prepareForCompetition=function(){this.unload(true)};iAd.MediaUnloadTearDown={};iAd.MediaUnloadTearDown.unloadElement=function(){this.callSuper();this.tearDownElement()};iAd.MediaUnloadTearDown.handleUnloadEvent=function(){this.callSuper();this.tearDownElement()};iAd.MediaUnloadTearDown.tearDownElement=function(){var a=this.element;a.parentNode&&a.parentNode.removeChild(a);this._element=null};iAd.MediaUnloadAndRestoreTime={};
iAd.MediaUnloadAndRestoreTime.unload=function(a){if(a&&this._loadState!=iAd.Media.LOAD_STATE_NONE)this._timeWhenUnloaded=this._time;this.callSuper()};iAd.MediaUnloadAndRestoreTime.enterPlaybackState=function(a){delete this.seekTargetTime;this.callSuper(a)};iAd.MediaUnloadAndRestoreTime.handleEmptied=function(a){if(this._loadState!=iAd.Media.LOAD_STATE_NONE)this._timeWhenUnloaded=this._time;var b=this._targetPlaybackState==iAd.Media.PLAYBACK_STATE_PLAYING;this.callSuper(a);b&&this.play()};
iAd.MediaUnloadAndRestoreTime.handleProgress=function(a){this._timeWhenUnloaded&&this.seekToTime(this._timeWhenUnloaded,true);this.seekTargetTime&&this.evaluateSeekTime();this.callSuper(a)};iAd.MediaUnloadAndRestoreTime.seekToTime=function(a,b){b||delete this._timeWhenUnloaded;var c=this.callSuper(a);if(c){this.awaitingSeekedEvent=true;this.seekTargetTime=a}return c};iAd.MediaUnloadAndRestoreTime.getRenderable=function(){return this._timeWhenUnloaded?false:this.callSuper()};
iAd.MediaUnloadAndRestoreTime.getTime=function(){return this._timeWhenUnloaded||this.callSuper()};iAd.MediaUnloadAndRestoreTime.handleSeeked=function(a){this.awaitingSeekedEvent=false;if(this._timeWhenUnloaded){this._restoredUnloadedTime=this._timeWhenUnloaded;delete this._timeWhenUnloaded}this.seekTargetTime?this.callMethodNameAfterDelay("evaluateSeekTime",0):this.callSuper(a)};
iAd.MediaUnloadAndRestoreTime.handleTimeupdate=function(a){if(this.seekTargetTime)if(iAd.Media.activeMedia[0]!=this)this.notifyDidSeek();else this._element.seeking||this.callMethodNameAfterDelay("evaluateSeekTime",0);var b=this._pausedForCompetition;b&&delete this._pausedForCompetition;if(!(b&&this._element.currentTime==0)){this._timeWhenUnloaded||this.callSuper(a);if(this._time>=this._restoredUnloadedTime){delete this._restoredUnloadedTime;this.callMethodNameAfterDelay("notifyPropertyChange",0,"renderable")}}};
iAd.MediaUnloadAndRestoreTime.evaluateSeekTime=function(){if(!(!this.seeking||this.awaitingSeekedEvent)){this.isTimeInBufferedRange(this._time);this.isTimeInBufferedRange(this._time)&&this.notifyDidSeek()}};iAd.MediaUnloadAndRestoreTime.getSeeking=function(){return this.seekTargetTime!=undefined};iAd.MediaUnloadAndRestoreTime.notifyDidSeek=function(){if(this.seeking){delete this.seekTargetTime;this.dispatchMediaNotification(iAd.Media.DID_SEEK)}};iAd.MediaForceLoad={};
iAd.MediaForceLoad.loadElement=function(){var a=this.element;a.load();this.ignorePauseEvent=this.ignorePlayEvent=true;a.play();a.pause()};iAd.MediaForceLoad.handlePlay=function(a){if(this.ignorePlayEvent)this.ignorePlayEvent=false;else this.callSuper(a)};iAd.MediaForceLoad.handlePause=function(a){if(this.ignorePauseEvent)this.ignorePauseEvent=false;else this.callSuper(a)};iAd.MediaForceLoad.handleWaiting=function(a){this.ignorePlayEvent||this.ignorePauseEvent||this.callSuper(a)};iAd.MediaLoop={};
iAd.MediaLoop.handleEnded=function(a){this._adapterLoop?this.playElement():this.callSuper(a)};iAd.MediaLoop.setLoop=function(a){this._adapterLoop=a};iAd.MediaLoop.getLoop=function(){return this._adapterLoop};iAd.Class({name:"iAd.Audio_5_0",superclass:iAd.Audio,iOSVersion:"5.0",mixins:[iAd.MediaCompetitionPause]});iAd.Media.registerMediaAdapter(iAd.Audio,iAd.Audio_5_0);iAd.Class({name:"iAd.Audio_4_3",superclass:iAd.Audio,iOSVersion:"4.3",mixins:[iAd.MediaCompetitionUnload,iAd.MediaLoop]});
iAd.Media.registerMediaAdapter(iAd.Audio,iAd.Audio_4_3);iAd.Class({name:"iAd.Audio_4_2",superclass:iAd.Audio,iOSVersion:"4.2",mixins:[iAd.MediaCompetitionUnload,iAd.MediaForceLoad,iAd.MediaLoop]});iAd.Media.registerMediaAdapter(iAd.Audio,iAd.Audio_4_2);iAd.Class({name:"iAd.MediaPlayer",superclass:iAd.View,synthesizedProperties:["media","loop"],cssClassName:"ad-media-player"});iAd.MediaPlayer.PLAYBACK_DID_START="mediaPlaybackDidStart";iAd.MediaPlayer.PLAYBACK_DID_PAUSE="mediaPlaybackDidPause";
iAd.MediaPlayer.PLAYBACK_DID_BEGIN_WAITING="mediaPlaybackDidBeginWaiting";iAd.MediaPlayer.PLAYBACK_DID_END_WAITING="mediaPlaybackDidEndWaiting";iAd.MediaPlayer.PLAYBACK_DID_END="mediaPlaybackDidEnd";iAd.MediaPlayer.DID_UPDATE_TIME="mediaDidUpdateTime";iAd.MediaPlayer.PLAYING_STATE="ad-media-playing";iAd.MediaPlayer.PAUSED_STATE="ad-media-paused";iAd.MediaPlayer.WAITING_STATE="ad-media-waiting";iAd.MediaPlayer.ENDED_STATE="ad-media-ended";
iAd.MediaPlayer.prototype.init=function(a){this._loop=false;this.callSuper(a);this.playbackState=this.delegate=null};iAd.MediaPlayer.prototype.getMediaAttributeName=function(){return null};iAd.MediaPlayer.prototype.getMediaClassType=function(){return null};iAd.MediaPlayer.prototype.readPropertiesFromLayerAttributes=function(a){this.callSuper(a);if(a=a[this.getMediaAttributeName()])this.media=a};
iAd.MediaPlayer.prototype.setValueForAttribute=function(a,b){b!=this.getMediaAttributeName()&&this.callSuper(a,b)};iAd.MediaPlayer.prototype.play=function(){if(this._media){this.registerMedia(this._media);return this._media.play()}return false};iAd.MediaPlayer.prototype.pause=function(){return this._media&&this._media._mediaPlayer==this?this._media.pause():false};iAd.MediaPlayer.prototype.stop=function(){return this._media&&this._media._mediaPlayer==this?this._media.stop():false};
iAd.MediaPlayer.prototype.seekToTime=function(a){return this._media&&this._media._mediaPlayer==this?this._media.seekToTime(a):false};iAd.MediaPlayer.prototype.togglePlayback=function(){if(this._media==null)return false;return this.isPlaying()?this.pause():this.play()};
iAd.MediaPlayer.prototype.setMedia=function(a){if(iAd.Utils.objectIsString(a))a=iAd.Media.mediaTypeForURL(this.getMediaClassType(),a);if(this._media!=a){this._media&&this.unregisterMedia(this._media);this._media=a;a!=null&&a.playbackState==iAd.Media.PLAYBACK_STATE_PLAYING&&this.registerMedia(a)}};iAd.MediaPlayer.prototype.setLoop=function(a){this._loop=a;this.syncMediaProperties()};iAd.MediaPlayer.prototype.syncMediaProperties=function(){if(this._media)this._media.loop=this._loop};
iAd.MediaPlayer.prototype.registerMedia=function(a){if(a._mediaPlayer==this)return false;var b=a._mediaPlayer;b&&b.unregisterMedia(a);a._mediaPlayer=this;this.syncMediaProperties();return true};iAd.MediaPlayer.prototype.unregisterMedia=function(a){if(a._mediaPlayer!=this)return false;a._mediaPlayer=null;a.pause();return true};iAd.MediaPlayer.prototype.enterPlaybackState=function(a){this.playbackState&&this.layer.removeClassName(this.playbackState);(this.playbackState=a)&&this.layer.addClassName(a)};
iAd.MediaPlayer.prototype.isPlaying=function(){return this._media&&this._media._mediaPlayer==this?this._media.playbackState==iAd.Media.PLAYBACK_STATE_PLAYING:false};iAd.MediaPlayer.prototype.isPaused=function(){return this._media&&this._media._mediaPlayer==this?this._media.playbackState==iAd.Media.PLAYBACK_STATE_PAUSED:false};iAd.MediaPlayer.prototype.isWaiting=function(){return this._media&&this._media._mediaPlayer==this?this._media.playbackState==iAd.Media.PLAYBACK_STATE_WAITING:false};
iAd.MediaPlayer.prototype.mediaPlaybackDidStart=function(){this.dispatchNotification(iAd.MediaPlayer.PLAYBACK_DID_START,this.delegate);this.enterPlaybackState(iAd.MediaPlayer.PLAYING_STATE)};iAd.MediaPlayer.prototype.mediaPlaybackDidPause=function(){this.dispatchNotification(iAd.MediaPlayer.PLAYBACK_DID_PAUSE,this.delegate);this.enterPlaybackState(iAd.MediaPlayer.PAUSED_STATE)};
iAd.MediaPlayer.prototype.mediaPlaybackDidEnd=function(){this.dispatchNotification(iAd.MediaPlayer.PLAYBACK_DID_END,this.delegate);this.enterPlaybackState(iAd.MediaPlayer.ENDED_STATE)};iAd.MediaPlayer.prototype.mediaPlaybackDidBeginWaiting=function(){this.dispatchNotification(iAd.MediaPlayer.PLAYBACK_DID_BEGIN_WAITING,this.delegate);this.enterPlaybackState(iAd.MediaPlayer.WAITING_STATE)};
iAd.MediaPlayer.prototype.mediaPlaybackDidEndWaiting=function(){this.dispatchNotification(iAd.MediaPlayer.PLAYBACK_DID_END_WAITING,this.delegate)};iAd.MediaPlayer.prototype.mediaDidUpdateTime=function(a,b){this.dispatchNotification(iAd.MediaPlayer.DID_UPDATE_TIME,this.delegate,[["time",b]])};iAd.MediaPlayer.prototype.mediaDidUnload=function(){this.enterPlaybackState(null)};iAd.Class({name:"iAd.AudioPlayer",superclass:iAd.MediaPlayer,synthesizedProperties:["audio"],cssClassName:"ad-audio-player",collectionAccessor:"audioPlayers"});
iAd.AudioPlayer.prototype.getMediaAttributeName=function(){return"ad-audio"};iAd.AudioPlayer.prototype.getMediaClassType=function(){return iAd.Audio};iAd.AudioPlayer.prototype.setAudio=function(a){this.media=a};iAd.AudioPlayer.prototype.getAudio=function(){return this.media};iAd.Class({name:"iAd.Video",superclass:iAd.Media,synthesizedProperties:["showsControls","playsInline","view"]});iAd.Video.DID_CHANGE_FULLSCREEN="videoDidChangeFullscreen";
iAd.Video.prototype.init=function(a){this._playsInline=true;this._isFullscreen=this._showsControls=false;this._view=null;this.callSuper(a)};iAd.Video.prototype.isFullscreenAllowed=function(){return this.element.webkitSupportsFullscreen};iAd.Video.prototype.enterFullscreen=function(){if(this.isFullscreenAllowed()){this.element.webkitEnterFullScreen();return true}return false};
iAd.Video.prototype.exitFullscreen=function(){if(this.isFullscreenAllowed()&&this.isFullscreen()){this.element.webkitExitFullScreen();return true}return false};iAd.Video.prototype.isFullscreen=function(){return this._isFullscreen};iAd.Video.prototype.addMediaEventListeners=function(){this.callSuper();var a=this.element;a.addEventListener("webkitbeginfullscreen",this);a.addEventListener("webkitendfullscreen",this);a.addEventListener("webkitfullscreenchange",this)};
iAd.Video.prototype.removeMediaEventListeners=function(){this.callSuper();var a=this.element;a.removeEventListener("webkitbeginfullscreen",this);a.removeEventListener("webkitendfullscreen",this);a.removeEventListener("webkitfullscreenchange",this)};iAd.Video.prototype.handleWebkitbeginfullscreen=function(){this._isFullscreen=true;this.notifyFullscreenDidChange()};iAd.Video.prototype.handleWebkitendfullscreen=function(){this._isFullscreen=false;this.notifyFullscreenDidChange()};
iAd.Video.prototype.handleWebkitfullscreenchange=function(){this._isFullscreen=document.webkitIsFullScreen&&document.webkitCurrentFullScreenElement==this.element;this.notifyFullscreenDidChange()};iAd.Video.prototype.notifyFullscreenDidChange=function(){this.dispatchMediaNotification(iAd.Video.DID_CHANGE_FULLSCREEN,[["fullscreen",this.isFullscreen()]])};iAd.Video.prototype.setPlaysInline=function(a){if(this._playsInline!=a){this._playsInline=a;this.updateElementAttributes()}};
iAd.Video.prototype.setShowsControls=function(a){if(this._showsControls!=a){this._showsControls=a;this.updateElementAttributes()}};iAd.Video.prototype.updateElementAttributes=function(){if(this._element){this.showsControls?this._element.setAttribute("controls",true):this._element.removeAttribute("controls");this.playsInline?this._element.setAttribute("webkit-playsinline",true):this._element.removeAttribute("webkit-playsinline")}};
iAd.Video.prototype.getElement=function(){if(!this._element){this._element=document.createElement("video");this.updateElementAttributes()}return this.callSuper()};iAd.Video.prototype.getView=function(){if(this._view==null){this._view=new iAd.VideoView;this._view.video=this}return this._view};iAd.Video.prototype.setView=function(){};iAd.Video.prototype.dispatchMediaNotification=function(a,b){this.notifyDelegate(a,this._view,b);this.callSuper(a,b)};
iAd.Video.videoForURL=function(a){return iAd.Media.mediaTypeForURL(iAd.Video,a)};iAd.Video.restoreFromArchive=function(a){return this.videoForURL(a.url)};iAd.Video.prototype.urlStrategy=function(a){return iAd.Video.urlStrategy?iAd.Video.urlStrategy(a):this.callSuper(a)};iAd.Video.prototype.loadReadyStrategy=function(a,b){return iAd.Video.loadReadyStrategy?iAd.Video.loadReadyStrategy(a,b):this.callSuper(a,b)};iAd.Video.loadReadyStrategy=null;iAd.Video.urlStrategy=null;
iAd.Class({name:"iAd.VideoView",superclass:iAd.View,cssClassName:"ad-video-view",synthesizedProperties:["video"],archivedProperties:["video"]});iAd.VideoView.prototype.willMoveToSuperview=function(a){if(this.superview!=null&&a!=null){this.removeVideoFromView();this.addVideoToViewIfRenderable()}};iAd.VideoView.prototype.layerWasRemovedFromDocument=function(){this.callSuper();this.removeVideoFromView()};iAd.VideoView.prototype.layerWasInsertedIntoDocument=function(){this.callSuper();this.addVideoToViewIfRenderable()};
iAd.VideoView.prototype.addVideoToViewIfRenderable=function(){this._video&&this._video.renderable&&this.addVideoToView()};iAd.VideoView.prototype.addVideoToView=function(){if(this._video&&!this.layer.contains(this._video.element)){this.layer.appendChild(this._video.element);this._video.elementWasInsertedIntoDocument()}};iAd.VideoView.prototype.removeVideoFromView=function(){if(this._video&&this._video.element.parentNode==this.layer){this.layer.removeChild(this._video.element);this._video.elementWasRemovedFromDocument()}};
iAd.VideoView.prototype.setVideo=function(a){this._video=a;this._video.addPropertyObserver("renderable",this,"videoRenderableDidUpdate")};iAd.VideoView.prototype.videoRenderableDidUpdate=function(){if(this._video)this._video.element.style.opacity=this._video.renderable?1:0};iAd.VideoView.prototype.mediaPlaybackWillStart=function(){this.addVideoToView();this.videoRenderableDidUpdate()};iAd.VideoView.prototype.mediaPlaybackDidStart=function(){this.videoRenderableDidUpdate()};
iAd.VideoView.prototype.mediaWillUnload=function(){this._video.element.style.opacity=0};iAd.VideoView.prototype.mediaDidUnload=function(){this.removeVideoFromView()};iAd.Class({name:"iAd.Video_5_0",superclass:iAd.Video,iOSVersion:"5.0",mixins:[iAd.VideoDOMReconstruct,iAd.VideoTouchEvents,iAd.VideoFullscreenLaunch,iAd.MediaCompetitionPause,iAd.MediaUnloadTearDown,iAd.MediaUnloadAndRestoreTime]});iAd.Media.registerMediaAdapter(iAd.Video,iAd.Video_5_0);
iAd.Class({name:"iAd.Video_4_3",superclass:iAd.Video,iOSVersion:"4.3",mixins:[iAd.VideoDOMReconstruct,iAd.VideoTouchEvents,iAd.VideoFullscreen,iAd.VideoInlineLock,iAd.MediaCompetitionUnload,iAd.MediaLoop,iAd.MediaUnloadTearDown,iAd.MediaUnloadAndRestoreTime]});iAd.Media.registerMediaAdapter(iAd.Video,iAd.Video_4_3);
iAd.Class({name:"iAd.Video_4_2",superclass:iAd.Video,iOSVersion:"4.2",mixins:[iAd.VideoDOMReconstruct,iAd.VideoTouchEvents,iAd.VideoFullscreen,iAd.VideoInlineLock,iAd.MediaCompetitionUnload,iAd.MediaForceLoad,iAd.MediaLoop,iAd.MediaUnloadTearDown,iAd.MediaUnloadAndRestoreTime]});iAd.Media.registerMediaAdapter(iAd.Video,iAd.Video_4_2);iAd.Class({name:"iAd.Video_iTunes",superclass:iAd.Video,context:"iTunes"});iAd.Video_iTunes.ITUNES_MEDIA_EVENTS=["play","playing","timeupdate","pause","ended","error"];
iAd.Video_iTunes.prototype.setPlaysInline=function(a){if(this._playsInline!=a&&this._playbackState==iAd.Media.PLAYBACK_STATE_PLAYING){iAd.Console.warn("iAd.Video: Cannot change the .playsInline property in iTunes while the video is playing.");return this._playsInline}if(this._playsInline!=a){this.unload();if(!a)this.loop=false;this.callSuper(a)}};
iAd.Video_iTunes.prototype.setLoop=function(a){!this.playsInline&&a?iAd.Console.warn("iAd.Video: Cannot set the .loop property to true in iTunes when playsInline is false."):this.callSuper(a)};iAd.Video_iTunes.prototype.getCanPlay=function(){if(this.playsInline)return this.callSuper();return true};iAd.Video_iTunes.prototype.getCanPlayThrough=function(){if(this.playsInline)return this.callSuper();return true};
iAd.Video_iTunes.prototype.getRenderable=function(){if(this.playsInline)return this.callSuper();return true};iAd.Video_iTunes.prototype.getSeeking=function(){if(this.playsInline)return this.callSuper();iAd.Console.warn("iAd.Video: Cannot access .seeking property in iTunes when playsInline is false.");return false};iAd.Video_iTunes.prototype.getDuration=function(){if(this.playsInline)return this.callSuper();return NaN};
iAd.Video_iTunes.prototype.closestBufferedIndex=function(){if(this.playsInline)return this.callSuper();return-1};iAd.Video_iTunes.prototype.getPercentLoaded=function(){if(this.playsInline)return this.callSuper();return 1};iAd.Video_iTunes.prototype.playElement=function(){if(this.playsInline)return this.callSuper();this._targetPlaybackState=iAd.Media.PLAYBACK_STATE_PLAYING;this.addMediaEventListeners();window.iTunes.play(this.resolvedURL)};
iAd.Video_iTunes.prototype.pause=function(){if(this.playsInline)return this.callSuper();iAd.Console.warn("iAd.Video: Cannot pause() in iTunes when playsInline is false.");return false};iAd.Video_iTunes.prototype.stop=function(){if(this.playsInline)return this.callSuper();return!(this._playbackState==iAd.Media.PLAYBACK_STATE_PAUSED&&this.time==0)};iAd.Video_iTunes.prototype.canSeekToTime=function(a){if(this.playsInline)return this.callSuper(a);return false};
iAd.Video_iTunes.prototype.seekToTime=function(){if(this.playsInline)return this.callSuper();iAd.Console.warn("iAd.Video: Cannot seekToTime() in iTunes when playsInline is false.");return false};
iAd.Video_iTunes.prototype.load=function(){if(this.playsInline)return this.callSuper();this.dispatchMediaNotification(iAd.Media.LOAD_WILL_START);this.dispatchMediaNotification(iAd.Media.LOAD_DID_START);this.dispatchMediaNotification(iAd.Media.LOAD_DID_PROGRESS,[["percentLoaded",this.percentLoaded]]);this.dispatchMediaNotification(iAd.Media.LOAD_DATA_AVAILABLE);this.dispatchMediaNotification(iAd.Media.LOAD_CAN_PLAY);this._loadReady=true;this.dispatchMediaNotification(iAd.Media.LOAD_IS_READY);this.enterLoadState(iAd.Media.LOAD_STATE_SUSPENDED);
return true};iAd.Video_iTunes.prototype.unload=function(){if(this.playsInline)return this.callSuper()};iAd.Video_iTunes.prototype.enterFullscreen=function(){try{return this.callSuper()}catch(a){iAd.Console.warn("Fullscreen playback is not supported without user interaction.");return false}};iAd.Video_iTunes.prototype.addMediaEventListeners=function(){if(this.playsInline)return this.callSuper();for(var a=iAd.Video_iTunes.ITUNES_MEDIA_EVENTS,b=0,c=a.length;b<c;b++)window.addEventListener(a[b],this)};
iAd.Video_iTunes.prototype.removeMediaEventListeners=function(){if(this.playsInline)return this.callSuper();for(var a=iAd.Video_iTunes.ITUNES_MEDIA_EVENTS,b=0,c=a.length;b<c;b++)window.removeEventListener(a[b],this)};iAd.Video_iTunes.prototype.handleTimeupdate=function(a){if(this.playsInline)return this.callSuper(a);a=window.iTunes.currentTime;this.clearTimeupdateWatchdogTimeout();if(this._time!=a){this._time=a;this.dispatchMediaNotification(iAd.Media.DID_UPDATE_TIME,[["time",this._time]])}};
iAd.Video_iTunes.prototype.handleEnded=function(a){if(this.playsInline)this.callSuper(a);else{this.enterPlaybackState(iAd.Media.PLAYBACK_STATE_ENDED);this.removeMediaEventListeners()}};iAd.Media.registerMediaAdapter(iAd.Video,iAd.Video_iTunes);iAd.Class({name:"iAd.VideoPlayer",superclass:iAd.MediaPlayer,synthesizedProperties:["video","showsControls","playsInline","posterImage","posterImageVisible"],cssClassName:"ad-video-player",collectionAccessor:"videoPlayers"});
iAd.VideoPlayer.POSTER_VISIBLE_STATE="ad-poster-image-visible";iAd.VideoPlayer.DID_CHANGE_FULLSCREEN="videoDidChangeFullscreen";iAd.VideoPlayer.prototype.init=function(a){this._playsInline=true;this._showsControls=false;this._posterImageVisible=true;this.callSuper(a)};iAd.VideoPlayer.prototype.getMediaAttributeName=function(){return"ad-video"};iAd.VideoPlayer.prototype.getMediaClassType=function(){return iAd.Video};iAd.VideoPlayer.prototype.isFullscreen=function(){return this.media.isFullscreen()};
iAd.VideoPlayer.prototype.layerWasCreated=function(){var a=this.posterView=new iAd.View;a.layer.addClassName("ad-poster-image");this.addSubview(a);this.layer.addClassName(iAd.VideoPlayer.POSTER_VISIBLE_STATE)};iAd.VideoPlayer.prototype.setValueForAttribute=function(a,b){if(b=="ad-poster-image")this.posterImage=iAd.Image.imageForURL(a,this.layerHasCustomAttribute("ad-has-hidpi-version"));else this.callSuper(a,b)};
iAd.VideoPlayer.prototype.setVideo=function(a){this.posterImageVisible=true;this.media=a};iAd.VideoPlayer.prototype.getVideo=function(){return this.media};iAd.VideoPlayer.prototype.setPosterImage=function(a){if(iAd.Utils.objectIsString(a))a=iAd.Image.imageForURL(a);if(this._posterImage!=a){this._posterImage&&this._posterImage.removePropertyObserver("loaded",this,"posterImageLoaded");this._posterImage=a;this.syncPosterImage()}};
iAd.VideoPlayer.prototype.setShowsControls=function(a){this._showsControls=a;this.syncMediaProperties()};iAd.VideoPlayer.prototype.setPlaysInline=function(a){this._playsInline=a;this.syncMediaProperties()};iAd.VideoPlayer.prototype.setSize=function(a){this.callSuper(a);this.syncMediaProperties()};
iAd.VideoPlayer.prototype.syncMediaProperties=function(){if(this._media){this._media.showsControls=this._showsControls;this._media.playsInline=this._playsInline;this._playsInline=this._media.playsInline;this.callSuper()}};iAd.VideoPlayer.prototype.registerMedia=function(a){var b=a.playbackState==iAd.Media.PLAYBACK_STATE_PLAYING;if(this.callSuper(a)){this.insertSubviewAtIndex(a.view,0);b&&this.callMethodNameAfterDelay("play",0)}};
iAd.VideoPlayer.prototype.unregisterMedia=function(a){if(this.callSuper(a)){this.posterImageVisible=true;a.view.superview==this&&a.view.removeFromSuperview()}};iAd.VideoPlayer.prototype.syncPosterImage=function(){var a=this.posterView.layer;if(this._posterImage==null)a.style.removeProperty("background-image");else if(this._posterImage){var b=this._posterImage;if(b.loaded)a.style.backgroundImage="url("+b.resolvedURL+")";else b.addPropertyObserver("loaded",this,"posterImageLoaded")}};
iAd.VideoPlayer.prototype.posterImageLoaded=function(a){a.removePropertyObserver("loaded",this,"posterImageLoaded");this.syncPosterImage()};iAd.VideoPlayer.prototype.setPosterImageVisible=function(a){if(this._posterImageVisible!=a){this._posterImageVisible=a;this.layer.toggleClassName(iAd.VideoPlayer.POSTER_VISIBLE_STATE,a)}};iAd.VideoPlayer.prototype.mediaPlaybackDidStart=function(a){this.posterImageVisible=false;this.callSuper(a)};
iAd.VideoPlayer.prototype.mediaPlaybackDidEnd=function(a){this.callSuper(a);a.exitFullscreen()};iAd.VideoPlayer.prototype.mediaDidUnload=function(a){this.posterImageVisible=true;this.callSuper(a)};iAd.VideoPlayer.prototype.videoDidChangeFullscreen=function(a,b){this.dispatchNotification(iAd.VideoPlayer.DID_CHANGE_FULLSCREEN,this.delegate,[["fullscreen",b]])};
iAd.Class({name:"iAd.ActivityIndicatorView",superclass:iAd.View,synthesizedProperties:["activityIndicatorViewStyle","hidesWhenStopped","animating","animationStyle","customIndicatorImage","autoSized"],archivedProperties:["activityIndicatorViewStyle","hidesWhenStopped","animating","animationStyle","customIndicatorImage","autoSized"],cssClassName:"ad-activity-indicator-view"});iAd.ActivityIndicatorView.collectionAccessor="activityIndicatorViews";iAd.ActivityIndicatorView.STYLE_WHITE="ad-white";
iAd.ActivityIndicatorView.STYLE_GRAY="ad-gray";iAd.ActivityIndicatorView.STYLE_CUSTOM="ad-custom";iAd.ActivityIndicatorView.ANIMATING_CSS="ad-animating";iAd.ActivityIndicatorView.SEGMENTS_CONTAINER_CSS="ad-segments-container";iAd.ActivityIndicatorView.ANIMATION_STYLE_STEPPED="ad-animation-stepped";iAd.ActivityIndicatorView.ANIMATION_STYLE_SMOOTH="ad-animation-smooth";iAd.ActivityIndicatorView.NUMBER_OF_SEGMENTS=12;iAd.ActivityIndicatorView.OPTIMAL_DIMENSION=74;
iAd.ActivityIndicatorView.prototype.init=function(a,b){this._activityIndicatorViewStyle=b||iAd.ActivityIndicatorView.STYLE_WHITE;this._autoSized=this._hidesWhenStopped=true;this.segmentsContainer=null;this._animating=false;this._animationStyle="";this.segments=[];this.callSuper(a);this.updateVisibility();this.animationStyle=this._animationStyle||iAd.ActivityIndicatorView.ANIMATION_STYLE_STEPPED;this.updateSegments()};
iAd.ActivityIndicatorView.prototype.setupLayer=function(){this.callSuper();if(this.layer.hasClassName(iAd.ActivityIndicatorView.STYLE_WHITE))this._activityIndicatorViewStyle=iAd.ActivityIndicatorView.STYLE_WHITE;else if(this.layer.hasClassName(iAd.ActivityIndicatorView.STYLE_GRAY))this._activityIndicatorViewStyle=iAd.ActivityIndicatorView.STYLE_GRAY;else if(this.layer.hasClassName(iAd.ActivityIndicatorView.STYLE_CUSTOM))this._activityIndicatorViewStyle=iAd.ActivityIndicatorView.STYLE_CUSTOM};
iAd.ActivityIndicatorView.prototype.layerWasCreated=function(){this.callSuper();this.activityIndicatorViewStyle=this._activityIndicatorViewStyle;this.scaleContainer=document.createElement("div");this.scaleContainer.className="ad-scale-container";this.segmentsContainer=document.createElement("div");this.segmentsContainer.className=iAd.ActivityIndicatorView.SEGMENTS_CONTAINER_CSS;this.scaleContainer.appendChild(this.segmentsContainer);if(this._size.equals(iAd.Size.ZERO_SIZE))this._size=new iAd.Size(37,
37);this._activityIndicatorViewStyle!==iAd.ActivityIndicatorView.STYLE_CUSTOM&&this.createSegments();this.layer.appendChild(this.scaleContainer)};iAd.ActivityIndicatorView.prototype.setSize=function(a){if(a.width!=a.height)a.width=a.height;this.callSuper(a);this.updateSegments()};
iAd.ActivityIndicatorView.prototype.setValueForAttribute=function(a,b){switch(b){case "ad-custom-indicator-image":this.customIndicatorImage=iAd.Image.imageForURL(a,this.layerHasCustomAttribute("ad-has-hidpi-version"));break;default:this.callSuper(a,b)}};iAd.ActivityIndicatorView.prototype.setHidesWhenStopped=function(a){this._hidesWhenStopped=a;this.updateVisibility()};
iAd.ActivityIndicatorView.prototype.setActivityIndicatorViewStyle=function(a){if(this.layer){this.layer.removeClassName(this._activityIndicatorViewStyle);this.layer.addClassName(a)}this._activityIndicatorViewStyle=a};iAd.ActivityIndicatorView.prototype.setAnimating=function(a){if(this._animating!=a){this._animating=a;this.layer.toggleClassName(iAd.ActivityIndicatorView.ANIMATING_CSS,a);this.updateVisibility()}};
iAd.ActivityIndicatorView.prototype.setAnimationStyle=function(a){if(a!=this._animationStyle){this.layer.removeClassName(this._animationStyle);this.layer.addClassName(a);this._animationStyle=a}};
iAd.ActivityIndicatorView.prototype.setCustomIndicatorImage=function(a){if(a==null||a.url==null){this._customIndicatorImage=null;this.layer.removeClassName(iAd.ActivityIndicatorView.STYLE_CUSTOM);this.segmentsContainer.style.backgroundImage="";this.segments.length||this.createSegments();this.updateSegments()}else{this._customIndicatorImage=a;a.loaded?this.renderImage():a.addPropertyObserver("loaded",this)}};
iAd.ActivityIndicatorView.prototype.setAutoSized=function(a){if(a!=this._autoSized)(this._autoSized=a)&&this.autoSize()};iAd.ActivityIndicatorView.prototype.handlePropertyChange=function(a,b){if(b=="loaded"){this.renderImage();this.removePropertyObserver("loaded",this)}};
iAd.ActivityIndicatorView.prototype.renderImage=function(){this._autoSized&&this.autoSize();this.layer.addClassName(iAd.ActivityIndicatorView.STYLE_CUSTOM);this.segmentsContainer.style.backgroundImage="url("+this._customIndicatorImage.resolvedURL+")";this.segmentsContainer.style.webkitTransformOrigin="";this.scaleContainer.style.webkitTransform="scale(1)"};
iAd.ActivityIndicatorView.prototype.autoSize=function(){if(this._customIndicatorImage&&this._customIndicatorImage.loaded)this.size=new iAd.Size(this._customIndicatorImage.width,this._customIndicatorImage.height)};iAd.ActivityIndicatorView.prototype.updateVisibility=function(){this.hidden=this._hidesWhenStopped&&!this._animating};
iAd.ActivityIndicatorView.prototype.createSegments=function(){for(var a=[],b=iAd.ActivityIndicatorView.NUMBER_OF_SEGMENTS,c=this.segmentsContainer;b--;){var d=document.createElement("div");d.style.opacity=Math.max(1-b/10,0.3);c.appendChild(d);a.push(d)}this.segments=a};
iAd.ActivityIndicatorView.prototype.updateSegments=function(){if(!(!this.segments.length||this.layer.hasClassName(iAd.ActivityIndicatorView.STYLE_CUSTOM))){var a=this._size.width/iAd.ActivityIndicatorView.OPTIMAL_DIMENSION,b=a<1?iAd.ActivityIndicatorView.OPTIMAL_DIMENSION:this._size.width,c=Math.floor(b/2),d=b/74,e=Math.floor(3*d)*2,f=Math.floor(10*d)*2,g=Math.floor((b-e)/2);b=Math.floor((b-f)/2);d=Math.floor(3*d);var h=this.segments.length;angle_increment=360/h;for(var i,j=0;j<h;j++){i=this.segments[j];
i.style.left=g+"px";i.style.top=b+"px";i.style.width=e+"px";i.style.height=f+"px";i.style.webkitBorderRadius=d+"px";i.style.webkitTransform="rotate("+angle_increment*j+"deg) translateY(-"+b+"px)"}this.segmentsContainer.style.webkitTransformOrigin=c+"px "+c+"px";this.scaleContainer.style.webkitTransform=a<1?"scale("+a+")":""}};iAd.Cell={};iAd.Cell.CELL_CLASS_CSS="ad-cell";iAd.Cell.CELL_FOCUSED_CSS="ad-focused-cell";iAd.Cell.getFocusedWithinContainer=function(){return!!this._focusedWithinContainer};
iAd.Cell.setFocusedWithinContainer=function(a){this.setFocusedWithinContainerAnimated(a,false)};iAd.Cell.setFocusedWithinContainerAnimated=function(a){this._focusedWithinContainer=a;this.layer.toggleClassName(iAd.Cell.CELL_FOCUSED_CSS,a)};iAd.Cell.prepareForReuse=function(){this.setFocusedWithinContainerAnimated(false,false)};iAd.Utils.setupDisplayNames(iAd.Cell,"iAd.Cell");iAd.CellContainer={};iAd.CellContainer.init=function(){this._focusedIndex=this.numberOfCells=0;this.cells=[]};
iAd.CellContainer.getFocusedIndex=function(){return this._focusedIndex};iAd.CellContainer.setFocusedIndex=function(a){this.focusCellAtIndexAnimated(a,false)};iAd.CellContainer.cellAtIndex=function(a){return this.cells[a]};iAd.CellContainer.focusCellAtIndexAnimated=function(a){this._focusedIndex=a};iAd.CellContainer.insertCellsAtIndexes=function(a){iAd.Console.warn("CellContainer: insertCellsAtIndexes is deprecated. Use insertCellsAtIndexesAnimated instead.");this.insertCellsAtIndexesAnimated(a,false)};
iAd.CellContainer.insertCellsAtIndexesAnimated=function(a,b){this.numberOfCells+=a.length;for(var c=Math.min.apply(Math,a);c<this.numberOfCells;c++){if(a.indexOf(c)>-1){var d=this.dataSource[iAd.CellContainer.CELL_AT_INDEX_DELEGATE](this,c);d.layer.addClassName(iAd.Cell.CELL_CLASS_CSS);this.cells.splice(c,0,d);this.insertSubviewAtIndex(this.viewForCellAtIndex(c),c)}this.cells[c]._index=c}this.updateLayoutAnimated(b)};iAd.CellContainer.viewForCellAtIndex=function(a){return this.cells[a]};
iAd.CellContainer.removeCellsAtIndexes=function(a){iAd.Console.warn("CellContainer: removeCellsAtIndexes is deprecated. Use removeCellsAtIndexesAnimated instead.");this.removeCellsAtIndexesAnimated(a,false)};
iAd.CellContainer.removeCellsAtIndexesAnimated=function(a,b){for(var c=0,d=Math.min.apply(Math,a);d<this.numberOfCells;d++){var e=this.cells[d];if(a.indexOf(d+c)>-1){this.viewForCellAtIndex(d).removeFromSuperview();this.cells.splice(d,1);e.layer.removeClassName(iAd.Cell.CELL_CLASS_CSS);delete e._index;c++;this.numberOfCells--;d--}else e._index=d}this.updateLayoutAnimated(b);this.numberOfCells>0&&a.indexOf(this.focusedIndex)>-1&&this.focusCellAtIndexAnimated(Math.min(this.focusedIndex,this.numberOfCells-
1),b,true)};iAd.CellContainer.dequeueReusableCell=function(){return null};
iAd.CellContainer.reloadData=function(){if(iAd.Utils.objectHasMethod(this.dataSource,iAd.CellContainer.NUMBER_OF_CELLS_DELEGATE)&&iAd.Utils.objectHasMethod(this.dataSource,iAd.CellContainer.CELL_AT_INDEX_DELEGATE)){if(this.numberOfCells>0){for(var a=[],b=0;b<this.numberOfCells;b++)a.push(b);this.removeCellsAtIndexesAnimated(a,false)}a=this.dataSource[iAd.CellContainer.NUMBER_OF_CELLS_DELEGATE](this);var c=[];for(b=0;b<a;b++)c.push(b);this.insertCellsAtIndexesAnimated(c,false);this.focusCellAtIndexAnimated(0,
false,true)}};iAd.CellContainer.updateLayout=function(){iAd.Console.warn("CellContainer: updateLayout is deprecated. Use updateLayoutAnimated instead.");this.updateLayoutAnimated(false)};iAd.CellContainer.updateLayoutAnimated=function(){};
iAd.CellContainer.willFocusCell=function(a,b,c){this.dispatchNotification(iAd.CellContainer.WILL_FOCUS_CELL_DELEGATE,this.delegate,[["cell",a],["index",b]]);if(a=this.cellAtIndex(this.focusedIndex))(a.setFocusedWithinContainerAnimated||iAd.Cell.setFocusedWithinContainerAnimated).call(a,false,c)};
iAd.CellContainer.didFocusCell=function(a,b,c){(a.setFocusedWithinContainerAnimated||iAd.Cell.setFocusedWithinContainerAnimated).call(a,true,c);this.dispatchNotification(iAd.CellContainer.DID_FOCUS_CELL_DELEGATE,this.delegate,[["cell",a],["index",b]])};iAd.CellContainer.NUMBER_OF_CELLS_DELEGATE="numberOfCellsInContainer";iAd.CellContainer.CELL_AT_INDEX_DELEGATE="cellAtIndexInContainer";iAd.CellContainer.WILL_FOCUS_CELL_DELEGATE="containerWillFocusCellAtIndex";
iAd.CellContainer.DID_FOCUS_CELL_DELEGATE="containerDidFocusCellAtIndex";iAd.Utils.setupDisplayNames(iAd.CellContainer,"iAd.CellContainer");iAd.Class("iAd.CellContainerDeclarativeDataSource");
iAd.CellContainerDeclarativeDataSource.prototype.init=function(a,b){this.managesLayers=!!b;this.callSuper();this.numberOfCells=a.childElementCount;this.cells=[];for(var c=Array.prototype.slice.call(a.children),d,e,f=0,g=c.length;f<g;f++){d=c[f];e=d.hasOwnProperty("_view");if(!e){new iAd.View(d);iAd.Console.warn(this.constructor.displayName+" created a view for the child element at index "+f+". Non view-based cells are deprecated; please ensure all elements that should be cells are instances of iAd.View or one of its subclasses.")}this.cells.push(d._view);
b||(e?d._view.removeFromSuperview():a.removeChild(d))}};iAd.CellContainerDeclarativeDataSource.prototype.numberOfCellsInContainer=function(){return this.numberOfCells};iAd.CellContainerDeclarativeDataSource.prototype.cellAtIndexInContainer=function(a,b){return this.cells[b]};
iAd.Class({name:"iAd.CarouselView",superclass:iAd.View,mixins:[iAd.CellContainer],synthesizedProperties:["rotation","snapsToCells","cellPadding","cellLength","orientation","focusedIndex"],archivedProperties:["rotation","snapsToCells","cellPadding","cellLength","orientation","focusedIndex","centersSelection","centerSelectionDuration"],excludedProperties:["subviews"],cssClassName:"ad-carousel-view",collectionAccessor:"carouselViews"});iAd.CarouselView.VERTICAL_ORIENTATION=0;
iAd.CarouselView.HORIZONTAL_ORIENTATION=1;iAd.CarouselView.FOCUS_ROTATION_DURATION=0.5;iAd.CarouselView.SNAP_ROTATION_DURATION=0.25;iAd.CarouselView.WILL_SELECT_CELL_AT_INDEX_DELEGATE="carouselViewWillSelectCellAtIndex";iAd.CarouselView.DID_SELECT_CELL_AT_INDEX_DELEGATE="carouselViewDidSelectCellAtIndex";iAd.CarouselView.CELL_ACTIVE_CSS="ad-active";iAd.CarouselView.ANIMATED_LAYOUT_CSS="ad-animated";iAd.CarouselView.PERSPECTIVE=1E3;iAd.CarouselView.MAX_TIME_FOR_TRACKING_POINTS=100;
iAd.CarouselView.prototype.init=function(a){this.delegate=this.dataSource=null;this.centersSelection=true;this.centerSelectionDuration=-1;this.numberOfCells=0;this.cellSize=new iAd.Size;this.touchedCell=null;this.showingHighlight=this.busySelecting=this.busyFocusing=false;this.currentHighlightCell=null;this.trackingMoved=false;this._rotation=0;this._snapsToCells=false;this._orientation=iAd.CarouselView.VERTICAL_ORIENTATION;this._cellLength=100;this._cellPadding=0;this.trackingPoints=[];this.animator=
new iAd.Animator(2,this,[0.211196,0.811224,0.641221,0.979592]);iAd.CellContainer.init.call(this,a);this.callSuper(a);this.hostingLayer.addEventListener("webkitTransitionEnd",this,false);this.userInteractionEnabled=true};iAd.CarouselView.prototype.willRestoreFromArchive=function(a){this.callSuper(a);this.archivedProperties={focusedIndex:a.focusedIndex,rotation:a.rotation}};
iAd.CarouselView.prototype.setupLayer=function(){this.callSuper();this.setupChildLayers();this.dataSource=new iAd.CellContainerDeclarativeDataSource(this.hostingLayer,true)};iAd.CarouselView.prototype.createLayer=function(){this.callSuper();this.setupChildLayers()};
iAd.CarouselView.prototype.setValueForAttribute=function(a,b){if(b=="ad-orientation")this.orientation=a=="horizontal"?iAd.CarouselView.HORIZONTAL_ORIENTATION:iAd.CarouselView.VERTICAL_ORIENTATION;else if(b=="ad-focused-index")this.archivedProperties={focusedIndex:a};else this.callSuper(a,b)};iAd.CarouselView.prototype.initWithDeclarativeBacking=function(){this.callSuper();this.reloadData()};
iAd.CarouselView.prototype.setSize=function(a){if(!a.equals(iAd.Size.ZERO_SIZE))if(!this._size.equals(a)){if(this.numberOfCells>0){var b=iAd.CarouselView.PERSPECTIVE,c=this.isVertical()?a.height:a.width;b=b/(2*b/c+Math.PI/this.numberOfCells-1)*Math.tan(Math.PI/this.numberOfCells)/0.5;c=this._cellLength+this._cellPadding;this._cellLength=Math.floor(this._cellLength/c*b);this._cellPadding=Math.floor(this._cellPadding/c*b)}this._size=a;this.updateLayoutAnimated(false)}};
iAd.CarouselView.prototype.layerWasInsertedIntoDocument=function(){this.callSuper();this.dataSource&&this.cells.length==0&&this.reloadData()};
iAd.CarouselView.prototype.setupChildLayers=function(){var a=this.layer,b=a.querySelector(".ad-aligner");if(b){this.aligner=b;this.hostingLayer=b.querySelector(".ad-hosting-layer");iAd.Console.warn("CarouselView: Aligner and hosting layer elements are no longer required in declarative markup. Please provide cells as direct children using <div> elements.")}else{b=this.aligner=document.createElement("div");b.className="ad-aligner";var c=this.hostingLayer=b.appendChild(document.createElement(this.usesDeclarativeBacking?
"div":"ul"));for(c.className="ad-hosting-layer";a.firstChild;)c.appendChild(a.firstChild);a.appendChild(b)}};iAd.CarouselView.prototype.isVertical=function(){return this._orientation==iAd.CarouselView.VERTICAL_ORIENTATION};iAd.CarouselView.prototype.reloadData=function(){iAd.CellContainer.reloadData.call(this);this.rotation=0;var a=this.archivedProperties;if(a){this.focusCellAtIndexAnimated(a.focusedIndex,false);this.rotation=a.rotation;delete this.archivedProperties}};
iAd.CarouselView.prototype.updateLayoutAnimated=function(a){if(!(this.usesDeclarativeBacking&&!this.declarativeLayerWasInitialized)){a&&this.layer.addClassName(iAd.CarouselView.ANIMATED_LAYOUT_CSS);a=this.isVertical();var b=this.cellPadding==0?1:0;if(a){this.cellSize.width=this.size.width;this.cellSize.height=this.cellLength+b}else{this.cellSize.width=this.cellLength+b;this.cellSize.height=this.size.height}this.updateRadiusAndSize();this.aligner.style.webkitTransform="translateZ("+-this.radius+"px)";
b=a?1:0;for(var c=a?0:1,d=360/this.numberOfCells,e=a?-this.cellSize.height/2:0,f=a?0:-this.cellSize.width/2,g=0;g<this.numberOfCells;g++){var h=this.cells[g];h.setLayerStyle({top:e+"px",left:f+"px",width:this.cellSize.width+"px",height:this.cellSize.height+"px","-webkit-transform":"rotate3d("+b+", "+c+", 0, "+-d*h._index+"deg) translateZ("+this.radius+"px)"})}this.hostingLayer.style.left=(a?0:this._size.width/2)+"px";this.hostingLayer.style.top=(a?this._size.height/2:0)+"px";this.setLayerStyle({"-webkit-perspective-origin":(a?
this.cellSize.width/2:this._size.width/2)+"px "+(a?this._size.height/2:this.cellSize.height/2)+"px"})}};
iAd.CarouselView.prototype.updateRadiusAndSize=function(){var a=this.radius=Math.ceil(0.5*(this._cellLength+this._cellPadding)/Math.tan(Math.PI/this.numberOfCells)),b=iAd.CarouselView.PERSPECTIVE;b=b/(b+a-(this._cellLength+this._cellPadding)/2)*2*a;if(this.isVertical()){a=this._size.width;b=b}else{a=b;b=this._size.height}a=new iAd.Size(Math.ceil(a),Math.ceil(b));if(!this._size.equals(a)){this._size=a;this.notifyPropertyChange("size")}};
iAd.CarouselView.prototype.setRotation=function(a){if(!(isNaN(a)||a==this._rotation)){this._rotation=a%360;this.updateHostingLayerRotation();!this.tracking&&!this.busySelecting&&!this.animator.animating&&this.focusCenteredCell()}};iAd.CarouselView.prototype.updateHostingLayerRotation=function(){var a=this.isVertical();this.hostingLayer.style.webkitTransform="rotate3d("+(a?1:0)+", "+(a?0:1)+", 0, "+this._rotation+"deg)"};
iAd.CarouselView.prototype.setCellPadding=function(a){if(a!=this._cellPadding){this._cellPadding=a;this.updateLayoutAnimated(false)}};iAd.CarouselView.prototype.setCellLength=function(a){if(this._cellLength!=a){this._cellLength=a;this.updateLayoutAnimated(false)}};iAd.CarouselView.prototype.setOrientation=function(a){if(a!=this._orientation){this._orientation=a;this.updateHostingLayerRotation();this.updateLayoutAnimated(false)}};
iAd.CarouselView.prototype.setFocusedIndex=function(a){this.focusCellAtIndexAnimated(a,true)};iAd.CarouselView.prototype.setSnapsToCells=function(a){if(this._snapsToCells!=a)(this._snapsToCells=a)&&this.focusCenteredCell()};
iAd.CarouselView.prototype.focusCellAtIndexAnimated=function(a,b,c){a=iAd.Number.clampValue(a,0,this.numberOfCells-1);if(!(this._focusedIndex===a&&!c)){c=a*(360/this.numberOfCells);if(c===this.rotation)b=false;this.willFocusCell(this.cellAtIndex(a),a,b);this._focusedIndex=a;if(b){a=Math.abs(c-this.rotation);if(a>90)a=c<this.rotation?c+360-this.rotation:this.rotation+360-c;b=this.centerSelectionDuration;if(b<0)b=Math.min(60,a)/60*iAd.CarouselView.FOCUS_ROTATION_DURATION;this.hostingLayer.style.webkitTransitionDuration=
Math.max(0.1,b)+"s";this.busyFocusing=true;this.rotation=c}else{this.hostingLayer.style.webkitTransitionDuration="0";this.rotation=c;this.didFocusCell(this.cellAtIndex(a),a,false)}}};
iAd.CarouselView.prototype.focusCenteredCell=function(){if(this.numberOfCells!=0){var a=this.indexAtAngle(this._rotation),b=a!=this._focusedIndex,c=this.cellAtIndex(a);if(b){this.willFocusCell(c,c._index,this._snapsToCells);this._focusedIndex=a}if(this._snapsToCells){this.busyFocusing=true;if(b)this.hostingLayer.style.webkitTransitionDuration=iAd.CarouselView.SNAP_ROTATION_DURATION+"s";this.rotation=a*(360/this.numberOfCells)}else b&&this.didFocusCell(c,c._index,false)}};
iAd.CarouselView.prototype.handleEvent=function(a){if(!(this.busySelecting&&a.type!="webkitTransitionEnd")){this.callSuper(a);if(a.type=="webkitTransitionEnd")if(a.target==this.hostingLayer)this.transitionEnded(a);else a.target.parentElement==this.hostingLayer&&this.layer.removeClassName(iAd.CarouselView.ANIMATED_LAYOUT_CSS)}};
iAd.CarouselView.prototype.touchesBegan=function(a){this.touchedCell=null;for(var b=a.target;b!=this.layer;){if(b.hasClassName(iAd.Cell.CELL_CLASS_CSS)){this.touchedCell=b._view;break}b=b.parentNode}if(this.touchedCell!=null){this.callSuper(a);this.hostingLayer.style.webkitTransitionDuration=0;(this.wasStopppedDuringAnimation=this.animator.animating)?this.stopAnimation():this.highlightCurrentCell();this.startRotation=this.rotation;this.startTouchPosition=iAd.Point.fromEventInElement(a,this.layer);
this.startAngleY=this.angleForPosition(this._size.height/2-this.startTouchPosition.y);this.startAngleX=this.angleForPosition(this._size.width/2-this.startTouchPosition.x);this.trackingMoved=false;this.trackingPoints=[];this.storeEventLocation(this.startTouchPosition)}};
iAd.CarouselView.prototype.touchesMoved=function(a){this.callSuper(a);this.removeCellHighlight();a=iAd.Point.fromEventInElement(a,this.layer);this.storeEventLocation(a);this.trackingMoved=true;a=this.isVertical()?this.angleForPosition(this._size.height/2-a.y)-this.startAngleY:this.startAngleX-this.angleForPosition(this._size.width/2-a.x);this.rotation=this.startRotation+iAd.Number.radiansToDegrees(a)};
iAd.CarouselView.prototype.touchesEnded=function(a){this.callSuper(a);if(this.touchedCell!=null&&!this.trackingMoved&&!this.wasStopppedDuringAnimation){a=this.touchedCell._index===this._focusedIndex;this.cellIsBeingSelected(a);this.centersSelection&&this.focusCellAtIndexAnimated(this.touchedCell._index,true);if(this.busyFocusing)this.busySelecting=true;else{this.cellWasSelected(a);this.removeCellHighlight()}}else{this.startAnimating();!this.animator.animating&&!this.busyFocusing&&this.focusCenteredCell()}};
iAd.CarouselView.prototype.transitionEnded=function(){this.hostingLayer.style.webkitTransitionDuration="0";if(this.busyFocusing){this.busyFocusing=false;this.didFocusCell(this.cellAtIndex(this.focusedIndex),this.focusedIndex,true)}if(this.busySelecting){this.busySelecting=false;this.cellWasSelected(this.cellAtIndex(this.focusedIndex),false);this.removeCellHighlight()}};iAd.CarouselView.prototype.angleForPosition=function(a){return Math.atan2(a,Math.sqrt(Math.pow(this.radius,2)-Math.pow(a,2)))};
iAd.CarouselView.prototype.storeEventLocation=function(a){this.trackingPoints.push({pos:this.isVertical()?a.y:a.x,date:new Date});this.trackingPoints.length>10&&this.trackingPoints.shift()};
iAd.CarouselView.prototype.startAnimating=function(){for(var a=-1,b=this.trackingPoints.length-1;b>0;--b)if(this.trackingPoints[b].pos!=0){a=b-1;break}if(a<0)return false;var c=a+1;b=this.trackingPoints[c].date-this.trackingPoints[a].date;a=this.trackingPoints[c].pos-this.trackingPoints[a].pos;if(Math.abs(a)<3||b>iAd.CarouselView.MAX_TIME_FOR_TRACKING_POINTS)return false;a=-Math.atan(a/this.radius);b=Math.abs(a);b=b<0.075?90:b<0.15?180:b<0.225?270:360;a=a<0?this.isVertical()?"top-":"right-":this.isVertical()?
"bottom-":"left-";if(a=="left-"||a=="top-")b=-b;this.rotationBeforeAnimation=this.rotation;this.animationAngle=b;if(this._snapsToCells){a=this.rotation+this.animationAngle;this.animationAngle-=a-Math.round(a/(360/this.numberOfCells))*(360/this.numberOfCells)}this.animator.start();return true};iAd.CarouselView.prototype.animationDidIterate=function(a,b){this.rotation=this.rotationBeforeAnimation+b*this.animationAngle};
iAd.CarouselView.prototype.animationDidEnd=function(){var a=this.indexAtAngle(this.rotation);this.touchedCell=this.cellAtIndex(a);this.willFocusCell(this.touchedCell,this.touchedCell._index,true);this._focusedIndex=a;this.busyFocusing=false;this.didFocusCell(this.touchedCell,this.touchedCell._index,true)};iAd.CarouselView.prototype.stopAnimation=function(){this.animator.stop()};
iAd.CarouselView.prototype.highlightCurrentCell=function(){if(this.touchedCell!=null){this.currentHighlightCell!=null&&this.removeCellHighlight();this.touchedCell.layer.addClassName(iAd.CarouselView.CELL_ACTIVE_CSS);this.currentHighlightCell=this.touchedCell;this.showingHighlight=true}};
iAd.CarouselView.prototype.removeCellHighlight=function(){if(!(!this.showingHighlight||this.touchedCell==null)){this.currentHighlightCell.layer.removeClassName(iAd.CarouselView.CELL_ACTIVE_CSS);this.currentHighlightCell=null;this.showingHighlight=false}};iAd.CarouselView.prototype.cellIsBeingSelected=function(a){this.dispatchNotification(iAd.CarouselView.WILL_SELECT_CELL_AT_INDEX_DELEGATE,this.delegate,[["index",this.touchedCell._index],["isInstantaneous",a]])};
iAd.CarouselView.prototype.cellWasSelected=function(a){this.dispatchNotification(iAd.CarouselView.DID_SELECT_CELL_AT_INDEX_DELEGATE,this.delegate,[["index",this.touchedCell._index],["wasInstantaneous",a]]);this.removeCellHighlight()};iAd.CarouselView.prototype.indexAtAngle=function(a){a=Math.round(a/(360/this.numberOfCells))%this.numberOfCells;if(a<0)a+=this.numberOfCells;return a};
iAd.Class({name:"iAd.FlowView",superclass:iAd.View,mixins:[iAd.CellContainer],synthesizedProperties:["sidePadding","focusedZOffset","sideZOffset","cellGap","dragMultiplier","cellRotation","flipDuration","perspective","priorityOrdering","delegateIndexNotificationDelay","trackCamera","focusedIndex","frontCellIndex","frontZOffset"],archivedProperties:["sidePadding","focusedZOffset","sideZOffset","cellGap","dragMultiplier","cellRotation","flipDuration","perspective","priorityOrdering","delegateIndexNotificationDelay",
"trackCamera","focusedIndex","cellSize"],excludedProperties:["subviews"],cssClassName:"ad-flow-view",collectionAccessor:"flowViews"});iAd.FlowView.DID_TAP_FRONT_CELL_NOTIFICATION="flowViewDidTapFrontCell";iAd.FlowView.DID_SELECT_CELL_NOTIFICATION="flowViewDidSelectCell";iAd.FlowView.DID_BEGIN_SWIPE_NOTIFICATION="flowViewDidBeginSwipe";iAd.FlowView.DID_END_SWIPE_NOTIFICATION="flowViewDidEndSwipe";iAd.FlowView.ANIMATED_CELL_CSS="ad-animated-cells";iAd.FlowView.ACCELERATION=8;
iAd.FlowView.MAX_TRACKING_TIME=200;iAd.FlowView.TAP_EVENT_DURATION=300;iAd.FlowView.SWIPE_THRESHOLD_ANGLE=iAd.Number.degreesToRadians(45);iAd.FlowView.DECELERATION_FRICTION_FACTOR=0.9;iAd.FlowView.DESIRED_ANIMATION_FRAME_RATE=1/60;iAd.FlowView.MINIMUM_VELOCITY=0.05;iAd.FlowView.MIN_VELOCITY_FOR_DECELERATION=1;iAd.FlowView.NUM_MOVE_EVENTS=3;iAd.FlowView.PENETRATION_DECELERATION=0.03;iAd.FlowView.PENETRATION_ACCELERATION=0.08;
iAd.FlowView.prototype.init=function(a){this.delegate=this.dataSource=null;this._sidePadding=160;this._focusedZOffset=0;this._sideZOffset=-100;this._cellGap=25;this._cellRotation=45;this._dragMultiplier=1;this._flipDuration=0.5;this._perspective=400;this._delegateIndexNotificationDelay=0.25;this._priorityOrdering=false;this._trackCamera=true;this.cellSize=iAd.Size.ZERO_SIZE;this.cellRotations=[];this._cameraOffset=0;this.timerSet=false;this._moveHistory=[];iAd.CellContainer.init.call(this,a);this.callSuper(a);
this.userInteractionEnabled=true};iAd.FlowView.prototype.willRestoreFromArchive=function(a){this.callSuper(a);this.archivedProperties={focusedIndex:a.focusedIndex}};iAd.FlowView.prototype.layerWasCreated=function(){this.callSuper();this.camera=this.layer.appendChild(document.createElement("div"));this.camera.addClassName("ad-flow-view-camera");this.hostingLayer=this.camera};
iAd.FlowView.prototype.setupLayer=function(){this.callSuper();this.normalizeListDeclarativeStyle();this.dataSource=new iAd.CellContainerDeclarativeDataSource(this.hostingLayer,false)};
iAd.FlowView.prototype.setValueForAttribute=function(a,b){switch(b){case "ad-focused-index":this.archivedProperties={focusedIndex:parseInt(a,10)};break;case "ad-cell-size-width":this.cellSize=new iAd.Size(a,this.cellSize.height);break;case "ad-cell-size-height":this.cellSize=new iAd.Size(this.cellSize.width,a);break;default:this.callSuper(a,b)}};iAd.FlowView.prototype.layerWasInsertedIntoDocument=function(){this.callSuper();this.dataSource&&this.numberOfCells==0&&this.reloadData();this.updateLayoutAnimated(false)};
iAd.FlowView.prototype.setFlipDuration=function(a){this._flipDuration=a};iAd.FlowView.prototype.setCellGap=function(a){this._cellGap=a;this.updateLayoutAnimated(false)};iAd.FlowView.prototype.setSidePadding=function(a){this._sidePadding=a;this.updateLayoutAnimated(false)};iAd.FlowView.prototype.setFocusedZOffset=function(a){this._focusedZOffset=a;this.updateLayoutAnimated(false)};iAd.FlowView.prototype.setSideZOffset=function(a){this._sideZOffset=a;this.updateLayoutAnimated(false)};
iAd.FlowView.prototype.setCellRotation=function(a){this._cellRotation=a;this.updateLayoutAnimated(false)};iAd.FlowView.prototype.setPriorityOrdering=function(a){this._priorityOrdering=a;for(a=0;a<this.numberOfCells;a++)this.cells[a]._layoutIndex=this.layoutIndexForOrderIndex(a);this.updateLayoutAnimated(false)};iAd.FlowView.prototype.setPerspective=function(a){this._perspective=a;this.setLayerStyle({"-webkit-perspective":this._perspective})};
iAd.FlowView.prototype.reloadData=function(){iAd.CellContainer.reloadData.call(this);var a=this.archivedProperties;if(a){this.focusCellAtIndexAnimated(a.focusedIndex,false);delete this.archivedProperties}};iAd.FlowView.prototype.viewForCellAtIndex=function(a){a=this.cells[a];var b=a.superview;if(b&&b.layer.hasClassName("ad-flow-view-cell-wrapper"))return b;b=new iAd.View;b.layer.addClassName("ad-flow-view-cell-wrapper");b.addSubview(a);return b};
iAd.FlowView.prototype.insertCellsAtIndexesAnimated=function(a,b){iAd.CellContainer.insertCellsAtIndexesAnimated.call(this,a,b);this.updateCellsLayout();this.updateLayoutAnimated(b)};iAd.FlowView.prototype.removeCellsAtIndexesAnimated=function(a,b){iAd.CellContainer.removeCellsAtIndexesAnimated.call(this,a,b);this.updateCellsLayout();this.updateLayoutAnimated(b)};
iAd.FlowView.prototype.focusCellAtIndexAnimated=function(a,b,c){if(!(a<0||a>=this.numberOfCells))if(!(!c&&this._focusedIndex==a)){this.changedTime=Date.now();if(!this.timerSet){this.timerSet=true;this.callMethodNameAfterDelay("testForInteractionDelegate",this._delegateIndexNotificationDelay)}c=this.cellAtIndex(a);var d=!this.trackingMoved;d&&this.willFocusCell(c,a,b);this._focusedIndex=a;var e=!!b;this.setAnimatesCells(e);if(!this.trackingMoved){this.setAnimatesCamera(e);this.centerCamera()}this.layoutCells();
if(b)d&&this.camera.addEventListener("webkitTransitionEnd",this,false);else this.didFocusCell(c,a,false)}};iAd.FlowView.prototype.layoutIndexForOrderIndex=function(a){if(this._priorityOrdering){var b=Math.floor((this.numberOfCells-1)/2);return a%2==1?b+Math.ceil(a/2):b-Math.floor(a/2)}else return a};iAd.FlowView.prototype.orderIndexForLayoutIndex=function(a){if(this._priorityOrdering){a=a-Math.floor((this.numberOfCells-1)/2);return a>0?a*2-1:a*-2}else return a};
iAd.FlowView.prototype.testForInteractionDelegate=function(){var a=(Date.now()-this.changedTime)/1E3;if(a<this._delegateIndexNotificationDelay)this.callMethodNameAfterDelay("testForInteractionDelegate",this._delegateIndexNotificationDelay-a);else{this.timerSet=false;this.dispatchNotification(iAd.FlowView.DID_SELECT_CELL_NOTIFICATION,this.delegate,[["cellIndex",this._focusedIndex]])}};
iAd.FlowView.prototype.updateLayoutAnimated=function(a){this.setAnimatesCamera(a);this.setAnimatesCells(a);this.layoutCells();this.centerCamera()};iAd.FlowView.prototype.setAnimatesCamera=function(a){this.camera.style.webkitTransitionDuration=a?"":"0s"};iAd.FlowView.prototype.centerCamera=function(){this._cameraOffset=this._focusedIndex*this._cellGap;this.layoutCamera()};iAd.FlowView.prototype.layoutCamera=function(){this.camera.style.webkitTransform=iAd.CSS.t(this._cameraOffset*-1,0)};
iAd.FlowView.prototype.setAnimatesCells=function(a){if(a!=this._animatesCells){this._animatesCells=a;this.layer.toggleClassName(iAd.FlowView.ANIMATED_CELL_CSS,a)}};
iAd.FlowView.prototype.layoutCells=function(){for(var a=0;a<this.numberOfCells;a++){var b=this.cells[a]._layoutIndex,c=this._focusedIndex-b,d=Math.abs(c),e=b*this._cellGap-this.sidePadding,f=this._cellRotation,g=0.1*d+this._sideZOffset;if(c==0){e=b*this._cellGap;f=0;g=this._focusedZOffset}else if(c<0){e=this._focusedIndex*this._cellGap+this.sidePadding+d*this._cellGap;f=-this._cellRotation}this.cellRotations[a]=f;b=iAd.CSS.t3d(e,0,g);f=iAd.CSS.r3d(0,1,0,iAd.Number.degreesToRadians(f));this.viewForCellAtIndex(a).transform=
b;this.cells[a].transform=f}};iAd.FlowView.prototype.updateCellsLayout=function(){for(var a=this.cellSize,b=new iAd.Point(-a.width/2,(this._size.height-a.height)/2),c=this.cells,d,e=0,f=c.length;e<f;e++){d=c[e];d._orderIndex=e;d._layoutIndex=this.layoutIndexForOrderIndex(e);d.layer.addClassName("ad-flow-view-cell");d.size=a;d.position=b;d.superview._orderIndex=e;this.cellRotations.push(null)}};iAd.FlowView.prototype.cellAtIndex=function(a){return this.cells[a]};
iAd.FlowView.prototype.handleEvent=function(a){this.callSuper(a);if(a.type=="webkitTransitionEnd"){var b=this.camera;if(a.target==b){b.removeEventListener("webkitTransitionEnd",this,false);a=this._focusedIndex;this.didFocusCell(this.cellAtIndex(a),a,false)}}};
iAd.FlowView.prototype.touchesBegan=function(a){if(!(this.tracking||a.touches&&a.touches.length>1)){this.stopDecelerationAnimation();this.previousIndex=this._focusedIndex;this.downTime=a.timeStamp;this.downTimePosition=this.downOffset=this._cameraOffset;this.downPoint=iAd.Point.fromEventInElement(a,this.layer);for(var b=a.target;b&&!b.hasClassName("ad-flow-view-cell");)b=b.parentNode;this.downIndex=b&&b.hasClassName("ad-flow-view-cell")?b._view._layoutIndex:this._focusedIndex;this.trackingMoved=false;
this._trackCamera&&this.setAnimatesCamera(false);this.setAnimatesCells(true);this.callSuper(a)}};
iAd.FlowView.prototype.touchesMoved=function(a){if(!(a.touches&&a.touches.length>1)){this.lastEventTime=a.timeStamp;var b=iAd.Point.fromEventInElement(a,this.layer),c=b.x-this.downPoint.x,d=b.y-this.downPoint.y;if(this.trackingMoved){if(this.trackingMoved){a.preventDefault();this._cameraOffset=this.downOffset-c;if(this._cameraOffset<0)this._cameraOffset/=2;else if(this._cameraOffset>(this.numberOfCells-1)*this._cellGap)this._cameraOffset=((this.numberOfCells-1)*this._cellGap+this._cameraOffset)/2;
if(!this._trackCamera)this._cameraOffset=Math.round(this._cameraOffset/this._cellGap)*this._cellGap;this.layoutCamera();b=this.previousIndex-Math.round(c/this._cellGap);b!=this._focusedIndex&&this.focusCellAtIndexAnimated(b,true);this._moveHistory.push({time:a.timeStamp,offset:this._cameraOffset})>iAd.FlowView.NUM_MOVE_EVENTS&&this._moveHistory.shift();if(this.lastEventTime-this.downTime>iAd.FlowView.MAX_TRACKING_TIME){this.downTime=this.lastEventTime;this.downTimePosition=this._cameraOffset}}}else if(!(Math.abs(c)<
3&&Math.abs(d)<3)){var e=false;if(c!=0&&d!=0)e=Math.abs(Math.atan(d/c))<=iAd.FlowView.SWIPE_THRESHOLD_ANGLE;else if(c!=0)e=true;if(e){this.trackingMoved=true;this.downPoint=b;this.dispatchNotification(iAd.FlowView.DID_BEGIN_SWIPE_NOTIFICATION,this.delegate)}else this.touchesCancelled(a)}}};
iAd.FlowView.prototype.touchesEnded=function(a){a.preventDefault();if(!(a.touches&&a.touches.length>1)){this.callSuper(a);a=a.timeStamp;var b=this.downIndex;if(!this.trackingMoved&&a-this.downTime<iAd.FlowView.TAP_EVENT_DURATION)b==this._focusedIndex?this.dispatchNotification(iAd.FlowView.DID_TAP_FRONT_CELL_NOTIFICATION,this.delegate,[["cellIndex",this._focusedIndex]]):this.focusCellAtIndexAnimated(b,true);else if(a-this.lastEventTime<=iAd.FlowView.MAX_TRACKING_TIME)this.startDecelerationAnimation();
else this.trackingMoved?this.swipeEnded():this.focusCellAtIndexAnimated(b,true);this._moveHistory=[];this.trackingMoved=false}};iAd.FlowView.prototype.swipeEnded=function(){this._trackCamera&&this.setAnimatesCamera(true);this.centerCamera();this.dispatchNotification(iAd.FlowView.DID_END_SWIPE_NOTIFICATION,this.delegate);var a=this._focusedIndex;this.willFocusCell(this.cellAtIndex(a),a,true);this.camera.addEventListener("webkitTransitionEnd",this,false)};
iAd.FlowView.prototype.getOffsetVelocity=function(){var a=this._moveHistory.length;if(a<2)return 0;return(this._moveHistory[a-1].offset-this._moveHistory[a-2].offset)/(this._moveHistory[a-1].time-this._moveHistory[a-2].time)};
iAd.FlowView.prototype.startDecelerationAnimation=function(){this.decelerationVelocity=this.getOffsetVelocity();this.minDecelerationPoint=0;this.maxDecelerationPoint=(this.numberOfCells-1)*this._cellGap;this.penetrationDeceleration=iAd.FlowView.PENETRATION_DECELERATION;this.penetrationAcceleration=iAd.FlowView.PENETRATION_ACCELERATION;if(Math.abs(this.decelerationVelocity)>iAd.FlowView.MIN_VELOCITY_FOR_DECELERATION){var a=this._cameraOffset+this.decelerationVelocity/(1-iAd.FlowView.DECELERATION_FRICTION_FACTOR),
b=Math.round(a/this._cellGap);if(b>=0&&b<=this.numberOfCells-1){this.decelerationVelocity=(1-iAd.FlowView.DECELERATION_FRICTION_FACTOR)*(b*this._cellGap-this._cameraOffset);a=this._cameraOffset+this.decelerationVelocity/(1-iAd.FlowView.DECELERATION_FRICTION_FACTOR)}a=iAd.Number.clampValue(Math.round(a/this._cellGap),0,this.numberOfCells-1);if(a!=this._focusedIndex)this.focusedIndex=a;this.decelerating=true;this.decelerationTimer=this.callMethodNameAfterDelay("stepThroughDecelerationAnimation",iAd.FlowView.DESIRED_ANIMATION_FRAME_RATE);
this.lastFrame=new Date}else this.swipeEnded()};iAd.FlowView.prototype.stopDecelerationAnimation=function(){this.decelerating=false;clearTimeout(this.decelerationTimer)};
iAd.FlowView.prototype.stepThroughDecelerationAnimation=function(a){if(this.decelerating){var b=new Date,c=b-this.lastFrame;c=a?0:Math.round(c/iAd.FlowView.DESIRED_ANIMATION_FRAME_RATE)-1;for(var d=0;d<c;d++)this.stepThroughDecelerationAnimation(true);this._cameraOffset=c=this._cameraOffset+this.decelerationVelocity;a||this.layoutCamera();this.decelerationVelocity*=iAd.FlowView.DECELERATION_FRICTION_FACTOR;d=Math.abs(this.decelerationVelocity);if(!a&&d<=iAd.FlowView.MINIMUM_VELOCITY){this.decelerating=
false;this.swipeEnded()}else{if(!a)this.decelerationTimer=this.callMethodNameAfterDelay("stepThroughDecelerationAnimation",iAd.FlowView.DESIRED_ANIMATION_FRAME_RATE);d=0;if(c<this.minDecelerationPoint)d=this.minDecelerationPoint-c;else if(c>this.maxDecelerationPoint)d=this.maxDecelerationPoint-c;if(d!=0)if(d*this.decelerationVelocity<=0)this.decelerationVelocity+=d*this.penetrationDeceleration;else this.decelerationVelocity=d*this.penetrationAcceleration;if(!a)this.lastFrame=b}}};
iAd.FlowView.prototype.getFrontCellIndex=function(){iAd.Console.warn("iAd.FlowView: the .frontCellIndex property was deprecated in iAd JS 1.6 in favor of the .focusedIndex property.");return this.focusedIndex};iAd.FlowView.prototype.setFrontCellIndex=function(a){iAd.Console.warn("iAd.FlowView: the .frontCellIndex property was deprecated in iAd JS 1.6 in favor of the .focusedIndex property.");this.focusedIndex=a};
iAd.FlowView.prototype.getFrontZOffset=function(){iAd.Console.warn("iAd.FlowView: the .frontZOffset property was deprecated in iAd JS 1.6 in favor of the .focusedZOffset property.");return this.focusedZOffset};iAd.FlowView.prototype.setFrontZOffset=function(a){iAd.Console.warn("iAd.FlowView: the .frontZOffset property was deprecated in iAd JS 1.6 in favor of the .focusedZOffset property.");this.focusedZOffset=a};
iAd.FlowView.prototype.normalizeListDeclarativeStyle=function(){var a=this.layer.querySelector("ul");if(!(!a||a.parentNode!==this.layer)){a.parentNode.removeChild(a);a=a.children;for(var b,c,d=0,e=a.length;d<e;d++){b=a[d];for(c=document.createElement("div");b.childNodes.length;)c.appendChild(b.firstChild);this.addSubview(new iAd.View(c))}}};
iAd.Class({name:"iAd.NavigationItem",mixins:[iAd.EventTriage],synthesizedProperties:["title","titleView","backBarButtonItem","leftBarButtonItem","rightBarButtonItem","hidesBackButton"],archivedProperties:["title","titleView","backBarButtonItem","leftBarButtonItem","rightBarButtonItem","hidesBackButton"]});iAd.NavigationItem.LEFT_BUTTON_LEFT_MARGIN=5;iAd.NavigationItem.LEFT_BUTTON_RIGHT_MARGIN=8;iAd.NavigationItem.RIGHT_BUTTON_LEFT_MARGIN=11;iAd.NavigationItem.RIGHT_BUTTON_RIGHT_MARGIN=5;
iAd.NavigationItem.prototype.init=function(a){this.callSuper();this._title="";this._backBarButtonItem=new iAd.BarButtonItem(iAd.BarButtonItem.TYPE_BACK);this._hidesBackButton=false;this._titleView=this._rightBarButtonItem=this._leftBarButtonItem=null;this.defaultTitleView=new iAd.BarButton(null,iAd.BarButtonItem.TYPE_PLAIN);this.defaultTitleView.layer.setAttribute("role","header");this.viewController=this.navigationBar=this.positions=null;this.title=a||"";this._backBarButtonItem.addEventListener(iAd.View.ACTIVATE_EVENT,
this,false)};iAd.NavigationItem.prototype.handleViewActivate=function(){if(this.viewController!=null&&this.viewController.parentViewController!=null)this.viewController.parentViewController.popViewControllerAnimated(true);else this.navigationBar!=null&&this.navigationBar.popNavigationItemAnimated(true)};iAd.NavigationItem.prototype.setTitle=function(a){this._title=a;this.updateLayoutIfTopItem()};
iAd.NavigationItem.prototype.setTitleView=function(a){if(a!==this._titleView){var b=this.titleViewForDisplay();this._titleView=a;if(b.superview){b.superview.insertSubviewBeforeSubview(this.titleViewForDisplay(),b);b.removeFromSuperview()}this.updateLayoutIfTopItem()}};iAd.NavigationItem.prototype.titleViewForDisplay=function(){return this._titleView||this.defaultTitleView};
iAd.NavigationItem.prototype.setBackBarButtonItem=function(a){if(this.navigationBar!=null&&this.navigationBar.backItem===this){this._backBarButtonItem!=null&&this._backBarButtonItem.view.superview.removeFromSuperview();this._backBarButtonItem=a;if(a!=null){var b=new iAd.View;b.addSubview(a.view);b.opacity=this.navigationBar.topItem._hidesBackButton?0:1;this.navigationBar.insertSubviewAtIndex(b,0)}this.navigationBar.topItem.updateLayoutIfTopItem()}else this._backBarButtonItem=a;this._backBarButtonItem!=
null&&this._backBarButtonItem.addEventListener(iAd.View.ACTIVATE_EVENT,this,false)};iAd.NavigationItem.prototype.setHidesBackButton=function(a){this.setHidesBackButtonAnimated(a,false)};
iAd.NavigationItem.prototype.setLeftBarButtonItem=function(a){if(this.navigationBar!=null&&this.navigationBar.topItem===this){this.getDefaultBackButton();this.leftButton!=null&&this.leftButton.view.superview.removeFromSuperview();a=(this._leftBarButtonItem=a)||this.getDefaultBackButton();if(a!=null){var b=new iAd.View;b.addSubview(a.view);if(this._leftBarButtonItem==null)b.opacity=this._hidesBackButton?0:1;this.navigationBar.insertSubviewAtIndex(b,0)}this.updateLayoutIfTopItem()}else this._leftBarButtonItem=
a};iAd.NavigationItem.prototype.setRightBarButtonItem=function(a){if(this.navigationBar!=null&&this.navigationBar.topItem===this){this._rightBarButtonItem!=null&&this._rightBarButtonItem.view.superview.removeFromSuperview();this._rightBarButtonItem=a;a!=null&&this.navigationBar.addSubview(new iAd.View).addSubview(this._rightBarButtonItem.view);this.updateLayoutIfTopItem()}else this._rightBarButtonItem=a};
iAd.NavigationItem.prototype.setHidesBackButtonAnimated=function(a,b){var c=this.getDefaultBackButton();if(this._hidesBackButton!=a){this._hidesBackButton=a;if(c!=null){c=c.view.superview;c.transitionsEnabled=b;c.opacity=a?0:1;c.layer.style.pointerEvents=a?"none":"all"}}};
iAd.NavigationItem.prototype.setLeftBarButtonItemAnimated=function(a,b){if(!b||this.navigationBar==null||this.navigationBar.topItem!==this)this.leftBarButtonItem=a;else{iAd.Transaction.begin();iAd.Transaction.defaults.duration=0.5;iAd.Transaction.defaults.properties=["opacity"];var c=this.leftButton;c!=null&&(new iAd.Transition({target:c.view.superview,to:[0],removesTargetUponCompletion:true})).start();c=(this._leftBarButtonItem=a)||this.getDefaultBackButton();if(c!=null){var d=new iAd.View;d.addSubview(c.view);
this.navigationBar.subviews.length==0?this.navigationBar.addSubview(d):this.navigationBar.insertSubviewAtIndex(d,0);if(this._leftBarButtonItem!=null||!this._hidesBackButton)(new iAd.Transition({target:d,from:[0],to:[1]})).start()}this.updateLayoutIfTopItem();iAd.Transaction.commit()}};
iAd.NavigationItem.prototype.setRightBarButtonItemAnimated=function(a,b){if(!b||this.navigationBar==null||this.navigationBar.topItem!==this)this.rightBarButtonItem=a;else{iAd.Transaction.begin();iAd.Transaction.defaults.duration=0.5;iAd.Transaction.defaults.properties=["opacity"];var c=this._rightBarButtonItem;c!=null&&(new iAd.Transition({target:c.view.superview,to:[0],removesTargetUponCompletion:true})).start();this._rightBarButtonItem=a;if(this._rightBarButtonItem!=null){c=this.navigationBar.addSubview(new iAd.View);
c.addSubview(this._rightBarButtonItem.view);(new iAd.Transition({target:c,from:[0],to:[1]})).start()}this.updateLayoutIfTopItem();iAd.Transaction.commit()}};iAd.NavigationItem.prototype.getDefaultBackButton=function(){return this.navigationBar!=null&&this.navigationBar.backItem!=null?this.navigationBar.backItem.backBarButtonItem:null};
iAd.NavigationItem.prototype.sizeItemsAndComputePositionsWithBackItem=function(a){if(!(this.navigationBar==null||this.navigationBar._size.equals(iAd.Size.ZERO_SIZE))){var b=this.navigationBar.isInPopover?0:iAd.NavigationItem.LEFT_BUTTON_LEFT_MARGIN,c=this.navigationBar.isInPopover?0:iAd.NavigationItem.RIGHT_BUTTON_RIGHT_MARGIN,d=this._leftBarButtonItem||(a!=null?a.backBarButtonItem:null),e=this._rightBarButtonItem!=null?this._rightBarButtonItem.view.size.width:0,f=this.navigationBar.size.width-b-
c;if(d!=null)f-=iAd.NavigationItem.LEFT_BUTTON_RIGHT_MARGIN;if(this._rightBarButtonItem!=null)f-=iAd.NavigationItem.RIGHT_BUTTON_LEFT_MARGIN+e;var g=0;if(d!=null){d.maxWidth=this.navigationBar.size.width/2;if(d!==this._leftBarButtonItem&&d.title==""&&d.image==null)d.title=a.title;g=d.view.size.width}a=this.titleViewForDisplay();var h=this._titleView==null;if(h){a.maxWidth=0;a.title=this._title}var i=a.size.width;if(i+g>f){if(d!=null){d.maxWidth=iAd.Number.clampValue(f/3,f-i,d.maxWidth);g=d.view.size.width}i=
f-g;if(h)a.maxWidth=i;else a.size=new iAd.Size(i,a.size.height);i=a.size.width}c=this.navigationBar.size.width-c-e;g=b+(d!=null?g+iAd.NavigationItem.LEFT_BUTTON_RIGHT_MARGIN:0);e=c-i-(e>0?iAd.NavigationItem.RIGHT_BUTTON_LEFT_MARGIN:0);f=i=(this.navigationBar.size.width-i)/2;if(i>e||i<g)f=Math.abs(i-g)<Math.abs(i-e)?g:e;this.leftButton=d;this.positions={leftButton:new iAd.Point(b,d!=null?(iAd.NavigationBar.DEFAULT_HEIGHT-d.view.size.height)/2:0),title:new iAd.Point(f,(iAd.NavigationBar.DEFAULT_HEIGHT-
a.size.height)/2),rightButton:new iAd.Point(c,this._rightBarButtonItem!=null?(iAd.NavigationBar.DEFAULT_HEIGHT-this._rightBarButtonItem.view.size.height)/2:0)};for(var j in this.positions){b=this.positions[j];b.x=iAd.CSS.roundedPxValue(b.x);b.y=iAd.CSS.roundedPxValue(b.y)}}};
iAd.NavigationItem.prototype.updateLayout=function(){if(this.positions!=null){if(this.leftButton!=null)this.leftButton.view.superview.position=this.positions.leftButton;if(this._rightBarButtonItem!=null)this._rightBarButtonItem.view.superview.position=this.positions.rightButton;this.titleViewForDisplay().superview.position=this.positions.title}};
iAd.NavigationItem.prototype.updateLayoutIfTopItem=function(){if(!(this.navigationBar==null||this.navigationBar.topItem!==this)){this.sizeItemsAndComputePositionsWithBackItem(this.navigationBar.backItem);this.updateLayout()}};iAd.Class({name:"iAd.NavigationBar",superclass:iAd.View,synthesizedProperties:["barStyle","items","topItem","backItem","busy"],archivedProperties:["barStyle","items"],cssClassName:"ad-navigation-bar",collectionAccessor:"navigationBars"});iAd.NavigationBar.STYLE_DEFAULT="ad-default";
iAd.NavigationBar.STYLE_BLACK="ad-black";iAd.NavigationBar.STYLE_BLACK_TRANSLUCENT="ad-black-translucent";iAd.NavigationBar.DEFAULT_HEIGHT=44;iAd.NavigationBar.ANIMATION_DURATION=0.35;iAd.NavigationBar.SHOULD_PUSH_ITEM_DELEGATE="navigationBarShouldPushItem";iAd.NavigationBar.DID_PUSH_ITEM_DELEGATE="navigationBarDidPushItem";iAd.NavigationBar.SHOULD_POP_ITEM_DELEGATE="navigationBarShouldPopItem";iAd.NavigationBar.DID_POP_ITEM_DELEGATE="navigationBarDidPopItem";
iAd.NavigationBar.prototype.init=function(a){this.delegate=null;this._barStyle=iAd.NavigationBar.STYLE_DEFAULT;this._items=[];this._busy=false;this.itemsToSetupAfterAnimatedChange=null;this.callSuper(a);if(!this.usesDeclarativeBacking)this.barStyle=iAd.NavigationBar.STYLE_DEFAULT};
iAd.NavigationBar.prototype.setupLayer=function(){this.callSuper();this.barStyle=this.layer.hasClassName(iAd.NavigationBar.STYLE_BLACK)?iAd.NavigationBar.STYLE_BLACK:this.layer.hasClassName(iAd.NavigationBar.STYLE_BLACK_TRANSLUCENT)?iAd.NavigationBar.STYLE_BLACK_TRANSLUCENT:iAd.NavigationBar.STYLE_DEFAULT};iAd.NavigationBar.prototype.setSize=function(a){this.callSuper(new iAd.Size(a.width,iAd.NavigationBar.DEFAULT_HEIGHT));this.updateTopItemLayout()};
iAd.NavigationBar.prototype.willMoveToSuperview=function(a){if(a!=null&&!this.usesDeclarativeBacking&&this._size.width==0)this.size=new iAd.Size(a._size.width,iAd.NavigationBar.DEFAULT_HEIGHT)};iAd.NavigationBar.prototype.setBarStyle=function(a){this.layer.removeClassName(this._barStyle);this.layer.addClassName(a);this._barStyle=a};iAd.NavigationBar.prototype.getTopItem=function(){return this._items.length>0?this._items[this._items.length-1]:null};
iAd.NavigationBar.prototype.getBackItem=function(){return this._items.length>1?this._items[this._items.length-2]:null};iAd.NavigationBar.prototype.setItems=function(a){this.setItemsAnimated(a,false)};
iAd.NavigationBar.prototype.setItemsAnimated=function(a,b){if(!(this.busy||!a||a.length==0)){iAd.Transaction.begin();for(var c=this.topItem,d=a.length>1?a[a.length-2]:null,e=a[a.length-1],f=0,g=this._items.length;f<g;f++)this._items[f].navigationBar=null;f=0;for(g=a.length;f<g;f++)a[f].navigationBar=this;if(c==null){this.addItemViews(e,d,false);e.sizeItemsAndComputePositionsWithBackItem(d);e.updateLayout();this._items=a;this.dispatchNotification(iAd.NavigationBar.DID_PUSH_ITEM_DELEGATE,this.delegate,
[["item",e]]);iAd.Transaction.commit()}else if(c===e){for(this.removeViewsForItem(c);this.subviews.length;)this.subviews[0].removeFromSuperview();this.addItemViews(e,d,false);e.sizeItemsAndComputePositionsWithBackItem(d);e.updateLayout();this._items=a;iAd.Transaction.commit()}else{f=this._items.indexOf(e)==-1;this.addItemViews(e,d,true);e.sizeItemsAndComputePositionsWithBackItem(d);this.itemsAfterTransition=a;this.transitionToItem(e,c,f,b)}}};
iAd.NavigationBar.prototype.pushNavigationItemAnimated=function(a,b){if(!this.busy){iAd.Transaction.begin();this.shouldPushItem(a)&&this.setItemsAnimated(this._items.concat([a]),b);iAd.Transaction.commit()}};iAd.NavigationBar.prototype.popNavigationItemAnimated=function(a){if(!(this.busy||this._items.length<2)){iAd.Transaction.begin();this.shouldPopItem(this.topItem)&&this.setItemsAnimated(this._items.slice(0,this._items.length-1),a);iAd.Transaction.commit()}};
iAd.NavigationBar.prototype.isItemViewHostedInBar=function(a){return(a=a.superview)&&a.superview===this};
iAd.NavigationBar.prototype.addItemViews=function(a,b,c){var d=[],e=a._leftBarButtonItem||(b!=null?b.backBarButtonItem:null)||null;if(a.rightBarButtonItem!=null&&!this.isItemViewHostedInBar(a.rightBarButtonItem.view)){b=this.addSubview(new iAd.View);b.addSubview(a.rightBarButtonItem.view);d.push(b)}var f=a.titleViewForDisplay();if(f!=null&&!this.isItemViewHostedInBar(f)){b=a.rightBarButtonItem!=null?this.insertSubviewBeforeSubview(new iAd.View,a.rightBarButtonItem.view.superview):this.addSubview(new iAd.View);
b.addSubview(f);d.push(b)}if(e!=null&&!this.isItemViewHostedInBar(e.view)){b=this.insertSubviewBeforeSubview(new iAd.View,f.superview);b.addSubview(e.view);d.push(b)}for(a=c?0:1;d.length;){b=d.pop();b.opacity=a;b.wantsHardwareLayerBacking=true}};
iAd.NavigationBar.prototype.transitionToItem=function(a,b,c,d){this.busy=d;this.previousItem=b;this.transitionWentForward=c;iAd.Transaction.defaults.duration=d?iAd.NavigationBar.ANIMATION_DURATION:0;iAd.Transaction.defaults.properties=["opacity","position"];var e=null;if(b._leftBarButtonItem!=null){if(b._leftBarButtonItem!==a._leftBarButtonItem)e=(new iAd.Transition({target:b._leftBarButtonItem.view.superview,properties:["opacity"],to:[0]})).start()}else if(b.leftButton!=null){e=c?-b.leftButton.view.size.width-
iAd.NavigationItem.LEFT_BUTTON_LEFT_MARGIN:a.positions.title.x;e=(new iAd.Transition({target:b.leftButton.view.superview,to:[0,new iAd.Point(e,b.positions.leftButton.y)]})).start()}var f=b.titleViewForDisplay(),g=a.titleViewForDisplay(),h=f!==g;if(h){e=c?iAd.NavigationItem.LEFT_BUTTON_LEFT_MARGIN:this.size.width;e=(new iAd.Transition({target:f.superview,to:[0,new iAd.Point(e,b.positions.title.y)]})).start()}if(b._rightBarButtonItem!=null&&b._rightBarButtonItem!==a._rightBarButtonItem)e=(new iAd.Transition({target:b._rightBarButtonItem.view.superview,
properties:["opacity"],to:[0]})).start();if(a._leftBarButtonItem!=null){if(a._leftBarButtonItem!==b._leftBarButtonItem){a._leftBarButtonItem.view.superview.position=a.positions.leftButton;e=(new iAd.Transition({target:a._leftBarButtonItem.view.superview,properties:["opacity"],from:[0],to:[1]})).start()}}else if(a.leftButton!=null){f=c?b.positions.title.x:-b.leftButton.view.size.width-iAd.NavigationItem.LEFT_BUTTON_LEFT_MARGIN;e=(new iAd.Transition({target:a.leftButton.view.superview,from:[0,new iAd.Point(f,
a.positions.leftButton.y)],to:[a.hidesBackButton?0:1,a.positions.leftButton]})).start()}if(h){f=c?this.size.width:iAd.NavigationItem.LEFT_BUTTON_LEFT_MARGIN;e=(new iAd.Transition({target:g.superview,from:[0,new iAd.Point(f,a.positions.title.y)],to:[1,a.positions.title]})).start()}if(a._rightBarButtonItem!=null&&a._rightBarButtonItem!==b._rightBarButtonItem){a._rightBarButtonItem.view.superview.position=a.positions.rightButton;e=(new iAd.Transition({target:a._rightBarButtonItem.view.superview,properties:["opacity"],
from:[0],to:[1]})).start()}if(d=d&&e!=null)e.delegate=this;iAd.Transaction.commit();d||this.transitionsEnded()};iAd.NavigationBar.prototype.transitionsEnded=function(){this._items=this.itemsAfterTransition;this.busy=false;this.transitionWentForward?this.dispatchNotification(iAd.NavigationBar.DID_PUSH_ITEM_DELEGATE,this.delegate,[["item",this.topItem]]):this.dispatchNotification(iAd.NavigationBar.DID_POP_ITEM_DELEGATE,this.delegate,[["item",this.previousItem]]);this.removeViewsForItem(this.previousItem)};
iAd.NavigationBar.prototype.removeViewsForItem=function(a){var b=a.titleViewForDisplay();b!==this.topItem.titleViewForDisplay()&&b.superview.removeFromSuperview();a.leftButton!=null&&a.leftButton!==this.topItem.leftButton&&a.leftButton.view.superview.removeFromSuperview();a._rightBarButtonItem!=null&&a._rightBarButtonItem!==this.topItem._rightBarButtonItem&&a._rightBarButtonItem.view.superview.removeFromSuperview();a.leftButton!=null&&a.leftButton.removeEventListener(iAd.View.ACTIVATE_EVENT,this,
false)};iAd.NavigationBar.prototype.updateTopItemLayout=function(){this._items.length>0&&this.topItem.updateLayoutIfTopItem()};iAd.NavigationBar.prototype.shouldPushItem=function(a){this.dispatchNotification(iAd.NavigationBar.SHOULD_PUSH_ITEM_DELEGATE,this.delegate,[["item",a]]);return true};iAd.NavigationBar.prototype.shouldPopItem=function(a){this.dispatchNotification(iAd.NavigationBar.SHOULD_POP_ITEM_DELEGATE,this.delegate,[["item",a]]);return true};
iAd.NavigationBar.prototype.transitionDidComplete=function(){this.transitionsEnded()};iAd.Class({name:"iAd.PickerComponent",superclass:iAd.ScrollView});iAd.PickerComponent.prototype.init=function(a,b){this.callSuper();this.delegate=this;this.index=a;this.rows=b;this.showsVerticalScrollIndicator=this.clipsToBounds=false};
iAd.PickerComponent.prototype.getSelectedRow=function(){return this._selectedRow=iAd.Number.clampValue(Math.round((this.contentOffset.y+iAd.PickerView.COMPONENT_TOP_MARGIN-iAd.PickerView.COMPONENT_BOTTOM_MARGIN)/iAd.PickerView.DEFAULT_ROW_HEIGHT),0,this.rows-1)};iAd.PickerComponent.prototype.startDecelerationAnimation=function(){this.callSuper();this.expectedContentOffsetY=null;this.decelerating||this.superview.selectRowInComponentAnimated(this.getSelectedRow(),this.index,true)};
iAd.PickerComponent.prototype.scrollViewWillEndDraggingWithVelocityAndTargetContentOffset=function(a,b,c){a=(c.y+iAd.PickerView.COMPONENT_TOP_MARGIN-iAd.PickerView.COMPONENT_BOTTOM_MARGIN)/iAd.PickerView.DEFAULT_ROW_HEIGHT;b=iAd.Number.clampValue(Math.round(a),0,this.rows-1);if(a>=0&&a<=this.rows-1)this.expectedContentOffsetY=c.y=b*iAd.PickerView.DEFAULT_ROW_HEIGHT};
iAd.PickerComponent.prototype.scrollViewDidEndDecelerating=function(){if(this.expectedContentOffsetY!=null)this.contentOffset=new iAd.Point(this.contentOffset.x,this.expectedContentOffsetY);this.superview.notifyDelegateOfRowInComponentSelection(this.rowAtY(this.contentOffset.y),this.index)};iAd.PickerComponent.prototype.beginTracking=function(a){this.callSuper(a);a=this.rowAtY(iAd.Point.fromEventInElement(a,this.hostingLayer).y);this.touchedRow=a>=0&&a<=this.rows-1?a:-1};
iAd.PickerComponent.prototype.touchesEnded=function(a){var b=this.dragging;this.callSuper(a);a.eventPhase==Event.BUBBLING_PHASE||this.decelerating||b||this.touchedRow!=-1&&this.superview.selectRowInComponentAnimated(this.touchedRow,this.index,true)};iAd.PickerComponent.prototype.rowAtY=function(a){return Math.floor((a-iAd.PickerView.COMPONENT_TOP_MARGIN)/iAd.PickerView.DEFAULT_ROW_HEIGHT)};
iAd.Class({name:"iAd.PickerView",superclass:iAd.View,synthesizedProperties:["showsSelectionIndicator"],archivedProperties:["showsSelectionIndicator"],excludedProperties:["subviews"]});iAd.PickerView.NUMBER_OF_COMPONENTS="numberOfComponentsInPickerView";iAd.PickerView.NUMBER_OF_ROWS_IN_COMPONENT="pickerViewNumberOfRowsInComponent";iAd.PickerView.ROW_HEIGHT_FOR_COMPONENT="pickerViewRowHeightForComponent";iAd.PickerView.WIDTH_FOR_COMPONENT="pickerViewWidthForComponent";
iAd.PickerView.TITLE_FOR_ROW_FOR_COMPONENT="pickerViewTitleForRowForComponent";iAd.PickerView.VIEW_FOR_ROW_FOR_COMPONENT="pickerViewViewForRowForComponent";iAd.PickerView.DID_SELECT_ROW_IN_COMPONENT="pickerViewDidSelectRowInComponent";iAd.PickerView.DEFAULT_WIDTH=320;iAd.PickerView.DEFAULT_HEIGHT=216;iAd.PickerView.DEFAULT_ROW_HEIGHT=39;iAd.PickerView.COMPONENT_TOP_MARGIN=89;iAd.PickerView.COMPONENT_BOTTOM_MARGIN=88;
iAd.PickerView.prototype.init=function(){this.callSuper();this.numberOfComponents=0;this.dataSource=this.delegate=null;this._showsSelectionIndicator=false;this.components=[];this._size=new iAd.Size(iAd.PickerView.DEFAULT_WIDTH,iAd.PickerView.DEFAULT_HEIGHT);this.clipsToBounds=true};iAd.PickerView.prototype.didEncodeObjectToArchive=function(a){this.callSuper(a);a=a.selectedRows=[];for(var b=0,c=this.numberOfComponents;b<c;b++)a.push(this.selectedRowInComponent(b))};
iAd.PickerView.prototype.willRestoreFromArchive=function(a){this.callSuper(a);this.archivedSelectedRows=a.selectedRows};
iAd.PickerView.prototype.createLayer=function(){this.callSuper();this.layer.addClassName("ad-picker-view");var a=this.layer.appendChild(document.createElement("div"));a.className="ad-frame";this.componentsBackground=a.appendChild(document.createElement("div"));this.indicatorsBackground=a.appendChild(document.createElement("div"));this.hostingLayer=a.appendChild(document.createElement("div"));this.shadowOverlay=a.appendChild(document.createElement("div"));this.frameOverlay=a.appendChild(document.createElement("div"));
this.indicatorsOverlay=a.appendChild(document.createElement("div"))};iAd.PickerView.prototype.layerWasInsertedIntoDocument=function(){this.callSuper();this.dataSource&&this.numberOfComponents==0&&this.reloadAllComponents()};iAd.PickerView.prototype.setSize=function(a){a.width=iAd.PickerView.DEFAULT_WIDTH;a.height=iAd.PickerView.DEFAULT_HEIGHT;this.callSuper(a)};
iAd.PickerView.prototype.setShowsSelectionIndicator=function(a){this.layer.toggleClassName("ad-shows-selection-indicator",a);this._showsSelectionIndicator=a};iAd.PickerView.prototype.numberOfRowsInComponent=function(a){if(a<0||a>=this.numberOfComponents)throw Error("iAd.PickerView.numberOfRowsInComponent - no component "+a);return this.components[a].rows};
iAd.PickerView.prototype.updateNumberOfComponents=function(){if(iAd.Utils.objectHasMethod(this.dataSource,iAd.PickerView.NUMBER_OF_COMPONENTS)){this.numberOfComponents=this.dataSource[iAd.PickerView.NUMBER_OF_COMPONENTS](this);if(this.numberOfComponents<1)throw Error("iAd.PickerView must have at least one component");}else throw Error("the iAd.PickerView dataSource must implement "+iAd.PickerView.NUMBER_OF_COMPONENTS);};
iAd.PickerView.prototype.reloadAllComponents=function(){this.updateNumberOfComponents();for(var a=this.numberOfComponents,b=this.components.length;a<b;a++)if(this.components[a]!==undefined){this.components[a].removeFromSuperview();this.components[a]=undefined}for(b=0;b<this.numberOfComponents;b++)this.reloadComponent(b);this.updateComponentsLayout();if(a=this.archivedSelectedRows){var c=0;for(b=a.length;c<b;c++)this.selectRowInComponentAnimated(a[c],c,false);delete this.archivedSelectedRows}};
iAd.PickerView.prototype.reloadComponent=function(a){a>this.numberOfComponents&&this.updateNumberOfComponents();if(a<0||a>=this.numberOfComponents)throw Error("iAd.PickerView.reloadComponent was called with an invalid component : "+a);if(iAd.Utils.objectHasMethod(this.dataSource,iAd.PickerView.NUMBER_OF_ROWS_IN_COMPONENT))var b=this.dataSource[iAd.PickerView.NUMBER_OF_ROWS_IN_COMPONENT](this,a);else throw Error("the iAd.PickerView dataSource must implement "+iAd.PickerView.NUMBER_OF_ROWS_IN_COMPONENT);
var c=null;if(iAd.Utils.objectHasMethod(this.delegate,iAd.PickerView.TITLE_FOR_ROW_FOR_COMPONENT))c=this.delegate[iAd.PickerView.TITLE_FOR_ROW_FOR_COMPONENT];else if(iAd.Utils.objectHasMethod(this.delegate,iAd.PickerView.VIEW_FOR_ROW_FOR_COMPONENT))c=this.delegate[iAd.PickerView.VIEW_FOR_ROW_FOR_COMPONENT];else throw Error("the iAd.PickerView delegate must implement either "+iAd.PickerView.TITLE_FOR_ROW_FOR_COMPONENT+" or "+iAd.PickerView.VIEW_FOR_ROW_FOR_COMPONENT);if(this.components[a]==undefined)this.components[a]=
this.addSubview(new iAd.PickerComponent(a,b));var d=this.components[a];d.hostingLayer.textContent="";for(var e=d.subviews=0;e<b;e++){var f=c.call(this.delegate,this,e,a);if(f instanceof iAd.View)d.addSubview(f);else{var g=document.createElement("div");g.className="ad-title-row";g.textContent=f;d.hostingLayer.appendChild(g)}}};
iAd.PickerView.prototype.updateComponentsLayout=function(){this.componentsBackground.textContent="";this.indicatorsBackground.textContent="";for(var a=300/this.numberOfComponents,b=iAd.Utils.objectHasMethod(this.delegate,iAd.PickerView.WIDTH_FOR_COMPONENT),c=0,d=0;d<this.numberOfComponents;d++){var e=this.components[d],f=b?this.delegate[iAd.PickerView.WIDTH_FOR_COMPONENT](this,d):a;e.position=new iAd.Point(c,0);e.size=new iAd.Size(f,iAd.PickerView.DEFAULT_HEIGHT);e.contentSize=new iAd.Size(f,this.components[d].rows*
iAd.PickerView.DEFAULT_ROW_HEIGHT+iAd.PickerView.COMPONENT_TOP_MARGIN+iAd.PickerView.COMPONENT_BOTTOM_MARGIN);c+=f;this.componentsBackground.appendChild(document.createElement("div")).style.width=f+"px";this.indicatorsBackground.appendChild(document.createElement("div")).style.width=f+"px"}this.frameOverlay.parentNode.style.width=c+20+"px";this.frameOverlay.parentNode.style.left=(320-c-20)/2+"px"};
iAd.PickerView.prototype.selectRowInComponentAnimated=function(a,b,c){if(b<0||b>=this.numberOfComponents)throw Error("iAd.PickerView.selectRowInComponentAnimated - no component "+b);if(a<0||a>=this.numberOfRowsInComponent(b))throw Error("iAd.PickerView.selectRowInComponentAnimated - no row "+a+" in component "+b);this.components[b].setContentOffsetAnimated(new iAd.Point(0,a*iAd.PickerView.DEFAULT_ROW_HEIGHT),c);this.notifyDelegateOfRowInComponentSelection(a,b)};
iAd.PickerView.prototype.selectedRowInComponent=function(a){if(a<0||a>=this.numberOfComponents)throw Error("iAd.PickerView.selectedRowInComponent - no component "+a);return this.components[a].getSelectedRow()};iAd.PickerView.prototype.notifyDelegateOfRowInComponentSelection=function(a,b){this.dispatchNotification(iAd.PickerView.DID_SELECT_ROW_IN_COMPONENT,this.delegate,[["row",a],["component",b]])};iAd.PickerView.prototype.viewForRowForComponent=function(){};
iAd.Class({name:"iAd.ProgressView",superclass:iAd.View,synthesizedProperties:["progress","progressViewStyle","width"],archivedProperties:["progress","progressViewStyle"],cssClassName:"ad-progress-view",collectionAccessor:"progressViews"});iAd.ProgressView.STYLE_DEFAULT="ad-default";iAd.ProgressView.STYLE_BAR="ad-bar";iAd.ProgressView.DEFAULT_HEIGHT=9;iAd.ProgressView.BAR_HEIGHT=11;
iAd.ProgressView.prototype.init=function(a,b){this._progress=0;this._progressViewStyle=b||iAd.ProgressView.STYLE_DEFAULT;this.callSuper(a)};iAd.ProgressView.prototype.setupLayer=function(){this.callSuper();this.progressViewStyle=this.layer.hasClassName(iAd.ProgressView.STYLE_BAR)?iAd.ProgressView.STYLE_BAR:iAd.ProgressView.STYLE_DEFAULT};iAd.ProgressView.prototype.createLayer=function(){this.callSuper();this.layer.addClassName(this._progressViewStyle)};
iAd.ProgressView.prototype.layerWasCreated=function(){this.callSuper();this.bar=this.layer.appendChild(document.createElement("div"))};iAd.ProgressView.prototype.readPropertiesFromLayerAttributes=function(a){this.callSuper(a);this.updateBar()};iAd.ProgressView.prototype.setSize=function(a){a.height=this._progressViewStyle==iAd.ProgressView.STYLE_DEFAULT?iAd.ProgressView.DEFAULT_HEIGHT:iAd.ProgressView.BAR_HEIGHT;this.callSuper(a);this.updateBar()};
iAd.ProgressView.prototype.willMoveToSuperview=function(a){if(iAd.Utils.objectIsInstanceOfClass(a,iAd.Toolbar))this.progressViewStyle=iAd.ProgressView.STYLE_BAR};iAd.ProgressView.prototype.getWidth=function(){return this.size.width};iAd.ProgressView.prototype.setWidth=function(a){this.size=new iAd.Size(a,0)};iAd.ProgressView.prototype.setProgress=function(a){a=iAd.Number.clampValue(a,0,1);if(a!=this._progress){this._progress=a;this.updateBar()}};
iAd.ProgressView.prototype.setProgressViewStyle=function(a){if(a!=this._progressViewStyle){this.layer.removeClassName(this._progressViewStyle);this.layer.addClassName(a);this._progressViewStyle=a}};iAd.ProgressView.prototype.updateBar=function(){this.bar.style.display=this._progress==0?"none":"block";this.bar.style.width=(this.size.width*this._progress).toFixed(2)+"px"};iAd.View.TRANSITION_DISSOLVE_OUT={properties:["opacity"],from:[1],to:[0]};
iAd.View.TRANSITION_DISSOLVE_IN={properties:["opacity"],from:[0],to:[1]};iAd.View.TRANSITION_ZOOM_IN={properties:["opacity","transform"],from:[0,"scale(0.2)"],to:[1,"scale(1)"]};iAd.View.TRANSITION_ZOOM_OUT={properties:["opacity","transform"],from:[0,"scale(1.2)"],to:[1,"scale(1)"]};iAd.View.TRANSITION_CROSS_SPIN_RIGHT={properties:["opacity","transform"],from:[0,"rotate(20deg)"],to:[1,"rotate(0)"]};
iAd.View.TRANSITION_CROSS_SPIN_LEFT={properties:["opacity","transform"],from:[0,"rotate(-20deg)"],to:[1,"rotate(0)"]};iAd.View.TRANSITION_FLIP_LEFT_OUT={properties:["transform"],from:["perspective(800) rotateY(0deg) translateZ(0)"],to:["perspective(800) rotateY(-180deg) translateZ(1px)"]};iAd.View.TRANSITION_FLIP_LEFT_IN={properties:["transform"],from:["perspective(800) rotateY(180deg) translateZ(1px)"],to:["perspective(800) rotateY(0deg) translateZ(0)"]};
iAd.View.TRANSITION_FLIP_RIGHT_OUT={properties:["transform"],from:["perspective(800) rotateY(0deg) translateZ(0)"],to:["perspective(800) rotateY(180deg) translateZ(1px)"]};iAd.View.TRANSITION_FLIP_RIGHT_IN={properties:["transform"],from:["perspective(800) rotateY(-180deg) translateZ(1px)"],to:["perspective(800) rotateY(0deg) translateZ(0)"]};
iAd.View.TRANSITION_CUBE_LEFT_OUT=function(a){a=-a.size.width/2;return{base:["anchorPoint",new iAd.Point(0.5,0.5),"anchorPointZ",a],properties:["transform"],from:["perspective(800) translateZ("+a+"px) rotateY(0deg)"],to:["perspective(800) translateZ("+a+"px) rotateY(-90deg)"]}};
iAd.View.TRANSITION_CUBE_LEFT_IN=function(a){a=-a.size.width/2;return{base:["anchorPoint",new iAd.Point(0.5,0.5),"anchorPointZ",a],properties:["transform"],from:["perspective(800) translateZ("+a+"px) rotateY(90deg)"],to:["perspective(800) translateZ("+a+"px) rotateY(0deg)"]}};
iAd.View.TRANSITION_CUBE_RIGHT_OUT=function(a){a=-a.size.width/2;return{base:["anchorPoint",new iAd.Point(0.5,0.5),"anchorPointZ",a],properties:["transform"],from:["perspective(800) translateZ("+a+"px) rotateY(0deg)"],to:["perspective(800) translateZ("+a+"px) rotateY(90deg)"]}};
iAd.View.TRANSITION_CUBE_RIGHT_IN=function(a){a=-a.size.width/2;return{base:["anchorPoint",new iAd.Point(0.5,0.5),"anchorPointZ",a],properties:["transform"],from:["perspective(800) translateZ("+a+"px) rotateY(-90deg)"],to:["perspective(800) translateZ("+a+"px) rotateY(0deg)"]}};iAd.View.TRANSITION_DOOR_OPEN_LEFT_OUT={base:["anchorPoint",new iAd.Point(0,0.5)],properties:["transform"],from:["perspective(800) rotateY(0deg)"],to:["perspective(800) rotateY(-90deg)"]};
iAd.View.TRANSITION_DOOR_CLOSE_LEFT_IN={base:["anchorPoint",new iAd.Point(0,0.5)],properties:["transform"],from:["perspective(800) rotateY(-90deg)"],to:["perspective(800) rotateY(0deg)"]};iAd.View.TRANSITION_DOOR_OPEN_RIGHT_OUT={base:["anchorPoint",new iAd.Point(1,0.5)],properties:["transform"],from:["perspective(800) rotateY(0deg)"],to:["perspective(800) rotateY(90deg)"]};
iAd.View.TRANSITION_DOOR_CLOSE_RIGHT_IN={base:["anchorPoint",new iAd.Point(1,0.5)],properties:["transform"],from:["perspective(800) rotateY(90deg)"],to:["perspective(800) rotateY(0deg)"]};iAd.View.TRANSITION_REVOLVE_TOWARDS_LEFT_OUT={base:["anchorPoint",new iAd.Point(0,0.5)],properties:["transform","opacity"],from:["perspective(800) rotateY(0deg)",1],to:["perspective(800) rotateY(-90deg)",0]};
iAd.View.TRANSITION_REVOLVE_TOWARDS_LEFT_IN={base:["anchorPoint",new iAd.Point(0,0.5)],properties:["transform"],from:["perspective(800) rotateY(90deg)"],to:["perspective(800) rotateY(0deg)"]};iAd.View.TRANSITION_REVOLVE_AWAY_LEFT_OUT={base:["anchorPoint",new iAd.Point(0,0.5)],properties:["transform"],from:["perspective(800) rotateY(0deg)"],to:["perspective(800) rotateY(90deg)"]};
iAd.View.TRANSITION_REVOLVE_AWAY_LEFT_IN={base:["anchorPoint",new iAd.Point(0,0.5)],properties:["transform","opacity"],from:["perspective(800) rotateY(-90deg)",0],to:["perspective(800) rotateY(0deg)",1]};iAd.View.TRANSITION_REVOLVE_TOWARDS_RIGHT_OUT={base:["anchorPoint",new iAd.Point(1,0.5)],properties:["transform","opacity"],from:["perspective(800) rotateY(0deg)",1],to:["perspective(800) rotateY(90deg)",0]};
iAd.View.TRANSITION_REVOLVE_TOWARDS_RIGHT_IN={base:["anchorPoint",new iAd.Point(1,0.5)],properties:["transform"],from:["perspective(800) rotateY(-90deg)"],to:["perspective(800) rotateY(0deg)"]};iAd.View.TRANSITION_REVOLVE_AWAY_RIGHT_OUT={base:["anchorPoint",new iAd.Point(1,0.5)],properties:["transform"],from:["perspective(800) rotateY(0deg)"],to:["perspective(800) rotateY(-90deg)"]};
iAd.View.TRANSITION_REVOLVE_AWAY_RIGHT_IN={base:["anchorPoint",new iAd.Point(1,0.5)],properties:["transform","opacity"],from:["perspective(800) rotateY(90deg)",0],to:["perspective(800) rotateY(0deg)",1]};iAd.View.TRANSITION_SPIN_LEFT_OUT={properties:["transform","opacity"],from:["perspective(800) rotate(0)",1],to:["perspective(800) rotate(180deg)",0]};
iAd.View.TRANSITION_SPIN_LEFT_IN={base:["zIndex",1],properties:["transform","opacity"],from:["perspective(800) rotate(-180deg)",0],to:["perspective(800) rotate(0)",1]};iAd.View.TRANSITION_SPIN_RIGHT_OUT={properties:["transform","opacity"],from:["perspective(800) rotate(0)",1],to:["perspective(800) rotate(-180deg)",0]};iAd.View.TRANSITION_SPIN_RIGHT_IN={base:["zIndex",1],properties:["transform","opacity"],from:["perspective(800) rotate(180deg)",0],to:["perspective(800) rotate(0)",1]};
iAd.View.TRANSITION_SCALE_IN={base:["zIndex",1],properties:["transform"],from:["scale(0.01)"],to:["scale(1)"]};iAd.View.TRANSITION_SCALE_OUT={base:["zIndex",1],properties:["transform"],from:["scale(1)"],to:["scale(0.01)"]};iAd.Class({name:"iAd.Toolbar",superclass:iAd.View,synthesizedProperties:["items","barStyle"],archivedProperties:["items","barStyle"],excludedProperties:["subviews"],cssClassName:"ad-toolbar",collectionAccessor:"toolbars"});iAd.Toolbar.DEFAULT_HEIGHT=44;iAd.Toolbar.EDGE_MARGIN=6;
iAd.Toolbar.ITEM_MARGIN=10;iAd.Toolbar.STYLE_DEFAULT="ad-default";iAd.Toolbar.STYLE_BLACK="ad-black";iAd.Toolbar.STYLE_BLACK_TRANSLUCENT="ad-black-translucent";iAd.Toolbar.ANIMATION_DURATION=0.2;iAd.Toolbar.FADE_OUT_TRANSITION={properties:["transform","opacity"],to:["scale(0.01)",0]};iAd.Toolbar.prototype.init=function(a){this._items=[];this._barStyle="";this.callSuper(a);if(!this.usesDeclarativeBacking)this.barStyle=iAd.Toolbar.STYLE_DEFAULT};
iAd.Toolbar.prototype.setupLayer=function(){this.callSuper();if(this.layer.hasClassName(iAd.Toolbar.STYLE_BLACK))this._barStyle=iAd.Toolbar.STYLE_BLACK;else if(this.layer.hasClassName(iAd.Toolbar.STYLE_BLACK_TRANSLUCENT))this._barStyle=iAd.Toolbar.STYLE_BLACK_TRANSLUCENT;else this.barStyle=iAd.Toolbar.STYLE_DEFAULT};
iAd.Toolbar.prototype.layerWasCreated=function(){this.callSuper();this.glow=this.layer.appendChild(document.createElement("div"));this.glow.className="ad-glow";this.layer.addEventListener("webkitTransitionEnd",this,false);this.clipsToBounds=true};
iAd.Toolbar.prototype.readPropertiesFromLayerAttributes=function(a){this.callSuper(a);a=[];for(var b,c=0,d=this.subviews.length;c<d;c++){b=this.subviews[c];b.willMoveToSuperview(this);a.push(new iAd.BarButtonItem(null,b));b.didMoveToSuperview()}this.setItemsAnimated(a,false)};iAd.Toolbar.prototype.setPosition=function(a){this.callSuper(a);this.layerIsInDocument&&this.callMethodNameAfterDelay("updateBackgroundWithPosition",0)};
iAd.Toolbar.prototype.setSize=function(a){a.height=iAd.Toolbar.DEFAULT_HEIGHT;this.callSuper(a);this.updateLayout()};iAd.Toolbar.prototype.willMoveToSuperview=function(a){if(a!=null&&this._size.width==0)this.size=new iAd.Size(a.size.width,iAd.Toolbar.DEFAULT_HEIGHT)};iAd.Toolbar.prototype.layerWasInsertedIntoDocument=function(){this.callSuper();this.updateBackgroundWithPosition()};
iAd.Toolbar.prototype.setBarStyle=function(a){this.layer.removeClassName(this._barStyle);this.layer.addClassName(a);this._barStyle=a};iAd.Toolbar.prototype.setItems=function(a){this.setItemsAnimated(a,false)};
iAd.Toolbar.prototype.setItemsAnimated=function(a,b){if(a==null)a=[];iAd.Transaction.begin();iAd.Transaction.defaults.duration=b?iAd.Toolbar.ANIMATION_DURATION:0;for(var c=0,d=this._items.length;c<d;c++){var e=this._items[c],f=e.view;if(a.indexOf(e)==-1)if(b){f.needsRemoval=true;f.applyTransition(iAd.Toolbar.FADE_OUT_TRANSITION)}else f.removeFromSuperview()}c=0;for(d=a.length;c<d;c++){e=a[c];f=e.view;if(f.superview!==this){e._newItem=true;this.addSubview(f);f.addPropertyObserver("size",this);e.type==
iAd.BarButtonItem.TYPE_PLAIN&&f.addEventListener(iAd.View.TOUCH_STATE_CHANGE_EVENT,this,false)}}var g=0;c=f=0;for(d=a.length;c<d;c++){e=a[c];if(e.type==iAd.BarButtonItem.TYPE_FLEXIBLE_SPACE)g++;else f+=e.view.size.width}c=this.isInPopover?0:iAd.Toolbar.EDGE_MARGIN;d=this.size.width-f-iAd.Toolbar.ITEM_MARGIN*(a.length-1)-c*2;g=g>0?d/g:0;var h=c,i;c=0;for(d=a.length;c<d;c++){i=iAd.Toolbar.ITEM_MARGIN;e=a[c];f=e.view;if(e.type==iAd.BarButtonItem.TYPE_FLEXIBLE_SPACE)h+=g;else if(e.type==iAd.BarButtonItem.TYPE_FIXED_SPACE){h+=
f.size.width;i=0}else{var j=new iAd.Point(iAd.CSS.roundedPxValue(h),iAd.CSS.roundedPxValue((this.size.height-f.size.height)/2));if(e._newItem){f.position=j;e._newItem=false;b&&f.applyTransition(iAd.View.TRANSITION_DISSOLVE_IN)}else f.applyTransition({properties:["position"],to:[j]});h+=f.size.width}h+=i}iAd.Transaction.commit();this._items=a};iAd.Toolbar.prototype.updateLayout=function(){this._items.length>0&&this.setItemsAnimated(this._items,false)};
iAd.Toolbar.prototype.updateBackgroundWithPosition=function(){this.layer.toggleClassName("ad-top",window.webkitConvertPointFromNodeToPage(this.layer,new WebKitPoint(0,0)).y==0)};
iAd.Toolbar.prototype.handleEvent=function(a){this.callSuper(a);if(a.type=="webkitTransitionEnd"){if(a.target!==this.layer)if(a.target!==this.glow)this.removeItemViewIfNeeded(a.target._control);else if(this.glow.style.opacity==0)this.glow.style.display="none"}else if(a.type==iAd.View.TOUCH_STATE_CHANGE_EVENT){a=a.ad.sender.view;this.glow.style.webkitTransform=iAd.CSS.t(a.position.x+a.size.width/2-50,0);this.glow.style.opacity=a.touchInside?1:0;this.glow.style.display="block"}};
iAd.Toolbar.prototype.removeItemViewIfNeeded=function(a){if(a&&a.needsRemoval){a.removeFromSuperview();a.needsRemoval=false;a.transitionsEnabled=false;a.transform="scale(1)";a.opacity=1}};iAd.Toolbar.prototype.handlePropertyChange=function(){this.setItemsAnimated(this._items,false)};
